var yL=Object.defineProperty,vL=Object.defineProperties;var xL=Object.getOwnPropertyDescriptors;var iT=Object.getOwnPropertySymbols;var bL=Object.prototype.hasOwnProperty,wL=Object.prototype.propertyIsEnumerable;var nT=(i,t,s)=>t in i?yL(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s,mi=(i,t)=>{for(var s in t||(t={}))bL.call(t,s)&&nT(i,s,t[s]);if(iT)for(var s of iT(t))wL.call(t,s)&&nT(i,s,t[s]);return i},E_=(i,t)=>vL(i,xL(t));var Ur="top",to="bottom",io="right",jr="left",T_="auto",oh=[Ur,to,io,jr],nc="start",sh="end",rT="clippingParents",e0="viewport",ah="popper",oT="reference",t0=oh.reduce(function(i,t){return i.concat([t+"-"+nc,t+"-"+sh])},[]),i0=[].concat(oh,[T_]).reduce(function(i,t){return i.concat([t,t+"-"+nc,t+"-"+sh])},[]),sT="beforeRead",aT="read",lT="afterRead",cT="beforeMain",uT="main",hT="afterMain",dT="beforeWrite",fT="write",pT="afterWrite",mT=[sT,aT,lT,cT,uT,hT,dT,fT,pT];function ds(i){return i?(i.nodeName||"").toLowerCase():null}function Vo(i){if(i==null)return window;if(i.toString()!=="[object Window]"){var t=i.ownerDocument;return t&&t.defaultView||window}return i}function Df(i){var t=Vo(i).Element;return i instanceof t||i instanceof Element}function xo(i){var t=Vo(i).HTMLElement;return i instanceof t||i instanceof HTMLElement}function _T(i){if(typeof ShadowRoot=="undefined")return!1;var t=Vo(i).ShadowRoot;return i instanceof t||i instanceof ShadowRoot}function EL(i){var t=i.state;Object.keys(t.elements).forEach(function(s){var h=t.styles[s]||{},_=t.attributes[s]||{},x=t.elements[s];!xo(x)||!ds(x)||(Object.assign(x.style,h),Object.keys(_).forEach(function(E){var a=_[E];a===!1?x.removeAttribute(E):x.setAttribute(E,a===!0?"":a)}))})}function TL(i){var t=i.state,s={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,s.popper),t.styles=s,t.elements.arrow&&Object.assign(t.elements.arrow.style,s.arrow),function(){Object.keys(t.elements).forEach(function(h){var _=t.elements[h],x=t.attributes[h]||{},E=Object.keys(t.styles.hasOwnProperty(h)?t.styles[h]:s[h]),a=E.reduce(function(S,O){return S[O]="",S},{});!xo(_)||!ds(_)||(Object.assign(_.style,a),Object.keys(x).forEach(function(S){_.removeAttribute(S)}))})}}var n0={name:"applyStyles",enabled:!0,phase:"write",fn:EL,effect:TL,requires:["computeStyles"]};function fs(i){return i.split("-")[0]}function lh(i,t){var s=i.getBoundingClientRect(),h=1,_=1;return{width:s.width/h,height:s.height/_,top:s.top/_,right:s.right/h,bottom:s.bottom/_,left:s.left/h,x:s.left/h,y:s.top/_}}function r0(i){var t=lh(i),s=i.offsetWidth,h=i.offsetHeight;return Math.abs(t.width-s)<=1&&(s=t.width),Math.abs(t.height-h)<=1&&(h=t.height),{x:i.offsetLeft,y:i.offsetTop,width:s,height:h}}function gT(i,t){var s=t.getRootNode&&t.getRootNode();if(i.contains(t))return!0;if(s&&_T(s)){var h=t;do{if(h&&i.isSameNode(h))return!0;h=h.parentNode||h.host}while(h)}return!1}function Qs(i){return Vo(i).getComputedStyle(i)}function CL(i){return["table","td","th"].indexOf(ds(i))>=0}function Za(i){return((Df(i)?i.ownerDocument:i.document)||window.document).documentElement}function C_(i){return ds(i)==="html"?i:i.assignedSlot||i.parentNode||(_T(i)?i.host:null)||Za(i)}function yT(i){return!xo(i)||Qs(i).position==="fixed"?null:i.offsetParent}function SL(i){var t=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,s=navigator.userAgent.indexOf("Trident")!==-1;if(s&&xo(i)){var h=Qs(i);if(h.position==="fixed")return null}for(var _=C_(i);xo(_)&&["html","body"].indexOf(ds(_))<0;){var x=Qs(_);if(x.transform!=="none"||x.perspective!=="none"||x.contain==="paint"||["transform","perspective"].indexOf(x.willChange)!==-1||t&&x.willChange==="filter"||t&&x.filter&&x.filter!=="none")return _;_=_.parentNode}return null}function Lf(i){for(var t=Vo(i),s=yT(i);s&&CL(s)&&Qs(s).position==="static";)s=yT(s);return s&&(ds(s)==="html"||ds(s)==="body"&&Qs(s).position==="static")?t:s||SL(i)||t}function o0(i){return["top","bottom"].indexOf(i)>=0?"x":"y"}var Wa=Math.max,zf=Math.min,S_=Math.round;function A_(i,t,s){return Wa(i,zf(t,s))}function vT(){return{top:0,right:0,bottom:0,left:0}}function xT(i){return Object.assign({},vT(),i)}function bT(i,t){return t.reduce(function(s,h){return s[h]=i,s},{})}var AL=function(t,s){return t=typeof t=="function"?t(Object.assign({},s.rects,{placement:s.placement})):t,xT(typeof t!="number"?t:bT(t,oh))};function IL(i){var t,s=i.state,h=i.name,_=i.options,x=s.elements.arrow,E=s.modifiersData.popperOffsets,a=fs(s.placement),S=o0(a),O=[jr,io].indexOf(a)>=0,M=O?"height":"width";if(!(!x||!E)){var P=AL(_.padding,s),z=r0(x),q=S==="y"?Ur:jr,se=S==="y"?to:io,ue=s.rects.reference[M]+s.rects.reference[S]-E[S]-s.rects.popper[M],oe=E[S]-s.rects.reference[S],fe=Lf(x),xe=fe?S==="y"?fe.clientHeight||0:fe.clientWidth||0:0,Be=ue/2-oe/2,$e=P[q],Ge=xe-z[M]-P[se],xt=xe/2-z[M]/2+Be,pt=A_($e,xt,Ge),jt=S;s.modifiersData[h]=(t={},t[jt]=pt,t.centerOffset=pt-xt,t)}}function ML(i){var t=i.state,s=i.options,h=s.element,_=h===void 0?"[data-popper-arrow]":h;_!=null&&(typeof _=="string"&&(_=t.elements.popper.querySelector(_),!_)||!gT(t.elements.popper,_)||(t.elements.arrow=_))}var wT={name:"arrow",enabled:!0,phase:"main",fn:IL,effect:ML,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ch(i){return i.split("-")[1]}var kL={top:"auto",right:"auto",bottom:"auto",left:"auto"};function PL(i){var t=i.x,s=i.y,h=window,_=h.devicePixelRatio||1;return{x:S_(S_(t*_)/_)||0,y:S_(S_(s*_)/_)||0}}function ET(i){var t,s=i.popper,h=i.popperRect,_=i.placement,x=i.variation,E=i.offsets,a=i.position,S=i.gpuAcceleration,O=i.adaptive,M=i.roundOffsets,P=M===!0?PL(E):typeof M=="function"?M(E):E,z=P.x,q=z===void 0?0:z,se=P.y,ue=se===void 0?0:se,oe=E.hasOwnProperty("x"),fe=E.hasOwnProperty("y"),xe=jr,Be=Ur,$e=window;if(O){var Ge=Lf(s),xt="clientHeight",pt="clientWidth";Ge===Vo(s)&&(Ge=Za(s),Qs(Ge).position!=="static"&&a==="absolute"&&(xt="scrollHeight",pt="scrollWidth")),Ge=Ge,(_===Ur||(_===jr||_===io)&&x===sh)&&(Be=to,ue-=Ge[xt]-h.height,ue*=S?1:-1),(_===jr||(_===Ur||_===to)&&x===sh)&&(xe=io,q-=Ge[pt]-h.width,q*=S?1:-1)}var jt=Object.assign({position:a},O&&kL);if(S){var Dt;return Object.assign({},jt,(Dt={},Dt[Be]=fe?"0":"",Dt[xe]=oe?"0":"",Dt.transform=($e.devicePixelRatio||1)<=1?"translate("+q+"px, "+ue+"px)":"translate3d("+q+"px, "+ue+"px, 0)",Dt))}return Object.assign({},jt,(t={},t[Be]=fe?ue+"px":"",t[xe]=oe?q+"px":"",t.transform="",t))}function DL(i){var t=i.state,s=i.options,h=s.gpuAcceleration,_=h===void 0?!0:h,x=s.adaptive,E=x===void 0?!0:x,a=s.roundOffsets,S=a===void 0?!0:a,O={placement:fs(t.placement),variation:ch(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:_};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,ET(Object.assign({},O,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:E,roundOffsets:S})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,ET(Object.assign({},O,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:S})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var s0={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:DL,data:{}},I_={passive:!0};function LL(i){var t=i.state,s=i.instance,h=i.options,_=h.scroll,x=_===void 0?!0:_,E=h.resize,a=E===void 0?!0:E,S=Vo(t.elements.popper),O=[].concat(t.scrollParents.reference,t.scrollParents.popper);return x&&O.forEach(function(M){M.addEventListener("scroll",s.update,I_)}),a&&S.addEventListener("resize",s.update,I_),function(){x&&O.forEach(function(M){M.removeEventListener("scroll",s.update,I_)}),a&&S.removeEventListener("resize",s.update,I_)}}var a0={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:LL,data:{}},zL={left:"right",right:"left",bottom:"top",top:"bottom"};function M_(i){return i.replace(/left|right|bottom|top/g,function(t){return zL[t]})}var OL={start:"end",end:"start"};function TT(i){return i.replace(/start|end/g,function(t){return OL[t]})}function l0(i){var t=Vo(i),s=t.pageXOffset,h=t.pageYOffset;return{scrollLeft:s,scrollTop:h}}function c0(i){return lh(Za(i)).left+l0(i).scrollLeft}function RL(i){var t=Vo(i),s=Za(i),h=t.visualViewport,_=s.clientWidth,x=s.clientHeight,E=0,a=0;return h&&(_=h.width,x=h.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(E=h.offsetLeft,a=h.offsetTop)),{width:_,height:x,x:E+c0(i),y:a}}function BL(i){var t,s=Za(i),h=l0(i),_=(t=i.ownerDocument)==null?void 0:t.body,x=Wa(s.scrollWidth,s.clientWidth,_?_.scrollWidth:0,_?_.clientWidth:0),E=Wa(s.scrollHeight,s.clientHeight,_?_.scrollHeight:0,_?_.clientHeight:0),a=-h.scrollLeft+c0(i),S=-h.scrollTop;return Qs(_||s).direction==="rtl"&&(a+=Wa(s.clientWidth,_?_.clientWidth:0)-x),{width:x,height:E,x:a,y:S}}function u0(i){var t=Qs(i),s=t.overflow,h=t.overflowX,_=t.overflowY;return/auto|scroll|overlay|hidden/.test(s+_+h)}function CT(i){return["html","body","#document"].indexOf(ds(i))>=0?i.ownerDocument.body:xo(i)&&u0(i)?i:CT(C_(i))}function Of(i,t){var s;t===void 0&&(t=[]);var h=CT(i),_=h===((s=i.ownerDocument)==null?void 0:s.body),x=Vo(h),E=_?[x].concat(x.visualViewport||[],u0(h)?h:[]):h,a=t.concat(E);return _?a:a.concat(Of(C_(E)))}function h0(i){return Object.assign({},i,{left:i.x,top:i.y,right:i.x+i.width,bottom:i.y+i.height})}function FL(i){var t=lh(i);return t.top=t.top+i.clientTop,t.left=t.left+i.clientLeft,t.bottom=t.top+i.clientHeight,t.right=t.left+i.clientWidth,t.width=i.clientWidth,t.height=i.clientHeight,t.x=t.left,t.y=t.top,t}function ST(i,t){return t===e0?h0(RL(i)):xo(t)?FL(t):h0(BL(Za(i)))}function NL(i){var t=Of(C_(i)),s=["absolute","fixed"].indexOf(Qs(i).position)>=0,h=s&&xo(i)?Lf(i):i;return Df(h)?t.filter(function(_){return Df(_)&&gT(_,h)&&ds(_)!=="body"}):[]}function UL(i,t,s){var h=t==="clippingParents"?NL(i):[].concat(t),_=[].concat(h,[s]),x=_[0],E=_.reduce(function(a,S){var O=ST(i,S);return a.top=Wa(O.top,a.top),a.right=zf(O.right,a.right),a.bottom=zf(O.bottom,a.bottom),a.left=Wa(O.left,a.left),a},ST(i,x));return E.width=E.right-E.left,E.height=E.bottom-E.top,E.x=E.left,E.y=E.top,E}function AT(i){var t=i.reference,s=i.element,h=i.placement,_=h?fs(h):null,x=h?ch(h):null,E=t.x+t.width/2-s.width/2,a=t.y+t.height/2-s.height/2,S;switch(_){case Ur:S={x:E,y:t.y-s.height};break;case to:S={x:E,y:t.y+t.height};break;case io:S={x:t.x+t.width,y:a};break;case jr:S={x:t.x-s.width,y:a};break;default:S={x:t.x,y:t.y}}var O=_?o0(_):null;if(O!=null){var M=O==="y"?"height":"width";switch(x){case nc:S[O]=S[O]-(t[M]/2-s[M]/2);break;case sh:S[O]=S[O]+(t[M]/2-s[M]/2);break}}return S}function uh(i,t){t===void 0&&(t={});var s=t,h=s.placement,_=h===void 0?i.placement:h,x=s.boundary,E=x===void 0?rT:x,a=s.rootBoundary,S=a===void 0?e0:a,O=s.elementContext,M=O===void 0?ah:O,P=s.altBoundary,z=P===void 0?!1:P,q=s.padding,se=q===void 0?0:q,ue=xT(typeof se!="number"?se:bT(se,oh)),oe=M===ah?oT:ah,fe=i.rects.popper,xe=i.elements[z?oe:M],Be=UL(Df(xe)?xe:xe.contextElement||Za(i.elements.popper),E,S),$e=lh(i.elements.reference),Ge=AT({reference:$e,element:fe,strategy:"absolute",placement:_}),xt=h0(Object.assign({},fe,Ge)),pt=M===ah?xt:$e,jt={top:Be.top-pt.top+ue.top,bottom:pt.bottom-Be.bottom+ue.bottom,left:Be.left-pt.left+ue.left,right:pt.right-Be.right+ue.right},Dt=i.modifiersData.offset;if(M===ah&&Dt){var Ft=Dt[_];Object.keys(jt).forEach(function(ai){var wt=[io,to].indexOf(ai)>=0?1:-1,Nt=[Ur,to].indexOf(ai)>=0?"y":"x";jt[ai]+=Ft[Nt]*wt})}return jt}function jL(i,t){t===void 0&&(t={});var s=t,h=s.placement,_=s.boundary,x=s.rootBoundary,E=s.padding,a=s.flipVariations,S=s.allowedAutoPlacements,O=S===void 0?i0:S,M=ch(h),P=M?a?t0:t0.filter(function(se){return ch(se)===M}):oh,z=P.filter(function(se){return O.indexOf(se)>=0});z.length===0&&(z=P);var q=z.reduce(function(se,ue){return se[ue]=uh(i,{placement:ue,boundary:_,rootBoundary:x,padding:E})[fs(ue)],se},{});return Object.keys(q).sort(function(se,ue){return q[se]-q[ue]})}function VL(i){if(fs(i)===T_)return[];var t=M_(i);return[TT(i),t,TT(t)]}function $L(i){var t=i.state,s=i.options,h=i.name;if(!t.modifiersData[h]._skip){for(var _=s.mainAxis,x=_===void 0?!0:_,E=s.altAxis,a=E===void 0?!0:E,S=s.fallbackPlacements,O=s.padding,M=s.boundary,P=s.rootBoundary,z=s.altBoundary,q=s.flipVariations,se=q===void 0?!0:q,ue=s.allowedAutoPlacements,oe=t.options.placement,fe=fs(oe),xe=fe===oe,Be=S||(xe||!se?[M_(oe)]:VL(oe)),$e=[oe].concat(Be).reduce(function(yn,Ne){return yn.concat(fs(Ne)===T_?jL(t,{placement:Ne,boundary:M,rootBoundary:P,padding:O,flipVariations:se,allowedAutoPlacements:ue}):Ne)},[]),Ge=t.rects.reference,xt=t.rects.popper,pt=new Map,jt=!0,Dt=$e[0],Ft=0;Ft<$e.length;Ft++){var ai=$e[Ft],wt=fs(ai),Nt=ch(ai)===nc,qi=[Ur,to].indexOf(wt)>=0,bn=qi?"width":"height",hi=uh(t,{placement:ai,boundary:M,rootBoundary:P,altBoundary:z,padding:O}),ri=qi?Nt?io:jr:Nt?to:Ur;Ge[bn]>xt[bn]&&(ri=M_(ri));var ei=M_(ri),Wi=[];if(x&&Wi.push(hi[wt]<=0),a&&Wi.push(hi[ri]<=0,hi[ei]<=0),Wi.every(function(yn){return yn})){Dt=ai,jt=!1;break}pt.set(ai,Wi)}if(jt)for(var sn=se?3:1,kn=function(Ne){var bt=$e.find(function(ct){var It=pt.get(ct);if(It)return It.slice(0,Ne).every(function(wi){return wi})});if(bt)return Dt=bt,"break"},oi=sn;oi>0;oi--){var Si=kn(oi);if(Si==="break")break}t.placement!==Dt&&(t.modifiersData[h]._skip=!0,t.placement=Dt,t.reset=!0)}}var IT={name:"flip",enabled:!0,phase:"main",fn:$L,requiresIfExists:["offset"],data:{_skip:!1}};function MT(i,t,s){return s===void 0&&(s={x:0,y:0}),{top:i.top-t.height-s.y,right:i.right-t.width+s.x,bottom:i.bottom-t.height+s.y,left:i.left-t.width-s.x}}function kT(i){return[Ur,io,to,jr].some(function(t){return i[t]>=0})}function GL(i){var t=i.state,s=i.name,h=t.rects.reference,_=t.rects.popper,x=t.modifiersData.preventOverflow,E=uh(t,{elementContext:"reference"}),a=uh(t,{altBoundary:!0}),S=MT(E,h),O=MT(a,_,x),M=kT(S),P=kT(O);t.modifiersData[s]={referenceClippingOffsets:S,popperEscapeOffsets:O,isReferenceHidden:M,hasPopperEscaped:P},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":M,"data-popper-escaped":P})}var PT={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:GL};function qL(i,t,s){var h=fs(i),_=[jr,Ur].indexOf(h)>=0?-1:1,x=typeof s=="function"?s(Object.assign({},t,{placement:i})):s,E=x[0],a=x[1];return E=E||0,a=(a||0)*_,[jr,io].indexOf(h)>=0?{x:a,y:E}:{x:E,y:a}}function ZL(i){var t=i.state,s=i.options,h=i.name,_=s.offset,x=_===void 0?[0,0]:_,E=i0.reduce(function(M,P){return M[P]=qL(P,t.rects,x),M},{}),a=E[t.placement],S=a.x,O=a.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=S,t.modifiersData.popperOffsets.y+=O),t.modifiersData[h]=E}var DT={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:ZL};function WL(i){var t=i.state,s=i.name;t.modifiersData[s]=AT({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}var d0={name:"popperOffsets",enabled:!0,phase:"read",fn:WL,data:{}};function HL(i){return i==="x"?"y":"x"}function XL(i){var t=i.state,s=i.options,h=i.name,_=s.mainAxis,x=_===void 0?!0:_,E=s.altAxis,a=E===void 0?!1:E,S=s.boundary,O=s.rootBoundary,M=s.altBoundary,P=s.padding,z=s.tether,q=z===void 0?!0:z,se=s.tetherOffset,ue=se===void 0?0:se,oe=uh(t,{boundary:S,rootBoundary:O,padding:P,altBoundary:M}),fe=fs(t.placement),xe=ch(t.placement),Be=!xe,$e=o0(fe),Ge=HL($e),xt=t.modifiersData.popperOffsets,pt=t.rects.reference,jt=t.rects.popper,Dt=typeof ue=="function"?ue(Object.assign({},t.rects,{placement:t.placement})):ue,Ft={x:0,y:0};if(!!xt){if(x||a){var ai=$e==="y"?Ur:jr,wt=$e==="y"?to:io,Nt=$e==="y"?"height":"width",qi=xt[$e],bn=xt[$e]+oe[ai],hi=xt[$e]-oe[wt],ri=q?-jt[Nt]/2:0,ei=xe===nc?pt[Nt]:jt[Nt],Wi=xe===nc?-jt[Nt]:-pt[Nt],sn=t.elements.arrow,kn=q&&sn?r0(sn):{width:0,height:0},oi=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:vT(),Si=oi[ai],yn=oi[wt],Ne=A_(0,pt[Nt],kn[Nt]),bt=Be?pt[Nt]/2-ri-Ne-Si-Dt:ei-Ne-Si-Dt,ct=Be?-pt[Nt]/2+ri+Ne+yn+Dt:Wi+Ne+yn+Dt,It=t.elements.arrow&&Lf(t.elements.arrow),wi=It?$e==="y"?It.clientTop||0:It.clientLeft||0:0,di=t.modifiersData.offset?t.modifiersData.offset[t.placement][$e]:0,ti=xt[$e]+bt-di-wi,Wt=xt[$e]+ct-di;if(x){var de=A_(q?zf(bn,ti):bn,qi,q?Wa(hi,Wt):hi);xt[$e]=de,Ft[$e]=de-qi}if(a){var me=$e==="x"?Ur:jr,Le=$e==="x"?to:io,He=xt[Ge],Ze=He+oe[me],et=He-oe[Le],vt=A_(q?zf(Ze,ti):Ze,He,q?Wa(et,Wt):et);xt[Ge]=vt,Ft[Ge]=vt-He}}t.modifiersData[h]=Ft}}var LT={name:"preventOverflow",enabled:!0,phase:"main",fn:XL,requiresIfExists:["offset"]};function KL(i){return{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}}function YL(i){return i===Vo(i)||!xo(i)?l0(i):KL(i)}function JL(i){var t=i.getBoundingClientRect(),s=t.width/i.offsetWidth||1,h=t.height/i.offsetHeight||1;return s!==1||h!==1}function QL(i,t,s){s===void 0&&(s=!1);var h=xo(t);xo(t)&&JL(t);var _=Za(t),x=lh(i),E={scrollLeft:0,scrollTop:0},a={x:0,y:0};return(h||!h&&!s)&&((ds(t)!=="body"||u0(_))&&(E=YL(t)),xo(t)?(a=lh(t),a.x+=t.clientLeft,a.y+=t.clientTop):_&&(a.x=c0(_))),{x:x.left+E.scrollLeft-a.x,y:x.top+E.scrollTop-a.y,width:x.width,height:x.height}}function ez(i){var t=new Map,s=new Set,h=[];i.forEach(function(x){t.set(x.name,x)});function _(x){s.add(x.name);var E=[].concat(x.requires||[],x.requiresIfExists||[]);E.forEach(function(a){if(!s.has(a)){var S=t.get(a);S&&_(S)}}),h.push(x)}return i.forEach(function(x){s.has(x.name)||_(x)}),h}function tz(i){var t=ez(i);return mT.reduce(function(s,h){return s.concat(t.filter(function(_){return _.phase===h}))},[])}function iz(i){var t;return function(){return t||(t=new Promise(function(s){Promise.resolve().then(function(){t=void 0,s(i())})})),t}}function nz(i){var t=i.reduce(function(s,h){var _=s[h.name];return s[h.name]=_?Object.assign({},_,h,{options:Object.assign({},_.options,h.options),data:Object.assign({},_.data,h.data)}):h,s},{});return Object.keys(t).map(function(s){return t[s]})}var zT={placement:"bottom",modifiers:[],strategy:"absolute"};function OT(){for(var i=arguments.length,t=new Array(i),s=0;s<i;s++)t[s]=arguments[s];return!t.some(function(h){return!(h&&typeof h.getBoundingClientRect=="function")})}function k_(i){i===void 0&&(i={});var t=i,s=t.defaultModifiers,h=s===void 0?[]:s,_=t.defaultOptions,x=_===void 0?zT:_;return function(a,S,O){O===void 0&&(O=x);var M={placement:"bottom",orderedModifiers:[],options:Object.assign({},zT,x),modifiersData:{},elements:{reference:a,popper:S},attributes:{},styles:{}},P=[],z=!1,q={state:M,setOptions:function(fe){var xe=typeof fe=="function"?fe(M.options):fe;ue(),M.options=Object.assign({},x,M.options,xe),M.scrollParents={reference:Df(a)?Of(a):a.contextElement?Of(a.contextElement):[],popper:Of(S)};var Be=tz(nz([].concat(h,M.options.modifiers)));return M.orderedModifiers=Be.filter(function($e){return $e.enabled}),se(),q.update()},forceUpdate:function(){if(!z){var fe=M.elements,xe=fe.reference,Be=fe.popper;if(!!OT(xe,Be)){M.rects={reference:QL(xe,Lf(Be),M.options.strategy==="fixed"),popper:r0(Be)},M.reset=!1,M.placement=M.options.placement,M.orderedModifiers.forEach(function(Ft){return M.modifiersData[Ft.name]=Object.assign({},Ft.data)});for(var $e=0;$e<M.orderedModifiers.length;$e++){if(M.reset===!0){M.reset=!1,$e=-1;continue}var Ge=M.orderedModifiers[$e],xt=Ge.fn,pt=Ge.options,jt=pt===void 0?{}:pt,Dt=Ge.name;typeof xt=="function"&&(M=xt({state:M,options:jt,name:Dt,instance:q})||M)}}}},update:iz(function(){return new Promise(function(oe){q.forceUpdate(),oe(M)})}),destroy:function(){ue(),z=!0}};if(!OT(a,S))return q;q.setOptions(O).then(function(oe){!z&&O.onFirstUpdate&&O.onFirstUpdate(oe)});function se(){M.orderedModifiers.forEach(function(oe){var fe=oe.name,xe=oe.options,Be=xe===void 0?{}:xe,$e=oe.effect;if(typeof $e=="function"){var Ge=$e({state:M,name:fe,instance:q,options:Be}),xt=function(){};P.push(Ge||xt)}})}function ue(){P.forEach(function(oe){return oe()}),P=[]}return q}}var rz=k_(),oz=[a0,d0,s0,n0],sz=k_({defaultModifiers:oz}),az=[a0,d0,s0,n0,DT,IT,LT,wT,PT],f0=k_({defaultModifiers:az}),RT=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",popperGenerator:k_,detectOverflow:uh,createPopperBase:rz,createPopper:f0,createPopperLite:sz,top:Ur,bottom:to,right:io,left:jr,auto:T_,basePlacements:oh,start:nc,end:sh,clippingParents:rT,viewport:e0,popper:ah,reference:oT,variationPlacements:t0,placements:i0,beforeRead:sT,read:aT,afterRead:lT,beforeMain:cT,main:uT,afterMain:hT,beforeWrite:dT,write:fT,afterWrite:pT,modifierPhases:mT,applyStyles:n0,arrow:wT,computeStyles:s0,eventListeners:a0,flip:IT,hide:PT,offset:DT,popperOffsets:d0,preventOverflow:LT});/*!
  * Bootstrap v5.1.3 (https://getbootstrap.com/)
  * Copyright 2011-2021 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const lz=1e6,cz=1e3,p0="transitionend",uz=i=>i==null?`${i}`:{}.toString.call(i).match(/\s([a-z]+)/i)[1].toLowerCase(),hz=i=>{do i+=Math.floor(Math.random()*lz);while(document.getElementById(i));return i},BT=i=>{let t=i.getAttribute("data-bs-target");if(!t||t==="#"){let s=i.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),t=s&&s!=="#"?s.trim():null}return t},m0=i=>{const t=BT(i);return t&&document.querySelector(t)?t:null},Ha=i=>{const t=BT(i);return t?document.querySelector(t):null},dz=i=>{if(!i)return 0;let{transitionDuration:t,transitionDelay:s}=window.getComputedStyle(i);const h=Number.parseFloat(t),_=Number.parseFloat(s);return!h&&!_?0:(t=t.split(",")[0],s=s.split(",")[0],(Number.parseFloat(t)+Number.parseFloat(s))*cz)},FT=i=>{i.dispatchEvent(new Event(p0))},rc=i=>!i||typeof i!="object"?!1:(typeof i.jquery!="undefined"&&(i=i[0]),typeof i.nodeType!="undefined"),Xa=i=>rc(i)?i.jquery?i[0]:i:typeof i=="string"&&i.length>0?document.querySelector(i):null,ps=(i,t,s)=>{Object.keys(s).forEach(h=>{const _=s[h],x=t[h],E=x&&rc(x)?"element":uz(x);if(!new RegExp(_).test(E))throw new TypeError(`${i.toUpperCase()}: Option "${h}" provided type "${E}" but expected type "${_}".`)})},Rf=i=>!rc(i)||i.getClientRects().length===0?!1:getComputedStyle(i).getPropertyValue("visibility")==="visible",oc=i=>!i||i.nodeType!==Node.ELEMENT_NODE||i.classList.contains("disabled")?!0:typeof i.disabled!="undefined"?i.disabled:i.hasAttribute("disabled")&&i.getAttribute("disabled")!=="false",NT=i=>{if(!document.documentElement.attachShadow)return null;if(typeof i.getRootNode=="function"){const t=i.getRootNode();return t instanceof ShadowRoot?t:null}return i instanceof ShadowRoot?i:i.parentNode?NT(i.parentNode):null},P_=()=>{},hh=i=>{i.offsetHeight},UT=()=>{const{jQuery:i}=window;return i&&!document.body.hasAttribute("data-bs-no-jquery")?i:null},_0=[],fz=i=>{document.readyState==="loading"?(_0.length||document.addEventListener("DOMContentLoaded",()=>{_0.forEach(t=>t())}),_0.push(i)):i()},Vr=()=>document.documentElement.dir==="rtl",bo=i=>{fz(()=>{const t=UT();if(t){const s=i.NAME,h=t.fn[s];t.fn[s]=i.jQueryInterface,t.fn[s].Constructor=i,t.fn[s].noConflict=()=>(t.fn[s]=h,i.jQueryInterface)}})},sc=i=>{typeof i=="function"&&i()},jT=(i,t,s=!0)=>{if(!s){sc(i);return}const h=5,_=dz(t)+h;let x=!1;const E=({target:a})=>{a===t&&(x=!0,t.removeEventListener(p0,E),sc(i))};t.addEventListener(p0,E),setTimeout(()=>{x||FT(t)},_)},VT=(i,t,s,h)=>{let _=i.indexOf(t);if(_===-1)return i[!s&&h?i.length-1:0];const x=i.length;return _+=s?1:-1,h&&(_=(_+x)%x),i[Math.max(0,Math.min(_,x-1))]},pz=/[^.]*(?=\..*)\.|.*/,mz=/\..*/,_z=/::\d+$/,g0={};let $T=1;const gz={mouseenter:"mouseover",mouseleave:"mouseout"},yz=/^(mouseenter|mouseleave)/i,GT=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function qT(i,t){return t&&`${t}::${$T++}`||i.uidEvent||$T++}function ZT(i){const t=qT(i);return i.uidEvent=t,g0[t]=g0[t]||{},g0[t]}function vz(i,t){return function s(h){return h.delegateTarget=i,s.oneOff&&it.off(i,h.type,t),t.apply(i,[h])}}function xz(i,t,s){return function h(_){const x=i.querySelectorAll(t);for(let{target:E}=_;E&&E!==this;E=E.parentNode)for(let a=x.length;a--;)if(x[a]===E)return _.delegateTarget=E,h.oneOff&&it.off(i,_.type,t,s),s.apply(E,[_]);return null}}function WT(i,t,s=null){const h=Object.keys(i);for(let _=0,x=h.length;_<x;_++){const E=i[h[_]];if(E.originalHandler===t&&E.delegationSelector===s)return E}return null}function HT(i,t,s){const h=typeof t=="string",_=h?s:t;let x=KT(i);return GT.has(x)||(x=i),[h,_,x]}function XT(i,t,s,h,_){if(typeof t!="string"||!i)return;if(s||(s=h,h=null),yz.test(t)){const q=se=>function(ue){if(!ue.relatedTarget||ue.relatedTarget!==ue.delegateTarget&&!ue.delegateTarget.contains(ue.relatedTarget))return se.call(this,ue)};h?h=q(h):s=q(s)}const[x,E,a]=HT(t,s,h),S=ZT(i),O=S[a]||(S[a]={}),M=WT(O,E,x?s:null);if(M){M.oneOff=M.oneOff&&_;return}const P=qT(E,t.replace(pz,"")),z=x?xz(i,s,h):vz(i,s);z.delegationSelector=x?s:null,z.originalHandler=E,z.oneOff=_,z.uidEvent=P,O[P]=z,i.addEventListener(a,z,x)}function y0(i,t,s,h,_){const x=WT(t[s],h,_);!x||(i.removeEventListener(s,x,Boolean(_)),delete t[s][x.uidEvent])}function bz(i,t,s,h){const _=t[s]||{};Object.keys(_).forEach(x=>{if(x.includes(h)){const E=_[x];y0(i,t,s,E.originalHandler,E.delegationSelector)}})}function KT(i){return i=i.replace(mz,""),gz[i]||i}const it={on(i,t,s,h){XT(i,t,s,h,!1)},one(i,t,s,h){XT(i,t,s,h,!0)},off(i,t,s,h){if(typeof t!="string"||!i)return;const[_,x,E]=HT(t,s,h),a=E!==t,S=ZT(i),O=t.startsWith(".");if(typeof x!="undefined"){if(!S||!S[E])return;y0(i,S,E,x,_?s:null);return}O&&Object.keys(S).forEach(P=>{bz(i,S,P,t.slice(1))});const M=S[E]||{};Object.keys(M).forEach(P=>{const z=P.replace(_z,"");if(!a||t.includes(z)){const q=M[P];y0(i,S,E,q.originalHandler,q.delegationSelector)}})},trigger(i,t,s){if(typeof t!="string"||!i)return null;const h=UT(),_=KT(t),x=t!==_,E=GT.has(_);let a,S=!0,O=!0,M=!1,P=null;return x&&h&&(a=h.Event(t,s),h(i).trigger(a),S=!a.isPropagationStopped(),O=!a.isImmediatePropagationStopped(),M=a.isDefaultPrevented()),E?(P=document.createEvent("HTMLEvents"),P.initEvent(_,S,!0)):P=new CustomEvent(t,{bubbles:S,cancelable:!0}),typeof s!="undefined"&&Object.keys(s).forEach(z=>{Object.defineProperty(P,z,{get(){return s[z]}})}),M&&P.preventDefault(),O&&i.dispatchEvent(P),P.defaultPrevented&&typeof a!="undefined"&&a.preventDefault(),P}},Ka=new Map,Bf={set(i,t,s){Ka.has(i)||Ka.set(i,new Map);const h=Ka.get(i);if(!h.has(t)&&h.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(h.keys())[0]}.`);return}h.set(t,s)},get(i,t){return Ka.has(i)&&Ka.get(i).get(t)||null},remove(i,t){if(!Ka.has(i))return;const s=Ka.get(i);s.delete(t),s.size===0&&Ka.delete(i)}},wz="5.1.3";class $o{constructor(t){t=Xa(t),!!t&&(this._element=t,Bf.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Bf.remove(this._element,this.constructor.DATA_KEY),it.off(this._element,this.constructor.EVENT_KEY),Object.getOwnPropertyNames(this).forEach(t=>{this[t]=null})}_queueCallback(t,s,h=!0){jT(t,s,h)}static getInstance(t){return Bf.get(Xa(t),this.DATA_KEY)}static getOrCreateInstance(t,s={}){return this.getInstance(t)||new this(t,typeof s=="object"?s:null)}static get VERSION(){return wz}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}}const D_=(i,t="hide")=>{const s=`click.dismiss${i.EVENT_KEY}`,h=i.NAME;it.on(document,s,`[data-bs-dismiss="${h}"]`,function(_){if(["A","AREA"].includes(this.tagName)&&_.preventDefault(),oc(this))return;const x=Ha(this)||this.closest(`.${h}`);i.getOrCreateInstance(x)[t]()})},Ez="alert",Tz="bs.alert",YT=`.${Tz}`,Cz=`close${YT}`,Sz=`closed${YT}`,Az="fade",Iz="show";class L_ extends $o{static get NAME(){return Ez}close(){if(it.trigger(this._element,Cz).defaultPrevented)return;this._element.classList.remove(Iz);const s=this._element.classList.contains(Az);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),it.trigger(this._element,Sz),this.dispose()}static jQueryInterface(t){return this.each(function(){const s=L_.getOrCreateInstance(this);if(typeof t=="string"){if(s[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);s[t](this)}})}}D_(L_,"close");bo(L_);const Mz="button",kz="bs.button",Pz=`.${kz}`,Dz=".data-api",Lz="active",JT='[data-bs-toggle="button"]',zz=`click${Pz}${Dz}`;class z_ extends $o{static get NAME(){return Mz}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Lz))}static jQueryInterface(t){return this.each(function(){const s=z_.getOrCreateInstance(this);t==="toggle"&&s[t]()})}}it.on(document,zz,JT,i=>{i.preventDefault();const t=i.target.closest(JT);z_.getOrCreateInstance(t).toggle()});bo(z_);function QT(i){return i==="true"?!0:i==="false"?!1:i===Number(i).toString()?Number(i):i===""||i==="null"?null:i}function v0(i){return i.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}const Jn={setDataAttribute(i,t,s){i.setAttribute(`data-bs-${v0(t)}`,s)},removeDataAttribute(i,t){i.removeAttribute(`data-bs-${v0(t)}`)},getDataAttributes(i){if(!i)return{};const t={};return Object.keys(i.dataset).filter(s=>s.startsWith("bs")).forEach(s=>{let h=s.replace(/^bs/,"");h=h.charAt(0).toLowerCase()+h.slice(1,h.length),t[h]=QT(i.dataset[s])}),t},getDataAttribute(i,t){return QT(i.getAttribute(`data-bs-${v0(t)}`))},offset(i){const t=i.getBoundingClientRect();return{top:t.top+window.pageYOffset,left:t.left+window.pageXOffset}},position(i){return{top:i.offsetTop,left:i.offsetLeft}}},Oz=3,Jt={find(i,t=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(t,i))},findOne(i,t=document.documentElement){return Element.prototype.querySelector.call(t,i)},children(i,t){return[].concat(...i.children).filter(s=>s.matches(t))},parents(i,t){const s=[];let h=i.parentNode;for(;h&&h.nodeType===Node.ELEMENT_NODE&&h.nodeType!==Oz;)h.matches(t)&&s.push(h),h=h.parentNode;return s},prev(i,t){let s=i.previousElementSibling;for(;s;){if(s.matches(t))return[s];s=s.previousElementSibling}return[]},next(i,t){let s=i.nextElementSibling;for(;s;){if(s.matches(t))return[s];s=s.nextElementSibling}return[]},focusableChildren(i){const t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(", ");return this.find(t,i).filter(s=>!oc(s)&&Rf(s))}},eC="carousel",Rz="bs.carousel",no=`.${Rz}`,tC=".data-api",Bz="ArrowLeft",Fz="ArrowRight",Nz=500,Uz=40,iC={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},jz={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},ac="next",lc="prev",cc="left",Ff="right",Vz={[Bz]:Ff,[Fz]:cc},$z=`slide${no}`,nC=`slid${no}`,Gz=`keydown${no}`,qz=`mouseenter${no}`,Zz=`mouseleave${no}`,Wz=`touchstart${no}`,Hz=`touchmove${no}`,Xz=`touchend${no}`,Kz=`pointerdown${no}`,Yz=`pointerup${no}`,Jz=`dragstart${no}`,Qz=`load${no}${tC}`,eO=`click${no}${tC}`,tO="carousel",uc="active",iO="slide",nO="carousel-item-end",rO="carousel-item-start",oO="carousel-item-next",sO="carousel-item-prev",aO="pointer-event",lO=".active",O_=".active.carousel-item",cO=".carousel-item",uO=".carousel-item img",hO=".carousel-item-next, .carousel-item-prev",dO=".carousel-indicators",fO="[data-bs-target]",pO="[data-bs-slide], [data-bs-slide-to]",mO='[data-bs-ride="carousel"]',_O="touch",gO="pen";class ea extends $o{constructor(t,s){super(t);this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(s),this._indicatorsElement=Jt.findOne(dO,this._element),this._touchSupported="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0,this._pointerEvent=Boolean(window.PointerEvent),this._addEventListeners()}static get Default(){return iC}static get NAME(){return eC}next(){this._slide(ac)}nextWhenVisible(){!document.hidden&&Rf(this._element)&&this.next()}prev(){this._slide(lc)}pause(t){t||(this._isPaused=!0),Jt.findOne(hO,this._element)&&(FT(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null}cycle(t){t||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config&&this._config.interval&&!this._isPaused&&(this._updateInterval(),this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))}to(t){this._activeElement=Jt.findOne(O_,this._element);const s=this._getItemIndex(this._activeElement);if(t>this._items.length-1||t<0)return;if(this._isSliding){it.one(this._element,nC,()=>this.to(t));return}if(s===t){this.pause(),this.cycle();return}const h=t>s?ac:lc;this._slide(h,this._items[t])}_getConfig(t){return t=mi(mi(mi({},iC),Jn.getDataAttributes(this._element)),typeof t=="object"?t:{}),ps(eC,t,jz),t}_handleSwipe(){const t=Math.abs(this.touchDeltaX);if(t<=Uz)return;const s=t/this.touchDeltaX;this.touchDeltaX=0,!!s&&this._slide(s>0?Ff:cc)}_addEventListeners(){this._config.keyboard&&it.on(this._element,Gz,t=>this._keydown(t)),this._config.pause==="hover"&&(it.on(this._element,qz,t=>this.pause(t)),it.on(this._element,Zz,t=>this.cycle(t))),this._config.touch&&this._touchSupported&&this._addTouchEventListeners()}_addTouchEventListeners(){const t=x=>this._pointerEvent&&(x.pointerType===gO||x.pointerType===_O),s=x=>{t(x)?this.touchStartX=x.clientX:this._pointerEvent||(this.touchStartX=x.touches[0].clientX)},h=x=>{this.touchDeltaX=x.touches&&x.touches.length>1?0:x.touches[0].clientX-this.touchStartX},_=x=>{t(x)&&(this.touchDeltaX=x.clientX-this.touchStartX),this._handleSwipe(),this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(E=>this.cycle(E),Nz+this._config.interval))};Jt.find(uO,this._element).forEach(x=>{it.on(x,Jz,E=>E.preventDefault())}),this._pointerEvent?(it.on(this._element,Kz,x=>s(x)),it.on(this._element,Yz,x=>_(x)),this._element.classList.add(aO)):(it.on(this._element,Wz,x=>s(x)),it.on(this._element,Hz,x=>h(x)),it.on(this._element,Xz,x=>_(x)))}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const s=Vz[t.key];s&&(t.preventDefault(),this._slide(s))}_getItemIndex(t){return this._items=t&&t.parentNode?Jt.find(cO,t.parentNode):[],this._items.indexOf(t)}_getItemByOrder(t,s){const h=t===ac;return VT(this._items,s,h,this._config.wrap)}_triggerSlideEvent(t,s){const h=this._getItemIndex(t),_=this._getItemIndex(Jt.findOne(O_,this._element));return it.trigger(this._element,$z,{relatedTarget:t,direction:s,from:_,to:h})}_setActiveIndicatorElement(t){if(this._indicatorsElement){const s=Jt.findOne(lO,this._indicatorsElement);s.classList.remove(uc),s.removeAttribute("aria-current");const h=Jt.find(fO,this._indicatorsElement);for(let _=0;_<h.length;_++)if(Number.parseInt(h[_].getAttribute("data-bs-slide-to"),10)===this._getItemIndex(t)){h[_].classList.add(uc),h[_].setAttribute("aria-current","true");break}}}_updateInterval(){const t=this._activeElement||Jt.findOne(O_,this._element);if(!t)return;const s=Number.parseInt(t.getAttribute("data-bs-interval"),10);s?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=s):this._config.interval=this._config.defaultInterval||this._config.interval}_slide(t,s){const h=this._directionToOrder(t),_=Jt.findOne(O_,this._element),x=this._getItemIndex(_),E=s||this._getItemByOrder(h,_),a=this._getItemIndex(E),S=Boolean(this._interval),O=h===ac,M=O?rO:nO,P=O?oO:sO,z=this._orderToDirection(h);if(E&&E.classList.contains(uc)){this._isSliding=!1;return}if(this._isSliding||this._triggerSlideEvent(E,z).defaultPrevented||!_||!E)return;this._isSliding=!0,S&&this.pause(),this._setActiveIndicatorElement(E),this._activeElement=E;const se=()=>{it.trigger(this._element,nC,{relatedTarget:E,direction:z,from:x,to:a})};if(this._element.classList.contains(iO)){E.classList.add(P),hh(E),_.classList.add(M),E.classList.add(M);const ue=()=>{E.classList.remove(M,P),E.classList.add(uc),_.classList.remove(uc,P,M),this._isSliding=!1,setTimeout(se,0)};this._queueCallback(ue,_,!0)}else _.classList.remove(uc),E.classList.add(uc),this._isSliding=!1,se();S&&this.cycle()}_directionToOrder(t){return[Ff,cc].includes(t)?Vr()?t===cc?lc:ac:t===cc?ac:lc:t}_orderToDirection(t){return[ac,lc].includes(t)?Vr()?t===lc?cc:Ff:t===lc?Ff:cc:t}static carouselInterface(t,s){const h=ea.getOrCreateInstance(t,s);let{_config:_}=h;typeof s=="object"&&(_=mi(mi({},_),s));const x=typeof s=="string"?s:_.slide;if(typeof s=="number")h.to(s);else if(typeof x=="string"){if(typeof h[x]=="undefined")throw new TypeError(`No method named "${x}"`);h[x]()}else _.interval&&_.ride&&(h.pause(),h.cycle())}static jQueryInterface(t){return this.each(function(){ea.carouselInterface(this,t)})}static dataApiClickHandler(t){const s=Ha(this);if(!s||!s.classList.contains(tO))return;const h=mi(mi({},Jn.getDataAttributes(s)),Jn.getDataAttributes(this)),_=this.getAttribute("data-bs-slide-to");_&&(h.interval=!1),ea.carouselInterface(s,h),_&&ea.getInstance(s).to(_),t.preventDefault()}}it.on(document,eO,pO,ea.dataApiClickHandler);it.on(window,Qz,()=>{const i=Jt.find(mO);for(let t=0,s=i.length;t<s;t++)ea.carouselInterface(i[t],ea.getInstance(i[t]))});bo(ea);const rC="collapse",oC="bs.collapse",Nf=`.${oC}`,yO=".data-api",sC={toggle:!0,parent:null},vO={toggle:"boolean",parent:"(null|element)"},xO=`show${Nf}`,bO=`shown${Nf}`,wO=`hide${Nf}`,EO=`hidden${Nf}`,TO=`click${Nf}${yO}`,x0="show",dh="collapse",R_="collapsing",aC="collapsed",lC=`:scope .${dh} .${dh}`,CO="collapse-horizontal",SO="width",AO="height",IO=".collapse.show, .collapse.collapsing",b0='[data-bs-toggle="collapse"]';class fh extends $o{constructor(t,s){super(t);this._isTransitioning=!1,this._config=this._getConfig(s),this._triggerArray=[];const h=Jt.find(b0);for(let _=0,x=h.length;_<x;_++){const E=h[_],a=m0(E),S=Jt.find(a).filter(O=>O===this._element);a!==null&&S.length&&(this._selector=a,this._triggerArray.push(E))}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return sC}static get NAME(){return rC}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t=[],s;if(this._config.parent){const O=Jt.find(lC,this._config.parent);t=Jt.find(IO,this._config.parent).filter(M=>!O.includes(M))}const h=Jt.findOne(this._selector);if(t.length){const O=t.find(M=>h!==M);if(s=O?fh.getInstance(O):null,s&&s._isTransitioning)return}if(it.trigger(this._element,xO).defaultPrevented)return;t.forEach(O=>{h!==O&&fh.getOrCreateInstance(O,{toggle:!1}).hide(),s||Bf.set(O,oC,null)});const x=this._getDimension();this._element.classList.remove(dh),this._element.classList.add(R_),this._element.style[x]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const E=()=>{this._isTransitioning=!1,this._element.classList.remove(R_),this._element.classList.add(dh,x0),this._element.style[x]="",it.trigger(this._element,bO)},S=`scroll${x[0].toUpperCase()+x.slice(1)}`;this._queueCallback(E,this._element,!0),this._element.style[x]=`${this._element[S]}px`}hide(){if(this._isTransitioning||!this._isShown()||it.trigger(this._element,wO).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,hh(this._element),this._element.classList.add(R_),this._element.classList.remove(dh,x0);const h=this._triggerArray.length;for(let x=0;x<h;x++){const E=this._triggerArray[x],a=Ha(E);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([E],!1)}this._isTransitioning=!0;const _=()=>{this._isTransitioning=!1,this._element.classList.remove(R_),this._element.classList.add(dh),it.trigger(this._element,EO)};this._element.style[s]="",this._queueCallback(_,this._element,!0)}_isShown(t=this._element){return t.classList.contains(x0)}_getConfig(t){return t=mi(mi(mi({},sC),Jn.getDataAttributes(this._element)),t),t.toggle=Boolean(t.toggle),t.parent=Xa(t.parent),ps(rC,t,vO),t}_getDimension(){return this._element.classList.contains(CO)?SO:AO}_initializeChildren(){if(!this._config.parent)return;const t=Jt.find(lC,this._config.parent);Jt.find(b0,this._config.parent).filter(s=>!t.includes(s)).forEach(s=>{const h=Ha(s);h&&this._addAriaAndCollapsedClass([s],this._isShown(h))})}_addAriaAndCollapsedClass(t,s){!t.length||t.forEach(h=>{s?h.classList.remove(aC):h.classList.add(aC),h.setAttribute("aria-expanded",s)})}static jQueryInterface(t){return this.each(function(){const s={};typeof t=="string"&&/show|hide/.test(t)&&(s.toggle=!1);const h=fh.getOrCreateInstance(this,s);if(typeof t=="string"){if(typeof h[t]=="undefined")throw new TypeError(`No method named "${t}"`);h[t]()}})}}it.on(document,TO,b0,function(i){(i.target.tagName==="A"||i.delegateTarget&&i.delegateTarget.tagName==="A")&&i.preventDefault();const t=m0(this);Jt.find(t).forEach(h=>{fh.getOrCreateInstance(h,{toggle:!1}).toggle()})});bo(fh);const w0="dropdown",MO="bs.dropdown",hc=`.${MO}`,E0=".data-api",B_="Escape",cC="Space",uC="Tab",T0="ArrowUp",F_="ArrowDown",kO=2,PO=new RegExp(`${T0}|${F_}|${B_}`),DO=`hide${hc}`,LO=`hidden${hc}`,zO=`show${hc}`,OO=`shown${hc}`,hC=`click${hc}${E0}`,dC=`keydown${hc}${E0}`,RO=`keyup${hc}${E0}`,ph="show",BO="dropup",FO="dropend",NO="dropstart",UO="navbar",Uf='[data-bs-toggle="dropdown"]',C0=".dropdown-menu",jO=".navbar-nav",VO=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",$O=Vr()?"top-end":"top-start",GO=Vr()?"top-start":"top-end",qO=Vr()?"bottom-end":"bottom-start",ZO=Vr()?"bottom-start":"bottom-end",WO=Vr()?"left-start":"right-start",HO=Vr()?"right-start":"left-start",XO={offset:[0,2],boundary:"clippingParents",reference:"toggle",display:"dynamic",popperConfig:null,autoClose:!0},KO={offset:"(array|string|function)",boundary:"(string|element)",reference:"(string|element|object)",display:"string",popperConfig:"(null|object|function)",autoClose:"(boolean|string)"};class wo extends $o{constructor(t,s){super(t);this._popper=null,this._config=this._getConfig(s),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar()}static get Default(){return XO}static get DefaultType(){return KO}static get NAME(){return w0}toggle(){return this._isShown()?this.hide():this.show()}show(){if(oc(this._element)||this._isShown(this._menu))return;const t={relatedTarget:this._element};if(it.trigger(this._element,zO,t).defaultPrevented)return;const h=wo.getParentFromElement(this._element);this._inNavbar?Jn.setDataAttribute(this._menu,"popper","none"):this._createPopper(h),"ontouchstart"in document.documentElement&&!h.closest(jO)&&[].concat(...document.body.children).forEach(_=>it.on(_,"mouseover",P_)),this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(ph),this._element.classList.add(ph),it.trigger(this._element,OO,t)}hide(){if(oc(this._element)||!this._isShown(this._menu))return;const t={relatedTarget:this._element};this._completeHide(t)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(t){it.trigger(this._element,DO,t).defaultPrevented||("ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach(h=>it.off(h,"mouseover",P_)),this._popper&&this._popper.destroy(),this._menu.classList.remove(ph),this._element.classList.remove(ph),this._element.setAttribute("aria-expanded","false"),Jn.removeDataAttribute(this._menu,"popper"),it.trigger(this._element,LO,t))}_getConfig(t){if(t=mi(mi(mi({},this.constructor.Default),Jn.getDataAttributes(this._element)),t),ps(w0,t,this.constructor.DefaultType),typeof t.reference=="object"&&!rc(t.reference)&&typeof t.reference.getBoundingClientRect!="function")throw new TypeError(`${w0.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return t}_createPopper(t){if(typeof RT=="undefined")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let s=this._element;this._config.reference==="parent"?s=t:rc(this._config.reference)?s=Xa(this._config.reference):typeof this._config.reference=="object"&&(s=this._config.reference);const h=this._getPopperConfig(),_=h.modifiers.find(x=>x.name==="applyStyles"&&x.enabled===!1);this._popper=f0(s,this._menu,h),_&&Jn.setDataAttribute(this._menu,"popper","static")}_isShown(t=this._element){return t.classList.contains(ph)}_getMenuElement(){return Jt.next(this._element,C0)[0]}_getPlacement(){const t=this._element.parentNode;if(t.classList.contains(FO))return WO;if(t.classList.contains(NO))return HO;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return t.classList.contains(BO)?s?GO:$O:s?ZO:qO}_detectNavbar(){return this._element.closest(`.${UO}`)!==null}_getOffset(){const{offset:t}=this._config;return typeof t=="string"?t.split(",").map(s=>Number.parseInt(s,10)):typeof t=="function"?s=>t(s,this._element):t}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return this._config.display==="static"&&(t.modifiers=[{name:"applyStyles",enabled:!1}]),mi(mi({},t),typeof this._config.popperConfig=="function"?this._config.popperConfig(t):this._config.popperConfig)}_selectMenuItem({key:t,target:s}){const h=Jt.find(VO,this._menu).filter(Rf);!h.length||VT(h,s,t===F_,!h.includes(s)).focus()}static jQueryInterface(t){return this.each(function(){const s=wo.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof s[t]=="undefined")throw new TypeError(`No method named "${t}"`);s[t]()}})}static clearMenus(t){if(t&&(t.button===kO||t.type==="keyup"&&t.key!==uC))return;const s=Jt.find(Uf);for(let h=0,_=s.length;h<_;h++){const x=wo.getInstance(s[h]);if(!x||x._config.autoClose===!1||!x._isShown())continue;const E={relatedTarget:x._element};if(t){const a=t.composedPath(),S=a.includes(x._menu);if(a.includes(x._element)||x._config.autoClose==="inside"&&!S||x._config.autoClose==="outside"&&S||x._menu.contains(t.target)&&(t.type==="keyup"&&t.key===uC||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;t.type==="click"&&(E.clickEvent=t)}x._completeHide(E)}}static getParentFromElement(t){return Ha(t)||t.parentNode}static dataApiKeydownHandler(t){if(/input|textarea/i.test(t.target.tagName)?t.key===cC||t.key!==B_&&(t.key!==F_&&t.key!==T0||t.target.closest(C0)):!PO.test(t.key))return;const s=this.classList.contains(ph);if(!s&&t.key===B_||(t.preventDefault(),t.stopPropagation(),oc(this)))return;const h=this.matches(Uf)?this:Jt.prev(this,Uf)[0],_=wo.getOrCreateInstance(h);if(t.key===B_){_.hide();return}if(t.key===T0||t.key===F_){s||_.show(),_._selectMenuItem(t);return}(!s||t.key===cC)&&wo.clearMenus()}}it.on(document,dC,Uf,wo.dataApiKeydownHandler);it.on(document,dC,C0,wo.dataApiKeydownHandler);it.on(document,hC,wo.clearMenus);it.on(document,RO,wo.clearMenus);it.on(document,hC,Uf,function(i){i.preventDefault(),wo.getOrCreateInstance(this).toggle()});bo(wo);const fC=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",pC=".sticky-top";class S0{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,"paddingRight",s=>s+t),this._setElementAttributes(fC,"paddingRight",s=>s+t),this._setElementAttributes(pC,"marginRight",s=>s-t)}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,s,h){const _=this.getWidth(),x=E=>{if(E!==this._element&&window.innerWidth>E.clientWidth+_)return;this._saveInitialAttribute(E,s);const a=window.getComputedStyle(E)[s];E.style[s]=`${h(Number.parseFloat(a))}px`};this._applyManipulationCallback(t,x)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,"paddingRight"),this._resetElementAttributes(fC,"paddingRight"),this._resetElementAttributes(pC,"marginRight")}_saveInitialAttribute(t,s){const h=t.style[s];h&&Jn.setDataAttribute(t,s,h)}_resetElementAttributes(t,s){const h=_=>{const x=Jn.getDataAttribute(_,s);typeof x=="undefined"?_.style.removeProperty(s):(Jn.removeDataAttribute(_,s),_.style[s]=x)};this._applyManipulationCallback(t,h)}_applyManipulationCallback(t,s){rc(t)?s(t):Jt.find(t,this._element).forEach(s)}isOverflowing(){return this.getWidth()>0}}const YO={className:"modal-backdrop",isVisible:!0,isAnimated:!1,rootElement:"body",clickCallback:null},JO={className:"string",isVisible:"boolean",isAnimated:"boolean",rootElement:"(element|string)",clickCallback:"(function|null)"},mC="backdrop",QO="fade",_C="show",gC=`mousedown.bs.${mC}`;class yC{constructor(t){this._config=this._getConfig(t),this._isAppended=!1,this._element=null}show(t){if(!this._config.isVisible){sc(t);return}this._append(),this._config.isAnimated&&hh(this._getElement()),this._getElement().classList.add(_C),this._emulateAnimation(()=>{sc(t)})}hide(t){if(!this._config.isVisible){sc(t);return}this._getElement().classList.remove(_C),this._emulateAnimation(()=>{this.dispose(),sc(t)})}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add(QO),this._element=t}return this._element}_getConfig(t){return t=mi(mi({},YO),typeof t=="object"?t:{}),t.rootElement=Xa(t.rootElement),ps(mC,t,JO),t}_append(){this._isAppended||(this._config.rootElement.append(this._getElement()),it.on(this._getElement(),gC,()=>{sc(this._config.clickCallback)}),this._isAppended=!0)}dispose(){!this._isAppended||(it.off(this._element,gC),this._element.remove(),this._isAppended=!1)}_emulateAnimation(t){jT(t,this._getElement(),this._config.isAnimated)}}const eR={trapElement:null,autofocus:!0},tR={trapElement:"element",autofocus:"boolean"},iR="focustrap",nR="bs.focustrap",N_=`.${nR}`,rR=`focusin${N_}`,oR=`keydown.tab${N_}`,sR="Tab",aR="forward",vC="backward";class xC{constructor(t){this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}activate(){const{trapElement:t,autofocus:s}=this._config;this._isActive||(s&&t.focus(),it.off(document,N_),it.on(document,rR,h=>this._handleFocusin(h)),it.on(document,oR,h=>this._handleKeydown(h)),this._isActive=!0)}deactivate(){!this._isActive||(this._isActive=!1,it.off(document,N_))}_handleFocusin(t){const{target:s}=t,{trapElement:h}=this._config;if(s===document||s===h||h.contains(s))return;const _=Jt.focusableChildren(h);_.length===0?h.focus():this._lastTabNavDirection===vC?_[_.length-1].focus():_[0].focus()}_handleKeydown(t){t.key===sR&&(this._lastTabNavDirection=t.shiftKey?vC:aR)}_getConfig(t){return t=mi(mi({},eR),typeof t=="object"?t:{}),ps(iR,t,tR),t}}const bC="modal",lR="bs.modal",Eo=`.${lR}`,cR=".data-api",wC="Escape",EC={backdrop:!0,keyboard:!0,focus:!0},uR={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean"},hR=`hide${Eo}`,dR=`hidePrevented${Eo}`,TC=`hidden${Eo}`,CC=`show${Eo}`,fR=`shown${Eo}`,SC=`resize${Eo}`,AC=`click.dismiss${Eo}`,IC=`keydown.dismiss${Eo}`,pR=`mouseup.dismiss${Eo}`,MC=`mousedown.dismiss${Eo}`,mR=`click${Eo}${cR}`,kC="modal-open",_R="fade",PC="show",A0="modal-static",gR=".modal.show",yR=".modal-dialog",vR=".modal-body",xR='[data-bs-toggle="modal"]';class mh extends $o{constructor(t,s){super(t);this._config=this._getConfig(s),this._dialog=Jt.findOne(yR,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollBar=new S0}static get Default(){return EC}static get NAME(){return bC}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||this._isTransitioning||it.trigger(this._element,CC,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isAnimated()&&(this._isTransitioning=!0),this._scrollBar.hide(),document.body.classList.add(kC),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),it.on(this._dialog,MC,()=>{it.one(this._element,pR,h=>{h.target===this._element&&(this._ignoreBackdropClick=!0)})}),this._showBackdrop(()=>this._showElement(t)))}hide(){if(!this._isShown||this._isTransitioning||it.trigger(this._element,hR).defaultPrevented)return;this._isShown=!1;const s=this._isAnimated();s&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),this._focustrap.deactivate(),this._element.classList.remove(PC),it.off(this._element,AC),it.off(this._dialog,MC),this._queueCallback(()=>this._hideModal(),this._element,s)}dispose(){[window,this._dialog].forEach(t=>it.off(t,Eo)),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new yC({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new xC({trapElement:this._element})}_getConfig(t){return t=mi(mi(mi({},EC),Jn.getDataAttributes(this._element)),typeof t=="object"?t:{}),ps(bC,t,uR),t}_showElement(t){const s=this._isAnimated(),h=Jt.findOne(vR,this._dialog);(!this._element.parentNode||this._element.parentNode.nodeType!==Node.ELEMENT_NODE)&&document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0,h&&(h.scrollTop=0),s&&hh(this._element),this._element.classList.add(PC);const _=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,it.trigger(this._element,fR,{relatedTarget:t})};this._queueCallback(_,this._dialog,s)}_setEscapeEvent(){this._isShown?it.on(this._element,IC,t=>{this._config.keyboard&&t.key===wC?(t.preventDefault(),this.hide()):!this._config.keyboard&&t.key===wC&&this._triggerBackdropTransition()}):it.off(this._element,IC)}_setResizeEvent(){this._isShown?it.on(window,SC,()=>this._adjustDialog()):it.off(window,SC)}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(kC),this._resetAdjustments(),this._scrollBar.reset(),it.trigger(this._element,TC)})}_showBackdrop(t){it.on(this._element,AC,s=>{if(this._ignoreBackdropClick){this._ignoreBackdropClick=!1;return}s.target===s.currentTarget&&(this._config.backdrop===!0?this.hide():this._config.backdrop==="static"&&this._triggerBackdropTransition())}),this._backdrop.show(t)}_isAnimated(){return this._element.classList.contains(_R)}_triggerBackdropTransition(){if(it.trigger(this._element,dR).defaultPrevented)return;const{classList:s,scrollHeight:h,style:_}=this._element,x=h>document.documentElement.clientHeight;!x&&_.overflowY==="hidden"||s.contains(A0)||(x||(_.overflowY="hidden"),s.add(A0),this._queueCallback(()=>{s.remove(A0),x||this._queueCallback(()=>{_.overflowY=""},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),h=s>0;(!h&&t&&!Vr()||h&&!t&&Vr())&&(this._element.style.paddingLeft=`${s}px`),(h&&!t&&!Vr()||!h&&t&&Vr())&&(this._element.style.paddingRight=`${s}px`)}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,s){return this.each(function(){const h=mh.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof h[t]=="undefined")throw new TypeError(`No method named "${t}"`);h[t](s)}})}}it.on(document,mR,xR,function(i){const t=Ha(this);["A","AREA"].includes(this.tagName)&&i.preventDefault(),it.one(t,CC,_=>{_.defaultPrevented||it.one(t,TC,()=>{Rf(this)&&this.focus()})});const s=Jt.findOne(gR);s&&mh.getInstance(s).hide(),mh.getOrCreateInstance(t).toggle(this)});D_(mh);bo(mh);const DC="offcanvas",bR="bs.offcanvas",dc=`.${bR}`,LC=".data-api",wR=`load${dc}${LC}`,ER="Escape",zC={backdrop:!0,keyboard:!0,scroll:!1},TR={backdrop:"boolean",keyboard:"boolean",scroll:"boolean"},OC="show",CR="offcanvas-backdrop",RC=".offcanvas.show",SR=`show${dc}`,AR=`shown${dc}`,IR=`hide${dc}`,BC=`hidden${dc}`,MR=`click${dc}${LC}`,kR=`keydown.dismiss${dc}`,PR='[data-bs-toggle="offcanvas"]';class fc extends $o{constructor(t,s){super(t);this._config=this._getConfig(s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get NAME(){return DC}static get Default(){return zC}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){if(this._isShown||it.trigger(this._element,SR,{relatedTarget:t}).defaultPrevented)return;this._isShown=!0,this._element.style.visibility="visible",this._backdrop.show(),this._config.scroll||new S0().hide(),this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(OC);const h=()=>{this._config.scroll||this._focustrap.activate(),it.trigger(this._element,AR,{relatedTarget:t})};this._queueCallback(h,this._element,!0)}hide(){if(!this._isShown||it.trigger(this._element,IR).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.remove(OC),this._backdrop.hide();const s=()=>{this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._element.style.visibility="hidden",this._config.scroll||new S0().reset(),it.trigger(this._element,BC)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_getConfig(t){return t=mi(mi(mi({},zC),Jn.getDataAttributes(this._element)),typeof t=="object"?t:{}),ps(DC,t,TR),t}_initializeBackDrop(){return new yC({className:CR,isVisible:this._config.backdrop,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:()=>this.hide()})}_initializeFocusTrap(){return new xC({trapElement:this._element})}_addEventListeners(){it.on(this._element,kR,t=>{this._config.keyboard&&t.key===ER&&this.hide()})}static jQueryInterface(t){return this.each(function(){const s=fc.getOrCreateInstance(this,t);if(typeof t=="string"){if(s[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);s[t](this)}})}}it.on(document,MR,PR,function(i){const t=Ha(this);if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),oc(this))return;it.one(t,BC,()=>{Rf(this)&&this.focus()});const s=Jt.findOne(RC);s&&s!==t&&fc.getInstance(s).hide(),fc.getOrCreateInstance(t).toggle(this)});it.on(window,wR,()=>Jt.find(RC).forEach(i=>fc.getOrCreateInstance(i).show()));D_(fc);bo(fc);const DR=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),LR=/^aria-[\w-]*$/i,zR=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,OR=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,RR=(i,t)=>{const s=i.nodeName.toLowerCase();if(t.includes(s))return DR.has(s)?Boolean(zR.test(i.nodeValue)||OR.test(i.nodeValue)):!0;const h=t.filter(_=>_ instanceof RegExp);for(let _=0,x=h.length;_<x;_++)if(h[_].test(s))return!0;return!1},BR={"*":["class","dir","id","lang","role",LR],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]};function FC(i,t,s){if(!i.length)return i;if(s&&typeof s=="function")return s(i);const _=new window.DOMParser().parseFromString(i,"text/html"),x=[].concat(..._.body.querySelectorAll("*"));for(let E=0,a=x.length;E<a;E++){const S=x[E],O=S.nodeName.toLowerCase();if(!Object.keys(t).includes(O)){S.remove();continue}const M=[].concat(...S.attributes),P=[].concat(t["*"]||[],t[O]||[]);M.forEach(z=>{RR(z,P)||S.removeAttribute(z.nodeName)})}return _.body.innerHTML}const NC="tooltip",FR="bs.tooltip",ms=`.${FR}`,NR="bs-tooltip",UR=new Set(["sanitize","allowList","sanitizeFn"]),jR={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(array|string|function)",container:"(string|element|boolean)",fallbackPlacements:"array",boundary:"(string|element)",customClass:"(string|function)",sanitize:"boolean",sanitizeFn:"(null|function)",allowList:"object",popperConfig:"(null|object|function)"},VR={AUTO:"auto",TOP:"top",RIGHT:Vr()?"left":"right",BOTTOM:"bottom",LEFT:Vr()?"right":"left"},$R={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:[0,0],container:!1,fallbackPlacements:["top","right","bottom","left"],boundary:"clippingParents",customClass:"",sanitize:!0,sanitizeFn:null,allowList:BR,popperConfig:null},GR={HIDE:`hide${ms}`,HIDDEN:`hidden${ms}`,SHOW:`show${ms}`,SHOWN:`shown${ms}`,INSERTED:`inserted${ms}`,CLICK:`click${ms}`,FOCUSIN:`focusin${ms}`,FOCUSOUT:`focusout${ms}`,MOUSEENTER:`mouseenter${ms}`,MOUSELEAVE:`mouseleave${ms}`},U_="fade",qR="modal",jf="show",Vf="show",I0="out",UC=".tooltip-inner",jC=`.${qR}`,VC="hide.bs.modal",$f="hover",M0="focus",ZR="click",WR="manual";class _h extends $o{constructor(t,s){if(typeof RT=="undefined")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(t);this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this._config=this._getConfig(s),this.tip=null,this._setListeners()}static get Default(){return $R}static get NAME(){return NC}static get Event(){return GR}static get DefaultType(){return jR}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(t){if(!!this._isEnabled)if(t){const s=this._initializeOnDelegatedTarget(t);s._activeTrigger.click=!s._activeTrigger.click,s._isWithActiveTrigger()?s._enter(null,s):s._leave(null,s)}else{if(this.getTipElement().classList.contains(jf)){this._leave(null,this);return}this._enter(null,this)}}dispose(){clearTimeout(this._timeout),it.off(this._element.closest(jC),VC,this._hideModalHandler),this.tip&&this.tip.remove(),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this.isWithContent()&&this._isEnabled))return;const t=it.trigger(this._element,this.constructor.Event.SHOW),s=NT(this._element),h=s===null?this._element.ownerDocument.documentElement.contains(this._element):s.contains(this._element);if(t.defaultPrevented||!h)return;this.constructor.NAME==="tooltip"&&this.tip&&this.getTitle()!==this.tip.querySelector(UC).innerHTML&&(this._disposePopper(),this.tip.remove(),this.tip=null);const _=this.getTipElement(),x=hz(this.constructor.NAME);_.setAttribute("id",x),this._element.setAttribute("aria-describedby",x),this._config.animation&&_.classList.add(U_);const E=typeof this._config.placement=="function"?this._config.placement.call(this,_,this._element):this._config.placement,a=this._getAttachment(E);this._addAttachmentClass(a);const{container:S}=this._config;Bf.set(_,this.constructor.DATA_KEY,this),this._element.ownerDocument.documentElement.contains(this.tip)||(S.append(_),it.trigger(this._element,this.constructor.Event.INSERTED)),this._popper?this._popper.update():this._popper=f0(this._element,_,this._getPopperConfig(a)),_.classList.add(jf);const O=this._resolvePossibleFunction(this._config.customClass);O&&_.classList.add(...O.split(" ")),"ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach(z=>{it.on(z,"mouseover",P_)});const M=()=>{const z=this._hoverState;this._hoverState=null,it.trigger(this._element,this.constructor.Event.SHOWN),z===I0&&this._leave(null,this)},P=this.tip.classList.contains(U_);this._queueCallback(M,this.tip,P)}hide(){if(!this._popper)return;const t=this.getTipElement(),s=()=>{this._isWithActiveTrigger()||(this._hoverState!==Vf&&t.remove(),this._cleanTipClass(),this._element.removeAttribute("aria-describedby"),it.trigger(this._element,this.constructor.Event.HIDDEN),this._disposePopper())};if(it.trigger(this._element,this.constructor.Event.HIDE).defaultPrevented)return;t.classList.remove(jf),"ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach(x=>it.off(x,"mouseover",P_)),this._activeTrigger[ZR]=!1,this._activeTrigger[M0]=!1,this._activeTrigger[$f]=!1;const _=this.tip.classList.contains(U_);this._queueCallback(s,this.tip,_),this._hoverState=""}update(){this._popper!==null&&this._popper.update()}isWithContent(){return Boolean(this.getTitle())}getTipElement(){if(this.tip)return this.tip;const t=document.createElement("div");t.innerHTML=this._config.template;const s=t.children[0];return this.setContent(s),s.classList.remove(U_,jf),this.tip=s,this.tip}setContent(t){this._sanitizeAndSetContent(t,this.getTitle(),UC)}_sanitizeAndSetContent(t,s,h){const _=Jt.findOne(h,t);if(!s&&_){_.remove();return}this.setElementContent(_,s)}setElementContent(t,s){if(t!==null){if(rc(s)){s=Xa(s),this._config.html?s.parentNode!==t&&(t.innerHTML="",t.append(s)):t.textContent=s.textContent;return}this._config.html?(this._config.sanitize&&(s=FC(s,this._config.allowList,this._config.sanitizeFn)),t.innerHTML=s):t.textContent=s}}getTitle(){const t=this._element.getAttribute("data-bs-original-title")||this._config.title;return this._resolvePossibleFunction(t)}updateAttachment(t){return t==="right"?"end":t==="left"?"start":t}_initializeOnDelegatedTarget(t,s){return s||this.constructor.getOrCreateInstance(t.delegateTarget,this._getDelegateConfig())}_getOffset(){const{offset:t}=this._config;return typeof t=="string"?t.split(",").map(s=>Number.parseInt(s,10)):typeof t=="function"?s=>t(s,this._element):t}_resolvePossibleFunction(t){return typeof t=="function"?t.call(this._element):t}_getPopperConfig(t){const s={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"onChange",enabled:!0,phase:"afterWrite",fn:h=>this._handlePopperPlacementChange(h)}],onFirstUpdate:h=>{h.options.placement!==h.placement&&this._handlePopperPlacementChange(h)}};return mi(mi({},s),typeof this._config.popperConfig=="function"?this._config.popperConfig(s):this._config.popperConfig)}_addAttachmentClass(t){this.getTipElement().classList.add(`${this._getBasicClassPrefix()}-${this.updateAttachment(t)}`)}_getAttachment(t){return VR[t.toUpperCase()]}_setListeners(){this._config.trigger.split(" ").forEach(s=>{if(s==="click")it.on(this._element,this.constructor.Event.CLICK,this._config.selector,h=>this.toggle(h));else if(s!==WR){const h=s===$f?this.constructor.Event.MOUSEENTER:this.constructor.Event.FOCUSIN,_=s===$f?this.constructor.Event.MOUSELEAVE:this.constructor.Event.FOCUSOUT;it.on(this._element,h,this._config.selector,x=>this._enter(x)),it.on(this._element,_,this._config.selector,x=>this._leave(x))}}),this._hideModalHandler=()=>{this._element&&this.hide()},it.on(this._element.closest(jC),VC,this._hideModalHandler),this._config.selector?this._config=E_(mi({},this._config),{trigger:"manual",selector:""}):this._fixTitle()}_fixTitle(){const t=this._element.getAttribute("title"),s=typeof this._element.getAttribute("data-bs-original-title");(t||s!=="string")&&(this._element.setAttribute("data-bs-original-title",t||""),t&&!this._element.getAttribute("aria-label")&&!this._element.textContent&&this._element.setAttribute("aria-label",t),this._element.setAttribute("title",""))}_enter(t,s){if(s=this._initializeOnDelegatedTarget(t,s),t&&(s._activeTrigger[t.type==="focusin"?M0:$f]=!0),s.getTipElement().classList.contains(jf)||s._hoverState===Vf){s._hoverState=Vf;return}if(clearTimeout(s._timeout),s._hoverState=Vf,!s._config.delay||!s._config.delay.show){s.show();return}s._timeout=setTimeout(()=>{s._hoverState===Vf&&s.show()},s._config.delay.show)}_leave(t,s){if(s=this._initializeOnDelegatedTarget(t,s),t&&(s._activeTrigger[t.type==="focusout"?M0:$f]=s._element.contains(t.relatedTarget)),!s._isWithActiveTrigger()){if(clearTimeout(s._timeout),s._hoverState=I0,!s._config.delay||!s._config.delay.hide){s.hide();return}s._timeout=setTimeout(()=>{s._hoverState===I0&&s.hide()},s._config.delay.hide)}}_isWithActiveTrigger(){for(const t in this._activeTrigger)if(this._activeTrigger[t])return!0;return!1}_getConfig(t){const s=Jn.getDataAttributes(this._element);return Object.keys(s).forEach(h=>{UR.has(h)&&delete s[h]}),t=mi(mi(mi({},this.constructor.Default),s),typeof t=="object"&&t?t:{}),t.container=t.container===!1?document.body:Xa(t.container),typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),typeof t.title=="number"&&(t.title=t.title.toString()),typeof t.content=="number"&&(t.content=t.content.toString()),ps(NC,t,this.constructor.DefaultType),t.sanitize&&(t.template=FC(t.template,t.allowList,t.sanitizeFn)),t}_getDelegateConfig(){const t={};for(const s in this._config)this.constructor.Default[s]!==this._config[s]&&(t[s]=this._config[s]);return t}_cleanTipClass(){const t=this.getTipElement(),s=new RegExp(`(^|\\s)${this._getBasicClassPrefix()}\\S+`,"g"),h=t.getAttribute("class").match(s);h!==null&&h.length>0&&h.map(_=>_.trim()).forEach(_=>t.classList.remove(_))}_getBasicClassPrefix(){return NR}_handlePopperPlacementChange(t){const{state:s}=t;!s||(this.tip=s.elements.popper,this._cleanTipClass(),this._addAttachmentClass(this._getAttachment(s.placement)))}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null)}static jQueryInterface(t){return this.each(function(){const s=_h.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof s[t]=="undefined")throw new TypeError(`No method named "${t}"`);s[t]()}})}}bo(_h);const HR="popover",XR="bs.popover",_s=`.${XR}`,KR="bs-popover",YR=E_(mi({},_h.Default),{placement:"right",offset:[0,8],trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),JR=E_(mi({},_h.DefaultType),{content:"(string|element|function)"}),QR={HIDE:`hide${_s}`,HIDDEN:`hidden${_s}`,SHOW:`show${_s}`,SHOWN:`shown${_s}`,INSERTED:`inserted${_s}`,CLICK:`click${_s}`,FOCUSIN:`focusin${_s}`,FOCUSOUT:`focusout${_s}`,MOUSEENTER:`mouseenter${_s}`,MOUSELEAVE:`mouseleave${_s}`},eB=".popover-header",tB=".popover-body";class k0 extends _h{static get Default(){return YR}static get NAME(){return HR}static get Event(){return QR}static get DefaultType(){return JR}isWithContent(){return this.getTitle()||this._getContent()}setContent(t){this._sanitizeAndSetContent(t,this.getTitle(),eB),this._sanitizeAndSetContent(t,this._getContent(),tB)}_getContent(){return this._resolvePossibleFunction(this._config.content)}_getBasicClassPrefix(){return KR}static jQueryInterface(t){return this.each(function(){const s=k0.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof s[t]=="undefined")throw new TypeError(`No method named "${t}"`);s[t]()}})}}bo(k0);const $C="scrollspy",iB="bs.scrollspy",j_=`.${iB}`,nB=".data-api",GC={offset:10,method:"auto",target:""},rB={offset:"number",method:"string",target:"(string|element)"},oB=`activate${j_}`,sB=`scroll${j_}`,aB=`load${j_}${nB}`,qC="dropdown-item",gh="active",lB='[data-bs-spy="scroll"]',cB=".nav, .list-group",P0=".nav-link",uB=".nav-item",ZC=".list-group-item",D0=`${P0}, ${ZC}, .${qC}`,hB=".dropdown",dB=".dropdown-toggle",fB="offset",WC="position";class V_ extends $o{constructor(t,s){super(t);this._scrollElement=this._element.tagName==="BODY"?window:this._element,this._config=this._getConfig(s),this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,it.on(this._scrollElement,sB,()=>this._process()),this.refresh(),this._process()}static get Default(){return GC}static get NAME(){return $C}refresh(){const t=this._scrollElement===this._scrollElement.window?fB:WC,s=this._config.method==="auto"?t:this._config.method,h=s===WC?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),Jt.find(D0,this._config.target).map(x=>{const E=m0(x),a=E?Jt.findOne(E):null;if(a){const S=a.getBoundingClientRect();if(S.width||S.height)return[Jn[s](a).top+h,E]}return null}).filter(x=>x).sort((x,E)=>x[0]-E[0]).forEach(x=>{this._offsets.push(x[0]),this._targets.push(x[1])})}dispose(){it.off(this._scrollElement,j_),super.dispose()}_getConfig(t){return t=mi(mi(mi({},GC),Jn.getDataAttributes(this._element)),typeof t=="object"&&t?t:{}),t.target=Xa(t.target)||document.documentElement,ps($C,t,rB),t}_getScrollTop(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop}_getScrollHeight(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}_getOffsetHeight(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height}_process(){const t=this._getScrollTop()+this._config.offset,s=this._getScrollHeight(),h=this._config.offset+s-this._getOffsetHeight();if(this._scrollHeight!==s&&this.refresh(),t>=h){const _=this._targets[this._targets.length-1];this._activeTarget!==_&&this._activate(_);return}if(this._activeTarget&&t<this._offsets[0]&&this._offsets[0]>0){this._activeTarget=null,this._clear();return}for(let _=this._offsets.length;_--;)this._activeTarget!==this._targets[_]&&t>=this._offsets[_]&&(typeof this._offsets[_+1]=="undefined"||t<this._offsets[_+1])&&this._activate(this._targets[_])}_activate(t){this._activeTarget=t,this._clear();const s=D0.split(",").map(_=>`${_}[data-bs-target="${t}"],${_}[href="${t}"]`),h=Jt.findOne(s.join(","),this._config.target);h.classList.add(gh),h.classList.contains(qC)?Jt.findOne(dB,h.closest(hB)).classList.add(gh):Jt.parents(h,cB).forEach(_=>{Jt.prev(_,`${P0}, ${ZC}`).forEach(x=>x.classList.add(gh)),Jt.prev(_,uB).forEach(x=>{Jt.children(x,P0).forEach(E=>E.classList.add(gh))})}),it.trigger(this._scrollElement,oB,{relatedTarget:t})}_clear(){Jt.find(D0,this._config.target).filter(t=>t.classList.contains(gh)).forEach(t=>t.classList.remove(gh))}static jQueryInterface(t){return this.each(function(){const s=V_.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof s[t]=="undefined")throw new TypeError(`No method named "${t}"`);s[t]()}})}}it.on(window,aB,()=>{Jt.find(lB).forEach(i=>new V_(i))});bo(V_);const pB="tab",mB="bs.tab",Gf=`.${mB}`,_B=".data-api",gB=`hide${Gf}`,yB=`hidden${Gf}`,vB=`show${Gf}`,xB=`shown${Gf}`,bB=`click${Gf}${_B}`,wB="dropdown-menu",qf="active",HC="fade",XC="show",EB=".dropdown",TB=".nav, .list-group",KC=".active",YC=":scope > li > .active",CB='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',SB=".dropdown-toggle",AB=":scope > .dropdown-menu .active";class $_ extends $o{static get NAME(){return pB}show(){if(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&this._element.classList.contains(qf))return;let t;const s=Ha(this._element),h=this._element.closest(TB);if(h){const a=h.nodeName==="UL"||h.nodeName==="OL"?YC:KC;t=Jt.find(a,h),t=t[t.length-1]}const _=t?it.trigger(t,gB,{relatedTarget:this._element}):null;if(it.trigger(this._element,vB,{relatedTarget:t}).defaultPrevented||_!==null&&_.defaultPrevented)return;this._activate(this._element,h);const E=()=>{it.trigger(t,yB,{relatedTarget:this._element}),it.trigger(this._element,xB,{relatedTarget:t})};s?this._activate(s,s.parentNode,E):E()}_activate(t,s,h){const x=(s&&(s.nodeName==="UL"||s.nodeName==="OL")?Jt.find(YC,s):Jt.children(s,KC))[0],E=h&&x&&x.classList.contains(HC),a=()=>this._transitionComplete(t,x,h);x&&E?(x.classList.remove(XC),this._queueCallback(a,t,!0)):a()}_transitionComplete(t,s,h){if(s){s.classList.remove(qf);const x=Jt.findOne(AB,s.parentNode);x&&x.classList.remove(qf),s.getAttribute("role")==="tab"&&s.setAttribute("aria-selected",!1)}t.classList.add(qf),t.getAttribute("role")==="tab"&&t.setAttribute("aria-selected",!0),hh(t),t.classList.contains(HC)&&t.classList.add(XC);let _=t.parentNode;if(_&&_.nodeName==="LI"&&(_=_.parentNode),_&&_.classList.contains(wB)){const x=t.closest(EB);x&&Jt.find(SB,x).forEach(E=>E.classList.add(qf)),t.setAttribute("aria-expanded",!0)}h&&h()}static jQueryInterface(t){return this.each(function(){const s=$_.getOrCreateInstance(this);if(typeof t=="string"){if(typeof s[t]=="undefined")throw new TypeError(`No method named "${t}"`);s[t]()}})}}it.on(document,bB,CB,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),oc(this))return;$_.getOrCreateInstance(this).show()});bo($_);const JC="toast",IB="bs.toast",Ya=`.${IB}`,MB=`mouseover${Ya}`,kB=`mouseout${Ya}`,PB=`focusin${Ya}`,DB=`focusout${Ya}`,LB=`hide${Ya}`,zB=`hidden${Ya}`,OB=`show${Ya}`,RB=`shown${Ya}`,BB="fade",QC="hide",Zf="show",G_="showing",FB={animation:"boolean",autohide:"boolean",delay:"number"},eS={animation:!0,autohide:!0,delay:5e3};class q_ extends $o{constructor(t,s){super(t);this._config=this._getConfig(s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get DefaultType(){return FB}static get Default(){return eS}static get NAME(){return JC}show(){if(it.trigger(this._element,OB).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(BB);const s=()=>{this._element.classList.remove(G_),it.trigger(this._element,RB),this._maybeScheduleHide()};this._element.classList.remove(QC),hh(this._element),this._element.classList.add(Zf),this._element.classList.add(G_),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this._element.classList.contains(Zf)||it.trigger(this._element,LB).defaultPrevented)return;const s=()=>{this._element.classList.add(QC),this._element.classList.remove(G_),this._element.classList.remove(Zf),it.trigger(this._element,zB)};this._element.classList.add(G_),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this._element.classList.contains(Zf)&&this._element.classList.remove(Zf),super.dispose()}_getConfig(t){return t=mi(mi(mi({},eS),Jn.getDataAttributes(this._element)),typeof t=="object"&&t?t:{}),ps(JC,t,this.constructor.DefaultType),t}_maybeScheduleHide(){!this._config.autohide||this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay))}_onInteraction(t,s){switch(t.type){case"mouseover":case"mouseout":this._hasMouseInteraction=s;break;case"focusin":case"focusout":this._hasKeyboardInteraction=s;break}if(s){this._clearTimeout();return}const h=t.relatedTarget;this._element===h||this._element.contains(h)||this._maybeScheduleHide()}_setListeners(){it.on(this._element,MB,t=>this._onInteraction(t,!0)),it.on(this._element,kB,t=>this._onInteraction(t,!1)),it.on(this._element,PB,t=>this._onInteraction(t,!0)),it.on(this._element,DB,t=>this._onInteraction(t,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each(function(){const s=q_.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof s[t]=="undefined")throw new TypeError(`No method named "${t}"`);s[t](this)}})}}D_(q_);bo(q_);function L0(i,t){const s=Object.create(null),h=i.split(",");for(let _=0;_<h.length;_++)s[h[_]]=!0;return t?_=>!!s[_.toLowerCase()]:_=>!!s[_]}const NB="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",UB=L0(NB);function tS(i){return!!i||i===""}function z0(i){if(Qt(i)){const t={};for(let s=0;s<i.length;s++){const h=i[s],_=er(h)?$B(h):z0(h);if(_)for(const x in _)t[x]=_[x]}return t}else{if(er(i))return i;if(Sn(i))return i}}const jB=/;(?![^(]*\))/g,VB=/:(.+)/;function $B(i){const t={};return i.split(jB).forEach(s=>{if(s){const h=s.split(VB);h.length>1&&(t[h[0].trim()]=h[1].trim())}}),t}function Z_(i){let t="";if(er(i))t=i;else if(Qt(i))for(let s=0;s<i.length;s++){const h=Z_(i[s]);h&&(t+=h+" ")}else if(Sn(i))for(const s in i)i[s]&&(t+=s+" ");return t.trim()}function GB(i,t){if(i.length!==t.length)return!1;let s=!0;for(let h=0;s&&h<i.length;h++)s=W_(i[h],t[h]);return s}function W_(i,t){if(i===t)return!0;let s=rS(i),h=rS(t);if(s||h)return s&&h?i.getTime()===t.getTime():!1;if(s=Qt(i),h=Qt(t),s||h)return s&&h?GB(i,t):!1;if(s=Sn(i),h=Sn(t),s||h){if(!s||!h)return!1;const _=Object.keys(i).length,x=Object.keys(t).length;if(_!==x)return!1;for(const E in i){const a=i.hasOwnProperty(E),S=t.hasOwnProperty(E);if(a&&!S||!a&&S||!W_(i[E],t[E]))return!1}}return String(i)===String(t)}function qB(i,t){return i.findIndex(s=>W_(s,t))}const L8=i=>i==null?"":Qt(i)||Sn(i)&&(i.toString===sS||!_i(i.toString))?JSON.stringify(i,iS,2):String(i),iS=(i,t)=>t&&t.__v_isRef?iS(i,t.value):vh(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((s,[h,_])=>(s[`${h} =>`]=_,s),{})}:X_(t)?{[`Set(${t.size})`]:[...t.values()]}:Sn(t)&&!Qt(t)&&!aS(t)?String(t):t,on={},yh=[],Go=()=>{},ZB=()=>!1,WB=/^on[^a-z]/,H_=i=>WB.test(i),O0=i=>i.startsWith("onUpdate:"),Qn=Object.assign,nS=(i,t)=>{const s=i.indexOf(t);s>-1&&i.splice(s,1)},HB=Object.prototype.hasOwnProperty,Ri=(i,t)=>HB.call(i,t),Qt=Array.isArray,vh=i=>K_(i)==="[object Map]",X_=i=>K_(i)==="[object Set]",rS=i=>i instanceof Date,_i=i=>typeof i=="function",er=i=>typeof i=="string",R0=i=>typeof i=="symbol",Sn=i=>i!==null&&typeof i=="object",oS=i=>Sn(i)&&_i(i.then)&&_i(i.catch),sS=Object.prototype.toString,K_=i=>sS.call(i),XB=i=>K_(i).slice(8,-1),aS=i=>K_(i)==="[object Object]",B0=i=>er(i)&&i!=="NaN"&&i[0]!=="-"&&""+parseInt(i,10)===i,Y_=L0(",key,ref,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),J_=i=>{const t=Object.create(null);return s=>t[s]||(t[s]=i(s))},KB=/-(\w)/g,gs=J_(i=>i.replace(KB,(t,s)=>s?s.toUpperCase():"")),YB=/\B([A-Z])/g,xh=J_(i=>i.replace(YB,"-$1").toLowerCase()),Q_=J_(i=>i.charAt(0).toUpperCase()+i.slice(1)),F0=J_(i=>i?`on${Q_(i)}`:""),Wf=(i,t)=>!Object.is(i,t),eg=(i,t)=>{for(let s=0;s<i.length;s++)i[s](t)},tg=(i,t,s)=>{Object.defineProperty(i,t,{configurable:!0,enumerable:!1,value:s})},Hf=i=>{const t=parseFloat(i);return isNaN(t)?i:t};let lS;const JB=()=>lS||(lS=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let pc;const ig=[];class QB{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&pc&&(this.parent=pc,this.index=(pc.scopes||(pc.scopes=[])).push(this)-1)}run(t){if(this.active)try{return this.on(),t()}finally{this.off()}}on(){this.active&&(ig.push(this),pc=this)}off(){this.active&&(ig.pop(),pc=ig[ig.length-1])}stop(t){if(this.active){if(this.effects.forEach(s=>s.stop()),this.cleanups.forEach(s=>s()),this.scopes&&this.scopes.forEach(s=>s.stop(!0)),this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.active=!1}}}function e3(i,t){t=t||pc,t&&t.active&&t.effects.push(i)}const N0=i=>{const t=new Set(i);return t.w=0,t.n=0,t},cS=i=>(i.w&Ja)>0,uS=i=>(i.n&Ja)>0,t3=({deps:i})=>{if(i.length)for(let t=0;t<i.length;t++)i[t].w|=Ja},i3=i=>{const{deps:t}=i;if(t.length){let s=0;for(let h=0;h<t.length;h++){const _=t[h];cS(_)&&!uS(_)?_.delete(i):t[s++]=_,_.w&=~Ja,_.n&=~Ja}t.length=s}},U0=new WeakMap;let Xf=0,Ja=1;const j0=30,Kf=[];let mc;const _c=Symbol(""),V0=Symbol("");class $0{constructor(t,s=null,h){this.fn=t,this.scheduler=s,this.active=!0,this.deps=[],e3(this,h)}run(){if(!this.active)return this.fn();if(!Kf.includes(this))try{return Kf.push(mc=this),n3(),Ja=1<<++Xf,Xf<=j0?t3(this):hS(this),this.fn()}finally{Xf<=j0&&i3(this),Ja=1<<--Xf,gc(),Kf.pop();const t=Kf.length;mc=t>0?Kf[t-1]:void 0}}stop(){this.active&&(hS(this),this.onStop&&this.onStop(),this.active=!1)}}function hS(i){const{deps:t}=i;if(t.length){for(let s=0;s<t.length;s++)t[s].delete(i);t.length=0}}let bh=!0;const G0=[];function wh(){G0.push(bh),bh=!1}function n3(){G0.push(bh),bh=!0}function gc(){const i=G0.pop();bh=i===void 0?!0:i}function ro(i,t,s){if(!dS())return;let h=U0.get(i);h||U0.set(i,h=new Map);let _=h.get(s);_||h.set(s,_=N0()),fS(_)}function dS(){return bh&&mc!==void 0}function fS(i,t){let s=!1;Xf<=j0?uS(i)||(i.n|=Ja,s=!cS(i)):s=!i.has(mc),s&&(i.add(mc),mc.deps.push(i))}function ta(i,t,s,h,_,x){const E=U0.get(i);if(!E)return;let a=[];if(t==="clear")a=[...E.values()];else if(s==="length"&&Qt(i))E.forEach((S,O)=>{(O==="length"||O>=h)&&a.push(S)});else switch(s!==void 0&&a.push(E.get(s)),t){case"add":Qt(i)?B0(s)&&a.push(E.get("length")):(a.push(E.get(_c)),vh(i)&&a.push(E.get(V0)));break;case"delete":Qt(i)||(a.push(E.get(_c)),vh(i)&&a.push(E.get(V0)));break;case"set":vh(i)&&a.push(E.get(_c));break}if(a.length===1)a[0]&&q0(a[0]);else{const S=[];for(const O of a)O&&S.push(...O);q0(N0(S))}}function q0(i,t){for(const s of Qt(i)?i:[...i])(s!==mc||s.allowRecurse)&&(s.scheduler?s.scheduler():s.run())}const r3=L0("__proto__,__v_isRef,__isVue"),pS=new Set(Object.getOwnPropertyNames(Symbol).map(i=>Symbol[i]).filter(R0)),o3=Z0(),s3=Z0(!1,!0),a3=Z0(!0),mS=l3();function l3(){const i={};return["includes","indexOf","lastIndexOf"].forEach(t=>{i[t]=function(...s){const h=Gi(this);for(let x=0,E=this.length;x<E;x++)ro(h,"get",x+"");const _=h[t](...s);return _===-1||_===!1?h[t](...s.map(Gi)):_}}),["push","pop","shift","unshift","splice"].forEach(t=>{i[t]=function(...s){wh();const h=Gi(this)[t].apply(this,s);return gc(),h}}),i}function Z0(i=!1,t=!1){return function(h,_,x){if(_==="__v_isReactive")return!i;if(_==="__v_isReadonly")return i;if(_==="__v_raw"&&x===(i?t?T3:TS:t?ES:wS).get(h))return h;const E=Qt(h);if(!i&&E&&Ri(mS,_))return Reflect.get(mS,_,x);const a=Reflect.get(h,_,x);return(R0(_)?pS.has(_):r3(_))||(i||ro(h,"get",_),t)?a:$r(a)?!E||!B0(_)?a.value:a:Sn(a)?i?CS(a):Yf(a):a}}const c3=_S(),u3=_S(!0);function _S(i=!1){return function(s,h,_,x){let E=s[h];if(!i&&(_=Gi(_),E=Gi(E),!Qt(s)&&$r(E)&&!$r(_)))return E.value=_,!0;const a=Qt(s)&&B0(h)?Number(h)<s.length:Ri(s,h),S=Reflect.set(s,h,_,x);return s===Gi(x)&&(a?Wf(_,E)&&ta(s,"set",h,_):ta(s,"add",h,_)),S}}function h3(i,t){const s=Ri(i,t);i[t];const h=Reflect.deleteProperty(i,t);return h&&s&&ta(i,"delete",t,void 0),h}function d3(i,t){const s=Reflect.has(i,t);return(!R0(t)||!pS.has(t))&&ro(i,"has",t),s}function f3(i){return ro(i,"iterate",Qt(i)?"length":_c),Reflect.ownKeys(i)}const gS={get:o3,set:c3,deleteProperty:h3,has:d3,ownKeys:f3},p3={get:a3,set(i,t){return!0},deleteProperty(i,t){return!0}},m3=Qn({},gS,{get:s3,set:u3}),W0=i=>i,ng=i=>Reflect.getPrototypeOf(i);function rg(i,t,s=!1,h=!1){i=i.__v_raw;const _=Gi(i),x=Gi(t);t!==x&&!s&&ro(_,"get",t),!s&&ro(_,"get",x);const{has:E}=ng(_),a=h?W0:s?K0:Jf;if(E.call(_,t))return a(i.get(t));if(E.call(_,x))return a(i.get(x));i!==_&&i.get(t)}function og(i,t=!1){const s=this.__v_raw,h=Gi(s),_=Gi(i);return i!==_&&!t&&ro(h,"has",i),!t&&ro(h,"has",_),i===_?s.has(i):s.has(i)||s.has(_)}function sg(i,t=!1){return i=i.__v_raw,!t&&ro(Gi(i),"iterate",_c),Reflect.get(i,"size",i)}function yS(i){i=Gi(i);const t=Gi(this);return ng(t).has.call(t,i)||(t.add(i),ta(t,"add",i,i)),this}function vS(i,t){t=Gi(t);const s=Gi(this),{has:h,get:_}=ng(s);let x=h.call(s,i);x||(i=Gi(i),x=h.call(s,i));const E=_.call(s,i);return s.set(i,t),x?Wf(t,E)&&ta(s,"set",i,t):ta(s,"add",i,t),this}function xS(i){const t=Gi(this),{has:s,get:h}=ng(t);let _=s.call(t,i);_||(i=Gi(i),_=s.call(t,i)),h&&h.call(t,i);const x=t.delete(i);return _&&ta(t,"delete",i,void 0),x}function bS(){const i=Gi(this),t=i.size!==0,s=i.clear();return t&&ta(i,"clear",void 0,void 0),s}function ag(i,t){return function(h,_){const x=this,E=x.__v_raw,a=Gi(E),S=t?W0:i?K0:Jf;return!i&&ro(a,"iterate",_c),E.forEach((O,M)=>h.call(_,S(O),S(M),x))}}function lg(i,t,s){return function(...h){const _=this.__v_raw,x=Gi(_),E=vh(x),a=i==="entries"||i===Symbol.iterator&&E,S=i==="keys"&&E,O=_[i](...h),M=s?W0:t?K0:Jf;return!t&&ro(x,"iterate",S?V0:_c),{next(){const{value:P,done:z}=O.next();return z?{value:P,done:z}:{value:a?[M(P[0]),M(P[1])]:M(P),done:z}},[Symbol.iterator](){return this}}}}function Qa(i){return function(...t){return i==="delete"?!1:this}}function _3(){const i={get(x){return rg(this,x)},get size(){return sg(this)},has:og,add:yS,set:vS,delete:xS,clear:bS,forEach:ag(!1,!1)},t={get(x){return rg(this,x,!1,!0)},get size(){return sg(this)},has:og,add:yS,set:vS,delete:xS,clear:bS,forEach:ag(!1,!0)},s={get(x){return rg(this,x,!0)},get size(){return sg(this,!0)},has(x){return og.call(this,x,!0)},add:Qa("add"),set:Qa("set"),delete:Qa("delete"),clear:Qa("clear"),forEach:ag(!0,!1)},h={get(x){return rg(this,x,!0,!0)},get size(){return sg(this,!0)},has(x){return og.call(this,x,!0)},add:Qa("add"),set:Qa("set"),delete:Qa("delete"),clear:Qa("clear"),forEach:ag(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(x=>{i[x]=lg(x,!1,!1),s[x]=lg(x,!0,!1),t[x]=lg(x,!1,!0),h[x]=lg(x,!0,!0)}),[i,s,t,h]}const[g3,y3,v3,x3]=_3();function H0(i,t){const s=t?i?x3:v3:i?y3:g3;return(h,_,x)=>_==="__v_isReactive"?!i:_==="__v_isReadonly"?i:_==="__v_raw"?h:Reflect.get(Ri(s,_)&&_ in h?s:h,_,x)}const b3={get:H0(!1,!1)},w3={get:H0(!1,!0)},E3={get:H0(!0,!1)},wS=new WeakMap,ES=new WeakMap,TS=new WeakMap,T3=new WeakMap;function C3(i){switch(i){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function S3(i){return i.__v_skip||!Object.isExtensible(i)?0:C3(XB(i))}function Yf(i){return i&&i.__v_isReadonly?i:X0(i,!1,gS,b3,wS)}function A3(i){return X0(i,!1,m3,w3,ES)}function CS(i){return X0(i,!0,p3,E3,TS)}function X0(i,t,s,h,_){if(!Sn(i)||i.__v_raw&&!(t&&i.__v_isReactive))return i;const x=_.get(i);if(x)return x;const E=S3(i);if(E===0)return i;const a=new Proxy(i,E===2?h:s);return _.set(i,a),a}function Eh(i){return SS(i)?Eh(i.__v_raw):!!(i&&i.__v_isReactive)}function SS(i){return!!(i&&i.__v_isReadonly)}function AS(i){return Eh(i)||SS(i)}function Gi(i){const t=i&&i.__v_raw;return t?Gi(t):i}function IS(i){return tg(i,"__v_skip",!0),i}const Jf=i=>Sn(i)?Yf(i):i,K0=i=>Sn(i)?CS(i):i;function MS(i){dS()&&(i=Gi(i),i.dep||(i.dep=N0()),fS(i.dep))}function kS(i,t){i=Gi(i),i.dep&&q0(i.dep)}function $r(i){return Boolean(i&&i.__v_isRef===!0)}function I3(i){return PS(i,!1)}function M3(i){return PS(i,!0)}function PS(i,t){return $r(i)?i:new k3(i,t)}class k3{constructor(t,s){this._shallow=s,this.dep=void 0,this.__v_isRef=!0,this._rawValue=s?t:Gi(t),this._value=s?t:Jf(t)}get value(){return MS(this),this._value}set value(t){t=this._shallow?t:Gi(t),Wf(t,this._rawValue)&&(this._rawValue=t,this._value=this._shallow?t:Jf(t),kS(this))}}function Qf(i){return $r(i)?i.value:i}const P3={get:(i,t,s)=>Qf(Reflect.get(i,t,s)),set:(i,t,s,h)=>{const _=i[t];return $r(_)&&!$r(s)?(_.value=s,!0):Reflect.set(i,t,s,h)}};function DS(i){return Eh(i)?i:new Proxy(i,P3)}class D3{constructor(t,s,h){this._setter=s,this.dep=void 0,this._dirty=!0,this.__v_isRef=!0,this.effect=new $0(t,()=>{this._dirty||(this._dirty=!0,kS(this))}),this.__v_isReadonly=h}get value(){const t=Gi(this);return MS(t),t._dirty&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function ys(i,t){let s,h;const _=_i(i);return _?(s=i,h=Go):(s=i.get,h=i.set),new D3(s,h,_||!h)}Promise.resolve();function L3(i,t,...s){const h=i.vnode.props||on;let _=s;const x=t.startsWith("update:"),E=x&&t.slice(7);if(E&&E in h){const M=`${E==="modelValue"?"model":E}Modifiers`,{number:P,trim:z}=h[M]||on;z?_=s.map(q=>q.trim()):P&&(_=s.map(Hf))}let a,S=h[a=F0(t)]||h[a=F0(gs(t))];!S&&x&&(S=h[a=F0(xh(t))]),S&&So(S,i,6,_);const O=h[a+"Once"];if(O){if(!i.emitted)i.emitted={};else if(i.emitted[a])return;i.emitted[a]=!0,So(O,i,6,_)}}function LS(i,t,s=!1){const h=t.emitsCache,_=h.get(i);if(_!==void 0)return _;const x=i.emits;let E={},a=!1;if(!_i(i)){const S=O=>{const M=LS(O,t,!0);M&&(a=!0,Qn(E,M))};!s&&t.mixins.length&&t.mixins.forEach(S),i.extends&&S(i.extends),i.mixins&&i.mixins.forEach(S)}return!x&&!a?(h.set(i,null),null):(Qt(x)?x.forEach(S=>E[S]=null):Qn(E,x),h.set(i,E),E)}function Y0(i,t){return!i||!H_(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ri(i,t[0].toLowerCase()+t.slice(1))||Ri(i,xh(t))||Ri(i,t))}let oo=null,cg=null;function ug(i){const t=oo;return oo=i,cg=i&&i.type.__scopeId||null,t}function z8(i){cg=i}function O8(){cg=null}function z3(i,t=oo,s){if(!t||i._n)return i;const h=(..._)=>{h._d&&s2(-1);const x=ug(t),E=i(..._);return ug(x),h._d&&s2(1),E};return h._n=!0,h._c=!0,h._d=!0,h}function J0(i){const{type:t,vnode:s,proxy:h,withProxy:_,props:x,propsOptions:[E],slots:a,attrs:S,emit:O,render:M,renderCache:P,data:z,setupState:q,ctx:se,inheritAttrs:ue}=i;let oe,fe;const xe=ug(i);try{if(s.shapeFlag&4){const $e=_||h;oe=bs(M.call($e,$e,P,x,q,z,se)),fe=S}else{const $e=t;oe=bs($e.length>1?$e(x,{attrs:S,slots:a,emit:O}):$e(x,null)),fe=t.props?S:O3(S)}}catch($e){ep.length=0,wg($e,i,1),oe=wr(qo)}let Be=oe;if(fe&&ue!==!1){const $e=Object.keys(fe),{shapeFlag:Ge}=Be;$e.length&&Ge&(1|6)&&(E&&$e.some(O0)&&(fe=R3(fe,E)),Be=Th(Be,fe))}return s.dirs&&(Be.dirs=Be.dirs?Be.dirs.concat(s.dirs):s.dirs),s.transition&&(Be.transition=s.transition),oe=Be,ug(xe),oe}const O3=i=>{let t;for(const s in i)(s==="class"||s==="style"||H_(s))&&((t||(t={}))[s]=i[s]);return t},R3=(i,t)=>{const s={};for(const h in i)(!O0(h)||!(h.slice(9)in t))&&(s[h]=i[h]);return s};function B3(i,t,s){const{props:h,children:_,component:x}=i,{props:E,children:a,patchFlag:S}=t,O=x.emitsOptions;if(t.dirs||t.transition)return!0;if(s&&S>=0){if(S&1024)return!0;if(S&16)return h?zS(h,E,O):!!E;if(S&8){const M=t.dynamicProps;for(let P=0;P<M.length;P++){const z=M[P];if(E[z]!==h[z]&&!Y0(O,z))return!0}}}else return(_||a)&&(!a||!a.$stable)?!0:h===E?!1:h?E?zS(h,E,O):!0:!!E;return!1}function zS(i,t,s){const h=Object.keys(t);if(h.length!==Object.keys(i).length)return!0;for(let _=0;_<h.length;_++){const x=h[_];if(t[x]!==i[x]&&!Y0(s,x))return!0}return!1}function F3({vnode:i,parent:t},s){for(;t&&t.subTree===i;)(i=t.vnode).el=s,t=t.parent}const N3=i=>i.__isSuspense;function U3(i,t){t&&t.pendingBranch?Qt(i)?t.effects.push(...i):t.effects.push(i):UF(i)}function hg(i,t){if(Hn){let s=Hn.provides;const h=Hn.parent&&Hn.parent.provides;h===s&&(s=Hn.provides=Object.create(h)),s[i]=t}}function vs(i,t,s=!1){const h=Hn||oo;if(h){const _=h.parent==null?h.vnode.appContext&&h.vnode.appContext.provides:h.parent.provides;if(_&&i in _)return _[i];if(arguments.length>1)return s&&_i(t)?t.call(h.proxy):t}}function j3(){const i={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return US(()=>{i.isMounted=!0}),jS(()=>{i.isUnmounting=!0}),i}const To=[Function,Array],V3={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:To,onEnter:To,onAfterEnter:To,onEnterCancelled:To,onBeforeLeave:To,onLeave:To,onAfterLeave:To,onLeaveCancelled:To,onBeforeAppear:To,onAppear:To,onAfterAppear:To,onAppearCancelled:To},setup(i,{slots:t}){const s=MF(),h=j3();let _;return()=>{const x=t.default&&FS(t.default(),!0);if(!x||!x.length)return;const E=Gi(i),{mode:a}=E,S=x[0];if(h.isLeaving)return ex(S);const O=BS(S);if(!O)return ex(S);const M=Q0(O,E,h,s);tx(O,M);const P=s.subTree,z=P&&BS(P);let q=!1;const{getTransitionKey:se}=O.type;if(se){const ue=se();_===void 0?_=ue:ue!==_&&(_=ue,q=!0)}if(z&&z.type!==qo&&(!bc(O,z)||q)){const ue=Q0(z,E,h,s);if(tx(z,ue),a==="out-in")return h.isLeaving=!0,ue.afterLeave=()=>{h.isLeaving=!1,s.update()},ex(S);a==="in-out"&&O.type!==qo&&(ue.delayLeave=(oe,fe,xe)=>{const Be=RS(h,z);Be[String(z.key)]=z,oe._leaveCb=()=>{fe(),oe._leaveCb=void 0,delete M.delayedLeave},M.delayedLeave=xe})}return S}}},OS=V3;function RS(i,t){const{leavingVNodes:s}=i;let h=s.get(t.type);return h||(h=Object.create(null),s.set(t.type,h)),h}function Q0(i,t,s,h){const{appear:_,mode:x,persisted:E=!1,onBeforeEnter:a,onEnter:S,onAfterEnter:O,onEnterCancelled:M,onBeforeLeave:P,onLeave:z,onAfterLeave:q,onLeaveCancelled:se,onBeforeAppear:ue,onAppear:oe,onAfterAppear:fe,onAppearCancelled:xe}=t,Be=String(i.key),$e=RS(s,i),Ge=(pt,jt)=>{pt&&So(pt,h,9,jt)},xt={mode:x,persisted:E,beforeEnter(pt){let jt=a;if(!s.isMounted)if(_)jt=ue||a;else return;pt._leaveCb&&pt._leaveCb(!0);const Dt=$e[Be];Dt&&bc(i,Dt)&&Dt.el._leaveCb&&Dt.el._leaveCb(),Ge(jt,[pt])},enter(pt){let jt=S,Dt=O,Ft=M;if(!s.isMounted)if(_)jt=oe||S,Dt=fe||O,Ft=xe||M;else return;let ai=!1;const wt=pt._enterCb=Nt=>{ai||(ai=!0,Nt?Ge(Ft,[pt]):Ge(Dt,[pt]),xt.delayedLeave&&xt.delayedLeave(),pt._enterCb=void 0)};jt?(jt(pt,wt),jt.length<=1&&wt()):wt()},leave(pt,jt){const Dt=String(i.key);if(pt._enterCb&&pt._enterCb(!0),s.isUnmounting)return jt();Ge(P,[pt]);let Ft=!1;const ai=pt._leaveCb=wt=>{Ft||(Ft=!0,jt(),wt?Ge(se,[pt]):Ge(q,[pt]),pt._leaveCb=void 0,$e[Dt]===i&&delete $e[Dt])};$e[Dt]=i,z?(z(pt,ai),z.length<=1&&ai()):ai()},clone(pt){return Q0(pt,t,s,h)}};return xt}function ex(i){if(dg(i))return i=Th(i),i.children=null,i}function BS(i){return dg(i)?i.children?i.children[0]:void 0:i}function tx(i,t){i.shapeFlag&6&&i.component?tx(i.component.subTree,t):i.shapeFlag&128?(i.ssContent.transition=t.clone(i.ssContent),i.ssFallback.transition=t.clone(i.ssFallback)):i.transition=t}function FS(i,t=!1){let s=[],h=0;for(let _=0;_<i.length;_++){const x=i[_];x.type===Co?(x.patchFlag&128&&h++,s=s.concat(FS(x.children,t))):(t||x.type!==qo)&&s.push(x)}if(h>1)for(let _=0;_<s.length;_++)s[_].patchFlag=-2;return s}function ix(i){return _i(i)?{setup:i,name:i.name}:i}const nx=i=>!!i.type.__asyncLoader,dg=i=>i.type.__isKeepAlive;function $3(i,t){NS(i,"a",t)}function G3(i,t){NS(i,"da",t)}function NS(i,t,s=Hn){const h=i.__wdc||(i.__wdc=()=>{let _=s;for(;_;){if(_.isDeactivated)return;_=_.parent}i()});if(fg(t,h,s),s){let _=s.parent;for(;_&&_.parent;)dg(_.parent.vnode)&&q3(h,t,s,_),_=_.parent}}function q3(i,t,s,h){const _=fg(t,i,h,!0);VS(()=>{nS(h[t],_)},s)}function fg(i,t,s=Hn,h=!1){if(s){const _=s[i]||(s[i]=[]),x=t.__weh||(t.__weh=(...E)=>{if(s.isUnmounted)return;wh(),Ch(s);const a=So(t,s,i,E);return wc(),gc(),a});return h?_.unshift(x):_.push(x),x}}const ia=i=>(t,s=Hn)=>(!bg||i==="sp")&&fg(i,t,s),Z3=ia("bm"),US=ia("m"),W3=ia("bu"),H3=ia("u"),jS=ia("bum"),VS=ia("um"),X3=ia("sp"),K3=ia("rtg"),Y3=ia("rtc");function J3(i,t=Hn){fg("ec",i,t)}let rx=!0;function Q3(i){const t=qS(i),s=i.proxy,h=i.ctx;rx=!1,t.beforeCreate&&$S(t.beforeCreate,i,"bc");const{data:_,computed:x,methods:E,watch:a,provide:S,inject:O,created:M,beforeMount:P,mounted:z,beforeUpdate:q,updated:se,activated:ue,deactivated:oe,beforeDestroy:fe,beforeUnmount:xe,destroyed:Be,unmounted:$e,render:Ge,renderTracked:xt,renderTriggered:pt,errorCaptured:jt,serverPrefetch:Dt,expose:Ft,inheritAttrs:ai,components:wt,directives:Nt,filters:qi}=t;if(O&&eF(O,h,null,i.appContext.config.unwrapInjectedRef),E)for(const ri in E){const ei=E[ri];_i(ei)&&(h[ri]=ei.bind(s))}if(_){const ri=_.call(s,s);Sn(ri)&&(i.data=Yf(ri))}if(rx=!0,x)for(const ri in x){const ei=x[ri],Wi=_i(ei)?ei.bind(s,s):_i(ei.get)?ei.get.bind(s,s):Go,sn=!_i(ei)&&_i(ei.set)?ei.set.bind(s):Go,kn=ys({get:Wi,set:sn});Object.defineProperty(h,ri,{enumerable:!0,configurable:!0,get:()=>kn.value,set:oi=>kn.value=oi})}if(a)for(const ri in a)GS(a[ri],h,s,ri);if(S){const ri=_i(S)?S.call(s):S;Reflect.ownKeys(ri).forEach(ei=>{hg(ei,ri[ei])})}M&&$S(M,i,"c");function hi(ri,ei){Qt(ei)?ei.forEach(Wi=>ri(Wi.bind(s))):ei&&ri(ei.bind(s))}if(hi(Z3,P),hi(US,z),hi(W3,q),hi(H3,se),hi($3,ue),hi(G3,oe),hi(J3,jt),hi(Y3,xt),hi(K3,pt),hi(jS,xe),hi(VS,$e),hi(X3,Dt),Qt(Ft))if(Ft.length){const ri=i.exposed||(i.exposed={});Ft.forEach(ei=>{Object.defineProperty(ri,ei,{get:()=>s[ei],set:Wi=>s[ei]=Wi})})}else i.exposed||(i.exposed={});Ge&&i.render===Go&&(i.render=Ge),ai!=null&&(i.inheritAttrs=ai),wt&&(i.components=wt),Nt&&(i.directives=Nt)}function eF(i,t,s=Go,h=!1){Qt(i)&&(i=ox(i));for(const _ in i){const x=i[_];let E;Sn(x)?"default"in x?E=vs(x.from||_,x.default,!0):E=vs(x.from||_):E=vs(x),$r(E)&&h?Object.defineProperty(t,_,{enumerable:!0,configurable:!0,get:()=>E.value,set:a=>E.value=a}):t[_]=E}}function $S(i,t,s){So(Qt(i)?i.map(h=>h.bind(t.proxy)):i.bind(t.proxy),t,s)}function GS(i,t,s,h){const _=h.includes(".")?E2(s,h):()=>s[h];if(er(i)){const x=t[i];_i(x)&&Tg(_,x)}else if(_i(i))Tg(_,i.bind(s));else if(Sn(i))if(Qt(i))i.forEach(x=>GS(x,t,s,h));else{const x=_i(i.handler)?i.handler.bind(s):t[i.handler];_i(x)&&Tg(_,x,i)}}function qS(i){const t=i.type,{mixins:s,extends:h}=t,{mixins:_,optionsCache:x,config:{optionMergeStrategies:E}}=i.appContext,a=x.get(t);let S;return a?S=a:!_.length&&!s&&!h?S=t:(S={},_.length&&_.forEach(O=>pg(S,O,E,!0)),pg(S,t,E)),x.set(t,S),S}function pg(i,t,s,h=!1){const{mixins:_,extends:x}=t;x&&pg(i,x,s,!0),_&&_.forEach(E=>pg(i,E,s,!0));for(const E in t)if(!(h&&E==="expose")){const a=tF[E]||s&&s[E];i[E]=a?a(i[E],t[E]):t[E]}return i}const tF={data:ZS,props:yc,emits:yc,methods:yc,computed:yc,beforeCreate:xr,created:xr,beforeMount:xr,mounted:xr,beforeUpdate:xr,updated:xr,beforeDestroy:xr,beforeUnmount:xr,destroyed:xr,unmounted:xr,activated:xr,deactivated:xr,errorCaptured:xr,serverPrefetch:xr,components:yc,directives:yc,watch:nF,provide:ZS,inject:iF};function ZS(i,t){return t?i?function(){return Qn(_i(i)?i.call(this,this):i,_i(t)?t.call(this,this):t)}:t:i}function iF(i,t){return yc(ox(i),ox(t))}function ox(i){if(Qt(i)){const t={};for(let s=0;s<i.length;s++)t[i[s]]=i[s];return t}return i}function xr(i,t){return i?[...new Set([].concat(i,t))]:t}function yc(i,t){return i?Qn(Qn(Object.create(null),i),t):t}function nF(i,t){if(!i)return t;if(!t)return i;const s=Qn(Object.create(null),i);for(const h in t)s[h]=xr(i[h],t[h]);return s}function rF(i,t,s,h=!1){const _={},x={};tg(x,yg,1),i.propsDefaults=Object.create(null),WS(i,t,_,x);for(const E in i.propsOptions[0])E in _||(_[E]=void 0);s?i.props=h?_:A3(_):i.type.props?i.props=_:i.props=x,i.attrs=x}function oF(i,t,s,h){const{props:_,attrs:x,vnode:{patchFlag:E}}=i,a=Gi(_),[S]=i.propsOptions;let O=!1;if((h||E>0)&&!(E&16)){if(E&8){const M=i.vnode.dynamicProps;for(let P=0;P<M.length;P++){let z=M[P];const q=t[z];if(S)if(Ri(x,z))q!==x[z]&&(x[z]=q,O=!0);else{const se=gs(z);_[se]=sx(S,a,se,q,i,!1)}else q!==x[z]&&(x[z]=q,O=!0)}}}else{WS(i,t,_,x)&&(O=!0);let M;for(const P in a)(!t||!Ri(t,P)&&((M=xh(P))===P||!Ri(t,M)))&&(S?s&&(s[P]!==void 0||s[M]!==void 0)&&(_[P]=sx(S,a,P,void 0,i,!0)):delete _[P]);if(x!==a)for(const P in x)(!t||!Ri(t,P))&&(delete x[P],O=!0)}O&&ta(i,"set","$attrs")}function WS(i,t,s,h){const[_,x]=i.propsOptions;let E=!1,a;if(t)for(let S in t){if(Y_(S))continue;const O=t[S];let M;_&&Ri(_,M=gs(S))?!x||!x.includes(M)?s[M]=O:(a||(a={}))[M]=O:Y0(i.emitsOptions,S)||O!==h[S]&&(h[S]=O,E=!0)}if(x){const S=Gi(s),O=a||on;for(let M=0;M<x.length;M++){const P=x[M];s[P]=sx(_,S,P,O[P],i,!Ri(O,P))}}return E}function sx(i,t,s,h,_,x){const E=i[s];if(E!=null){const a=Ri(E,"default");if(a&&h===void 0){const S=E.default;if(E.type!==Function&&_i(S)){const{propsDefaults:O}=_;s in O?h=O[s]:(Ch(_),h=O[s]=S.call(null,t),wc())}else h=S}E[0]&&(x&&!a?h=!1:E[1]&&(h===""||h===xh(s))&&(h=!0))}return h}function HS(i,t,s=!1){const h=t.propsCache,_=h.get(i);if(_)return _;const x=i.props,E={},a=[];let S=!1;if(!_i(i)){const M=P=>{S=!0;const[z,q]=HS(P,t,!0);Qn(E,z),q&&a.push(...q)};!s&&t.mixins.length&&t.mixins.forEach(M),i.extends&&M(i.extends),i.mixins&&i.mixins.forEach(M)}if(!x&&!S)return h.set(i,yh),yh;if(Qt(x))for(let M=0;M<x.length;M++){const P=gs(x[M]);XS(P)&&(E[P]=on)}else if(x)for(const M in x){const P=gs(M);if(XS(P)){const z=x[M],q=E[P]=Qt(z)||_i(z)?{type:z}:z;if(q){const se=JS(Boolean,q.type),ue=JS(String,q.type);q[0]=se>-1,q[1]=ue<0||se<ue,(se>-1||Ri(q,"default"))&&a.push(P)}}}const O=[E,a];return h.set(i,O),O}function XS(i){return i[0]!=="$"}function KS(i){const t=i&&i.toString().match(/^\s*function (\w+)/);return t?t[1]:i===null?"null":""}function YS(i,t){return KS(i)===KS(t)}function JS(i,t){return Qt(t)?t.findIndex(s=>YS(s,i)):_i(t)&&YS(t,i)?0:-1}const QS=i=>i[0]==="_"||i==="$stable",ax=i=>Qt(i)?i.map(bs):[bs(i)],sF=(i,t,s)=>{const h=z3((..._)=>ax(t(..._)),s);return h._c=!1,h},e2=(i,t,s)=>{const h=i._ctx;for(const _ in i){if(QS(_))continue;const x=i[_];if(_i(x))t[_]=sF(_,x,h);else if(x!=null){const E=ax(x);t[_]=()=>E}}},t2=(i,t)=>{const s=ax(t);i.slots.default=()=>s},aF=(i,t)=>{if(i.vnode.shapeFlag&32){const s=t._;s?(i.slots=Gi(t),tg(t,"_",s)):e2(t,i.slots={})}else i.slots={},t&&t2(i,t);tg(i.slots,yg,1)},lF=(i,t,s)=>{const{vnode:h,slots:_}=i;let x=!0,E=on;if(h.shapeFlag&32){const a=t._;a?s&&a===1?x=!1:(Qn(_,t),!s&&a===1&&delete _._):(x=!t.$stable,e2(t,_)),E=t}else t&&(t2(i,t),E={default:1});if(x)for(const a in _)!QS(a)&&!(a in E)&&delete _[a]};function cF(i,t){const s=oo;if(s===null)return i;const h=s.proxy,_=i.dirs||(i.dirs=[]);for(let x=0;x<t.length;x++){let[E,a,S,O=on]=t[x];_i(E)&&(E={mounted:E,updated:E}),E.deep&&Ec(a),_.push({dir:E,instance:h,value:a,oldValue:void 0,arg:S,modifiers:O})}return i}function vc(i,t,s,h){const _=i.dirs,x=t&&t.dirs;for(let E=0;E<_.length;E++){const a=_[E];x&&(a.oldValue=x[E].value);let S=a.dir[h];S&&(wh(),So(S,s,8,[i.el,a,i,t]),gc())}}function i2(){return{app:null,config:{isNativeTag:ZB,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uF=0;function hF(i,t){return function(h,_=null){_!=null&&!Sn(_)&&(_=null);const x=i2(),E=new Set;let a=!1;const S=x.app={_uid:uF++,_component:h,_props:_,_container:null,_context:x,_instance:null,version:VF,get config(){return x.config},set config(O){},use(O,...M){return E.has(O)||(O&&_i(O.install)?(E.add(O),O.install(S,...M)):_i(O)&&(E.add(O),O(S,...M))),S},mixin(O){return x.mixins.includes(O)||x.mixins.push(O),S},component(O,M){return M?(x.components[O]=M,S):x.components[O]},directive(O,M){return M?(x.directives[O]=M,S):x.directives[O]},mount(O,M,P){if(!a){const z=wr(h,_);return z.appContext=x,M&&t?t(z,O):i(z,O,P),a=!0,S._container=O,O.__vue_app__=S,fx(z.component)||z.component.proxy}},unmount(){a&&(i(null,S._container),delete S._container.__vue_app__)},provide(O,M){return x.provides[O]=M,S}};return S}}const br=U3;function dF(i){return fF(i)}function fF(i,t){const s=JB();s.__VUE__=!0;const{insert:h,remove:_,patchProp:x,createElement:E,createText:a,createComment:S,setText:O,setElementText:M,parentNode:P,nextSibling:z,setScopeId:q=Go,cloneNode:se,insertStaticContent:ue}=i,oe=(de,me,Le,He=null,Ze=null,et=null,vt=!1,Ue=null,rt=!!me.dynamicChildren)=>{if(de===me)return;de&&!bc(de,me)&&(He=It(de),Si(de,Ze,et,!0),de=null),me.patchFlag===-2&&(rt=!1,me.dynamicChildren=null);const{type:Qe,ref:Mt,shapeFlag:Tt}=me;switch(Qe){case cx:fe(de,me,Le,He);break;case qo:xe(de,me,Le,He);break;case mg:de==null&&Be(me,Le,He,vt);break;case Co:Nt(de,me,Le,He,Ze,et,vt,Ue,rt);break;default:Tt&1?xt(de,me,Le,He,Ze,et,vt,Ue,rt):Tt&6?qi(de,me,Le,He,Ze,et,vt,Ue,rt):(Tt&64||Tt&128)&&Qe.process(de,me,Le,He,Ze,et,vt,Ue,rt,di)}Mt!=null&&Ze&&lx(Mt,de&&de.ref,et,me||de,!me)},fe=(de,me,Le,He)=>{if(de==null)h(me.el=a(me.children),Le,He);else{const Ze=me.el=de.el;me.children!==de.children&&O(Ze,me.children)}},xe=(de,me,Le,He)=>{de==null?h(me.el=S(me.children||""),Le,He):me.el=de.el},Be=(de,me,Le,He)=>{[de.el,de.anchor]=ue(de.children,me,Le,He)},$e=({el:de,anchor:me},Le,He)=>{let Ze;for(;de&&de!==me;)Ze=z(de),h(de,Le,He),de=Ze;h(me,Le,He)},Ge=({el:de,anchor:me})=>{let Le;for(;de&&de!==me;)Le=z(de),_(de),de=Le;_(me)},xt=(de,me,Le,He,Ze,et,vt,Ue,rt)=>{vt=vt||me.type==="svg",de==null?pt(me,Le,He,Ze,et,vt,Ue,rt):Ft(de,me,Ze,et,vt,Ue,rt)},pt=(de,me,Le,He,Ze,et,vt,Ue)=>{let rt,Qe;const{type:Mt,props:Tt,shapeFlag:zt,transition:Vt,patchFlag:li,dirs:fi}=de;if(de.el&&se!==void 0&&li===-1)rt=de.el=se(de.el);else{if(rt=de.el=E(de.type,et,Tt&&Tt.is,Tt),zt&8?M(rt,de.children):zt&16&&Dt(de.children,rt,null,He,Ze,et&&Mt!=="foreignObject",vt,Ue),fi&&vc(de,null,He,"created"),Tt){for(const Ii in Tt)Ii!=="value"&&!Y_(Ii)&&x(rt,Ii,null,Tt[Ii],et,de.children,He,Ze,ct);"value"in Tt&&x(rt,"value",null,Tt.value),(Qe=Tt.onVnodeBeforeMount)&&xs(Qe,He,de)}jt(rt,de,de.scopeId,vt,He)}fi&&vc(de,null,He,"beforeMount");const pi=(!Ze||Ze&&!Ze.pendingBranch)&&Vt&&!Vt.persisted;pi&&Vt.beforeEnter(rt),h(rt,me,Le),((Qe=Tt&&Tt.onVnodeMounted)||pi||fi)&&br(()=>{Qe&&xs(Qe,He,de),pi&&Vt.enter(rt),fi&&vc(de,null,He,"mounted")},Ze)},jt=(de,me,Le,He,Ze)=>{if(Le&&q(de,Le),He)for(let et=0;et<He.length;et++)q(de,He[et]);if(Ze){let et=Ze.subTree;if(me===et){const vt=Ze.vnode;jt(de,vt,vt.scopeId,vt.slotScopeIds,Ze.parent)}}},Dt=(de,me,Le,He,Ze,et,vt,Ue,rt=0)=>{for(let Qe=rt;Qe<de.length;Qe++){const Mt=de[Qe]=Ue?el(de[Qe]):bs(de[Qe]);oe(null,Mt,me,Le,He,Ze,et,vt,Ue)}},Ft=(de,me,Le,He,Ze,et,vt)=>{const Ue=me.el=de.el;let{patchFlag:rt,dynamicChildren:Qe,dirs:Mt}=me;rt|=de.patchFlag&16;const Tt=de.props||on,zt=me.props||on;let Vt;(Vt=zt.onVnodeBeforeUpdate)&&xs(Vt,Le,me,de),Mt&&vc(me,de,Le,"beforeUpdate");const li=Ze&&me.type!=="foreignObject";if(Qe?ai(de.dynamicChildren,Qe,Ue,Le,He,li,et):vt||Wi(de,me,Ue,null,Le,He,li,et,!1),rt>0){if(rt&16)wt(Ue,me,Tt,zt,Le,He,Ze);else if(rt&2&&Tt.class!==zt.class&&x(Ue,"class",null,zt.class,Ze),rt&4&&x(Ue,"style",Tt.style,zt.style,Ze),rt&8){const fi=me.dynamicProps;for(let pi=0;pi<fi.length;pi++){const Ii=fi[pi],Un=Tt[Ii],wn=zt[Ii];(wn!==Un||Ii==="value")&&x(Ue,Ii,Un,wn,Ze,de.children,Le,He,ct)}}rt&1&&de.children!==me.children&&M(Ue,me.children)}else!vt&&Qe==null&&wt(Ue,me,Tt,zt,Le,He,Ze);((Vt=zt.onVnodeUpdated)||Mt)&&br(()=>{Vt&&xs(Vt,Le,me,de),Mt&&vc(me,de,Le,"updated")},He)},ai=(de,me,Le,He,Ze,et,vt)=>{for(let Ue=0;Ue<me.length;Ue++){const rt=de[Ue],Qe=me[Ue],Mt=rt.el&&(rt.type===Co||!bc(rt,Qe)||rt.shapeFlag&(6|64))?P(rt.el):Le;oe(rt,Qe,Mt,null,He,Ze,et,vt,!0)}},wt=(de,me,Le,He,Ze,et,vt)=>{if(Le!==He){for(const Ue in He){if(Y_(Ue))continue;const rt=He[Ue],Qe=Le[Ue];rt!==Qe&&Ue!=="value"&&x(de,Ue,Qe,rt,vt,me.children,Ze,et,ct)}if(Le!==on)for(const Ue in Le)!Y_(Ue)&&!(Ue in He)&&x(de,Ue,Le[Ue],null,vt,me.children,Ze,et,ct);"value"in He&&x(de,"value",Le.value,He.value)}},Nt=(de,me,Le,He,Ze,et,vt,Ue,rt)=>{const Qe=me.el=de?de.el:a(""),Mt=me.anchor=de?de.anchor:a("");let{patchFlag:Tt,dynamicChildren:zt,slotScopeIds:Vt}=me;Vt&&(Ue=Ue?Ue.concat(Vt):Vt),de==null?(h(Qe,Le,He),h(Mt,Le,He),Dt(me.children,Le,Mt,Ze,et,vt,Ue,rt)):Tt>0&&Tt&64&&zt&&de.dynamicChildren?(ai(de.dynamicChildren,zt,Le,Ze,et,vt,Ue),(me.key!=null||Ze&&me===Ze.subTree)&&n2(de,me,!0)):Wi(de,me,Le,Mt,Ze,et,vt,Ue,rt)},qi=(de,me,Le,He,Ze,et,vt,Ue,rt)=>{me.slotScopeIds=Ue,de==null?me.shapeFlag&512?Ze.ctx.activate(me,Le,He,vt,rt):bn(me,Le,He,Ze,et,vt,rt):hi(de,me,rt)},bn=(de,me,Le,He,Ze,et,vt)=>{const Ue=de.component=IF(de,He,Ze);if(dg(de)&&(Ue.ctx.renderer=di),kF(Ue),Ue.asyncDep){if(Ze&&Ze.registerDep(Ue,ri),!de.el){const rt=Ue.subTree=wr(qo);xe(null,rt,me,Le)}return}ri(Ue,de,me,Le,Ze,et,vt)},hi=(de,me,Le)=>{const He=me.component=de.component;if(B3(de,me,Le))if(He.asyncDep&&!He.asyncResolved){ei(He,me,Le);return}else He.next=me,FF(He.update),He.update();else me.component=de.component,me.el=de.el,He.vnode=me},ri=(de,me,Le,He,Ze,et,vt)=>{const Ue=()=>{if(de.isMounted){let{next:Mt,bu:Tt,u:zt,parent:Vt,vnode:li}=de,fi=Mt,pi;rt.allowRecurse=!1,Mt?(Mt.el=li.el,ei(de,Mt,vt)):Mt=li,Tt&&eg(Tt),(pi=Mt.props&&Mt.props.onVnodeBeforeUpdate)&&xs(pi,Vt,Mt,li),rt.allowRecurse=!0;const Ii=J0(de),Un=de.subTree;de.subTree=Ii,oe(Un,Ii,P(Un.el),It(Un),de,Ze,et),Mt.el=Ii.el,fi===null&&F3(de,Ii.el),zt&&br(zt,Ze),(pi=Mt.props&&Mt.props.onVnodeUpdated)&&br(()=>xs(pi,Vt,Mt,li),Ze)}else{let Mt;const{el:Tt,props:zt}=me,{bm:Vt,m:li,parent:fi}=de,pi=nx(me);if(rt.allowRecurse=!1,Vt&&eg(Vt),!pi&&(Mt=zt&&zt.onVnodeBeforeMount)&&xs(Mt,fi,me),rt.allowRecurse=!0,Tt&&Wt){const Ii=()=>{de.subTree=J0(de),Wt(Tt,de.subTree,de,Ze,null)};pi?me.type.__asyncLoader().then(()=>!de.isUnmounted&&Ii()):Ii()}else{const Ii=de.subTree=J0(de);oe(null,Ii,Le,He,de,Ze,et),me.el=Ii.el}if(li&&br(li,Ze),!pi&&(Mt=zt&&zt.onVnodeMounted)){const Ii=me;br(()=>xs(Mt,fi,Ii),Ze)}me.shapeFlag&256&&de.a&&br(de.a,Ze),de.isMounted=!0,me=Le=He=null}},rt=new $0(Ue,()=>g2(de.update),de.scope),Qe=de.update=rt.run.bind(rt);Qe.id=de.uid,rt.allowRecurse=Qe.allowRecurse=!0,Qe()},ei=(de,me,Le)=>{me.component=de;const He=de.vnode.props;de.vnode=me,de.next=null,oF(de,me.props,He,Le),lF(de,me.children,Le),wh(),yx(void 0,de.update),gc()},Wi=(de,me,Le,He,Ze,et,vt,Ue,rt=!1)=>{const Qe=de&&de.children,Mt=de?de.shapeFlag:0,Tt=me.children,{patchFlag:zt,shapeFlag:Vt}=me;if(zt>0){if(zt&128){kn(Qe,Tt,Le,He,Ze,et,vt,Ue,rt);return}else if(zt&256){sn(Qe,Tt,Le,He,Ze,et,vt,Ue,rt);return}}Vt&8?(Mt&16&&ct(Qe,Ze,et),Tt!==Qe&&M(Le,Tt)):Mt&16?Vt&16?kn(Qe,Tt,Le,He,Ze,et,vt,Ue,rt):ct(Qe,Ze,et,!0):(Mt&8&&M(Le,""),Vt&16&&Dt(Tt,Le,He,Ze,et,vt,Ue,rt))},sn=(de,me,Le,He,Ze,et,vt,Ue,rt)=>{de=de||yh,me=me||yh;const Qe=de.length,Mt=me.length,Tt=Math.min(Qe,Mt);let zt;for(zt=0;zt<Tt;zt++){const Vt=me[zt]=rt?el(me[zt]):bs(me[zt]);oe(de[zt],Vt,Le,null,Ze,et,vt,Ue,rt)}Qe>Mt?ct(de,Ze,et,!0,!1,Tt):Dt(me,Le,He,Ze,et,vt,Ue,rt,Tt)},kn=(de,me,Le,He,Ze,et,vt,Ue,rt)=>{let Qe=0;const Mt=me.length;let Tt=de.length-1,zt=Mt-1;for(;Qe<=Tt&&Qe<=zt;){const Vt=de[Qe],li=me[Qe]=rt?el(me[Qe]):bs(me[Qe]);if(bc(Vt,li))oe(Vt,li,Le,null,Ze,et,vt,Ue,rt);else break;Qe++}for(;Qe<=Tt&&Qe<=zt;){const Vt=de[Tt],li=me[zt]=rt?el(me[zt]):bs(me[zt]);if(bc(Vt,li))oe(Vt,li,Le,null,Ze,et,vt,Ue,rt);else break;Tt--,zt--}if(Qe>Tt){if(Qe<=zt){const Vt=zt+1,li=Vt<Mt?me[Vt].el:He;for(;Qe<=zt;)oe(null,me[Qe]=rt?el(me[Qe]):bs(me[Qe]),Le,li,Ze,et,vt,Ue,rt),Qe++}}else if(Qe>zt)for(;Qe<=Tt;)Si(de[Qe],Ze,et,!0),Qe++;else{const Vt=Qe,li=Qe,fi=new Map;for(Qe=li;Qe<=zt;Qe++){const Pn=me[Qe]=rt?el(me[Qe]):bs(me[Qe]);Pn.key!=null&&fi.set(Pn.key,Qe)}let pi,Ii=0;const Un=zt-li+1;let wn=!1,Sr=0;const co=new Array(Un);for(Qe=0;Qe<Un;Qe++)co[Qe]=0;for(Qe=Vt;Qe<=Tt;Qe++){const Pn=de[Qe];if(Ii>=Un){Si(Pn,Ze,et,!0);continue}let jn;if(Pn.key!=null)jn=fi.get(Pn.key);else for(pi=li;pi<=zt;pi++)if(co[pi-li]===0&&bc(Pn,me[pi])){jn=pi;break}jn===void 0?Si(Pn,Ze,et,!0):(co[jn-li]=Qe+1,jn>=Sr?Sr=jn:wn=!0,oe(Pn,me[jn],Le,null,Ze,et,vt,Ue,rt),Ii++)}const Yo=wn?pF(co):yh;for(pi=Yo.length-1,Qe=Un-1;Qe>=0;Qe--){const Pn=li+Qe,jn=me[Pn],Jo=Pn+1<Mt?me[Pn+1].el:He;co[Qe]===0?oe(null,jn,Le,Jo,Ze,et,vt,Ue,rt):wn&&(pi<0||Qe!==Yo[pi]?oi(jn,Le,Jo,2):pi--)}}},oi=(de,me,Le,He,Ze=null)=>{const{el:et,type:vt,transition:Ue,children:rt,shapeFlag:Qe}=de;if(Qe&6){oi(de.component.subTree,me,Le,He);return}if(Qe&128){de.suspense.move(me,Le,He);return}if(Qe&64){vt.move(de,me,Le,di);return}if(vt===Co){h(et,me,Le);for(let Tt=0;Tt<rt.length;Tt++)oi(rt[Tt],me,Le,He);h(de.anchor,me,Le);return}if(vt===mg){$e(de,me,Le);return}if(He!==2&&Qe&1&&Ue)if(He===0)Ue.beforeEnter(et),h(et,me,Le),br(()=>Ue.enter(et),Ze);else{const{leave:Tt,delayLeave:zt,afterLeave:Vt}=Ue,li=()=>h(et,me,Le),fi=()=>{Tt(et,()=>{li(),Vt&&Vt()})};zt?zt(et,li,fi):fi()}else h(et,me,Le)},Si=(de,me,Le,He=!1,Ze=!1)=>{const{type:et,props:vt,ref:Ue,children:rt,dynamicChildren:Qe,shapeFlag:Mt,patchFlag:Tt,dirs:zt}=de;if(Ue!=null&&lx(Ue,null,Le,de,!0),Mt&256){me.ctx.deactivate(de);return}const Vt=Mt&1&&zt,li=!nx(de);let fi;if(li&&(fi=vt&&vt.onVnodeBeforeUnmount)&&xs(fi,me,de),Mt&6)bt(de.component,Le,He);else{if(Mt&128){de.suspense.unmount(Le,He);return}Vt&&vc(de,null,me,"beforeUnmount"),Mt&64?de.type.remove(de,me,Le,Ze,di,He):Qe&&(et!==Co||Tt>0&&Tt&64)?ct(Qe,me,Le,!1,!0):(et===Co&&Tt&(128|256)||!Ze&&Mt&16)&&ct(rt,me,Le),He&&yn(de)}(li&&(fi=vt&&vt.onVnodeUnmounted)||Vt)&&br(()=>{fi&&xs(fi,me,de),Vt&&vc(de,null,me,"unmounted")},Le)},yn=de=>{const{type:me,el:Le,anchor:He,transition:Ze}=de;if(me===Co){Ne(Le,He);return}if(me===mg){Ge(de);return}const et=()=>{_(Le),Ze&&!Ze.persisted&&Ze.afterLeave&&Ze.afterLeave()};if(de.shapeFlag&1&&Ze&&!Ze.persisted){const{leave:vt,delayLeave:Ue}=Ze,rt=()=>vt(Le,et);Ue?Ue(de.el,et,rt):rt()}else et()},Ne=(de,me)=>{let Le;for(;de!==me;)Le=z(de),_(de),de=Le;_(me)},bt=(de,me,Le)=>{const{bum:He,scope:Ze,update:et,subTree:vt,um:Ue}=de;He&&eg(He),Ze.stop(),et&&(et.active=!1,Si(vt,de,me,Le)),Ue&&br(Ue,me),br(()=>{de.isUnmounted=!0},me),me&&me.pendingBranch&&!me.isUnmounted&&de.asyncDep&&!de.asyncResolved&&de.suspenseId===me.pendingId&&(me.deps--,me.deps===0&&me.resolve())},ct=(de,me,Le,He=!1,Ze=!1,et=0)=>{for(let vt=et;vt<de.length;vt++)Si(de[vt],me,Le,He,Ze)},It=de=>de.shapeFlag&6?It(de.component.subTree):de.shapeFlag&128?de.suspense.next():z(de.anchor||de.el),wi=(de,me,Le)=>{de==null?me._vnode&&Si(me._vnode,null,null,!0):oe(me._vnode||null,de,me,null,null,null,Le),x2(),me._vnode=de},di={p:oe,um:Si,m:oi,r:yn,mt:bn,mc:Dt,pc:Wi,pbc:ai,n:It,o:i};let ti,Wt;return t&&([ti,Wt]=t(di)),{render:wi,hydrate:ti,createApp:hF(wi,ti)}}function lx(i,t,s,h,_=!1){if(Qt(i)){i.forEach((z,q)=>lx(z,t&&(Qt(t)?t[q]:t),s,h,_));return}if(nx(h)&&!_)return;const x=h.shapeFlag&4?fx(h.component)||h.component.proxy:h.el,E=_?null:x,{i:a,r:S}=i,O=t&&t.r,M=a.refs===on?a.refs={}:a.refs,P=a.setupState;if(O!=null&&O!==S&&(er(O)?(M[O]=null,Ri(P,O)&&(P[O]=null)):$r(O)&&(O.value=null)),er(S)){const z=()=>{M[S]=E,Ri(P,S)&&(P[S]=E)};E?(z.id=-1,br(z,s)):z()}else if($r(S)){const z=()=>{S.value=E};E?(z.id=-1,br(z,s)):z()}else _i(S)&&tl(S,a,12,[E,M])}function xs(i,t,s,h=null){So(i,t,7,[s,h])}function n2(i,t,s=!1){const h=i.children,_=t.children;if(Qt(h)&&Qt(_))for(let x=0;x<h.length;x++){const E=h[x];let a=_[x];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=_[x]=el(_[x]),a.el=E.el),s||n2(E,a))}}function pF(i){const t=i.slice(),s=[0];let h,_,x,E,a;const S=i.length;for(h=0;h<S;h++){const O=i[h];if(O!==0){if(_=s[s.length-1],i[_]<O){t[h]=_,s.push(h);continue}for(x=0,E=s.length-1;x<E;)a=x+E>>1,i[s[a]]<O?x=a+1:E=a;O<i[s[x]]&&(x>0&&(t[h]=s[x-1]),s[x]=h)}}for(x=s.length,E=s[x-1];x-- >0;)s[x]=E,E=t[E];return s}const mF=i=>i.__isTeleport,r2="components";function R8(i,t){return gF(r2,i,!0,t)||i}const _F=Symbol();function gF(i,t,s=!0,h=!1){const _=oo||Hn;if(_){const x=_.type;if(i===r2){const a=zF(x);if(a&&(a===t||a===gs(t)||a===Q_(gs(t))))return x}const E=o2(_[i]||x[i],t)||o2(_.appContext[i],t);return!E&&h?x:E}}function o2(i,t){return i&&(i[t]||i[gs(t)]||i[Q_(gs(t))])}const Co=Symbol(void 0),cx=Symbol(void 0),qo=Symbol(void 0),mg=Symbol(void 0),ep=[];let xc=null;function ux(i=!1){ep.push(xc=i?null:[])}function yF(){ep.pop(),xc=ep[ep.length-1]||null}let _g=1;function s2(i){_g+=i}function a2(i){return i.dynamicChildren=_g>0?xc||yh:null,yF(),_g>0&&xc&&xc.push(i),i}function vF(i,t,s,h,_,x){return a2(u2(i,t,s,h,_,x,!0))}function l2(i,t,s,h,_){return a2(wr(i,t,s,h,_,!0))}function gg(i){return i?i.__v_isVNode===!0:!1}function bc(i,t){return i.type===t.type&&i.key===t.key}const yg="__vInternal",c2=({key:i})=>i!=null?i:null,vg=({ref:i})=>i!=null?er(i)||$r(i)||_i(i)?{i:oo,r:i}:i:null;function u2(i,t=null,s=null,h=0,_=null,x=i===Co?0:1,E=!1,a=!1){const S={__v_isVNode:!0,__v_skip:!0,type:i,props:t,key:t&&c2(t),ref:t&&vg(t),scopeId:cg,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:x,patchFlag:h,dynamicProps:_,dynamicChildren:null,appContext:null};return a?(hx(S,s),x&128&&i.normalize(S)):s&&(S.shapeFlag|=er(s)?8:16),_g>0&&!E&&xc&&(S.patchFlag>0||x&6)&&S.patchFlag!==32&&xc.push(S),S}const wr=xF;function xF(i,t=null,s=null,h=0,_=null,x=!1){if((!i||i===_F)&&(i=qo),gg(i)){const a=Th(i,t,!0);return s&&hx(a,s),a}if(OF(i)&&(i=i.__vccOpts),t){t=bF(t);let{class:a,style:S}=t;a&&!er(a)&&(t.class=Z_(a)),Sn(S)&&(AS(S)&&!Qt(S)&&(S=Qn({},S)),t.style=z0(S))}const E=er(i)?1:N3(i)?128:mF(i)?64:Sn(i)?4:_i(i)?2:0;return u2(i,t,s,h,_,E,x,!0)}function bF(i){return i?AS(i)||yg in i?Qn({},i):i:null}function Th(i,t,s=!1){const{props:h,ref:_,patchFlag:x,children:E}=i,a=t?TF(h||{},t):h;return{__v_isVNode:!0,__v_skip:!0,type:i.type,props:a,key:a&&c2(a),ref:t&&t.ref?s&&_?Qt(_)?_.concat(vg(t)):[_,vg(t)]:vg(t):_,scopeId:i.scopeId,slotScopeIds:i.slotScopeIds,children:E,target:i.target,targetAnchor:i.targetAnchor,staticCount:i.staticCount,shapeFlag:i.shapeFlag,patchFlag:t&&i.type!==Co?x===-1?16:x|16:x,dynamicProps:i.dynamicProps,dynamicChildren:i.dynamicChildren,appContext:i.appContext,dirs:i.dirs,transition:i.transition,component:i.component,suspense:i.suspense,ssContent:i.ssContent&&Th(i.ssContent),ssFallback:i.ssFallback&&Th(i.ssFallback),el:i.el,anchor:i.anchor}}function wF(i=" ",t=0){return wr(cx,null,i,t)}function B8(i,t){const s=wr(mg,null,i);return s.staticCount=t,s}function EF(i="",t=!1){return t?(ux(),l2(qo,null,i)):wr(qo,null,i)}function bs(i){return i==null||typeof i=="boolean"?wr(qo):Qt(i)?wr(Co,null,i.slice()):typeof i=="object"?el(i):wr(cx,null,String(i))}function el(i){return i.el===null||i.memo?i:Th(i)}function hx(i,t){let s=0;const{shapeFlag:h}=i;if(t==null)t=null;else if(Qt(t))s=16;else if(typeof t=="object")if(h&(1|64)){const _=t.default;_&&(_._c&&(_._d=!1),hx(i,_()),_._c&&(_._d=!0));return}else{s=32;const _=t._;!_&&!(yg in t)?t._ctx=oo:_===3&&oo&&(oo.slots._===1?t._=1:(t._=2,i.patchFlag|=1024))}else _i(t)?(t={default:t,_ctx:oo},s=32):(t=String(t),h&64?(s=16,t=[wF(t)]):s=8);i.children=t,i.shapeFlag|=s}function TF(...i){const t={};for(let s=0;s<i.length;s++){const h=i[s];for(const _ in h)if(_==="class")t.class!==h.class&&(t.class=Z_([t.class,h.class]));else if(_==="style")t.style=z0([t.style,h.style]);else if(H_(_)){const x=t[_],E=h[_];x!==E&&(t[_]=x?[].concat(x,E):E)}else _!==""&&(t[_]=h[_])}return t}function F8(i,t,s,h){let _;const x=s&&s[h];if(Qt(i)||er(i)){_=new Array(i.length);for(let E=0,a=i.length;E<a;E++)_[E]=t(i[E],E,void 0,x&&x[E])}else if(typeof i=="number"){_=new Array(i);for(let E=0;E<i;E++)_[E]=t(E+1,E,void 0,x&&x[E])}else if(Sn(i))if(i[Symbol.iterator])_=Array.from(i,(E,a)=>t(E,a,void 0,x&&x[a]));else{const E=Object.keys(i);_=new Array(E.length);for(let a=0,S=E.length;a<S;a++){const O=E[a];_[a]=t(i[O],O,a,x&&x[a])}}else _=[];return s&&(s[h]=_),_}function N8(i,t,s={},h,_){if(oo.isCE)return wr("slot",t==="default"?null:{name:t},h&&h());let x=i[t];x&&x._c&&(x._d=!1),ux();const E=x&&h2(x(s)),a=l2(Co,{key:s.key||`_${t}`},E||(h?h():[]),E&&i._===1?64:-2);return!_&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),x&&x._c&&(x._d=!0),a}function h2(i){return i.some(t=>gg(t)?!(t.type===qo||t.type===Co&&!h2(t.children)):!0)?i:null}const dx=i=>i?d2(i)?fx(i)||i.proxy:dx(i.parent):null,xg=Qn(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>dx(i.parent),$root:i=>dx(i.root),$emit:i=>i.emit,$options:i=>qS(i),$forceUpdate:i=>()=>g2(i.update),$nextTick:i=>gx.bind(i.proxy),$watch:i=>jF.bind(i)}),CF={get({_:i},t){const{ctx:s,setupState:h,data:_,props:x,accessCache:E,type:a,appContext:S}=i;let O;if(t[0]!=="$"){const q=E[t];if(q!==void 0)switch(q){case 0:return h[t];case 1:return _[t];case 3:return s[t];case 2:return x[t]}else{if(h!==on&&Ri(h,t))return E[t]=0,h[t];if(_!==on&&Ri(_,t))return E[t]=1,_[t];if((O=i.propsOptions[0])&&Ri(O,t))return E[t]=2,x[t];if(s!==on&&Ri(s,t))return E[t]=3,s[t];rx&&(E[t]=4)}}const M=xg[t];let P,z;if(M)return t==="$attrs"&&ro(i,"get",t),M(i);if((P=a.__cssModules)&&(P=P[t]))return P;if(s!==on&&Ri(s,t))return E[t]=3,s[t];if(z=S.config.globalProperties,Ri(z,t))return z[t]},set({_:i},t,s){const{data:h,setupState:_,ctx:x}=i;if(_!==on&&Ri(_,t))_[t]=s;else if(h!==on&&Ri(h,t))h[t]=s;else if(Ri(i.props,t))return!1;return t[0]==="$"&&t.slice(1)in i?!1:(x[t]=s,!0)},has({_:{data:i,setupState:t,accessCache:s,ctx:h,appContext:_,propsOptions:x}},E){let a;return s[E]!==void 0||i!==on&&Ri(i,E)||t!==on&&Ri(t,E)||(a=x[0])&&Ri(a,E)||Ri(h,E)||Ri(xg,E)||Ri(_.config.globalProperties,E)}},SF=i2();let AF=0;function IF(i,t,s){const h=i.type,_=(t?t.appContext:i.appContext)||SF,x={uid:AF++,vnode:i,type:h,parent:t,appContext:_,root:null,next:null,subTree:null,update:null,scope:new QB(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(_.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:HS(h,_),emitsOptions:LS(h,_),emit:null,emitted:null,propsDefaults:on,inheritAttrs:h.inheritAttrs,ctx:on,data:on,props:on,attrs:on,slots:on,refs:on,setupState:on,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return x.ctx={_:x},x.root=t?t.root:x,x.emit=L3.bind(null,x),i.ce&&i.ce(x),x}let Hn=null;const MF=()=>Hn||oo,Ch=i=>{Hn=i,i.scope.on()},wc=()=>{Hn&&Hn.scope.off(),Hn=null};function d2(i){return i.vnode.shapeFlag&4}let bg=!1;function kF(i,t=!1){bg=t;const{props:s,children:h}=i.vnode,_=d2(i);rF(i,s,_,t),aF(i,h);const x=_?PF(i,t):void 0;return bg=!1,x}function PF(i,t){const s=i.type;i.accessCache=Object.create(null),i.proxy=IS(new Proxy(i.ctx,CF));const{setup:h}=s;if(h){const _=i.setupContext=h.length>1?LF(i):null;Ch(i),wh();const x=tl(h,i,0,[i.props,_]);if(gc(),wc(),oS(x)){if(x.then(wc,wc),t)return x.then(E=>{f2(i,E,t)}).catch(E=>{wg(E,i,0)});i.asyncDep=x}else f2(i,x,t)}else m2(i,t)}function f2(i,t,s){_i(t)?i.type.__ssrInlineRender?i.ssrRender=t:i.render=t:Sn(t)&&(i.setupState=DS(t)),m2(i,s)}let p2;function m2(i,t,s){const h=i.type;if(!i.render){if(!t&&p2&&!h.render){const _=h.template;if(_){const{isCustomElement:x,compilerOptions:E}=i.appContext.config,{delimiters:a,compilerOptions:S}=h,O=Qn(Qn({isCustomElement:x,delimiters:a},E),S);h.render=p2(_,O)}}i.render=h.render||Go}Ch(i),wh(),Q3(i),gc(),wc()}function DF(i){return new Proxy(i.attrs,{get(t,s){return ro(i,"get","$attrs"),t[s]}})}function LF(i){const t=h=>{i.exposed=h||{}};let s;return{get attrs(){return s||(s=DF(i))},slots:i.slots,emit:i.emit,expose:t}}function fx(i){if(i.exposed)return i.exposeProxy||(i.exposeProxy=new Proxy(DS(IS(i.exposed)),{get(t,s){if(s in t)return t[s];if(s in xg)return xg[s](i)}}))}function zF(i){return _i(i)&&i.displayName||i.name}function OF(i){return _i(i)&&"__vccOpts"in i}function tl(i,t,s,h){let _;try{_=h?i(...h):i()}catch(x){wg(x,t,s)}return _}function So(i,t,s,h){if(_i(i)){const x=tl(i,t,s,h);return x&&oS(x)&&x.catch(E=>{wg(E,t,s)}),x}const _=[];for(let x=0;x<i.length;x++)_.push(So(i[x],t,s,h));return _}function wg(i,t,s,h=!0){const _=t?t.vnode:null;if(t){let x=t.parent;const E=t.proxy,a=s;for(;x;){const O=x.ec;if(O){for(let M=0;M<O.length;M++)if(O[M](i,E,a)===!1)return}x=x.parent}const S=t.appContext.config.errorHandler;if(S){tl(S,null,10,[i,E,a]);return}}RF(i,s,_,h)}function RF(i,t,s,h=!0){console.error(i)}let Eg=!1,px=!1;const so=[];let na=0;const tp=[];let ip=null,Sh=0;const np=[];let il=null,Ah=0;const _2=Promise.resolve();let mx=null,_x=null;function gx(i){const t=mx||_2;return i?t.then(this?i.bind(this):i):t}function BF(i){let t=na+1,s=so.length;for(;t<s;){const h=t+s>>>1;rp(so[h])<i?t=h+1:s=h}return t}function g2(i){(!so.length||!so.includes(i,Eg&&i.allowRecurse?na+1:na))&&i!==_x&&(i.id==null?so.push(i):so.splice(BF(i.id),0,i),y2())}function y2(){!Eg&&!px&&(px=!0,mx=_2.then(b2))}function FF(i){const t=so.indexOf(i);t>na&&so.splice(t,1)}function v2(i,t,s,h){Qt(i)?s.push(...i):(!t||!t.includes(i,i.allowRecurse?h+1:h))&&s.push(i),y2()}function NF(i){v2(i,ip,tp,Sh)}function UF(i){v2(i,il,np,Ah)}function yx(i,t=null){if(tp.length){for(_x=t,ip=[...new Set(tp)],tp.length=0,Sh=0;Sh<ip.length;Sh++)ip[Sh]();ip=null,Sh=0,_x=null,yx(i,t)}}function x2(i){if(np.length){const t=[...new Set(np)];if(np.length=0,il){il.push(...t);return}for(il=t,il.sort((s,h)=>rp(s)-rp(h)),Ah=0;Ah<il.length;Ah++)il[Ah]();il=null,Ah=0}}const rp=i=>i.id==null?1/0:i.id;function b2(i){px=!1,Eg=!0,yx(i),so.sort((s,h)=>rp(s)-rp(h));const t=Go;try{for(na=0;na<so.length;na++){const s=so[na];s&&s.active!==!1&&tl(s,null,14)}}finally{na=0,so.length=0,x2(),Eg=!1,mx=null,(so.length||tp.length||np.length)&&b2(i)}}function U8(i,t){return vx(i,null,t)}const w2={};function Tg(i,t,s){return vx(i,t,s)}function vx(i,t,{immediate:s,deep:h,flush:_,onTrack:x,onTrigger:E}=on){const a=Hn;let S,O=!1,M=!1;if($r(i)?(S=()=>i.value,O=!!i._shallow):Eh(i)?(S=()=>i,h=!0):Qt(i)?(M=!0,O=i.some(Eh),S=()=>i.map(fe=>{if($r(fe))return fe.value;if(Eh(fe))return Ec(fe);if(_i(fe))return tl(fe,a,2)})):_i(i)?t?S=()=>tl(i,a,2):S=()=>{if(!(a&&a.isUnmounted))return P&&P(),So(i,a,3,[z])}:S=Go,t&&h){const fe=S;S=()=>Ec(fe())}let P,z=fe=>{P=oe.onStop=()=>{tl(fe,a,4)}};if(bg)return z=Go,t?s&&So(t,a,3,[S(),M?[]:void 0,z]):S(),Go;let q=M?[]:w2;const se=()=>{if(!!oe.active)if(t){const fe=oe.run();(h||O||(M?fe.some((xe,Be)=>Wf(xe,q[Be])):Wf(fe,q)))&&(P&&P(),So(t,a,3,[fe,q===w2?void 0:q,z]),q=fe)}else oe.run()};se.allowRecurse=!!t;let ue;_==="sync"?ue=se:_==="post"?ue=()=>br(se,a&&a.suspense):ue=()=>{!a||a.isMounted?NF(se):se()};const oe=new $0(S,ue);return t?s?se():q=oe.run():_==="post"?br(oe.run.bind(oe),a&&a.suspense):oe.run(),()=>{oe.stop(),a&&a.scope&&nS(a.scope.effects,oe)}}function jF(i,t,s){const h=this.proxy,_=er(i)?i.includes(".")?E2(h,i):()=>h[i]:i.bind(h,h);let x;_i(t)?x=t:(x=t.handler,s=t);const E=Hn;Ch(this);const a=vx(_,x.bind(h),s);return E?Ch(E):wc(),a}function E2(i,t){const s=t.split(".");return()=>{let h=i;for(let _=0;_<s.length&&h;_++)h=h[s[_]];return h}}function Ec(i,t){if(!Sn(i)||i.__v_skip||(t=t||new Set,t.has(i)))return i;if(t.add(i),$r(i))Ec(i.value,t);else if(Qt(i))for(let s=0;s<i.length;s++)Ec(i[s],t);else if(X_(i)||vh(i))i.forEach(s=>{Ec(s,t)});else if(aS(i))for(const s in i)Ec(i[s],t);return i}function ra(i,t,s){const h=arguments.length;return h===2?Sn(t)&&!Qt(t)?gg(t)?wr(i,null,[t]):wr(i,t):wr(i,null,t):(h>3?s=Array.prototype.slice.call(arguments,2):h===3&&gg(s)&&(s=[s]),wr(i,t,s))}const VF="3.2.20",$F="http://www.w3.org/2000/svg",Ih=typeof document!="undefined"?document:null,T2=new Map,GF={insert:(i,t,s)=>{t.insertBefore(i,s||null)},remove:i=>{const t=i.parentNode;t&&t.removeChild(i)},createElement:(i,t,s,h)=>{const _=t?Ih.createElementNS($F,i):Ih.createElement(i,s?{is:s}:void 0);return i==="select"&&h&&h.multiple!=null&&_.setAttribute("multiple",h.multiple),_},createText:i=>Ih.createTextNode(i),createComment:i=>Ih.createComment(i),setText:(i,t)=>{i.nodeValue=t},setElementText:(i,t)=>{i.textContent=t},parentNode:i=>i.parentNode,nextSibling:i=>i.nextSibling,querySelector:i=>Ih.querySelector(i),setScopeId(i,t){i.setAttribute(t,"")},cloneNode(i){const t=i.cloneNode(!0);return"_value"in i&&(t._value=i._value),t},insertStaticContent(i,t,s,h){const _=s?s.previousSibling:t.lastChild;let x=T2.get(i);if(!x){const E=Ih.createElement("template");if(E.innerHTML=h?`<svg>${i}</svg>`:i,x=E.content,h){const a=x.firstChild;for(;a.firstChild;)x.appendChild(a.firstChild);x.removeChild(a)}T2.set(i,x)}return t.insertBefore(x.cloneNode(!0),s),[_?_.nextSibling:t.firstChild,s?s.previousSibling:t.lastChild]}};function qF(i,t,s){const h=i._vtc;h&&(t=(t?[t,...h]:[...h]).join(" ")),t==null?i.removeAttribute("class"):s?i.setAttribute("class",t):i.className=t}function ZF(i,t,s){const h=i.style,_=h.display;if(!s)i.removeAttribute("style");else if(er(s))t!==s&&(h.cssText=s);else{for(const x in s)xx(h,x,s[x]);if(t&&!er(t))for(const x in t)s[x]==null&&xx(h,x,"")}"_vod"in i&&(h.display=_)}const C2=/\s*!important$/;function xx(i,t,s){if(Qt(s))s.forEach(h=>xx(i,t,h));else if(t.startsWith("--"))i.setProperty(t,s);else{const h=WF(i,t);C2.test(s)?i.setProperty(xh(h),s.replace(C2,""),"important"):i[h]=s}}const S2=["Webkit","Moz","ms"],bx={};function WF(i,t){const s=bx[t];if(s)return s;let h=gs(t);if(h!=="filter"&&h in i)return bx[t]=h;h=Q_(h);for(let _=0;_<S2.length;_++){const x=S2[_]+h;if(x in i)return bx[t]=x}return t}const A2="http://www.w3.org/1999/xlink";function HF(i,t,s,h,_){if(h&&t.startsWith("xlink:"))s==null?i.removeAttributeNS(A2,t.slice(6,t.length)):i.setAttributeNS(A2,t,s);else{const x=UB(t);s==null||x&&!tS(s)?i.removeAttribute(t):i.setAttribute(t,x?"":s)}}function XF(i,t,s,h,_,x,E){if(t==="innerHTML"||t==="textContent"){h&&E(h,_,x),i[t]=s==null?"":s;return}if(t==="value"&&i.tagName!=="PROGRESS"){i._value=s;const a=s==null?"":s;i.value!==a&&(i.value=a),s==null&&i.removeAttribute(t);return}if(s===""||s==null){const a=typeof i[t];if(a==="boolean"){i[t]=tS(s);return}else if(s==null&&a==="string"){i[t]="",i.removeAttribute(t);return}else if(a==="number"){try{i[t]=0}catch{}i.removeAttribute(t);return}}try{i[t]=s}catch{}}let Cg=Date.now,I2=!1;if(typeof window!="undefined"){Cg()>document.createEvent("Event").timeStamp&&(Cg=()=>performance.now());const i=navigator.userAgent.match(/firefox\/(\d+)/i);I2=!!(i&&Number(i[1])<=53)}let wx=0;const KF=Promise.resolve(),YF=()=>{wx=0},JF=()=>wx||(KF.then(YF),wx=Cg());function Tc(i,t,s,h){i.addEventListener(t,s,h)}function QF(i,t,s,h){i.removeEventListener(t,s,h)}function eN(i,t,s,h,_=null){const x=i._vei||(i._vei={}),E=x[t];if(h&&E)E.value=h;else{const[a,S]=tN(t);if(h){const O=x[t]=iN(h,_);Tc(i,a,O,S)}else E&&(QF(i,a,E,S),x[t]=void 0)}}const M2=/(?:Once|Passive|Capture)$/;function tN(i){let t;if(M2.test(i)){t={};let s;for(;s=i.match(M2);)i=i.slice(0,i.length-s[0].length),t[s[0].toLowerCase()]=!0}return[xh(i.slice(2)),t]}function iN(i,t){const s=h=>{const _=h.timeStamp||Cg();(I2||_>=s.attached-1)&&So(nN(h,s.value),t,5,[h])};return s.value=i,s.attached=JF(),s}function nN(i,t){if(Qt(t)){const s=i.stopImmediatePropagation;return i.stopImmediatePropagation=()=>{s.call(i),i._stopped=!0},t.map(h=>_=>!_._stopped&&h(_))}else return t}const k2=/^on[a-z]/,rN=(i,t,s,h,_=!1,x,E,a,S)=>{t==="class"?qF(i,h,_):t==="style"?ZF(i,s,h):H_(t)?O0(t)||eN(i,t,s,h,E):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):oN(i,t,h,_))?XF(i,t,h,x,E,a,S):(t==="true-value"?i._trueValue=h:t==="false-value"&&(i._falseValue=h),HF(i,t,h,_))};function oN(i,t,s,h){return h?!!(t==="innerHTML"||t==="textContent"||t in i&&k2.test(t)&&_i(s)):t==="spellcheck"||t==="draggable"||t==="form"||t==="list"&&i.tagName==="INPUT"||t==="type"&&i.tagName==="TEXTAREA"||k2.test(t)&&er(s)?!1:t in i}const nl="transition",op="animation",P2=(i,{slots:t})=>ra(OS,sN(i),t);P2.displayName="Transition";const D2={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};P2.props=Qn({},OS.props,D2);const Cc=(i,t=[])=>{Qt(i)?i.forEach(s=>s(...t)):i&&i(...t)},L2=i=>i?Qt(i)?i.some(t=>t.length>1):i.length>1:!1;function sN(i){const t={};for(const wt in i)wt in D2||(t[wt]=i[wt]);if(i.css===!1)return t;const{name:s="v",type:h,duration:_,enterFromClass:x=`${s}-enter-from`,enterActiveClass:E=`${s}-enter-active`,enterToClass:a=`${s}-enter-to`,appearFromClass:S=x,appearActiveClass:O=E,appearToClass:M=a,leaveFromClass:P=`${s}-leave-from`,leaveActiveClass:z=`${s}-leave-active`,leaveToClass:q=`${s}-leave-to`}=i,se=aN(_),ue=se&&se[0],oe=se&&se[1],{onBeforeEnter:fe,onEnter:xe,onEnterCancelled:Be,onLeave:$e,onLeaveCancelled:Ge,onBeforeAppear:xt=fe,onAppear:pt=xe,onAppearCancelled:jt=Be}=t,Dt=(wt,Nt,qi)=>{Mh(wt,Nt?M:a),Mh(wt,Nt?O:E),qi&&qi()},Ft=(wt,Nt)=>{Mh(wt,q),Mh(wt,z),Nt&&Nt()},ai=wt=>(Nt,qi)=>{const bn=wt?pt:xe,hi=()=>Dt(Nt,wt,qi);Cc(bn,[Nt,hi]),z2(()=>{Mh(Nt,wt?S:x),rl(Nt,wt?M:a),L2(bn)||O2(Nt,h,ue,hi)})};return Qn(t,{onBeforeEnter(wt){Cc(fe,[wt]),rl(wt,x),rl(wt,E)},onBeforeAppear(wt){Cc(xt,[wt]),rl(wt,S),rl(wt,O)},onEnter:ai(!1),onAppear:ai(!0),onLeave(wt,Nt){const qi=()=>Ft(wt,Nt);rl(wt,P),uN(),rl(wt,z),z2(()=>{Mh(wt,P),rl(wt,q),L2($e)||O2(wt,h,oe,qi)}),Cc($e,[wt,qi])},onEnterCancelled(wt){Dt(wt,!1),Cc(Be,[wt])},onAppearCancelled(wt){Dt(wt,!0),Cc(jt,[wt])},onLeaveCancelled(wt){Ft(wt),Cc(Ge,[wt])}})}function aN(i){if(i==null)return null;if(Sn(i))return[Ex(i.enter),Ex(i.leave)];{const t=Ex(i);return[t,t]}}function Ex(i){return Hf(i)}function rl(i,t){t.split(/\s+/).forEach(s=>s&&i.classList.add(s)),(i._vtc||(i._vtc=new Set)).add(t)}function Mh(i,t){t.split(/\s+/).forEach(h=>h&&i.classList.remove(h));const{_vtc:s}=i;s&&(s.delete(t),s.size||(i._vtc=void 0))}function z2(i){requestAnimationFrame(()=>{requestAnimationFrame(i)})}let lN=0;function O2(i,t,s,h){const _=i._endId=++lN,x=()=>{_===i._endId&&h()};if(s)return setTimeout(x,s);const{type:E,timeout:a,propCount:S}=cN(i,t);if(!E)return h();const O=E+"end";let M=0;const P=()=>{i.removeEventListener(O,z),x()},z=q=>{q.target===i&&++M>=S&&P()};setTimeout(()=>{M<S&&P()},a+1),i.addEventListener(O,z)}function cN(i,t){const s=window.getComputedStyle(i),h=se=>(s[se]||"").split(", "),_=h(nl+"Delay"),x=h(nl+"Duration"),E=R2(_,x),a=h(op+"Delay"),S=h(op+"Duration"),O=R2(a,S);let M=null,P=0,z=0;t===nl?E>0&&(M=nl,P=E,z=x.length):t===op?O>0&&(M=op,P=O,z=S.length):(P=Math.max(E,O),M=P>0?E>O?nl:op:null,z=M?M===nl?x.length:S.length:0);const q=M===nl&&/\b(transform|all)(,|$)/.test(s[nl+"Property"]);return{type:M,timeout:P,propCount:z,hasTransform:q}}function R2(i,t){for(;i.length<t.length;)i=i.concat(i);return Math.max(...t.map((s,h)=>B2(s)+B2(i[h])))}function B2(i){return Number(i.slice(0,-1).replace(",","."))*1e3}function uN(){return document.body.offsetHeight}const Sg=i=>{const t=i.props["onUpdate:modelValue"];return Qt(t)?s=>eg(t,s):t};function hN(i){i.target.composing=!0}function F2(i){const t=i.target;t.composing&&(t.composing=!1,dN(t,"input"))}function dN(i,t){const s=document.createEvent("HTMLEvents");s.initEvent(t,!0,!0),i.dispatchEvent(s)}const fN={created(i,{modifiers:{lazy:t,trim:s,number:h}},_){i._assign=Sg(_);const x=h||_.props&&_.props.type==="number";Tc(i,t?"change":"input",E=>{if(E.target.composing)return;let a=i.value;s?a=a.trim():x&&(a=Hf(a)),i._assign(a)}),s&&Tc(i,"change",()=>{i.value=i.value.trim()}),t||(Tc(i,"compositionstart",hN),Tc(i,"compositionend",F2),Tc(i,"change",F2))},mounted(i,{value:t}){i.value=t==null?"":t},beforeUpdate(i,{value:t,modifiers:{lazy:s,trim:h,number:_}},x){if(i._assign=Sg(x),i.composing||document.activeElement===i&&(s||h&&i.value.trim()===t||(_||i.type==="number")&&Hf(i.value)===t))return;const E=t==null?"":t;i.value!==E&&(i.value=E)}},j8={deep:!0,created(i,{value:t,modifiers:{number:s}},h){const _=X_(t);Tc(i,"change",()=>{const x=Array.prototype.filter.call(i.options,E=>E.selected).map(E=>s?Hf(Ag(E)):Ag(E));i._assign(i.multiple?_?new Set(x):x:x[0])}),i._assign=Sg(h)},mounted(i,{value:t}){N2(i,t)},beforeUpdate(i,t,s){i._assign=Sg(s)},updated(i,{value:t}){N2(i,t)}};function N2(i,t){const s=i.multiple;if(!(s&&!Qt(t)&&!X_(t))){for(let h=0,_=i.options.length;h<_;h++){const x=i.options[h],E=Ag(x);if(s)Qt(t)?x.selected=qB(t,E)>-1:x.selected=t.has(E);else if(W_(Ag(x),t)){i.selectedIndex!==h&&(i.selectedIndex=h);return}}!s&&i.selectedIndex!==-1&&(i.selectedIndex=-1)}}function Ag(i){return"_value"in i?i._value:i.value}const pN=["ctrl","shift","alt","meta"],mN={stop:i=>i.stopPropagation(),prevent:i=>i.preventDefault(),self:i=>i.target!==i.currentTarget,ctrl:i=>!i.ctrlKey,shift:i=>!i.shiftKey,alt:i=>!i.altKey,meta:i=>!i.metaKey,left:i=>"button"in i&&i.button!==0,middle:i=>"button"in i&&i.button!==1,right:i=>"button"in i&&i.button!==2,exact:(i,t)=>pN.some(s=>i[`${s}Key`]&&!t.includes(s))},V8=(i,t)=>(s,...h)=>{for(let _=0;_<t.length;_++){const x=mN[t[_]];if(x&&x(s,t))return}return i(s,...h)},_N=Qn({patchProp:rN},GF);let U2;function gN(){return U2||(U2=dF(_N))}const $8=(...i)=>{const t=gN().createApp(...i),{mount:s}=t;return t.mount=h=>{const _=yN(h);if(!_)return;const x=t._component;!_i(x)&&!x.render&&!x.template&&(x.template=_.innerHTML),_.innerHTML="";const E=s(_,!1,_ instanceof SVGElement);return _ instanceof Element&&(_.removeAttribute("v-cloak"),_.setAttribute("data-v-app","")),E},t};function yN(i){return er(i)?document.querySelector(i):i}var vN=(i,t)=>{for(const[s,h]of t)i[s]=h;return i};const kh=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),j2="SweetAlert2:",xN=i=>{const t=[];for(let s=0;s<i.length;s++)t.indexOf(i[s])===-1&&t.push(i[s]);return t},V2=i=>i.charAt(0).toUpperCase()+i.slice(1),Ao=i=>Array.prototype.slice.call(i),Gr=i=>{console.warn(`${j2} ${typeof i=="object"?i.join(" "):i}`)},Ph=i=>{console.error(`${j2} ${i}`)},$2=[],bN=i=>{$2.includes(i)||($2.push(i),Gr(i))},wN=(i,t)=>{bN(`"${i}" is deprecated and will be removed in the next major release. Please use "${t}" instead.`)},Tx=i=>typeof i=="function"?i():i,Cx=i=>i&&typeof i.toPromise=="function",sp=i=>Cx(i)?i.toPromise():Promise.resolve(i),Sx=i=>i&&Promise.resolve(i)===i,EN=i=>typeof i=="object"&&i.jquery,G2=i=>i instanceof Element||EN(i),TN=i=>{const t={};return typeof i[0]=="object"&&!G2(i[0])?Object.assign(t,i[0]):["title","html","icon"].forEach((s,h)=>{const _=i[h];typeof _=="string"||G2(_)?t[s]=_:_!==void 0&&Ph(`Unexpected type of ${s}! Expected "string" or "Element", got ${typeof _}`)}),t},CN="swal2-",q2=i=>{const t={};for(const s in i)t[i[s]]=CN+i[s];return t},Ve=q2(["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"]),ap=q2(["success","warning","info","question","error"]),dr=()=>document.body.querySelector(`.${Ve.container}`),lp=i=>{const t=dr();return t?t.querySelector(i):null},Io=i=>lp(`.${i}`),Ji=()=>Io(Ve.popup),cp=()=>Io(Ve.icon),Z2=()=>Io(Ve.title),Ig=()=>Io(Ve["html-container"]),W2=()=>Io(Ve.image),H2=()=>Io(Ve["progress-steps"]),Mg=()=>Io(Ve["validation-message"]),Zo=()=>lp(`.${Ve.actions} .${Ve.confirm}`),ol=()=>lp(`.${Ve.actions} .${Ve.deny}`),SN=()=>Io(Ve["input-label"]),Dh=()=>lp(`.${Ve.loader}`),Sc=()=>lp(`.${Ve.actions} .${Ve.cancel}`),kg=()=>Io(Ve.actions),X2=()=>Io(Ve.footer),Pg=()=>Io(Ve["timer-progress-bar"]),Ax=()=>Io(Ve.close),AN=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,Ix=()=>{const i=Ao(Ji().querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])')).sort((s,h)=>(s=parseInt(s.getAttribute("tabindex")),h=parseInt(h.getAttribute("tabindex")),s>h?1:s<h?-1:0)),t=Ao(Ji().querySelectorAll(AN)).filter(s=>s.getAttribute("tabindex")!=="-1");return xN(i.concat(t)).filter(s=>Mo(s))},Mx=()=>!up()&&!document.body.classList.contains(Ve["no-backdrop"]),up=()=>document.body.classList.contains(Ve["toast-shown"]),IN=()=>Ji().hasAttribute("data-loading"),Lh={previousBodyPadding:null},fr=(i,t)=>{if(i.textContent="",t){const h=new DOMParser().parseFromString(t,"text/html");Ao(h.querySelector("head").childNodes).forEach(_=>{i.appendChild(_)}),Ao(h.querySelector("body").childNodes).forEach(_=>{i.appendChild(_)})}},hp=(i,t)=>{if(!t)return!1;const s=t.split(/\s+/);for(let h=0;h<s.length;h++)if(!i.classList.contains(s[h]))return!1;return!0},MN=(i,t)=>{Ao(i.classList).forEach(s=>{!Object.values(Ve).includes(s)&&!Object.values(ap).includes(s)&&!Object.values(t.showClass).includes(s)&&i.classList.remove(s)})},Wo=(i,t,s)=>{if(MN(i,t),t.customClass&&t.customClass[s]){if(typeof t.customClass[s]!="string"&&!t.customClass[s].forEach)return Gr(`Invalid type of customClass.${s}! Expected string or iterable object, got "${typeof t.customClass[s]}"`);Pi(i,t.customClass[s])}},kx=(i,t)=>{if(!t)return null;switch(t){case"select":case"textarea":case"file":return Es(i,Ve[t]);case"checkbox":return i.querySelector(`.${Ve.checkbox} input`);case"radio":return i.querySelector(`.${Ve.radio} input:checked`)||i.querySelector(`.${Ve.radio} input:first-child`);case"range":return i.querySelector(`.${Ve.range} input`);default:return Es(i,Ve.input)}},K2=i=>{if(i.focus(),i.type!=="file"){const t=i.value;i.value="",i.value=t}},Y2=(i,t,s)=>{!i||!t||(typeof t=="string"&&(t=t.split(/\s+/).filter(Boolean)),t.forEach(h=>{i.forEach?i.forEach(_=>{s?_.classList.add(h):_.classList.remove(h)}):s?i.classList.add(h):i.classList.remove(h)}))},Pi=(i,t)=>{Y2(i,t,!0)},ws=(i,t)=>{Y2(i,t,!1)},Es=(i,t)=>{for(let s=0;s<i.childNodes.length;s++)if(hp(i.childNodes[s],t))return i.childNodes[s]},dp=(i,t,s)=>{s===`${parseInt(s)}`&&(s=parseInt(s)),s||parseInt(s)===0?i.style[t]=typeof s=="number"?`${s}px`:s:i.style.removeProperty(t)},tr=(i,t="flex")=>{i.style.display=t},pr=i=>{i.style.display="none"},J2=(i,t,s,h)=>{const _=i.querySelector(t);_&&(_.style[s]=h)},Dg=(i,t,s)=>{t?tr(i,s):pr(i)},Mo=i=>!!(i&&(i.offsetWidth||i.offsetHeight||i.getClientRects().length)),kN=()=>!Mo(Zo())&&!Mo(ol())&&!Mo(Sc()),Q2=i=>i.scrollHeight>i.clientHeight,eA=i=>{const t=window.getComputedStyle(i),s=parseFloat(t.getPropertyValue("animation-duration")||"0"),h=parseFloat(t.getPropertyValue("transition-duration")||"0");return s>0||h>0},Px=(i,t=!1)=>{const s=Pg();Mo(s)&&(t&&(s.style.transition="none",s.style.width="100%"),setTimeout(()=>{s.style.transition=`width ${i/1e3}s linear`,s.style.width="0%"},10))},PN=()=>{const i=Pg(),t=parseInt(window.getComputedStyle(i).width);i.style.removeProperty("transition"),i.style.width="100%";const s=parseInt(window.getComputedStyle(i).width),h=parseInt(t/s*100);i.style.removeProperty("transition"),i.style.width=`${h}%`},tA=()=>typeof window=="undefined"||typeof document=="undefined",DN=`
 <div aria-labelledby="${Ve.title}" aria-describedby="${Ve["html-container"]}" class="${Ve.popup}" tabindex="-1">
   <button type="button" class="${Ve.close}"></button>
   <ul class="${Ve["progress-steps"]}"></ul>
   <div class="${Ve.icon}"></div>
   <img class="${Ve.image}" />
   <h2 class="${Ve.title}" id="${Ve.title}"></h2>
   <div class="${Ve["html-container"]}" id="${Ve["html-container"]}"></div>
   <input class="${Ve.input}" />
   <input type="file" class="${Ve.file}" />
   <div class="${Ve.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${Ve.select}"></select>
   <div class="${Ve.radio}"></div>
   <label for="${Ve.checkbox}" class="${Ve.checkbox}">
     <input type="checkbox" />
     <span class="${Ve.label}"></span>
   </label>
   <textarea class="${Ve.textarea}"></textarea>
   <div class="${Ve["validation-message"]}" id="${Ve["validation-message"]}"></div>
   <div class="${Ve.actions}">
     <div class="${Ve.loader}"></div>
     <button type="button" class="${Ve.confirm}"></button>
     <button type="button" class="${Ve.deny}"></button>
     <button type="button" class="${Ve.cancel}"></button>
   </div>
   <div class="${Ve.footer}"></div>
   <div class="${Ve["timer-progress-bar-container"]}">
     <div class="${Ve["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),LN=()=>{const i=dr();return i?(i.remove(),ws([document.documentElement,document.body],[Ve["no-backdrop"],Ve["toast-shown"],Ve["has-column"]]),!0):!1},Ac=()=>{Bh.isVisible()&&Bh.resetValidationMessage()},zN=()=>{const i=Ji(),t=Es(i,Ve.input),s=Es(i,Ve.file),h=i.querySelector(`.${Ve.range} input`),_=i.querySelector(`.${Ve.range} output`),x=Es(i,Ve.select),E=i.querySelector(`.${Ve.checkbox} input`),a=Es(i,Ve.textarea);t.oninput=Ac,s.onchange=Ac,x.onchange=Ac,E.onchange=Ac,a.oninput=Ac,h.oninput=()=>{Ac(),_.value=h.value},h.onchange=()=>{Ac(),h.nextSibling.value=h.value}},ON=i=>typeof i=="string"?document.querySelector(i):i,RN=i=>{const t=Ji();t.setAttribute("role",i.toast?"alert":"dialog"),t.setAttribute("aria-live",i.toast?"polite":"assertive"),i.toast||t.setAttribute("aria-modal","true")},BN=i=>{window.getComputedStyle(i).direction==="rtl"&&Pi(dr(),Ve.rtl)},FN=i=>{const t=LN();if(tA()){Ph("SweetAlert2 requires document to initialize");return}const s=document.createElement("div");s.className=Ve.container,t&&Pi(s,Ve["no-transition"]),fr(s,DN);const h=ON(i.target);h.appendChild(s),RN(i),BN(h),zN()},Dx=(i,t)=>{i instanceof HTMLElement?t.appendChild(i):typeof i=="object"?NN(i,t):i&&fr(t,i)},NN=(i,t)=>{i.jquery?UN(t,i):fr(t,i.toString())},UN=(i,t)=>{if(i.textContent="",0 in t)for(let s=0;s in t;s++)i.appendChild(t[s].cloneNode(!0));else i.appendChild(t.cloneNode(!0))},fp=(()=>{if(tA())return!1;const i=document.createElement("div"),t={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd oanimationend",animation:"animationend"};for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&typeof i.style[s]!="undefined")return t[s];return!1})(),jN=()=>{const i=document.createElement("div");i.className=Ve["scrollbar-measure"],document.body.appendChild(i);const t=i.getBoundingClientRect().width-i.clientWidth;return document.body.removeChild(i),t},VN=(i,t)=>{const s=kg(),h=Dh(),_=Zo(),x=ol(),E=Sc();!t.showConfirmButton&&!t.showDenyButton&&!t.showCancelButton?pr(s):tr(s),Wo(s,t,"actions"),Lx(_,"confirm",t),Lx(x,"deny",t),Lx(E,"cancel",t),$N(_,x,E,t),t.reverseButtons&&(s.insertBefore(E,h),s.insertBefore(x,h),s.insertBefore(_,h)),fr(h,t.loaderHtml),Wo(h,t,"loader")};function $N(i,t,s,h){if(!h.buttonsStyling)return ws([i,t,s],Ve.styled);Pi([i,t,s],Ve.styled),h.confirmButtonColor&&(i.style.backgroundColor=h.confirmButtonColor,Pi(i,Ve["default-outline"])),h.denyButtonColor&&(t.style.backgroundColor=h.denyButtonColor,Pi(t,Ve["default-outline"])),h.cancelButtonColor&&(s.style.backgroundColor=h.cancelButtonColor,Pi(s,Ve["default-outline"]))}function Lx(i,t,s){Dg(i,s[`show${V2(t)}Button`],"inline-block"),fr(i,s[`${t}ButtonText`]),i.setAttribute("aria-label",s[`${t}ButtonAriaLabel`]),i.className=Ve[t],Wo(i,s,`${t}Button`),Pi(i,s[`${t}ButtonClass`])}function GN(i,t){typeof t=="string"?i.style.background=t:t||Pi([document.documentElement,document.body],Ve["no-backdrop"])}function qN(i,t){t in Ve?Pi(i,Ve[t]):(Gr('The "position" parameter is not valid, defaulting to "center"'),Pi(i,Ve.center))}function ZN(i,t){if(t&&typeof t=="string"){const s=`grow-${t}`;s in Ve&&Pi(i,Ve[s])}}const WN=(i,t)=>{const s=dr();!s||(GN(s,t.backdrop),qN(s,t.position),ZN(s,t.grow),Wo(s,t,"container"))};var bi={awaitingPromise:new WeakMap,promise:new WeakMap,innerParams:new WeakMap,domCache:new WeakMap};const HN=["input","file","range","select","radio","checkbox","textarea"],XN=(i,t)=>{const s=Ji(),h=bi.innerParams.get(i),_=!h||t.input!==h.input;HN.forEach(x=>{const E=Ve[x],a=Es(s,E);JN(x,t.inputAttributes),a.className=E,_&&pr(a)}),t.input&&(_&&KN(t),QN(t))},KN=i=>{if(!qr[i.input])return Ph(`Unexpected type of input! Expected "text", "email", "password", "number", "tel", "select", "radio", "checkbox", "textarea", "file" or "url", got "${i.input}"`);const t=iA(i.input),s=qr[i.input](t,i);tr(s),setTimeout(()=>{K2(s)})},YN=i=>{for(let t=0;t<i.attributes.length;t++){const s=i.attributes[t].name;["type","value","style"].includes(s)||i.removeAttribute(s)}},JN=(i,t)=>{const s=kx(Ji(),i);if(!!s){YN(s);for(const h in t)s.setAttribute(h,t[h])}},QN=i=>{const t=iA(i.input);i.customClass&&Pi(t,i.customClass.input)},zx=(i,t)=>{(!i.placeholder||t.inputPlaceholder)&&(i.placeholder=t.inputPlaceholder)},pp=(i,t,s)=>{if(s.inputLabel){i.id=Ve.input;const h=document.createElement("label"),_=Ve["input-label"];h.setAttribute("for",i.id),h.className=_,Pi(h,s.customClass.inputLabel),h.innerText=s.inputLabel,t.insertAdjacentElement("beforebegin",h)}},iA=i=>{const t=Ve[i]?Ve[i]:Ve.input;return Es(Ji(),t)},qr={};qr.text=qr.email=qr.password=qr.number=qr.tel=qr.url=(i,t)=>(typeof t.inputValue=="string"||typeof t.inputValue=="number"?i.value=t.inputValue:Sx(t.inputValue)||Gr(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof t.inputValue}"`),pp(i,i,t),zx(i,t),i.type=t.input,i);qr.file=(i,t)=>(pp(i,i,t),zx(i,t),i);qr.range=(i,t)=>{const s=i.querySelector("input"),h=i.querySelector("output");return s.value=t.inputValue,s.type=t.input,h.value=t.inputValue,pp(s,i,t),i};qr.select=(i,t)=>{if(i.textContent="",t.inputPlaceholder){const s=document.createElement("option");fr(s,t.inputPlaceholder),s.value="",s.disabled=!0,s.selected=!0,i.appendChild(s)}return pp(i,i,t),i};qr.radio=i=>(i.textContent="",i);qr.checkbox=(i,t)=>{const s=kx(Ji(),"checkbox");s.value=1,s.id=Ve.checkbox,s.checked=Boolean(t.inputValue);const h=i.querySelector("span");return fr(h,t.inputPlaceholder),i};qr.textarea=(i,t)=>{i.value=t.inputValue,zx(i,t),pp(i,i,t);const s=h=>parseInt(window.getComputedStyle(h).marginLeft)+parseInt(window.getComputedStyle(h).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const h=parseInt(window.getComputedStyle(Ji()).width),_=()=>{const x=i.offsetWidth+s(i);x>h?Ji().style.width=`${x}px`:Ji().style.width=null};new MutationObserver(_).observe(i,{attributes:!0,attributeFilter:["style"]})}}),i};const e4=(i,t)=>{const s=Ig();Wo(s,t,"htmlContainer"),t.html?(Dx(t.html,s),tr(s,"block")):t.text?(s.textContent=t.text,tr(s,"block")):pr(s),XN(i,t)},t4=(i,t)=>{const s=X2();Dg(s,t.footer),t.footer&&Dx(t.footer,s),Wo(s,t,"footer")},i4=(i,t)=>{const s=Ax();fr(s,t.closeButtonHtml),Wo(s,t,"closeButton"),Dg(s,t.showCloseButton),s.setAttribute("aria-label",t.closeButtonAriaLabel)},n4=(i,t)=>{const s=bi.innerParams.get(i),h=cp();if(s&&t.icon===s.icon){rA(h,t),nA(h,t);return}if(!t.icon&&!t.iconHtml)return pr(h);if(t.icon&&Object.keys(ap).indexOf(t.icon)===-1)return Ph(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${t.icon}"`),pr(h);tr(h),rA(h,t),nA(h,t),Pi(h,t.showClass.icon)},nA=(i,t)=>{for(const s in ap)t.icon!==s&&ws(i,ap[s]);Pi(i,ap[t.icon]),o4(i,t),r4(),Wo(i,t,"icon")},r4=()=>{const i=Ji(),t=window.getComputedStyle(i).getPropertyValue("background-color"),s=i.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let h=0;h<s.length;h++)s[h].style.backgroundColor=t},rA=(i,t)=>{i.textContent="",t.iconHtml?fr(i,oA(t.iconHtml)):t.icon==="success"?fr(i,`
      <div class="swal2-success-circular-line-left"></div>
      <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
      <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
      <div class="swal2-success-circular-line-right"></div>
    `):t.icon==="error"?fr(i,`
      <span class="swal2-x-mark">
        <span class="swal2-x-mark-line-left"></span>
        <span class="swal2-x-mark-line-right"></span>
      </span>
    `):fr(i,oA({question:"?",warning:"!",info:"i"}[t.icon]))},o4=(i,t)=>{if(!!t.iconColor){i.style.color=t.iconColor,i.style.borderColor=t.iconColor;for(const s of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])J2(i,s,"backgroundColor",t.iconColor);J2(i,".swal2-success-ring","borderColor",t.iconColor)}},oA=i=>`<div class="${Ve["icon-content"]}">${i}</div>`,s4=(i,t)=>{const s=W2();if(!t.imageUrl)return pr(s);tr(s,""),s.setAttribute("src",t.imageUrl),s.setAttribute("alt",t.imageAlt),dp(s,"width",t.imageWidth),dp(s,"height",t.imageHeight),s.className=Ve.image,Wo(s,t,"image")},a4=i=>{const t=document.createElement("li");return Pi(t,Ve["progress-step"]),fr(t,i),t},l4=i=>{const t=document.createElement("li");return Pi(t,Ve["progress-step-line"]),i.progressStepsDistance&&(t.style.width=i.progressStepsDistance),t},c4=(i,t)=>{const s=H2();if(!t.progressSteps||t.progressSteps.length===0)return pr(s);tr(s),s.textContent="",t.currentProgressStep>=t.progressSteps.length&&Gr("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),t.progressSteps.forEach((h,_)=>{const x=a4(h);if(s.appendChild(x),_===t.currentProgressStep&&Pi(x,Ve["active-progress-step"]),_!==t.progressSteps.length-1){const E=l4(t);s.appendChild(E)}})},u4=(i,t)=>{const s=Z2();Dg(s,t.title||t.titleText,"block"),t.title&&Dx(t.title,s),t.titleText&&(s.innerText=t.titleText),Wo(s,t,"title")},h4=(i,t)=>{const s=dr(),h=Ji();t.toast?(dp(s,"width",t.width),h.style.width="100%",h.insertBefore(Dh(),cp())):dp(h,"width",t.width),dp(h,"padding",t.padding),t.background&&(h.style.background=t.background),pr(Mg()),d4(h,t)},d4=(i,t)=>{i.className=`${Ve.popup} ${Mo(i)?t.showClass.popup:""}`,t.toast?(Pi([document.documentElement,document.body],Ve["toast-shown"]),Pi(i,Ve.toast)):Pi(i,Ve.modal),Wo(i,t,"popup"),typeof t.customClass=="string"&&Pi(i,t.customClass),t.icon&&Pi(i,Ve[`icon-${t.icon}`])},sA=(i,t)=>{h4(i,t),WN(i,t),c4(i,t),n4(i,t),s4(i,t),u4(i,t),i4(i,t),e4(i,t),VN(i,t),t4(i,t),typeof t.didRender=="function"&&t.didRender(Ji())},f4=()=>Mo(Ji()),aA=()=>Zo()&&Zo().click(),p4=()=>ol()&&ol().click(),m4=()=>Sc()&&Sc().click();function _4(...i){const t=this;return new t(...i)}function g4(i){class t extends this{_main(h,_){return super._main(h,Object.assign({},i,_))}}return t}const zh=i=>{let t=Ji();t||Bh.fire(),t=Ji();const s=Dh();up()?pr(cp()):y4(t,i),tr(s),t.setAttribute("data-loading",!0),t.setAttribute("aria-busy",!0),t.focus()},y4=(i,t)=>{const s=kg(),h=Dh();!t&&Mo(Zo())&&(t=Zo()),tr(s),t&&(pr(t),h.setAttribute("data-button-to-replace",t.className)),h.parentNode.insertBefore(h,t),Pi([i,s],Ve.loading)},v4=100,si={},x4=()=>{si.previousActiveElement&&si.previousActiveElement.focus?(si.previousActiveElement.focus(),si.previousActiveElement=null):document.body&&document.body.focus()},b4=i=>new Promise(t=>{if(!i)return t();const s=window.scrollX,h=window.scrollY;si.restoreFocusTimeout=setTimeout(()=>{x4(),t()},v4),window.scrollTo(s,h)}),w4=()=>si.timeout&&si.timeout.getTimerLeft(),lA=()=>{if(si.timeout)return PN(),si.timeout.stop()},cA=()=>{if(si.timeout){const i=si.timeout.start();return Px(i),i}},E4=()=>{const i=si.timeout;return i&&(i.running?lA():cA())},T4=i=>{if(si.timeout){const t=si.timeout.increase(i);return Px(t,!0),t}},C4=()=>si.timeout&&si.timeout.isRunning();let uA=!1;const Ox={};function S4(i="data-swal-template"){Ox[i]=this,uA||(document.body.addEventListener("click",A4),uA=!0)}const A4=i=>{for(let t=i.target;t&&t!==document;t=t.parentNode)for(const s in Ox){const h=t.getAttribute(s);if(h){Ox[s].fire({template:h});return}}},Oh={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},I4=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],M4={},k4=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],hA=i=>Object.prototype.hasOwnProperty.call(Oh,i),P4=i=>I4.indexOf(i)!==-1,Rx=i=>M4[i],D4=i=>{hA(i)||Gr(`Unknown parameter "${i}"`)},L4=i=>{k4.includes(i)&&Gr(`The parameter "${i}" is incompatible with toasts`)},z4=i=>{Rx(i)&&wN(i,Rx(i))},O4=i=>{!i.backdrop&&i.allowOutsideClick&&Gr('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`');for(const t in i)D4(t),i.toast&&L4(t),z4(t)};var R4=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",isValidParameter:hA,isUpdatableParameter:P4,isDeprecatedParameter:Rx,argsToParams:TN,getContainer:dr,getPopup:Ji,getTitle:Z2,getHtmlContainer:Ig,getImage:W2,getIcon:cp,getInputLabel:SN,getCloseButton:Ax,getActions:kg,getConfirmButton:Zo,getDenyButton:ol,getCancelButton:Sc,getLoader:Dh,getFooter:X2,getTimerProgressBar:Pg,getFocusableElements:Ix,getValidationMessage:Mg,isLoading:IN,isVisible:f4,clickConfirm:aA,clickDeny:p4,clickCancel:m4,fire:_4,mixin:g4,showLoading:zh,enableLoading:zh,getTimerLeft:w4,stopTimer:lA,resumeTimer:cA,toggleTimer:E4,increaseTimer:T4,isTimerRunning:C4,bindClickHandler:S4});function dA(){const i=bi.innerParams.get(this);if(!i)return;const t=bi.domCache.get(this);pr(t.loader),up()?i.icon&&tr(cp()):B4(t),ws([t.popup,t.actions],Ve.loading),t.popup.removeAttribute("aria-busy"),t.popup.removeAttribute("data-loading"),t.confirmButton.disabled=!1,t.denyButton.disabled=!1,t.cancelButton.disabled=!1}const B4=i=>{const t=i.popup.getElementsByClassName(i.loader.getAttribute("data-button-to-replace"));t.length?tr(t[0],"inline-block"):kN()&&pr(i.actions)};function F4(i){const t=bi.innerParams.get(i||this),s=bi.domCache.get(i||this);return s?kx(s.popup,t.input):null}const N4=()=>{Lh.previousBodyPadding===null&&document.body.scrollHeight>window.innerHeight&&(Lh.previousBodyPadding=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Lh.previousBodyPadding+jN()}px`)},U4=()=>{Lh.previousBodyPadding!==null&&(document.body.style.paddingRight=`${Lh.previousBodyPadding}px`,Lh.previousBodyPadding=null)},j4=()=>{if((/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&!hp(document.body,Ve.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,Pi(document.body,Ve.iosfix),$4(),V4()}},V4=()=>{if(!navigator.userAgent.match(/(CriOS|FxiOS|EdgiOS|YaBrowser|UCBrowser)/i)){const t=44;Ji().scrollHeight>window.innerHeight-t&&(dr().style.paddingBottom=`${t}px`)}},$4=()=>{const i=dr();let t;i.ontouchstart=s=>{t=G4(s)},i.ontouchmove=s=>{t&&(s.preventDefault(),s.stopPropagation())}},G4=i=>{const t=i.target,s=dr();return q4(i)||Z4(i)?!1:t===s||!Q2(s)&&t.tagName!=="INPUT"&&t.tagName!=="TEXTAREA"&&!(Q2(Ig())&&Ig().contains(t))},q4=i=>i.touches&&i.touches.length&&i.touches[0].touchType==="stylus",Z4=i=>i.touches&&i.touches.length>1,W4=()=>{if(hp(document.body,Ve.iosfix)){const i=parseInt(document.body.style.top,10);ws(document.body,Ve.iosfix),document.body.style.top="",document.body.scrollTop=i*-1}},H4=()=>{Ao(document.body.children).forEach(t=>{t===dr()||t.contains(dr())||(t.hasAttribute("aria-hidden")&&t.setAttribute("data-previous-aria-hidden",t.getAttribute("aria-hidden")),t.setAttribute("aria-hidden","true"))})},fA=()=>{Ao(document.body.children).forEach(t=>{t.hasAttribute("data-previous-aria-hidden")?(t.setAttribute("aria-hidden",t.getAttribute("data-previous-aria-hidden")),t.removeAttribute("data-previous-aria-hidden")):t.removeAttribute("aria-hidden")})};var mp={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};function pA(i,t,s,h){up()?_A(i,h):(b4(s).then(()=>_A(i,h)),si.keydownTarget.removeEventListener("keydown",si.keydownHandler,{capture:si.keydownListenerCapture}),si.keydownHandlerAdded=!1),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?(t.setAttribute("style","display:none !important"),t.removeAttribute("class"),t.innerHTML=""):t.remove(),Mx()&&(U4(),W4(),fA()),X4()}function X4(){ws([document.documentElement,document.body],[Ve.shown,Ve["height-auto"],Ve["no-backdrop"],Ve["toast-shown"]])}function Lg(i){i=Q4(i);const t=mp.swalPromiseResolve.get(this),s=Y4(this);this.isAwaitingPromise()?i.isDismissed||(mA(this),t(i)):s&&t(i)}function K4(){return!!bi.awaitingPromise.get(this)}const Y4=i=>{const t=Ji();if(!t)return!1;const s=bi.innerParams.get(i);if(!s||hp(t,s.hideClass.popup))return!1;ws(t,s.showClass.popup),Pi(t,s.hideClass.popup);const h=dr();return ws(h,s.showClass.backdrop),Pi(h,s.hideClass.backdrop),e5(i,t,s),!0};function J4(i){const t=mp.swalPromiseReject.get(this);mA(this),t&&t(i)}const mA=i=>{i.isAwaitingPromise()&&(bi.awaitingPromise.delete(i),bi.innerParams.get(i)||i._destroy())},Q4=i=>typeof i=="undefined"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},i),e5=(i,t,s)=>{const h=dr(),_=fp&&eA(t);typeof s.willClose=="function"&&s.willClose(t),_?t5(i,t,h,s.returnFocus,s.didClose):pA(i,h,s.returnFocus,s.didClose)},t5=(i,t,s,h,_)=>{si.swalCloseEventFinishedCallback=pA.bind(null,i,s,h,_),t.addEventListener(fp,function(x){x.target===t&&(si.swalCloseEventFinishedCallback(),delete si.swalCloseEventFinishedCallback)})},_A=(i,t)=>{setTimeout(()=>{typeof t=="function"&&t.bind(i.params)(),i._destroy()})};function gA(i,t,s){const h=bi.domCache.get(i);t.forEach(_=>{h[_].disabled=s})}function yA(i,t){if(!i)return!1;if(i.type==="radio"){const h=i.parentNode.parentNode.querySelectorAll("input");for(let _=0;_<h.length;_++)h[_].disabled=t}else i.disabled=t}function i5(){gA(this,["confirmButton","denyButton","cancelButton"],!1)}function n5(){gA(this,["confirmButton","denyButton","cancelButton"],!0)}function r5(){return yA(this.getInput(),!1)}function o5(){return yA(this.getInput(),!0)}function s5(i){const t=bi.domCache.get(this),s=bi.innerParams.get(this);fr(t.validationMessage,i),t.validationMessage.className=Ve["validation-message"],s.customClass&&s.customClass.validationMessage&&Pi(t.validationMessage,s.customClass.validationMessage),tr(t.validationMessage);const h=this.getInput();h&&(h.setAttribute("aria-invalid",!0),h.setAttribute("aria-describedby",Ve["validation-message"]),K2(h),Pi(h,Ve.inputerror))}function a5(){const i=bi.domCache.get(this);i.validationMessage&&pr(i.validationMessage);const t=this.getInput();t&&(t.removeAttribute("aria-invalid"),t.removeAttribute("aria-describedby"),ws(t,Ve.inputerror))}function l5(){return bi.domCache.get(this).progressSteps}class c5{constructor(t,s){this.callback=t,this.remaining=s,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date-this.started),this.remaining}increase(t){const s=this.running;return s&&this.stop(),this.remaining+=t,s&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}var vA={email:(i,t)=>/^[a-zA-Z0-9.+_-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]{2,24}$/.test(i)?Promise.resolve():Promise.resolve(t||"Invalid email address"),url:(i,t)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(i)?Promise.resolve():Promise.resolve(t||"Invalid URL")};function u5(i){i.inputValidator||Object.keys(vA).forEach(t=>{i.input===t&&(i.inputValidator=vA[t])})}function h5(i){(!i.target||typeof i.target=="string"&&!document.querySelector(i.target)||typeof i.target!="string"&&!i.target.appendChild)&&(Gr('Target parameter is not valid, defaulting to "body"'),i.target="body")}function d5(i){u5(i),i.showLoaderOnConfirm&&!i.preConfirm&&Gr(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),h5(i),typeof i.title=="string"&&(i.title=i.title.split(`
`).join("<br />")),FN(i)}const xA=["swal-title","swal-html","swal-footer"],f5=i=>{const t=typeof i.template=="string"?document.querySelector(i.template):i.template;if(!t)return{};const s=t.content;return x5(s),Object.assign(p5(s),m5(s),_5(s),g5(s),y5(s),v5(s,xA))},p5=i=>{const t={};return Ao(i.querySelectorAll("swal-param")).forEach(s=>{Ic(s,["name","value"]);const h=s.getAttribute("name");let _=s.getAttribute("value");typeof Oh[h]=="boolean"&&_==="false"&&(_=!1),typeof Oh[h]=="object"&&(_=JSON.parse(_)),t[h]=_}),t},m5=i=>{const t={};return Ao(i.querySelectorAll("swal-button")).forEach(s=>{Ic(s,["type","color","aria-label"]);const h=s.getAttribute("type");t[`${h}ButtonText`]=s.innerHTML,t[`show${V2(h)}Button`]=!0,s.hasAttribute("color")&&(t[`${h}ButtonColor`]=s.getAttribute("color")),s.hasAttribute("aria-label")&&(t[`${h}ButtonAriaLabel`]=s.getAttribute("aria-label"))}),t},_5=i=>{const t={},s=i.querySelector("swal-image");return s&&(Ic(s,["src","width","height","alt"]),s.hasAttribute("src")&&(t.imageUrl=s.getAttribute("src")),s.hasAttribute("width")&&(t.imageWidth=s.getAttribute("width")),s.hasAttribute("height")&&(t.imageHeight=s.getAttribute("height")),s.hasAttribute("alt")&&(t.imageAlt=s.getAttribute("alt"))),t},g5=i=>{const t={},s=i.querySelector("swal-icon");return s&&(Ic(s,["type","color"]),s.hasAttribute("type")&&(t.icon=s.getAttribute("type")),s.hasAttribute("color")&&(t.iconColor=s.getAttribute("color")),t.iconHtml=s.innerHTML),t},y5=i=>{const t={},s=i.querySelector("swal-input");s&&(Ic(s,["type","label","placeholder","value"]),t.input=s.getAttribute("type")||"text",s.hasAttribute("label")&&(t.inputLabel=s.getAttribute("label")),s.hasAttribute("placeholder")&&(t.inputPlaceholder=s.getAttribute("placeholder")),s.hasAttribute("value")&&(t.inputValue=s.getAttribute("value")));const h=i.querySelectorAll("swal-input-option");return h.length&&(t.inputOptions={},Ao(h).forEach(_=>{Ic(_,["value"]);const x=_.getAttribute("value"),E=_.innerHTML;t.inputOptions[x]=E})),t},v5=(i,t)=>{const s={};for(const h in t){const _=t[h],x=i.querySelector(_);x&&(Ic(x,[]),s[_.replace(/^swal-/,"")]=x.innerHTML.trim())}return s},x5=i=>{const t=xA.concat(["swal-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Ao(i.children).forEach(s=>{const h=s.tagName.toLowerCase();t.indexOf(h)===-1&&Gr(`Unrecognized element <${h}>`)})},Ic=(i,t)=>{Ao(i.attributes).forEach(s=>{t.indexOf(s.name)===-1&&Gr([`Unrecognized attribute "${s.name}" on <${i.tagName.toLowerCase()}>.`,`${t.length?`Allowed attributes are: ${t.join(", ")}`:"To set the value, use HTML within the element."}`])})},bA=10,b5=i=>{const t=dr(),s=Ji();typeof i.willOpen=="function"&&i.willOpen(s);const _=window.getComputedStyle(document.body).overflowY;T5(t,s,i),setTimeout(()=>{w5(t,s)},bA),Mx()&&(E5(t,i.scrollbarPadding,_),H4()),!up()&&!si.previousActiveElement&&(si.previousActiveElement=document.activeElement),typeof i.didOpen=="function"&&setTimeout(()=>i.didOpen(s)),ws(t,Ve["no-transition"])},wA=i=>{const t=Ji();if(i.target!==t)return;const s=dr();t.removeEventListener(fp,wA),s.style.overflowY="auto"},w5=(i,t)=>{fp&&eA(t)?(i.style.overflowY="hidden",t.addEventListener(fp,wA)):i.style.overflowY="auto"},E5=(i,t,s)=>{j4(),t&&s!=="hidden"&&N4(),setTimeout(()=>{i.scrollTop=0})},T5=(i,t,s)=>{Pi(i,s.showClass.backdrop),t.style.setProperty("opacity","0","important"),tr(t,"grid"),setTimeout(()=>{Pi(t,s.showClass.popup),t.style.removeProperty("opacity")},bA),Pi([document.documentElement,document.body],Ve.shown),s.heightAuto&&s.backdrop&&!s.toast&&Pi([document.documentElement,document.body],Ve["height-auto"])},C5=(i,t)=>{t.input==="select"||t.input==="radio"?k5(i,t):["text","email","number","tel","textarea"].includes(t.input)&&(Cx(t.inputValue)||Sx(t.inputValue))&&(zh(Zo()),P5(i,t))},S5=(i,t)=>{const s=i.getInput();if(!s)return null;switch(t.input){case"checkbox":return A5(s);case"radio":return I5(s);case"file":return M5(s);default:return t.inputAutoTrim?s.value.trim():s.value}},A5=i=>i.checked?1:0,I5=i=>i.checked?i.value:null,M5=i=>i.files.length?i.getAttribute("multiple")!==null?i.files:i.files[0]:null,k5=(i,t)=>{const s=Ji(),h=_=>D5[t.input](s,Bx(_),t);Cx(t.inputOptions)||Sx(t.inputOptions)?(zh(Zo()),sp(t.inputOptions).then(_=>{i.hideLoading(),h(_)})):typeof t.inputOptions=="object"?h(t.inputOptions):Ph(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof t.inputOptions}`)},P5=(i,t)=>{const s=i.getInput();pr(s),sp(t.inputValue).then(h=>{s.value=t.input==="number"?parseFloat(h)||0:`${h}`,tr(s),s.focus(),i.hideLoading()}).catch(h=>{Ph(`Error in inputValue promise: ${h}`),s.value="",tr(s),s.focus(),i.hideLoading()})},D5={select:(i,t,s)=>{const h=Es(i,Ve.select),_=(x,E,a)=>{const S=document.createElement("option");S.value=a,fr(S,E),S.selected=EA(a,s.inputValue),x.appendChild(S)};t.forEach(x=>{const E=x[0],a=x[1];if(Array.isArray(a)){const S=document.createElement("optgroup");S.label=E,S.disabled=!1,h.appendChild(S),a.forEach(O=>_(S,O[1],O[0]))}else _(h,a,E)}),h.focus()},radio:(i,t,s)=>{const h=Es(i,Ve.radio);t.forEach(x=>{const E=x[0],a=x[1],S=document.createElement("input"),O=document.createElement("label");S.type="radio",S.name=Ve.radio,S.value=E,EA(E,s.inputValue)&&(S.checked=!0);const M=document.createElement("span");fr(M,a),M.className=Ve.label,O.appendChild(S),O.appendChild(M),h.appendChild(O)});const _=h.querySelectorAll("input");_.length&&_[0].focus()}},Bx=i=>{const t=[];return typeof Map!="undefined"&&i instanceof Map?i.forEach((s,h)=>{let _=s;typeof _=="object"&&(_=Bx(_)),t.push([h,_])}):Object.keys(i).forEach(s=>{let h=i[s];typeof h=="object"&&(h=Bx(h)),t.push([s,h])}),t},EA=(i,t)=>t&&t.toString()===i.toString(),L5=i=>{const t=bi.innerParams.get(i);i.disableButtons(),t.input?TA(i,"confirm"):Nx(i,!0)},z5=i=>{const t=bi.innerParams.get(i);i.disableButtons(),t.returnInputValueOnDeny?TA(i,"deny"):Fx(i,!1)},O5=(i,t)=>{i.disableButtons(),t(kh.cancel)},TA=(i,t)=>{const s=bi.innerParams.get(i),h=S5(i,s);s.inputValidator?R5(i,h,t):i.getInput().checkValidity()?t==="deny"?Fx(i,h):Nx(i,h):(i.enableButtons(),i.showValidationMessage(s.validationMessage))},R5=(i,t,s)=>{const h=bi.innerParams.get(i);i.disableInput(),Promise.resolve().then(()=>sp(h.inputValidator(t,h.validationMessage))).then(x=>{i.enableButtons(),i.enableInput(),x?i.showValidationMessage(x):s==="deny"?Fx(i,t):Nx(i,t)})},Fx=(i,t)=>{const s=bi.innerParams.get(i||void 0);s.showLoaderOnDeny&&zh(ol()),s.preDeny?(bi.awaitingPromise.set(i||void 0,!0),Promise.resolve().then(()=>sp(s.preDeny(t,s.validationMessage))).then(_=>{_===!1?i.hideLoading():i.closePopup({isDenied:!0,value:typeof _=="undefined"?t:_})}).catch(_=>SA(i||void 0,_))):i.closePopup({isDenied:!0,value:t})},CA=(i,t)=>{i.closePopup({isConfirmed:!0,value:t})},SA=(i,t)=>{i.rejectPromise(t)},Nx=(i,t)=>{const s=bi.innerParams.get(i||void 0);s.showLoaderOnConfirm&&zh(),s.preConfirm?(i.resetValidationMessage(),bi.awaitingPromise.set(i||void 0,!0),Promise.resolve().then(()=>sp(s.preConfirm(t,s.validationMessage))).then(_=>{Mo(Mg())||_===!1?i.hideLoading():CA(i,typeof _=="undefined"?t:_)}).catch(_=>SA(i||void 0,_))):CA(i,t)},B5=(i,t,s,h)=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1),s.toast||(t.keydownHandler=_=>N5(i,_,h),t.keydownTarget=s.keydownListenerCapture?window:Ji(),t.keydownListenerCapture=s.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},Ux=(i,t,s)=>{const h=Ix();if(h.length)return t=t+s,t===h.length?t=0:t===-1&&(t=h.length-1),h[t].focus();Ji().focus()},AA=["ArrowRight","ArrowDown"],F5=["ArrowLeft","ArrowUp"],N5=(i,t,s)=>{const h=bi.innerParams.get(i);!h||(h.stopKeydownPropagation&&t.stopPropagation(),t.key==="Enter"?U5(i,t,h):t.key==="Tab"?j5(t,h):[...AA,...F5].includes(t.key)?V5(t.key):t.key==="Escape"&&$5(t,h,s))},U5=(i,t,s)=>{if(!t.isComposing&&t.target&&i.getInput()&&t.target.outerHTML===i.getInput().outerHTML){if(["textarea","file"].includes(s.input))return;aA(),t.preventDefault()}},j5=(i,t)=>{const s=i.target,h=Ix();let _=-1;for(let x=0;x<h.length;x++)if(s===h[x]){_=x;break}i.shiftKey?Ux(t,_,-1):Ux(t,_,1),i.stopPropagation(),i.preventDefault()},V5=i=>{const t=Zo(),s=ol(),h=Sc();if(![t,s,h].includes(document.activeElement))return;const _=AA.includes(i)?"nextElementSibling":"previousElementSibling",x=document.activeElement[_];x&&x.focus()},$5=(i,t,s)=>{Tx(t.allowEscapeKey)&&(i.preventDefault(),s(kh.esc))},G5=(i,t,s)=>{bi.innerParams.get(i).toast?q5(i,t,s):(Z5(t),W5(t),H5(i,t,s))},q5=(i,t,s)=>{t.popup.onclick=()=>{const h=bi.innerParams.get(i);h.showConfirmButton||h.showDenyButton||h.showCancelButton||h.showCloseButton||h.timer||h.input||s(kh.close)}};let zg=!1;const Z5=i=>{i.popup.onmousedown=()=>{i.container.onmouseup=function(t){i.container.onmouseup=void 0,t.target===i.container&&(zg=!0)}}},W5=i=>{i.container.onmousedown=()=>{i.popup.onmouseup=function(t){i.popup.onmouseup=void 0,(t.target===i.popup||i.popup.contains(t.target))&&(zg=!0)}}},H5=(i,t,s)=>{t.container.onclick=h=>{const _=bi.innerParams.get(i);if(zg){zg=!1;return}h.target===t.container&&Tx(_.allowOutsideClick)&&s(kh.backdrop)}};function X5(i,t={}){O4(Object.assign({},t,i)),si.currentInstance&&(si.currentInstance._destroy(),Mx()&&fA()),si.currentInstance=this;const s=K5(i,t);d5(s),Object.freeze(s),si.timeout&&(si.timeout.stop(),delete si.timeout),clearTimeout(si.restoreFocusTimeout);const h=J5(this);return sA(this,s),bi.innerParams.set(this,s),Y5(this,h,s)}const K5=(i,t)=>{const s=f5(i),h=Object.assign({},Oh,t,s,i);return h.showClass=Object.assign({},Oh.showClass,h.showClass),h.hideClass=Object.assign({},Oh.hideClass,h.hideClass),h},Y5=(i,t,s)=>new Promise((h,_)=>{const x=E=>{i.closePopup({isDismissed:!0,dismiss:E})};mp.swalPromiseResolve.set(i,h),mp.swalPromiseReject.set(i,_),t.confirmButton.onclick=()=>L5(i),t.denyButton.onclick=()=>z5(i),t.cancelButton.onclick=()=>O5(i,x),t.closeButton.onclick=()=>x(kh.close),G5(i,t,x),B5(i,si,s,x),C5(i,s),b5(s),Q5(si,s,x),eU(t,s),setTimeout(()=>{t.container.scrollTop=0})}),J5=i=>{const t={popup:Ji(),container:dr(),actions:kg(),confirmButton:Zo(),denyButton:ol(),cancelButton:Sc(),loader:Dh(),closeButton:Ax(),validationMessage:Mg(),progressSteps:H2()};return bi.domCache.set(i,t),t},Q5=(i,t,s)=>{const h=Pg();pr(h),t.timer&&(i.timeout=new c5(()=>{s("timer"),delete i.timeout},t.timer),t.timerProgressBar&&(tr(h),setTimeout(()=>{i.timeout&&i.timeout.running&&Px(t.timer)})))},eU=(i,t)=>{if(!t.toast){if(!Tx(t.allowEnterKey))return iU();tU(i,t)||Ux(t,-1,1)}},tU=(i,t)=>t.focusDeny&&Mo(i.denyButton)?(i.denyButton.focus(),!0):t.focusCancel&&Mo(i.cancelButton)?(i.cancelButton.focus(),!0):t.focusConfirm&&Mo(i.confirmButton)?(i.confirmButton.focus(),!0):!1,iU=()=>{document.activeElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};function nU(i){const t=Ji(),s=bi.innerParams.get(this);if(!t||hp(t,s.hideClass.popup))return Gr("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");const h={};Object.keys(i).forEach(x=>{Bh.isUpdatableParameter(x)?h[x]=i[x]:Gr(`Invalid parameter to update: "${x}". Updatable params are listed here: https://github.com/sweetalert2/sweetalert2/blob/master/src/utils/params.js

If you think this parameter should be updatable, request it here: https://github.com/sweetalert2/sweetalert2/issues/new?template=02_feature_request.md`)});const _=Object.assign({},s,h);sA(this,_),bi.innerParams.set(this,_),Object.defineProperties(this,{params:{value:Object.assign({},this.params,i),writable:!1,enumerable:!0}})}function rU(){const i=bi.domCache.get(this),t=bi.innerParams.get(this);if(!t){IA(this);return}i.popup&&si.swalCloseEventFinishedCallback&&(si.swalCloseEventFinishedCallback(),delete si.swalCloseEventFinishedCallback),si.deferDisposalTimer&&(clearTimeout(si.deferDisposalTimer),delete si.deferDisposalTimer),typeof t.didDestroy=="function"&&t.didDestroy(),oU(this)}const oU=i=>{IA(i),delete i.params,delete si.keydownHandler,delete si.keydownTarget,delete si.currentInstance},IA=i=>{i.isAwaitingPromise()?(jx(bi,i),bi.awaitingPromise.set(i,!0)):(jx(mp,i),jx(bi,i))},jx=(i,t)=>{for(const s in i)i[s].delete(t)};var MA=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",hideLoading:dA,disableLoading:dA,getInput:F4,close:Lg,isAwaitingPromise:K4,rejectPromise:J4,closePopup:Lg,closeModal:Lg,closeToast:Lg,enableButtons:i5,disableButtons:n5,enableInput:r5,disableInput:o5,showValidationMessage:s5,resetValidationMessage:a5,getProgressSteps:l5,_main:X5,update:nU,_destroy:rU});let Vx;class Rh{constructor(...t){if(typeof window=="undefined")return;Vx=this;const s=Object.freeze(this.constructor.argsToParams(t));Object.defineProperties(this,{params:{value:s,writable:!1,enumerable:!0,configurable:!0}});const h=this._main(this.params);bi.promise.set(this,h)}then(t){return bi.promise.get(this).then(t)}finally(t){return bi.promise.get(this).finally(t)}}Object.assign(Rh.prototype,MA);Object.assign(Rh,R4);Object.keys(MA).forEach(i=>{Rh[i]=function(...t){if(Vx)return Vx[i](...t)}});Rh.DismissReason=kh;Rh.version="11.1.9";const Bh=Rh;Bh.default=Bh;var sU=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function aU(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var $x={exports:{}},kA=function(t,s){return function(){for(var _=new Array(arguments.length),x=0;x<_.length;x++)_[x]=arguments[x];return t.apply(s,_)}},lU=kA,Mc=Object.prototype.toString;function Gx(i){return Mc.call(i)==="[object Array]"}function qx(i){return typeof i=="undefined"}function cU(i){return i!==null&&!qx(i)&&i.constructor!==null&&!qx(i.constructor)&&typeof i.constructor.isBuffer=="function"&&i.constructor.isBuffer(i)}function uU(i){return Mc.call(i)==="[object ArrayBuffer]"}function hU(i){return typeof FormData!="undefined"&&i instanceof FormData}function dU(i){var t;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?t=ArrayBuffer.isView(i):t=i&&i.buffer&&i.buffer instanceof ArrayBuffer,t}function fU(i){return typeof i=="string"}function pU(i){return typeof i=="number"}function PA(i){return i!==null&&typeof i=="object"}function Og(i){if(Mc.call(i)!=="[object Object]")return!1;var t=Object.getPrototypeOf(i);return t===null||t===Object.prototype}function mU(i){return Mc.call(i)==="[object Date]"}function _U(i){return Mc.call(i)==="[object File]"}function gU(i){return Mc.call(i)==="[object Blob]"}function DA(i){return Mc.call(i)==="[object Function]"}function yU(i){return PA(i)&&DA(i.pipe)}function vU(i){return typeof URLSearchParams!="undefined"&&i instanceof URLSearchParams}function xU(i){return i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")}function bU(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function Zx(i,t){if(!(i===null||typeof i=="undefined"))if(typeof i!="object"&&(i=[i]),Gx(i))for(var s=0,h=i.length;s<h;s++)t.call(null,i[s],s,i);else for(var _ in i)Object.prototype.hasOwnProperty.call(i,_)&&t.call(null,i[_],_,i)}function Wx(){var i={};function t(_,x){Og(i[x])&&Og(_)?i[x]=Wx(i[x],_):Og(_)?i[x]=Wx({},_):Gx(_)?i[x]=_.slice():i[x]=_}for(var s=0,h=arguments.length;s<h;s++)Zx(arguments[s],t);return i}function wU(i,t,s){return Zx(t,function(_,x){s&&typeof _=="function"?i[x]=lU(_,s):i[x]=_}),i}function EU(i){return i.charCodeAt(0)===65279&&(i=i.slice(1)),i}var ao={isArray:Gx,isArrayBuffer:uU,isBuffer:cU,isFormData:hU,isArrayBufferView:dU,isString:fU,isNumber:pU,isObject:PA,isPlainObject:Og,isUndefined:qx,isDate:mU,isFile:_U,isBlob:gU,isFunction:DA,isStream:yU,isURLSearchParams:vU,isStandardBrowserEnv:bU,forEach:Zx,merge:Wx,extend:wU,trim:xU,stripBOM:EU},Fh=ao;function LA(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var zA=function(t,s,h){if(!s)return t;var _;if(h)_=h(s);else if(Fh.isURLSearchParams(s))_=s.toString();else{var x=[];Fh.forEach(s,function(S,O){S===null||typeof S=="undefined"||(Fh.isArray(S)?O=O+"[]":S=[S],Fh.forEach(S,function(P){Fh.isDate(P)?P=P.toISOString():Fh.isObject(P)&&(P=JSON.stringify(P)),x.push(LA(O)+"="+LA(P))}))}),_=x.join("&")}if(_){var E=t.indexOf("#");E!==-1&&(t=t.slice(0,E)),t+=(t.indexOf("?")===-1?"?":"&")+_}return t},TU=ao;function Rg(){this.handlers=[]}Rg.prototype.use=function(t,s,h){return this.handlers.push({fulfilled:t,rejected:s,synchronous:h?h.synchronous:!1,runWhen:h?h.runWhen:null}),this.handlers.length-1};Rg.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)};Rg.prototype.forEach=function(t){TU.forEach(this.handlers,function(h){h!==null&&t(h)})};var CU=Rg,SU=ao,AU=function(t,s){SU.forEach(t,function(_,x){x!==s&&x.toUpperCase()===s.toUpperCase()&&(t[s]=_,delete t[x])})},OA=function(t,s,h,_,x){return t.config=s,h&&(t.code=h),t.request=_,t.response=x,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},t},IU=OA,RA=function(t,s,h,_,x){var E=new Error(t);return IU(E,s,h,_,x)},MU=RA,kU=function(t,s,h){var _=h.config.validateStatus;!h.status||!_||_(h.status)?t(h):s(MU("Request failed with status code "+h.status,h.config,null,h.request,h))},Bg=ao,PU=Bg.isStandardBrowserEnv()?function(){return{write:function(s,h,_,x,E,a){var S=[];S.push(s+"="+encodeURIComponent(h)),Bg.isNumber(_)&&S.push("expires="+new Date(_).toGMTString()),Bg.isString(x)&&S.push("path="+x),Bg.isString(E)&&S.push("domain="+E),a===!0&&S.push("secure"),document.cookie=S.join("; ")},read:function(s){var h=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return h?decodeURIComponent(h[3]):null},remove:function(s){this.write(s,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),DU=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)},LU=function(t,s){return s?t.replace(/\/+$/,"")+"/"+s.replace(/^\/+/,""):t},zU=DU,OU=LU,RU=function(t,s){return t&&!zU(s)?OU(t,s):s},Hx=ao,BU=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],FU=function(t){var s={},h,_,x;return t&&Hx.forEach(t.split(`
`),function(a){if(x=a.indexOf(":"),h=Hx.trim(a.substr(0,x)).toLowerCase(),_=Hx.trim(a.substr(x+1)),h){if(s[h]&&BU.indexOf(h)>=0)return;h==="set-cookie"?s[h]=(s[h]?s[h]:[]).concat([_]):s[h]=s[h]?s[h]+", "+_:_}}),s},BA=ao,NU=BA.isStandardBrowserEnv()?function(){var t=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a"),h;function _(x){var E=x;return t&&(s.setAttribute("href",E),E=s.href),s.setAttribute("href",E),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:s.pathname.charAt(0)==="/"?s.pathname:"/"+s.pathname}}return h=_(window.location.href),function(E){var a=BA.isString(E)?_(E):E;return a.protocol===h.protocol&&a.host===h.host}}():function(){return function(){return!0}}();function Xx(i){this.message=i}Xx.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")};Xx.prototype.__CANCEL__=!0;var Fg=Xx,Ng=ao,UU=kU,jU=PU,VU=zA,$U=RU,GU=FU,qU=NU,Kx=RA,ZU=jg,WU=Fg,FA=function(t){return new Promise(function(h,_){var x=t.data,E=t.headers,a=t.responseType,S;function O(){t.cancelToken&&t.cancelToken.unsubscribe(S),t.signal&&t.signal.removeEventListener("abort",S)}Ng.isFormData(x)&&delete E["Content-Type"];var M=new XMLHttpRequest;if(t.auth){var P=t.auth.username||"",z=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";E.Authorization="Basic "+btoa(P+":"+z)}var q=$U(t.baseURL,t.url);M.open(t.method.toUpperCase(),VU(q,t.params,t.paramsSerializer),!0),M.timeout=t.timeout;function se(){if(!!M){var oe="getAllResponseHeaders"in M?GU(M.getAllResponseHeaders()):null,fe=!a||a==="text"||a==="json"?M.responseText:M.response,xe={data:fe,status:M.status,statusText:M.statusText,headers:oe,config:t,request:M};UU(function($e){h($e),O()},function($e){_($e),O()},xe),M=null}}if("onloadend"in M?M.onloadend=se:M.onreadystatechange=function(){!M||M.readyState!==4||M.status===0&&!(M.responseURL&&M.responseURL.indexOf("file:")===0)||setTimeout(se)},M.onabort=function(){!M||(_(Kx("Request aborted",t,"ECONNABORTED",M)),M=null)},M.onerror=function(){_(Kx("Network Error",t,null,M)),M=null},M.ontimeout=function(){var fe=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",xe=t.transitional||ZU.transitional;t.timeoutErrorMessage&&(fe=t.timeoutErrorMessage),_(Kx(fe,t,xe.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",M)),M=null},Ng.isStandardBrowserEnv()){var ue=(t.withCredentials||qU(q))&&t.xsrfCookieName?jU.read(t.xsrfCookieName):void 0;ue&&(E[t.xsrfHeaderName]=ue)}"setRequestHeader"in M&&Ng.forEach(E,function(fe,xe){typeof x=="undefined"&&xe.toLowerCase()==="content-type"?delete E[xe]:M.setRequestHeader(xe,fe)}),Ng.isUndefined(t.withCredentials)||(M.withCredentials=!!t.withCredentials),a&&a!=="json"&&(M.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&M.addEventListener("progress",t.onDownloadProgress),typeof t.onUploadProgress=="function"&&M.upload&&M.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(S=function(oe){!M||(_(!oe||oe&&oe.type?new WU("canceled"):oe),M.abort(),M=null)},t.cancelToken&&t.cancelToken.subscribe(S),t.signal&&(t.signal.aborted?S():t.signal.addEventListener("abort",S))),x||(x=null),M.send(x)})},ir=ao,NA=AU,HU=OA,XU={"Content-Type":"application/x-www-form-urlencoded"};function UA(i,t){!ir.isUndefined(i)&&ir.isUndefined(i["Content-Type"])&&(i["Content-Type"]=t)}function KU(){var i;return(typeof XMLHttpRequest!="undefined"||typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]")&&(i=FA),i}function YU(i,t,s){if(ir.isString(i))try{return(t||JSON.parse)(i),ir.trim(i)}catch(h){if(h.name!=="SyntaxError")throw h}return(s||JSON.stringify)(i)}var Ug={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:KU(),transformRequest:[function(t,s){return NA(s,"Accept"),NA(s,"Content-Type"),ir.isFormData(t)||ir.isArrayBuffer(t)||ir.isBuffer(t)||ir.isStream(t)||ir.isFile(t)||ir.isBlob(t)?t:ir.isArrayBufferView(t)?t.buffer:ir.isURLSearchParams(t)?(UA(s,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):ir.isObject(t)||s&&s["Content-Type"]==="application/json"?(UA(s,"application/json"),YU(t)):t}],transformResponse:[function(t){var s=this.transitional||Ug.transitional,h=s&&s.silentJSONParsing,_=s&&s.forcedJSONParsing,x=!h&&this.responseType==="json";if(x||_&&ir.isString(t)&&t.length)try{return JSON.parse(t)}catch(E){if(x)throw E.name==="SyntaxError"?HU(E,this,"E_JSON_PARSE"):E}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};ir.forEach(["delete","get","head"],function(t){Ug.headers[t]={}});ir.forEach(["post","put","patch"],function(t){Ug.headers[t]=ir.merge(XU)});var jg=Ug,JU=ao,QU=jg,ej=function(t,s,h){var _=this||QU;return JU.forEach(h,function(E){t=E.call(_,t,s)}),t},jA=function(t){return!!(t&&t.__CANCEL__)},VA=ao,Yx=ej,tj=jA,ij=jg,nj=Fg;function Jx(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new nj("canceled")}var rj=function(t){Jx(t),t.headers=t.headers||{},t.data=Yx.call(t,t.data,t.headers,t.transformRequest),t.headers=VA.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),VA.forEach(["delete","get","head","post","put","patch","common"],function(_){delete t.headers[_]});var s=t.adapter||ij.adapter;return s(t).then(function(_){return Jx(t),_.data=Yx.call(t,_.data,_.headers,t.transformResponse),_},function(_){return tj(_)||(Jx(t),_&&_.response&&(_.response.data=Yx.call(t,_.response.data,_.response.headers,t.transformResponse))),Promise.reject(_)})},lo=ao,$A=function(t,s){s=s||{};var h={};function _(M,P){return lo.isPlainObject(M)&&lo.isPlainObject(P)?lo.merge(M,P):lo.isPlainObject(P)?lo.merge({},P):lo.isArray(P)?P.slice():P}function x(M){if(lo.isUndefined(s[M])){if(!lo.isUndefined(t[M]))return _(void 0,t[M])}else return _(t[M],s[M])}function E(M){if(!lo.isUndefined(s[M]))return _(void 0,s[M])}function a(M){if(lo.isUndefined(s[M])){if(!lo.isUndefined(t[M]))return _(void 0,t[M])}else return _(void 0,s[M])}function S(M){if(M in s)return _(t[M],s[M]);if(M in t)return _(void 0,t[M])}var O={url:E,method:E,data:E,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:S};return lo.forEach(Object.keys(t).concat(Object.keys(s)),function(P){var z=O[P]||x,q=z(P);lo.isUndefined(q)&&z!==S||(h[P]=q)}),h},GA={version:"0.23.0"},oj=GA.version,Qx={};["object","boolean","number","function","string","symbol"].forEach(function(i,t){Qx[i]=function(h){return typeof h===i||"a"+(t<1?"n ":" ")+i}});var qA={};Qx.transitional=function(t,s,h){function _(x,E){return"[Axios v"+oj+"] Transitional option '"+x+"'"+E+(h?". "+h:"")}return function(x,E,a){if(t===!1)throw new Error(_(E," has been removed"+(s?" in "+s:"")));return s&&!qA[E]&&(qA[E]=!0,console.warn(_(E," has been deprecated since v"+s+" and will be removed in the near future"))),t?t(x,E,a):!0}};function sj(i,t,s){if(typeof i!="object")throw new TypeError("options must be an object");for(var h=Object.keys(i),_=h.length;_-- >0;){var x=h[_],E=t[x];if(E){var a=i[x],S=a===void 0||E(a,x,i);if(S!==!0)throw new TypeError("option "+x+" must be "+S);continue}if(s!==!0)throw Error("Unknown option "+x)}}var aj={assertOptions:sj,validators:Qx},ZA=ao,lj=zA,WA=CU,HA=rj,Vg=$A,XA=aj,Nh=XA.validators;function _p(i){this.defaults=i,this.interceptors={request:new WA,response:new WA}}_p.prototype.request=function(t){typeof t=="string"?(t=arguments[1]||{},t.url=arguments[0]):t=t||{},t=Vg(this.defaults,t),t.method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var s=t.transitional;s!==void 0&&XA.assertOptions(s,{silentJSONParsing:Nh.transitional(Nh.boolean),forcedJSONParsing:Nh.transitional(Nh.boolean),clarifyTimeoutError:Nh.transitional(Nh.boolean)},!1);var h=[],_=!0;this.interceptors.request.forEach(function(z){typeof z.runWhen=="function"&&z.runWhen(t)===!1||(_=_&&z.synchronous,h.unshift(z.fulfilled,z.rejected))});var x=[];this.interceptors.response.forEach(function(z){x.push(z.fulfilled,z.rejected)});var E;if(!_){var a=[HA,void 0];for(Array.prototype.unshift.apply(a,h),a=a.concat(x),E=Promise.resolve(t);a.length;)E=E.then(a.shift(),a.shift());return E}for(var S=t;h.length;){var O=h.shift(),M=h.shift();try{S=O(S)}catch(P){M(P);break}}try{E=HA(S)}catch(P){return Promise.reject(P)}for(;x.length;)E=E.then(x.shift(),x.shift());return E};_p.prototype.getUri=function(t){return t=Vg(this.defaults,t),lj(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")};ZA.forEach(["delete","get","head","options"],function(t){_p.prototype[t]=function(s,h){return this.request(Vg(h||{},{method:t,url:s,data:(h||{}).data}))}});ZA.forEach(["post","put","patch"],function(t){_p.prototype[t]=function(s,h,_){return this.request(Vg(_||{},{method:t,url:s,data:h}))}});var cj=_p,uj=Fg;function Uh(i){if(typeof i!="function")throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(_){t=_});var s=this;this.promise.then(function(h){if(!!s._listeners){var _,x=s._listeners.length;for(_=0;_<x;_++)s._listeners[_](h);s._listeners=null}}),this.promise.then=function(h){var _,x=new Promise(function(E){s.subscribe(E),_=E}).then(h);return x.cancel=function(){s.unsubscribe(_)},x},i(function(_){s.reason||(s.reason=new uj(_),t(s.reason))})}Uh.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};Uh.prototype.subscribe=function(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]};Uh.prototype.unsubscribe=function(t){if(!!this._listeners){var s=this._listeners.indexOf(t);s!==-1&&this._listeners.splice(s,1)}};Uh.source=function(){var t,s=new Uh(function(_){t=_});return{token:s,cancel:t}};var hj=Uh,dj=function(t){return function(h){return t.apply(null,h)}},fj=function(t){return typeof t=="object"&&t.isAxiosError===!0},KA=ao,pj=kA,$g=cj,mj=$A,_j=jg;function YA(i){var t=new $g(i),s=pj($g.prototype.request,t);return KA.extend(s,$g.prototype,t),KA.extend(s,t),s.create=function(_){return YA(mj(i,_))},s}var Ts=YA(_j);Ts.Axios=$g;Ts.Cancel=Fg;Ts.CancelToken=hj;Ts.isCancel=jA;Ts.VERSION=GA.version;Ts.all=function(t){return Promise.all(t)};Ts.spread=dj;Ts.isAxiosError=fj;$x.exports=Ts;$x.exports.default=Ts;var G8=$x.exports,Gg=Object.assign,q8=ix({name:"VueHorizontal",data:()=>({left:0,width:0,scrollWidth:0,hasPrev:!1,hasNext:!1,debounceId:void 0}),props:{button:{type:Boolean,default:()=>!0},buttonBetween:{type:Boolean,default:()=>!0},scroll:{type:Boolean,default:()=>!1},displacement:{type:Number,default:()=>1},snap:{type:String,default:()=>"start"}},mounted(){this.onScrollDebounce()},beforeDestroy(){clearTimeout(this.debounceId)},methods:{children(){return this.$refs.container.children},findPrevSlot(i){const t=this.children();for(let s=0;s<t.length;s++){const h=t[s].getBoundingClientRect();if(h.left<=i&&i<=h.right||i<=h.left)return t[s]}},findNextSlot(i){const t=this.children();for(let s=0;s<t.length;s++){const h=t[s].getBoundingClientRect();if(!(h.right<=i)&&(h.left<=i||i<=h.left))return t[s]}},prev(i){i.stopPropagation(),this.$emit("prev");const t=this.$refs.container,s=t.getBoundingClientRect().left,h=s+t.clientWidth*-this.displacement-2.5,_=this.findPrevSlot(h);if(_){const E=_.getBoundingClientRect().left-s;return void this.scrollToLeft(t.scrollLeft+E)}const x=t.clientWidth*this.displacement;this.scrollToLeft(t.scrollLeft-x)},next(i){i.stopPropagation(),this.$emit("next");const t=this.$refs.container,s=t.getBoundingClientRect().left,h=s+t.clientWidth*this.displacement+2.5,_=this.findNextSlot(h);if(_){const E=_.getBoundingClientRect().left-s;if(E>2.5)return void this.scrollToLeft(t.scrollLeft+E)}const x=t.clientWidth*this.displacement;this.scrollToLeft(t.scrollLeft+x)},scrollToIndex(i){const t=this.children();if(t[i]){const s=this.$refs.container,h=t[i].getBoundingClientRect().left-s.getBoundingClientRect().left;this.scrollToLeft(s.scrollLeft+h)}},scrollToLeft(i,t="smooth"){this.$refs.container.scrollTo({left:i,behavior:t})},onScroll(){const i=this.$refs.container;i&&(this.$emit("scroll",{left:i.scrollLeft}),clearTimeout(this.debounceId),this.debounceId=setTimeout(this.onScrollDebounce,100))},onScrollDebounce(){return this.refresh(i=>{this.$emit("scroll-debounce",i)})},refresh(i){return gx(()=>{const t=this.calculate();this.left=t.left,this.width=t.width,this.scrollWidth=t.scrollWidth,this.hasNext=t.hasNext,this.hasPrev=t.hasPrev,i==null||i(t)})},calculate(){const i=this.$refs.container,t=this.children()[0];return{left:i.scrollLeft,width:i.clientWidth,scrollWidth:i.scrollWidth,hasNext:i.scrollWidth>i.scrollLeft+i.clientWidth+2.5,hasPrev:function(){var s,h;if(i.scrollLeft===0)return!1;const _=i.getBoundingClientRect().left,x=(h=(s=t==null?void 0:t.getBoundingClientRect())==null?void 0:s.left)!=null?h:0;return Math.abs(_-x)>=2.5}()}}},render(){const i=s=>{const h=ra("path",{d:"m9.8 12 5 5a1 1 0 1 1-1.4 1.4l-5.7-5.7a1 1 0 0 1 0-1.4l5.7-5.7a1 1 0 0 1 1.4 1.4l-5 5z"}),_=ra("path",{d:"m14.3 12.1-5-5a1 1 0 0 1 1.4-1.4l5.7 5.7a1 1 0 0 1 0 1.4l-5.7 5.7a1 1 0 0 1-1.4-1.4l5-5z"});return ra("svg",{class:"v-hl-svg",viewBox:"0 0 24 24","aria-label":`horizontal scroll area button for navigation to ${s==="prev"?"previous":"next"} section`,style:{width:"40px",height:"40px",margin:"6px",padding:"6px","border-radius":"20px","box-sizing":"border-box",background:"white",color:"black",fill:"currentColor","box-shadow":"0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24)"}},[s==="prev"?h:_])},t=s=>this.button&&(s!=="prev"||this.hasPrev)&&(s!=="next"||this.hasNext)?ra("div",{key:s==="prev"?0:1,class:`v-hl-btn v-hl-btn-${s}`,onClick:s==="prev"?this.prev:this.next,role:"button",style:Gg(Gg(Gg({},s==="prev"?{left:0,transform:this.buttonBetween?"translateX(-50%)":"none"}:{right:0,transform:this.buttonBetween?"translateX(50%)":"none"}),{cursor:"pointer",position:"absolute",top:0,bottom:0,display:"flex","align-self":"center","z-index":1,"align-items":"center"}),this.scroll?{}:{"overflow-x":"scroll","scrollbar-width":"none","-ms-overflow-style":"none","padding-bottom":"30px","margin-bottom":"-30px","clip-path":"inset(0 0 30px 0)"})},[s==="prev"?this.$slots["btn-prev"]?this.$slots["btn-prev"]():i("prev"):this.$slots["btn-next"]?this.$slots["btn-next"]():i("next")]):EF("",!0);return ra("div",{class:"vue-horizontal",style:{position:"relative",display:"flex"}},[t("prev"),t("next"),ra("div",{class:"v-hl-container",ref:"container",onScrollPassive:this.onScroll,style:Gg({display:"flex",width:"100%",margin:0,padding:0,border:"none","box-sizing":"content-box","overflow-x":"scroll","overflow-y":"hidden","scroll-snap-type":"x mandatory","-webkit-overflow-scrolling":"touch"},this.scroll?{}:{"scrollbar-width":"none","-ms-overflow-style":"none","padding-bottom":"30px","margin-bottom":"-30px","clip-path":"inset(0 0 30px 0)"})},(()=>{if(!this.$slots.default)return[];const s=_=>{_.props=_.props||{},_.props.style=_.props.style||{},_.props.style={"flex-shrink":0,"box-sizing":"border-box","min-height":"1px","scroll-snap-align":this.snap}},h=this.$slots.default();return h.forEach(_=>{if(_.el)return s(_);_.children&&Array.isArray(_.children)&&_.children.forEach(x=>{s(x)})}),h})())])}});/*!
  * vue-router v4.0.8
  * (c) 2021 Eduardo San Martin Morote
  * @license MIT
  */const JA=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",jh=i=>JA?Symbol(i):"_vr_"+i,gj=jh("rvlm"),QA=jh("rvd"),qg=jh("r"),eb=jh("rl"),tb=jh("rvl"),Vh=typeof window!="undefined";function yj(i){return i.__esModule||JA&&i[Symbol.toStringTag]==="Module"}const cn=Object.assign;function ib(i,t){const s={};for(const h in t){const _=t[h];s[h]=Array.isArray(_)?_.map(i):i(_)}return s}let Zg=()=>{};const vj=/\/$/,xj=i=>i.replace(vj,"");function nb(i,t,s="/"){let h,_={},x="",E="";const a=t.indexOf("?"),S=t.indexOf("#",a>-1?a:0);return a>-1&&(h=t.slice(0,a),x=t.slice(a+1,S>-1?S:t.length),_=i(x)),S>-1&&(h=h||t.slice(0,S),E=t.slice(S,t.length)),h=Tj(h!=null?h:t,s),{fullPath:h+(x&&"?")+x+E,path:h,query:_,hash:E}}function bj(i,t){let s=t.query?i(t.query):"";return t.path+(s&&"?")+s+(t.hash||"")}function eI(i,t){return!t||i.toLowerCase().indexOf(t.toLowerCase())?i:i.slice(t.length)||"/"}function wj(i,t,s){let h=t.matched.length-1,_=s.matched.length-1;return h>-1&&h===_&&$h(t.matched[h],s.matched[_])&&tI(t.params,s.params)&&i(t.query)===i(s.query)&&t.hash===s.hash}function $h(i,t){return(i.aliasOf||i)===(t.aliasOf||t)}function tI(i,t){if(Object.keys(i).length!==Object.keys(t).length)return!1;for(let s in i)if(!Ej(i[s],t[s]))return!1;return!0}function Ej(i,t){return Array.isArray(i)?iI(i,t):Array.isArray(t)?iI(t,i):i===t}function iI(i,t){return Array.isArray(t)?i.length===t.length&&i.every((s,h)=>s===t[h]):i.length===1&&i[0]===t}function Tj(i,t){if(i.startsWith("/"))return i;if(!i)return t;const s=t.split("/"),h=i.split("/");let _=s.length-1,x,E;for(x=0;x<h.length;x++)if(E=h[x],!(_===1||E==="."))if(E==="..")_--;else break;return s.slice(0,_).join("/")+"/"+h.slice(x-(x===h.length?1:0)).join("/")}var rb;(function(i){i.pop="pop",i.push="push"})(rb||(rb={}));var gp;(function(i){i.back="back",i.forward="forward",i.unknown=""})(gp||(gp={}));function Cj(i){if(!i)if(Vh){const t=document.querySelector("base");i=t&&t.getAttribute("href")||"/",i=i.replace(/^\w+:\/\/[^\/]+/,"")}else i="/";return i[0]!=="/"&&i[0]!=="#"&&(i="/"+i),xj(i)}const Sj=/^[^#]+#/;function Aj(i,t){return i.replace(Sj,"#")+t}function Ij(i,t){const s=document.documentElement.getBoundingClientRect(),h=i.getBoundingClientRect();return{behavior:t.behavior,left:h.left-s.left-(t.left||0),top:h.top-s.top-(t.top||0)}}const Wg=()=>({left:window.pageXOffset,top:window.pageYOffset});function Mj(i){let t;if("el"in i){let s=i.el;const h=typeof s=="string"&&s.startsWith("#"),_=typeof s=="string"?h?document.getElementById(s.slice(1)):document.querySelector(s):s;if(!_)return;t=Ij(_,i)}else t=i;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function nI(i,t){return(history.state?history.state.position-t:-1)+i}const ob=new Map;function kj(i,t){ob.set(i,t)}function Pj(i){const t=ob.get(i);return ob.delete(i),t}let Dj=()=>location.protocol+"//"+location.host;function rI(i,t){const{pathname:s,search:h,hash:_}=t,x=i.indexOf("#");if(x>-1){let a=_.includes(i.slice(x))?i.slice(x).length:1,S=_.slice(a);return S[0]!=="/"&&(S="/"+S),eI(S,"")}return eI(s,i)+h+_}function Lj(i,t,s,h){let _=[],x=[],E=null;const a=({state:z})=>{const q=rI(i,location),se=s.value,ue=t.value;let oe=0;if(z){if(s.value=q,t.value=z,E&&E===se){E=null;return}oe=ue?z.position-ue.position:0}else h(q);_.forEach(fe=>{fe(s.value,se,{delta:oe,type:rb.pop,direction:oe?oe>0?gp.forward:gp.back:gp.unknown})})};function S(){E=s.value}function O(z){_.push(z);const q=()=>{const se=_.indexOf(z);se>-1&&_.splice(se,1)};return x.push(q),q}function M(){const{history:z}=window;!z.state||z.replaceState(cn({},z.state,{scroll:Wg()}),"")}function P(){for(const z of x)z();x=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",M)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",M),{pauseListeners:S,listen:O,destroy:P}}function oI(i,t,s,h=!1,_=!1){return{back:i,current:t,forward:s,replaced:h,position:window.history.length,scroll:_?Wg():null}}function zj(i){const{history:t,location:s}=window;let h={value:rI(i,s)},_={value:t.state};_.value||x(h.value,{back:null,current:h.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function x(S,O,M){const P=i.indexOf("#"),z=P>-1?(s.host&&document.querySelector("base")?i:i.slice(P))+S:Dj()+i+S;try{t[M?"replaceState":"pushState"](O,"",z),_.value=O}catch(q){console.error(q),s[M?"replace":"assign"](z)}}function E(S,O){const M=cn({},t.state,oI(_.value.back,S,_.value.forward,!0),O,{position:_.value.position});x(S,M,!0),h.value=S}function a(S,O){const M=cn({},_.value,t.state,{forward:S,scroll:Wg()});x(M.current,M,!0);const P=cn({},oI(h.value,S,null),{position:M.position+1},O);x(S,P,!1),h.value=S}return{location:h,state:_,push:a,replace:E}}function Oj(i){i=Cj(i);const t=zj(i),s=Lj(i,t.state,t.location,t.replace);function h(x,E=!0){E||s.pauseListeners(),history.go(x)}const _=cn({location:"",base:i,go:h,createHref:Aj.bind(null,i)},t,s);return Object.defineProperty(_,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(_,"state",{enumerable:!0,get:()=>t.state.value}),_}function Z8(i){return i=location.host?i||location.pathname+location.search:"",i.indexOf("#")<0&&(i+="#"),Oj(i)}function Rj(i){return typeof i=="string"||i&&typeof i=="object"}function sI(i){return typeof i=="string"||typeof i=="symbol"}const kc={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},aI=jh("nf");var lI;(function(i){i[i.aborted=4]="aborted",i[i.cancelled=8]="cancelled",i[i.duplicated=16]="duplicated"})(lI||(lI={}));function Gh(i,t){return cn(new Error,{type:i,[aI]:!0},t)}function yp(i,t){return i instanceof Error&&aI in i&&(t==null||!!(i.type&t))}const cI="[^/]+?",Bj={sensitive:!1,strict:!1,start:!0,end:!0},Fj=/[.+*?^${}()[\]/\\]/g;function Nj(i,t){const s=cn({},Bj,t);let h=[],_=s.start?"^":"";const x=[];for(const O of i){const M=O.length?[]:[90];s.strict&&!O.length&&(_+="/");for(let P=0;P<O.length;P++){const z=O[P];let q=40+(s.sensitive?.25:0);if(z.type===0)P||(_+="/"),_+=z.value.replace(Fj,"\\$&"),q+=40;else if(z.type===1){const{value:se,repeatable:ue,optional:oe,regexp:fe}=z;x.push({name:se,repeatable:ue,optional:oe});const xe=fe||cI;if(xe!==cI){q+=10;try{new RegExp(`(${xe})`)}catch($e){throw new Error(`Invalid custom RegExp for param "${se}" (${xe}): `+$e.message)}}let Be=ue?`((?:${xe})(?:/(?:${xe}))*)`:`(${xe})`;P||(Be=oe&&O.length<2?`(?:/${Be})`:"/"+Be),oe&&(Be+="?"),_+=Be,q+=20,oe&&(q+=-8),ue&&(q+=-20),xe===".*"&&(q+=-50)}M.push(q)}h.push(M)}if(s.strict&&s.end){const O=h.length-1;h[O][h[O].length-1]+=.7000000000000001}s.strict||(_+="/?"),s.end?_+="$":s.strict&&(_+="(?:/|$)");const E=new RegExp(_,s.sensitive?"":"i");function a(O){const M=O.match(E),P={};if(!M)return null;for(let z=1;z<M.length;z++){const q=M[z]||"",se=x[z-1];P[se.name]=q&&se.repeatable?q.split("/"):q}return P}function S(O){let M="",P=!1;for(const z of i){(!P||!M.endsWith("/"))&&(M+="/"),P=!1;for(const q of z)if(q.type===0)M+=q.value;else if(q.type===1){const{value:se,repeatable:ue,optional:oe}=q,fe=se in O?O[se]:"";if(Array.isArray(fe)&&!ue)throw new Error(`Provided param "${se}" is an array but it is not repeatable (* or + modifiers)`);const xe=Array.isArray(fe)?fe.join("/"):fe;if(!xe)if(oe)z.length<2&&(M.endsWith("/")?M=M.slice(0,-1):P=!0);else throw new Error(`Missing required param "${se}"`);M+=xe}}return M}return{re:E,score:h,keys:x,parse:a,stringify:S}}function Uj(i,t){let s=0;for(;s<i.length&&s<t.length;){const h=t[s]-i[s];if(h)return h;s++}return i.length<t.length?i.length===1&&i[0]===40+40?-1:1:i.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function jj(i,t){let s=0;const h=i.score,_=t.score;for(;s<h.length&&s<_.length;){const x=Uj(h[s],_[s]);if(x)return x;s++}return _.length-h.length}const Vj={type:0,value:""},$j=/[a-zA-Z0-9_]/;function Gj(i){if(!i)return[[]];if(i==="/")return[[Vj]];if(!i.startsWith("/"))throw new Error(`Invalid path "${i}"`);function t(q){throw new Error(`ERR (${s})/"${O}": ${q}`)}let s=0,h=s;const _=[];let x;function E(){x&&_.push(x),x=[]}let a=0,S,O="",M="";function P(){!O||(s===0?x.push({type:0,value:O}):s===1||s===2||s===3?(x.length>1&&(S==="*"||S==="+")&&t(`A repeatable param (${O}) must be alone in its segment. eg: '/:ids+.`),x.push({type:1,value:O,regexp:M,repeatable:S==="*"||S==="+",optional:S==="*"||S==="?"})):t("Invalid state to consume buffer"),O="")}function z(){O+=S}for(;a<i.length;){if(S=i[a++],S==="\\"&&s!==2){h=s,s=4;continue}switch(s){case 0:S==="/"?(O&&P(),E()):S===":"?(P(),s=1):z();break;case 4:z(),s=h;break;case 1:S==="("?s=2:$j.test(S)?z():(P(),s=0,S!=="*"&&S!=="?"&&S!=="+"&&a--);break;case 2:S===")"?M[M.length-1]=="\\"?M=M.slice(0,-1)+S:s=3:M+=S;break;case 3:P(),s=0,S!=="*"&&S!=="?"&&S!=="+"&&a--,M="";break;default:t("Unknown state");break}}return s===2&&t(`Unfinished custom RegExp for param "${O}"`),P(),E(),_}function qj(i,t,s){const h=Nj(Gj(i.path),s),_=cn(h,{record:i,parent:t,children:[],alias:[]});return t&&!_.record.aliasOf==!t.record.aliasOf&&t.children.push(_),_}function Zj(i,t){const s=[],h=new Map;t=hI({strict:!1,end:!0,sensitive:!1},t);function _(M){return h.get(M)}function x(M,P,z){let q=!z,se=Hj(M);se.aliasOf=z&&z.record;const ue=hI(t,M),oe=[se];if("alias"in M){const Be=typeof M.alias=="string"?[M.alias]:M.alias;for(const $e of Be)oe.push(cn({},se,{components:z?z.record.components:se.components,path:$e,aliasOf:z?z.record:se}))}let fe,xe;for(const Be of oe){let{path:$e}=Be;if(P&&$e[0]!=="/"){let Ge=P.record.path,xt=Ge[Ge.length-1]==="/"?"":"/";Be.path=P.record.path+($e&&xt+$e)}if(fe=qj(Be,P,ue),z?z.alias.push(fe):(xe=xe||fe,xe!==fe&&xe.alias.push(fe),q&&M.name&&!uI(fe)&&E(M.name)),"children"in se){let Ge=se.children;for(let xt=0;xt<Ge.length;xt++)x(Ge[xt],fe,z&&z.children[xt])}z=z||fe,S(fe)}return xe?()=>{E(xe)}:Zg}function E(M){if(sI(M)){const P=h.get(M);P&&(h.delete(M),s.splice(s.indexOf(P),1),P.children.forEach(E),P.alias.forEach(E))}else{let P=s.indexOf(M);P>-1&&(s.splice(P,1),M.record.name&&h.delete(M.record.name),M.children.forEach(E),M.alias.forEach(E))}}function a(){return s}function S(M){let P=0;for(;P<s.length&&jj(M,s[P])>=0;)P++;s.splice(P,0,M),M.record.name&&!uI(M)&&h.set(M.record.name,M)}function O(M,P){let z,q={},se,ue;if("name"in M&&M.name){if(z=h.get(M.name),!z)throw Gh(1,{location:M});ue=z.record.name,q=cn(Wj(P.params,z.keys.filter(xe=>!xe.optional).map(xe=>xe.name)),M.params),se=z.stringify(q)}else if("path"in M)se=M.path,z=s.find(xe=>xe.re.test(se)),z&&(q=z.parse(se),ue=z.record.name);else{if(z=P.name?h.get(P.name):s.find(xe=>xe.re.test(P.path)),!z)throw Gh(1,{location:M,currentLocation:P});ue=z.record.name,q=cn({},P.params,M.params),se=z.stringify(q)}const oe=[];let fe=z;for(;fe;)oe.unshift(fe.record),fe=fe.parent;return{name:ue,path:se,params:q,matched:oe,meta:Kj(oe)}}return i.forEach(M=>x(M)),{addRoute:x,resolve:O,removeRoute:E,getRoutes:a,getRecordMatcher:_}}function Wj(i,t){let s={};for(let h of t)h in i&&(s[h]=i[h]);return s}function Hj(i){return{path:i.path,redirect:i.redirect,name:i.name,meta:i.meta||{},aliasOf:void 0,beforeEnter:i.beforeEnter,props:Xj(i),children:i.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in i?i.components||{}:{default:i.component}}}function Xj(i){const t={},s=i.props||!1;if("component"in i)t.default=s;else for(let h in i.components)t[h]=typeof s=="boolean"?s:s[h];return t}function uI(i){for(;i;){if(i.record.aliasOf)return!0;i=i.parent}return!1}function Kj(i){return i.reduce((t,s)=>cn(t,s.meta),{})}function hI(i,t){let s={};for(let h in i)s[h]=h in t?t[h]:i[h];return s}const dI=/#/g,Yj=/&/g,Jj=/\//g,Qj=/=/g,eV=/\?/g,fI=/\+/g,tV=/%5B/g,iV=/%5D/g,pI=/%5E/g,nV=/%60/g,mI=/%7B/g,rV=/%7C/g,_I=/%7D/g,oV=/%20/g;function sb(i){return encodeURI(""+i).replace(rV,"|").replace(tV,"[").replace(iV,"]")}function sV(i){return sb(i).replace(mI,"{").replace(_I,"}").replace(pI,"^")}function ab(i){return sb(i).replace(fI,"%2B").replace(oV,"+").replace(dI,"%23").replace(Yj,"%26").replace(nV,"`").replace(mI,"{").replace(_I,"}").replace(pI,"^")}function aV(i){return ab(i).replace(Qj,"%3D")}function lV(i){return sb(i).replace(dI,"%23").replace(eV,"%3F")}function cV(i){return lV(i).replace(Jj,"%2F")}function Hg(i){try{return decodeURIComponent(""+i)}catch{}return""+i}function uV(i){const t={};if(i===""||i==="?")return t;const h=(i[0]==="?"?i.slice(1):i).split("&");for(let _=0;_<h.length;++_){const x=h[_].replace(fI," ");let E=x.indexOf("="),a=Hg(E<0?x:x.slice(0,E));if(Object.prototype.hasOwnProperty(a))continue;let S=E<0?null:Hg(x.slice(E+1));if(a in t){let O=t[a];Array.isArray(O)||(O=t[a]=[O]),O.push(S)}else t[a]=S}return t}function gI(i){let t="";for(let s in i){const h=i[s];if(s=aV(s),h==null){h!==void 0&&(t+=(t.length?"&":"")+s);continue}(Array.isArray(h)?h.map(x=>x&&ab(x)):[h&&ab(h)]).forEach(x=>{x!==void 0&&(t+=(t.length?"&":"")+s,x!=null&&(t+="="+x))})}return t}function hV(i){const t={};for(let s in i){let h=i[s];h!==void 0&&(t[s]=Array.isArray(h)?h.map(_=>_==null?null:""+_):h==null?h:""+h)}return t}function vp(){let i=[];function t(h){return i.push(h),()=>{const _=i.indexOf(h);_>-1&&i.splice(_,1)}}function s(){i=[]}return{add:t,list:()=>i,reset:s}}function sl(i,t,s,h,_){const x=h&&(h.enterCallbacks[_]=h.enterCallbacks[_]||[]);return()=>new Promise((E,a)=>{const S=P=>{P===!1?a(Gh(4,{from:s,to:t})):P instanceof Error?a(P):Rj(P)?a(Gh(2,{from:t,to:P})):(x&&h.enterCallbacks[_]===x&&typeof P=="function"&&x.push(P),E())},O=i.call(h&&h.instances[_],t,s,S);let M=Promise.resolve(O);i.length<3&&(M=M.then(S)),M.catch(P=>a(P))})}function lb(i,t,s,h){const _=[];for(const x of i)for(const E in x.components){let a=x.components[E];if(!(t!=="beforeRouteEnter"&&!x.instances[E]))if(dV(a)){const O=(a.__vccOpts||a)[t];O&&_.push(sl(O,s,h,x,E))}else{let S=a();S=S.catch(console.error),_.push(()=>S.then(O=>{if(!O)return Promise.reject(new Error(`Couldn't resolve component "${E}" at "${x.path}"`));const M=yj(O)?O.default:O;x.components[E]=M;const z=(M.__vccOpts||M)[t];return z&&sl(z,s,h,x,E)()}))}}return _}function dV(i){return typeof i=="object"||"displayName"in i||"props"in i||"__vccOpts"in i}function fV(i){const t=vs(qg),s=vs(eb),h=ys(()=>t.resolve(Qf(i.to))),_=ys(()=>{let{matched:S}=h.value,{length:O}=S;const M=S[O-1];let P=s.matched;if(!M||!P.length)return-1;let z=P.findIndex($h.bind(null,M));if(z>-1)return z;let q=yI(S[O-2]);return O>1&&yI(M)===q&&P[P.length-1].path!==q?P.findIndex($h.bind(null,S[O-2])):z}),x=ys(()=>_.value>-1&&gV(s.params,h.value.params)),E=ys(()=>_.value>-1&&_.value===s.matched.length-1&&tI(s.params,h.value.params));function a(S={}){return _V(S)?t[Qf(i.replace)?"replace":"push"](Qf(i.to)):Promise.resolve()}return{route:h,href:ys(()=>h.value.href),isActive:x,isExactActive:E,navigate:a}}const pV=ix({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},setup(i,{slots:t}){const s=Yf(fV(i)),{options:h}=vs(qg),_=ys(()=>({[vI(i.activeClass,h.linkActiveClass,"router-link-active")]:s.isActive,[vI(i.exactActiveClass,h.linkExactActiveClass,"router-link-exact-active")]:s.isExactActive}));return()=>{const x=t.default&&t.default(s);return i.custom?x:ra("a",{"aria-current":s.isExactActive?i.ariaCurrentValue:null,href:s.href,onClick:s.navigate,class:_.value},x)}}}),mV=pV;function _V(i){if(!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)&&!i.defaultPrevented&&!(i.button!==void 0&&i.button!==0)){if(i.currentTarget&&i.currentTarget.getAttribute){const t=i.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return i.preventDefault&&i.preventDefault(),!0}}function gV(i,t){for(let s in t){let h=t[s],_=i[s];if(typeof h=="string"){if(h!==_)return!1}else if(!Array.isArray(_)||_.length!==h.length||h.some((x,E)=>x!==_[E]))return!1}return!0}function yI(i){return i?i.aliasOf?i.aliasOf.path:i.path:""}const vI=(i,t,s)=>i!=null?i:t!=null?t:s,yV=ix({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(i,{attrs:t,slots:s}){const h=vs(tb),_=ys(()=>i.route||h.value),x=vs(QA,0),E=ys(()=>_.value.matched[x]);hg(QA,x+1),hg(gj,E),hg(tb,_);const a=I3();return Tg(()=>[a.value,E.value,i.name],([S,O,M],[P,z,q])=>{O&&(O.instances[M]=S,z&&z!==O&&S&&S===P&&(O.leaveGuards.size||(O.leaveGuards=z.leaveGuards),O.updateGuards.size||(O.updateGuards=z.updateGuards))),S&&O&&(!z||!$h(O,z)||!P)&&(O.enterCallbacks[M]||[]).forEach(se=>se(S))},{flush:"post"}),()=>{const S=_.value,O=E.value,M=O&&O.components[i.name],P=i.name;if(!M)return xI(s.default,{Component:M,route:S});const z=O.props[i.name],q=z?z===!0?S.params:typeof z=="function"?z(S):z:null,ue=ra(M,cn({},q,t,{onVnodeUnmounted:oe=>{oe.component.isUnmounted&&(O.instances[P]=null)},ref:a}));return xI(s.default,{Component:ue,route:S})||ue}}});function xI(i,t){if(!i)return null;const s=i(t);return s.length===1?s[0]:s}const vV=yV;function W8(i){const t=Zj(i.routes,i);let s=i.parseQuery||uV,h=i.stringifyQuery||gI,_=i.history;const x=vp(),E=vp(),a=vp(),S=M3(kc);let O=kc;Vh&&i.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const M=ib.bind(null,Ne=>""+Ne),P=ib.bind(null,cV),z=ib.bind(null,Hg);function q(Ne,bt){let ct,It;return sI(Ne)?(ct=t.getRecordMatcher(Ne),It=bt):It=Ne,t.addRoute(It,ct)}function se(Ne){let bt=t.getRecordMatcher(Ne);bt&&t.removeRoute(bt)}function ue(){return t.getRoutes().map(Ne=>Ne.record)}function oe(Ne){return!!t.getRecordMatcher(Ne)}function fe(Ne,bt){if(bt=cn({},bt||S.value),typeof Ne=="string"){let Wt=nb(s,Ne,bt.path),de=t.resolve({path:Wt.path},bt),me=_.createHref(Wt.fullPath);return cn(Wt,de,{params:z(de.params),hash:Hg(Wt.hash),redirectedFrom:void 0,href:me})}let ct;"path"in Ne?ct=cn({},Ne,{path:nb(s,Ne.path,bt.path).path}):(ct=cn({},Ne,{params:P(Ne.params)}),bt.params=P(bt.params));let It=t.resolve(ct,bt);const wi=Ne.hash||"";It.params=M(z(It.params));const di=bj(h,cn({},Ne,{hash:sV(wi),path:It.path}));let ti=_.createHref(di);return cn({fullPath:di,hash:wi,query:h===gI?hV(Ne.query):Ne.query},It,{redirectedFrom:void 0,href:ti})}function xe(Ne){return typeof Ne=="string"?nb(s,Ne,S.value.path):cn({},Ne)}function Be(Ne,bt){if(O!==Ne)return Gh(8,{from:bt,to:Ne})}function $e(Ne){return pt(Ne)}function Ge(Ne){return $e(cn(xe(Ne),{replace:!0}))}function xt(Ne){const bt=Ne.matched[Ne.matched.length-1];if(bt&&bt.redirect){const{redirect:ct}=bt;let It=typeof ct=="function"?ct(Ne):ct;return typeof It=="string"&&(It=It.indexOf("?")>-1||It.indexOf("#")>-1?It=xe(It):{path:It}),cn({query:Ne.query,hash:Ne.hash,params:Ne.params},It)}}function pt(Ne,bt){const ct=O=fe(Ne),It=S.value,wi=Ne.state,di=Ne.force,ti=Ne.replace===!0,Wt=xt(ct);if(Wt)return pt(cn(xe(Wt),{state:wi,force:di,replace:ti}),bt||ct);const de=ct;de.redirectedFrom=bt;let me;return!di&&wj(h,It,ct)&&(me=Gh(16,{to:de,from:It}),sn(It,It,!0,!1)),(me?Promise.resolve(me):Dt(de,It)).catch(Le=>yp(Le)?Le:ri(Le)).then(Le=>{if(Le){if(yp(Le,2))return pt(cn(xe(Le.to),{state:wi,force:di,replace:ti}),bt||de)}else Le=ai(de,It,!0,ti,wi);return Ft(de,It,Le),Le})}function jt(Ne,bt){const ct=Be(Ne,bt);return ct?Promise.reject(ct):Promise.resolve()}function Dt(Ne,bt){let ct;const[It,wi,di]=xV(Ne,bt);ct=lb(It.reverse(),"beforeRouteLeave",Ne,bt);for(const Wt of It)Wt.leaveGuards.forEach(de=>{ct.push(sl(de,Ne,bt))});const ti=jt.bind(null,Ne,bt);return ct.push(ti),qh(ct).then(()=>{ct=[];for(const Wt of x.list())ct.push(sl(Wt,Ne,bt));return ct.push(ti),qh(ct)}).then(()=>{ct=lb(wi,"beforeRouteUpdate",Ne,bt);for(const Wt of wi)Wt.updateGuards.forEach(de=>{ct.push(sl(de,Ne,bt))});return ct.push(ti),qh(ct)}).then(()=>{ct=[];for(const Wt of Ne.matched)if(Wt.beforeEnter&&bt.matched.indexOf(Wt)<0)if(Array.isArray(Wt.beforeEnter))for(const de of Wt.beforeEnter)ct.push(sl(de,Ne,bt));else ct.push(sl(Wt.beforeEnter,Ne,bt));return ct.push(ti),qh(ct)}).then(()=>(Ne.matched.forEach(Wt=>Wt.enterCallbacks={}),ct=lb(di,"beforeRouteEnter",Ne,bt),ct.push(ti),qh(ct))).then(()=>{ct=[];for(const Wt of E.list())ct.push(sl(Wt,Ne,bt));return ct.push(ti),qh(ct)}).catch(Wt=>yp(Wt,8)?Wt:Promise.reject(Wt))}function Ft(Ne,bt,ct){for(const It of a.list())It(Ne,bt,ct)}function ai(Ne,bt,ct,It,wi){const di=Be(Ne,bt);if(di)return di;const ti=bt===kc,Wt=Vh?history.state:{};ct&&(It||ti?_.replace(Ne.fullPath,cn({scroll:ti&&Wt&&Wt.scroll},wi)):_.push(Ne.fullPath,wi)),S.value=Ne,sn(Ne,bt,ct,ti),Wi()}let wt;function Nt(){wt=_.listen((Ne,bt,ct)=>{let It=fe(Ne);const wi=xt(It);if(wi){pt(cn(wi,{replace:!0}),It).catch(Zg);return}O=It;const di=S.value;Vh&&kj(nI(di.fullPath,ct.delta),Wg()),Dt(It,di).catch(ti=>yp(ti,4|8)?ti:yp(ti,2)?(pt(ti.to,It).catch(Zg),Promise.reject()):(ct.delta&&_.go(-ct.delta,!1),ri(ti))).then(ti=>{ti=ti||ai(It,di,!1),ti&&ct.delta&&_.go(-ct.delta,!1),Ft(It,di,ti)}).catch(Zg)})}let qi=vp(),bn=vp(),hi;function ri(Ne){return Wi(Ne),bn.list().forEach(bt=>bt(Ne)),Promise.reject(Ne)}function ei(){return hi&&S.value!==kc?Promise.resolve():new Promise((Ne,bt)=>{qi.add([Ne,bt])})}function Wi(Ne){hi||(hi=!0,Nt(),qi.list().forEach(([bt,ct])=>Ne?ct(Ne):bt()),qi.reset())}function sn(Ne,bt,ct,It){const{scrollBehavior:wi}=i;if(!Vh||!wi)return Promise.resolve();let di=!ct&&Pj(nI(Ne.fullPath,0))||(It||!ct)&&history.state&&history.state.scroll||null;return gx().then(()=>wi(Ne,bt,di)).then(ti=>ti&&Mj(ti)).catch(ri)}const kn=Ne=>_.go(Ne);let oi;const Si=new Set;return{currentRoute:S,addRoute:q,removeRoute:se,hasRoute:oe,getRoutes:ue,resolve:fe,options:i,push:$e,replace:Ge,go:kn,back:()=>kn(-1),forward:()=>kn(1),beforeEach:x.add,beforeResolve:E.add,afterEach:a.add,onError:bn.add,isReady:ei,install(Ne){const bt=this;Ne.component("RouterLink",mV),Ne.component("RouterView",vV),Ne.config.globalProperties.$router=bt,Object.defineProperty(Ne.config.globalProperties,"$route",{enumerable:!0,get:()=>Qf(S)}),Vh&&!oi&&S.value===kc&&(oi=!0,$e(_.location).catch(wi=>{}));const ct={};for(let wi in kc)ct[wi]=ys(()=>S.value[wi]);Ne.provide(qg,bt),Ne.provide(eb,Yf(ct)),Ne.provide(tb,S);let It=Ne.unmount;Si.add(Ne),Ne.unmount=function(){Si.delete(Ne),Si.size<1&&(wt(),S.value=kc,oi=!1,hi=!1),It()}}}}function qh(i){return i.reduce((t,s)=>t.then(()=>s()),Promise.resolve())}function xV(i,t){const s=[],h=[],_=[],x=Math.max(t.matched.length,i.matched.length);for(let E=0;E<x;E++){const a=t.matched[E];a&&(i.matched.find(O=>$h(O,a))?h.push(a):s.push(a));const S=i.matched[E];S&&(t.matched.find(O=>$h(O,S))||_.push(S))}return[s,h,_]}function H8(){return vs(qg)}function X8(){return vs(eb)}const bI={subpremise:"short_name",street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"short_name",administrative_area_level_2:"long_name",country:"long_name",postal_code:"short_name"},bV=["locality","administrative_area_level_3"],wV=["locality","sublocality","postal_code","country","administrative_area_level_1","administrative_area_level_2"],EV=["address_components","adr_address","alt_id","formatted_address","geometry","icon","id","name","business_status","photo","place_id","scope","type","url","utc_offset_minutes","vicinity"],TV={name:"VueGoogleAutocomplete",props:{id:{type:String,required:!0},classname:String,placeholder:{type:String,default:"Start typing"},disabled:{type:Boolean,default:!1},types:{type:String,default:"address"},fields:{type:Array,default:function(){return EV}},country:{type:[String,Array],default:null},enableGeolocation:{type:Boolean,default:!1},geolocationOptions:{type:Object,default:null}},data(){return{autocomplete:null,autocompleteText:"",geolocation:{geocoder:null,loc:null,position:null}}},watch:{autocompleteText:function(i,t){this.$emit("inputChange",{newVal:i,oldVal:t},this.id)},country:function(i,t){this.autocomplete.setComponentRestrictions({country:this.country===null?[]:this.country})}},mounted:function(){const i={};this.types&&(i.types=[this.types]),this.country&&(i.componentRestrictions={country:this.country}),this.autocomplete=new google.maps.places.Autocomplete(document.getElementById(this.id),i),this.autocomplete.setFields(this.fields),this.autocomplete.addListener("place_changed",this.onPlaceChanged)},methods:{onPlaceChanged(){let i=this.autocomplete.getPlace();if(!i.geometry){this.$emit("no-results-found",i,this.id);return}i.address_components!==void 0&&(this.$emit("placechanged",this.formatResult(i),i,this.id),this.autocompleteText=document.getElementById(this.id).value,this.onChange())},onFocus(){this.biasAutocompleteLocation(),this.$emit("focus")},onBlur(){this.$emit("blur")},onChange(){this.$emit("change",this.autocompleteText)},onKeyPress(i){this.$emit("keypress",i)},onKeyUp(i){this.$emit("keyup",i)},clear(){this.autocompleteText=""},focus(){this.$refs.autocomplete.focus()},blur(){this.$refs.autocomplete.blur()},update(i){this.autocompleteText=i},updateCoordinates(i){!i&&!(i.lat||i.lng)||(this.geolocation.geocoder||(this.geolocation.geocoder=new google.maps.Geocoder),this.geolocation.geocoder.geocode({location:i},(t,s)=>{s==="OK"?(t=this.filterGeocodeResultTypes(t),t[0]?(this.$emit("placechanged",this.formatResult(t[0]),t[0],this.id),this.update(t[0].formatted_address)):this.$emit("error","no result for provided coordinates")):this.$emit("error","error getting address from coords")}))},geolocate(){this.updateGeolocation((i,t)=>{this.updateCoordinates(i)})},updateGeolocation(i=null){if(navigator.geolocation){let t={};this.geolocationOptions&&Object.assign(t,this.geolocationOptions),navigator.geolocation.getCurrentPosition(s=>{let h={lat:s.coords.latitude,lng:s.coords.longitude};this.geolocation.loc=h,this.geolocation.position=s,i&&i(h,s)},s=>{this.$emit("error","Cannot get Coordinates from navigator",s)},t)}},biasAutocompleteLocation(){this.enableGeolocation&&this.updateGeolocation((i,t)=>{let s=new google.maps.Circle({center:i,radius:t.coords.accuracy});this.autocomplete.setBounds(s.getBounds())})},formatResult(i){let t={};for(let s=0;s<i.address_components.length;s++){let h=i.address_components[s].types[0];if(bI[h]){let _=i.address_components[s][bI[h]];t[h]=_}}return t.latitude=i.geometry.location.lat(),t.longitude=i.geometry.location.lng(),t},filterGeocodeResultTypes(i){if(!i||!this.types)return i;let t=[],s=[this.types];s.includes("(cities)")&&(s=s.concat(bV)),s.includes("(regions)")&&(s=s.concat(wV));for(let h of i)for(let _ of h.types)if(s.includes(_)){t.push(h);break}return t}}},CV=["id","placeholder","disabled"];function SV(i,t,s,h,_,x){return cF((ux(),vF("input",{ref:"autocomplete",type:"text",class:Z_(s.classname),id:s.id,placeholder:s.placeholder,disabled:s.disabled,"onUpdate:modelValue":t[0]||(t[0]=E=>_.autocompleteText=E),onFocus:t[1]||(t[1]=E=>x.onFocus()),onBlur:t[2]||(t[2]=E=>x.onBlur()),onChange:t[3]||(t[3]=(...E)=>x.onChange&&x.onChange(...E)),onKeypress:t[4]||(t[4]=(...E)=>x.onKeyPress&&x.onKeyPress(...E)),onKeyup:t[5]||(t[5]=(...E)=>x.onKeyUp&&x.onKeyUp(...E))},null,42,CV)),[[fN,_.autocompleteText]])}var K8=vN(TV,[["render",SV]]);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var cb=function(i,t){return cb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,h){s.__proto__=h}||function(s,h){for(var _ in h)Object.prototype.hasOwnProperty.call(h,_)&&(s[_]=h[_])},cb(i,t)};function Zh(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function s(){this.constructor=i}cb(i,t),i.prototype=t===null?Object.create(t):(s.prototype=t.prototype,new s)}var gi=function(){return gi=Object.assign||function(i){for(var t,s=1,h=arguments.length;s<h;s++)for(var _ in t=arguments[s])Object.prototype.hasOwnProperty.call(t,_)&&(i[_]=t[_]);return i},gi.apply(this,arguments)};function Zr(i,t){var s={};for(var h in i)Object.prototype.hasOwnProperty.call(i,h)&&t.indexOf(h)<0&&(s[h]=i[h]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function"){var _=0;for(h=Object.getOwnPropertySymbols(i);_<h.length;_++)t.indexOf(h[_])<0&&Object.prototype.propertyIsEnumerable.call(i,h[_])&&(s[h[_]]=i[h[_]])}return s}function Bi(i,t,s,h){return new(s||(s=Promise))(function(_,x){function E(O){try{S(h.next(O))}catch(M){x(M)}}function a(O){try{S(h.throw(O))}catch(M){x(M)}}function S(O){var M;O.done?_(O.value):(M=O.value,M instanceof s?M:new s(function(P){P(M)})).then(E,a)}S((h=h.apply(i,t||[])).next())})}function Fi(i,t){var s,h,_,x,E={label:0,sent:function(){if(1&_[0])throw _[1];return _[1]},trys:[],ops:[]};return x={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function a(S){return function(O){return function(M){if(s)throw new TypeError("Generator is already executing.");for(;E;)try{if(s=1,h&&(_=2&M[0]?h.return:M[0]?h.throw||((_=h.return)&&_.call(h),0):h.next)&&!(_=_.call(h,M[1])).done)return _;switch(h=0,_&&(M=[2&M[0],_.value]),M[0]){case 0:case 1:_=M;break;case 4:return E.label++,{value:M[1],done:!1};case 5:E.label++,h=M[1],M=[0];continue;case 7:M=E.ops.pop(),E.trys.pop();continue;default:if(_=E.trys,!((_=_.length>0&&_[_.length-1])||M[0]!==6&&M[0]!==2)){E=0;continue}if(M[0]===3&&(!_||M[1]>_[0]&&M[1]<_[3])){E.label=M[1];break}if(M[0]===6&&E.label<_[1]){E.label=_[1],_=M;break}if(_&&E.label<_[2]){E.label=_[2],E.ops.push(M);break}_[2]&&E.ops.pop(),E.trys.pop();continue}M=t.call(i,E)}catch(P){M=[6,P],h=0}finally{s=_=0}if(5&M[0])throw M[1];return{value:M[0]?M[1]:void 0,done:!0}}([S,O])}}}function Wh(i,t){var s=typeof Symbol=="function"&&i[Symbol.iterator];if(!s)return i;var h,_,x=s.call(i),E=[];try{for(;(t===void 0||t-- >0)&&!(h=x.next()).done;)E.push(h.value)}catch(a){_={error:a}}finally{try{h&&!h.done&&(s=x.return)&&s.call(x)}finally{if(_)throw _.error}}return E}function ub(i,t,s){if(s||arguments.length===2)for(var h,_=0,x=t.length;_<x;_++)!h&&_ in t||(h||(h=Array.prototype.slice.call(t,0,_)),h[_]=t[_]);return i.concat(h||Array.prototype.slice.call(t))}var Cs=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function hb(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function Hh(i,t){return i(t={exports:{}},t.exports),t.exports}var al,Xg,Kg=function(i){return i&&i.Math==Math&&i},At=Kg(typeof globalThis=="object"&&globalThis)||Kg(typeof window=="object"&&window)||Kg(typeof self=="object"&&self)||Kg(typeof Cs=="object"&&Cs)||function(){return this}()||Function("return this")(),An=function(i){try{return!!i()}catch{return!0}},un=!An(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),xp=!An(function(){var i=function(){}.bind();return typeof i!="function"||i.hasOwnProperty("prototype")}),Yg=Function.prototype.call,Er=xp?Yg.bind(Yg):function(){return Yg.apply(Yg,arguments)},wI={}.propertyIsEnumerable,EI=Object.getOwnPropertyDescriptor,AV=EI&&!wI.call({1:2},1)?function(i){var t=EI(this,i);return!!t&&t.enumerable}:wI,db={f:AV},Pc=function(i,t){return{enumerable:!(1&i),configurable:!(2&i),writable:!(4&i),value:t}},TI=Function.prototype,IV=TI.bind,fb=TI.call,MV=xp&&IV.bind(fb,fb),Ni=xp?function(i){return i&&MV(i)}:function(i){return i&&function(){return fb.apply(i,arguments)}},kV=Ni({}.toString),PV=Ni("".slice),oa=function(i){return PV(kV(i),8,-1)},pb=At.Object,DV=Ni("".split),CI=An(function(){return!pb("z").propertyIsEnumerable(0)})?function(i){return oa(i)=="String"?DV(i,""):pb(i)}:pb,LV=At.TypeError,bp=function(i){if(i==null)throw LV("Can't call method on "+i);return i},Ss=function(i){return CI(bp(i))},pn=function(i){return typeof i=="function"},In=function(i){return typeof i=="object"?i!==null:pn(i)},zV=function(i){return pn(i)?i:void 0},Dc=function(i,t){return arguments.length<2?zV(At[i]):At[i]&&At[i][t]},Lc=Ni({}.isPrototypeOf),mb=Dc("navigator","userAgent")||"",SI=At.process,AI=At.Deno,II=SI&&SI.versions||AI&&AI.version,MI=II&&II.v8;MI&&(Xg=(al=MI.split("."))[0]>0&&al[0]<4?1:+(al[0]+al[1])),!Xg&&mb&&(!(al=mb.match(/Edge\/(\d+)/))||al[1]>=74)&&(al=mb.match(/Chrome\/(\d+)/))&&(Xg=+al[1]);var Jg=Xg,As=!!Object.getOwnPropertySymbols&&!An(function(){var i=Symbol();return!String(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&Jg&&Jg<41}),_b=As&&!Symbol.sham&&typeof Symbol.iterator=="symbol",OV=At.Object,Xh=_b?function(i){return typeof i=="symbol"}:function(i){var t=Dc("Symbol");return pn(t)&&Lc(t.prototype,OV(i))},RV=At.String,wp=function(i){try{return RV(i)}catch{return"Object"}},BV=At.TypeError,gb=function(i){if(pn(i))return i;throw BV(wp(i)+" is not a function")},Qg=function(i,t){var s=i[t];return s==null?void 0:gb(s)},FV=At.TypeError,NV=Object.defineProperty,yb=function(i,t){try{NV(At,i,{value:t,configurable:!0,writable:!0})}catch{At[i]=t}return t},ll=At["__core-js_shared__"]||yb("__core-js_shared__",{}),zc=Hh(function(i){(i.exports=function(t,s){return ll[t]||(ll[t]=s!==void 0?s:{})})("versions",[]).push({version:"3.21.1",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.1/LICENSE",source:"https://github.com/zloirock/core-js"})}),UV=At.Object,Kh=function(i){return UV(bp(i))},jV=Ni({}.hasOwnProperty),Yt=Object.hasOwn||function(i,t){return jV(Kh(i),t)},VV=0,$V=Math.random(),GV=Ni(1 .toString),Oc=function(i){return"Symbol("+(i===void 0?"":i)+")_"+GV(++VV+$V,36)},Ep=zc("wks"),Rc=At.Symbol,kI=Rc&&Rc.for,qV=_b?Rc:Rc&&Rc.withoutSetter||Oc,Ln=function(i){if(!Yt(Ep,i)||!As&&typeof Ep[i]!="string"){var t="Symbol."+i;As&&Yt(Rc,i)?Ep[i]=Rc[i]:Ep[i]=_b&&kI?kI(t):qV(t)}return Ep[i]},ZV=At.TypeError,WV=Ln("toPrimitive"),HV=function(i,t){if(!In(i)||Xh(i))return i;var s,h=Qg(i,WV);if(h){if(t===void 0&&(t="default"),s=Er(h,i,t),!In(s)||Xh(s))return s;throw ZV("Can't convert object to primitive value")}return t===void 0&&(t="number"),function(_,x){var E,a;if(x==="string"&&pn(E=_.toString)&&!In(a=Er(E,_))||pn(E=_.valueOf)&&!In(a=Er(E,_))||x!=="string"&&pn(E=_.toString)&&!In(a=Er(E,_)))return a;throw FV("Can't convert object to primitive value")}(i,t)},Bc=function(i){var t=HV(i,"string");return Xh(t)?t:t+""},vb=At.document,XV=In(vb)&&In(vb.createElement),PI=function(i){return XV?vb.createElement(i):{}},DI=!un&&!An(function(){return Object.defineProperty(PI("div"),"a",{get:function(){return 7}}).a!=7}),LI=Object.getOwnPropertyDescriptor,Tp={f:un?LI:function(i,t){if(i=Ss(i),t=Bc(t),DI)try{return LI(i,t)}catch{}if(Yt(i,t))return Pc(!Er(db.f,i,t),i[t])}},zI=un&&An(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),KV=At.String,YV=At.TypeError,Xn=function(i){if(In(i))return i;throw YV(KV(i)+" is not an object")},JV=At.TypeError,xb=Object.defineProperty,QV=Object.getOwnPropertyDescriptor,Tr={f:un?zI?function(i,t,s){if(Xn(i),t=Bc(t),Xn(s),typeof i=="function"&&t==="prototype"&&"value"in s&&"writable"in s&&!s.writable){var h=QV(i,t);h&&h.writable&&(i[t]=s.value,s={configurable:"configurable"in s?s.configurable:h.configurable,enumerable:"enumerable"in s?s.enumerable:h.enumerable,writable:!1})}return xb(i,t,s)}:xb:function(i,t,s){if(Xn(i),t=Bc(t),Xn(s),DI)try{return xb(i,t,s)}catch{}if("get"in s||"set"in s)throw JV("Accessors not supported");return"value"in s&&(i[t]=s.value),i}},cl=un?function(i,t,s){return Tr.f(i,t,Pc(1,s))}:function(i,t,s){return i[t]=s,i},e6=Ni(Function.toString);pn(ll.inspectSource)||(ll.inspectSource=function(i){return e6(i)});var ey,Cp,ty,bb=ll.inspectSource,OI=At.WeakMap,t6=pn(OI)&&/native code/.test(bb(OI)),RI=zc("keys"),iy=function(i){return RI[i]||(RI[i]=Oc(i))},Yh={},wb=At.TypeError,i6=At.WeakMap;if(t6||ll.state){var Fc=ll.state||(ll.state=new i6),n6=Ni(Fc.get),BI=Ni(Fc.has),r6=Ni(Fc.set);ey=function(i,t){if(BI(Fc,i))throw new wb("Object already initialized");return t.facade=i,r6(Fc,i,t),t},Cp=function(i){return n6(Fc,i)||{}},ty=function(i){return BI(Fc,i)}}else{var Jh=iy("state");Yh[Jh]=!0,ey=function(i,t){if(Yt(i,Jh))throw new wb("Object already initialized");return t.facade=i,cl(i,Jh,t),t},Cp=function(i){return Yt(i,Jh)?i[Jh]:{}},ty=function(i){return Yt(i,Jh)}}var Is={set:ey,get:Cp,has:ty,enforce:function(i){return ty(i)?Cp(i):ey(i,{})},getterFor:function(i){return function(t){var s;if(!In(t)||(s=Cp(t)).type!==i)throw wb("Incompatible receiver, "+i+" required");return s}}},FI=Function.prototype,o6=un&&Object.getOwnPropertyDescriptor,Eb=Yt(FI,"name"),Tb={EXISTS:Eb,PROPER:Eb&&function(){}.name==="something",CONFIGURABLE:Eb&&(!un||un&&o6(FI,"name").configurable)},Cr=Hh(function(i){var t=Tb.CONFIGURABLE,s=Is.get,h=Is.enforce,_=String(String).split("String");(i.exports=function(x,E,a,S){var O,M=!!S&&!!S.unsafe,P=!!S&&!!S.enumerable,z=!!S&&!!S.noTargetGet,q=S&&S.name!==void 0?S.name:E;pn(a)&&(String(q).slice(0,7)==="Symbol("&&(q="["+String(q).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!Yt(a,"name")||t&&a.name!==q)&&cl(a,"name",q),(O=h(a)).source||(O.source=_.join(typeof q=="string"?q:""))),x!==At?(M?!z&&x[E]&&(P=!0):delete x[E],P?x[E]=a:cl(x,E,a)):P?x[E]=a:yb(E,a)})(Function.prototype,"toString",function(){return pn(this)&&s(this).source||bb(this)})}),s6=Math.ceil,a6=Math.floor,Cb=function(i){var t=+i;return t!=t||t===0?0:(t>0?a6:s6)(t)},l6=Math.max,c6=Math.min,Sb=function(i,t){var s=Cb(i);return s<0?l6(s+t,0):c6(s,t)},u6=Math.min,NI=function(i){return i>0?u6(Cb(i),9007199254740991):0},Qh=function(i){return NI(i.length)},UI=function(i){return function(t,s,h){var _,x=Ss(t),E=Qh(x),a=Sb(h,E);if(i&&s!=s){for(;E>a;)if((_=x[a++])!=_)return!0}else for(;E>a;a++)if((i||a in x)&&x[a]===s)return i||a||0;return!i&&-1}},jI={includes:UI(!0),indexOf:UI(!1)},h6=jI.indexOf,VI=Ni([].push),$I=function(i,t){var s,h=Ss(i),_=0,x=[];for(s in h)!Yt(Yh,s)&&Yt(h,s)&&VI(x,s);for(;t.length>_;)Yt(h,s=t[_++])&&(~h6(x,s)||VI(x,s));return x},ny=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],d6=ny.concat("length","prototype"),Sp={f:Object.getOwnPropertyNames||function(i){return $I(i,d6)}},ry={f:Object.getOwnPropertySymbols},f6=Ni([].concat),p6=Dc("Reflect","ownKeys")||function(i){var t=Sp.f(Xn(i)),s=ry.f;return s?f6(t,s(i)):t},GI=function(i,t,s){for(var h=p6(t),_=Tr.f,x=Tp.f,E=0;E<h.length;E++){var a=h[E];Yt(i,a)||s&&Yt(s,a)||_(i,a,x(t,a))}},m6=/#|\.prototype\./,Ap=function(i,t){var s=g6[_6(i)];return s==v6||s!=y6&&(pn(t)?An(t):!!t)},_6=Ap.normalize=function(i){return String(i).replace(m6,".").toLowerCase()},g6=Ap.data={},y6=Ap.NATIVE="N",v6=Ap.POLYFILL="P",Ab=Ap,x6=Tp.f,mr=function(i,t){var s,h,_,x,E,a=i.target,S=i.global,O=i.stat;if(s=S?At:O?At[a]||yb(a,{}):(At[a]||{}).prototype)for(h in t){if(x=t[h],_=i.noTargetGet?(E=x6(s,h))&&E.value:s[h],!Ab(S?h:a+(O?".":"#")+h,i.forced)&&_!==void 0){if(typeof x==typeof _)continue;GI(x,_)}(i.sham||_&&_.sham)&&cl(x,"sham",!0),Cr(s,h,x,i)}},qI={};qI[Ln("toStringTag")]="z";var Ib,Mb=String(qI)==="[object z]",b6=Ln("toStringTag"),w6=At.Object,E6=oa(function(){return arguments}())=="Arguments",Nc=Mb?oa:function(i){var t,s,h;return i===void 0?"Undefined":i===null?"Null":typeof(s=function(_,x){try{return _[x]}catch{}}(t=w6(i),b6))=="string"?s:E6?oa(t):(h=oa(t))=="Object"&&pn(t.callee)?"Arguments":h},T6=At.String,sa=function(i){if(Nc(i)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return T6(i)},C6=Ln("match"),S6=At.TypeError,ZI=function(i){if(function(t){var s;return In(t)&&((s=t[C6])!==void 0?!!s:oa(t)=="RegExp")}(i))throw S6("The method doesn't accept regular expressions");return i},A6=Ln("match"),WI=function(i){var t=/./;try{"/./"[i](t)}catch{try{return t[A6]=!1,"/./"[i](t)}catch{}}return!1},I6=Tp.f,HI=Ni("".startsWith),M6=Ni("".slice),k6=Math.min,XI=WI("startsWith"),P6=!(XI||(Ib=I6(String.prototype,"startsWith"),!Ib||Ib.writable));mr({target:"String",proto:!0,forced:!P6&&!XI},{startsWith:function(i){var t=sa(bp(this));ZI(i);var s=NI(k6(arguments.length>1?arguments[1]:void 0,t.length)),h=sa(i);return HI?HI(t,h,s):M6(t,s,s+h.length)===h}});var kb=function(i,t){return Ni(At[i].prototype[t])};kb("String","startsWith");var oy=Array.isArray||function(i){return oa(i)=="Array"},Ip=function(i,t,s){var h=Bc(t);h in i?Tr.f(i,h,Pc(0,s)):i[h]=s},KI=function(){},D6=[],YI=Dc("Reflect","construct"),Pb=/^\s*(?:class|function)\b/,L6=Ni(Pb.exec),z6=!Pb.exec(KI),Mp=function(i){if(!pn(i))return!1;try{return YI(KI,D6,i),!0}catch{return!1}},JI=function(i){if(!pn(i))return!1;switch(Nc(i)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return z6||!!L6(Pb,bb(i))}catch{return!0}};JI.sham=!0;var QI,Db=!YI||An(function(){var i;return Mp(Mp.call)||!Mp(Object)||!Mp(function(){i=!0})||i})?JI:Mp,O6=Ln("species"),eM=At.Array,tM=function(i,t){return new(function(s){var h;return oy(s)&&(h=s.constructor,(Db(h)&&(h===eM||oy(h.prototype))||In(h)&&(h=h[O6])===null)&&(h=void 0)),h===void 0?eM:h}(i))(t===0?0:t)},R6=Ln("species"),iM=Ln("isConcatSpreadable"),nM=At.TypeError,B6=Jg>=51||!An(function(){var i=[];return i[iM]=!1,i.concat()[0]!==i}),F6=(QI="concat",Jg>=51||!An(function(){var i=[];return(i.constructor={})[R6]=function(){return{foo:1}},i[QI](Boolean).foo!==1})),N6=function(i){if(!In(i))return!1;var t=i[iM];return t!==void 0?!!t:oy(i)};mr({target:"Array",proto:!0,forced:!B6||!F6},{concat:function(i){var t,s,h,_,x,E=Kh(this),a=tM(E,0),S=0;for(t=-1,h=arguments.length;t<h;t++)if(N6(x=t===-1?E:arguments[t])){if(S+(_=Qh(x))>9007199254740991)throw nM("Maximum allowed index exceeded");for(s=0;s<_;s++,S++)s in x&&Ip(a,S,x[s])}else{if(S>=9007199254740991)throw nM("Maximum allowed index exceeded");Ip(a,S++,x)}return a.length=S,a}});var U6=Mb?{}.toString:function(){return"[object "+Nc(this)+"]"};Mb||Cr(Object.prototype,"toString",U6,{unsafe:!0});var sy,rM=Function.prototype,oM=rM.apply,sM=rM.call,j6=typeof Reflect=="object"&&Reflect.apply||(xp?sM.bind(oM):function(){return sM.apply(oM,arguments)}),Lb=Object.keys||function(i){return $I(i,ny)},V6=un&&!zI?Object.defineProperties:function(i,t){Xn(i);for(var s,h=Ss(t),_=Lb(t),x=_.length,E=0;x>E;)Tr.f(i,s=_[E++],h[s]);return i},aM={f:V6},$6=Dc("document","documentElement"),lM=iy("IE_PROTO"),zb=function(){},cM=function(i){return"<script>"+i+"<\/script>"},uM=function(i){i.write(cM("")),i.close();var t=i.parentWindow.Object;return i=null,t},ay=function(){try{sy=new ActiveXObject("htmlfile")}catch{}var i,t;ay=typeof document!="undefined"?document.domain&&sy?uM(sy):((t=PI("iframe")).style.display="none",$6.appendChild(t),t.src=String("javascript:"),(i=t.contentWindow.document).open(),i.write(cM("document.F=Object")),i.close(),i.F):uM(sy);for(var s=ny.length;s--;)delete ay.prototype[ny[s]];return ay()};Yh[lM]=!0;var ul=Object.create||function(i,t){var s;return i!==null?(zb.prototype=Xn(i),s=new zb,zb.prototype=null,s[lM]=i):s=ay(),t===void 0?s:aM.f(s,t)},G6=At.Array,q6=Math.max,hM=Sp.f,dM=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Z6=function(i){try{return hM(i)}catch{return function(s,h,_){for(var x=Qh(s),E=Sb(h,x),a=Sb(_===void 0?x:_,x),S=G6(q6(a-E,0)),O=0;E<a;E++,O++)Ip(S,O,s[E]);return S.length=O,S}(dM)}},Ob={f:function(i){return dM&&oa(i)=="Window"?Z6(i):hM(Ss(i))}},fM=Ni([].slice),pM={f:Ln},kp=At,W6=Tr.f,Wr=function(i){var t=kp.Symbol||(kp.Symbol={});Yt(t,i)||W6(t,i,{value:pM.f(i)})},H6=Tr.f,mM=Ln("toStringTag"),Uc=function(i,t,s){i&&!s&&(i=i.prototype),i&&!Yt(i,mM)&&H6(i,mM,{configurable:!0,value:t})},X6=Ni(Ni.bind),ly=function(i,t){return gb(i),t===void 0?i:xp?X6(i,t):function(){return i.apply(t,arguments)}},_M=Ni([].push),hl=function(i){var t=i==1,s=i==2,h=i==3,_=i==4,x=i==6,E=i==7,a=i==5||x;return function(S,O,M,P){for(var z,q,se=Kh(S),ue=CI(se),oe=ly(O,M),fe=Qh(ue),xe=0,Be=P||tM,$e=t?Be(S,fe):s||E?Be(S,0):void 0;fe>xe;xe++)if((a||xe in ue)&&(q=oe(z=ue[xe],xe,se),i))if(t)$e[xe]=q;else if(q)switch(i){case 3:return!0;case 5:return z;case 6:return xe;case 2:_M($e,z)}else switch(i){case 4:return!1;case 7:_M($e,z)}return x?-1:h||_?_:$e}},cy={forEach:hl(0),map:hl(1),filter:hl(2),some:hl(3),every:hl(4),find:hl(5),findIndex:hl(6),filterReject:hl(7)}.forEach,Hr=iy("hidden"),gM=Ln("toPrimitive"),K6=Is.set,yM=Is.getterFor("Symbol"),ko=Object.prototype,dl=At.Symbol,fl=dl&&dl.prototype,vM=At.TypeError,Rb=At.QObject,Pp=Dc("JSON","stringify"),xM=Tp.f,pl=Tr.f,bM=Ob.f,Y6=db.f,wM=Ni([].push),aa=zc("symbols"),Dp=zc("op-symbols"),Bb=zc("string-to-symbol-registry"),Fb=zc("symbol-to-string-registry"),J6=zc("wks"),Nb=!Rb||!Rb.prototype||!Rb.prototype.findChild,Ub=un&&An(function(){return ul(pl({},"a",{get:function(){return pl(this,"a",{value:7}).a}})).a!=7})?function(i,t,s){var h=xM(ko,t);h&&delete ko[t],pl(i,t,s),h&&i!==ko&&pl(ko,t,h)}:pl,jb=function(i,t){var s=aa[i]=ul(fl);return K6(s,{type:"Symbol",tag:i,description:t}),un||(s.description=t),s},uy=function(i,t,s){i===ko&&uy(Dp,t,s),Xn(i);var h=Bc(t);return Xn(s),Yt(aa,h)?(s.enumerable?(Yt(i,Hr)&&i[Hr][h]&&(i[Hr][h]=!1),s=ul(s,{enumerable:Pc(0,!1)})):(Yt(i,Hr)||pl(i,Hr,Pc(1,{})),i[Hr][h]=!0),Ub(i,h,s)):pl(i,h,s)},Vb=function(i,t){Xn(i);var s=Ss(t),h=Lb(s).concat(Gb(s));return cy(h,function(_){un&&!Er($b,s,_)||uy(i,_,s[_])}),i},$b=function(i){var t=Bc(i),s=Er(Y6,this,t);return!(this===ko&&Yt(aa,t)&&!Yt(Dp,t))&&(!(s||!Yt(this,t)||!Yt(aa,t)||Yt(this,Hr)&&this[Hr][t])||s)},EM=function(i,t){var s=Ss(i),h=Bc(t);if(s!==ko||!Yt(aa,h)||Yt(Dp,h)){var _=xM(s,h);return!_||!Yt(aa,h)||Yt(s,Hr)&&s[Hr][h]||(_.enumerable=!0),_}},TM=function(i){var t=bM(Ss(i)),s=[];return cy(t,function(h){Yt(aa,h)||Yt(Yh,h)||wM(s,h)}),s},Gb=function(i){var t=i===ko,s=bM(t?Dp:Ss(i)),h=[];return cy(s,function(_){!Yt(aa,_)||t&&!Yt(ko,_)||wM(h,aa[_])}),h};if(As||(fl=(dl=function(){if(Lc(fl,this))throw vM("Symbol is not a constructor");var i=arguments.length&&arguments[0]!==void 0?sa(arguments[0]):void 0,t=Oc(i),s=function(h){this===ko&&Er(s,Dp,h),Yt(this,Hr)&&Yt(this[Hr],t)&&(this[Hr][t]=!1),Ub(this,t,Pc(1,h))};return un&&Nb&&Ub(ko,t,{configurable:!0,set:s}),jb(t,i)}).prototype,Cr(fl,"toString",function(){return yM(this).tag}),Cr(dl,"withoutSetter",function(i){return jb(Oc(i),i)}),db.f=$b,Tr.f=uy,aM.f=Vb,Tp.f=EM,Sp.f=Ob.f=TM,ry.f=Gb,pM.f=function(i){return jb(Ln(i),i)},un&&(pl(fl,"description",{configurable:!0,get:function(){return yM(this).description}}),Cr(ko,"propertyIsEnumerable",$b,{unsafe:!0}))),mr({global:!0,wrap:!0,forced:!As,sham:!As},{Symbol:dl}),cy(Lb(J6),function(i){Wr(i)}),mr({target:"Symbol",stat:!0,forced:!As},{for:function(i){var t=sa(i);if(Yt(Bb,t))return Bb[t];var s=dl(t);return Bb[t]=s,Fb[s]=t,s},keyFor:function(i){if(!Xh(i))throw vM(i+" is not a symbol");if(Yt(Fb,i))return Fb[i]},useSetter:function(){Nb=!0},useSimple:function(){Nb=!1}}),mr({target:"Object",stat:!0,forced:!As,sham:!un},{create:function(i,t){return t===void 0?ul(i):Vb(ul(i),t)},defineProperty:uy,defineProperties:Vb,getOwnPropertyDescriptor:EM}),mr({target:"Object",stat:!0,forced:!As},{getOwnPropertyNames:TM,getOwnPropertySymbols:Gb}),mr({target:"Object",stat:!0,forced:An(function(){ry.f(1)})},{getOwnPropertySymbols:function(i){return ry.f(Kh(i))}}),Pp){var Q6=!As||An(function(){var i=dl();return Pp([i])!="[null]"||Pp({a:i})!="{}"||Pp(Object(i))!="{}"});mr({target:"JSON",stat:!0,forced:Q6},{stringify:function(i,t,s){var h=fM(arguments),_=t;if((In(t)||i!==void 0)&&!Xh(i))return oy(t)||(t=function(x,E){if(pn(_)&&(E=Er(_,this,x,E)),!Xh(E))return E}),h[1]=t,j6(Pp,null,h)}})}if(!fl[gM]){var e$=fl.valueOf;Cr(fl,gM,function(i){return Er(e$,this)})}Uc(dl,"Symbol"),Yh[Hr]=!0,Wr("asyncIterator");var t$=Tr.f,la=At.Symbol,jc=la&&la.prototype;if(un&&pn(la)&&(!("description"in jc)||la().description!==void 0)){var CM={},hy=function(){var i=arguments.length<1||arguments[0]===void 0?void 0:sa(arguments[0]),t=Lc(jc,this)?new la(i):i===void 0?la():la(i);return i===""&&(CM[t]=!0),t};GI(hy,la),hy.prototype=jc,jc.constructor=hy;var i$=String(la("test"))=="Symbol(test)",n$=Ni(jc.toString),r$=Ni(jc.valueOf),o$=/^Symbol\((.*)\)[^)]+$/,s$=Ni("".replace),a$=Ni("".slice);t$(jc,"description",{configurable:!0,get:function(){var i=r$(this),t=n$(i);if(Yt(CM,i))return"";var s=i$?a$(t,7,-1):s$(t,o$,"$1");return s===""?void 0:s}}),mr({global:!0,forced:!0},{Symbol:hy})}Wr("hasInstance"),Wr("isConcatSpreadable"),Wr("iterator"),Wr("match"),Wr("matchAll"),Wr("replace"),Wr("search"),Wr("species"),Wr("split"),Wr("toPrimitive"),Wr("toStringTag"),Wr("unscopables"),Uc(At.JSON,"JSON",!0),Uc(Math,"Math",!0),mr({global:!0},{Reflect:{}}),Uc(At.Reflect,"Reflect",!0),kp.Symbol;var Vc,SM,AM,l$=Ni("".charAt),IM=Ni("".charCodeAt),c$=Ni("".slice),MM=function(i){return function(t,s){var h,_,x=sa(bp(t)),E=Cb(s),a=x.length;return E<0||E>=a?i?"":void 0:(h=IM(x,E))<55296||h>56319||E+1===a||(_=IM(x,E+1))<56320||_>57343?i?l$(x,E):h:i?c$(x,E,E+2):_-56320+(h-55296<<10)+65536}},u$={codeAt:MM(!1),charAt:MM(!0)},h$=!An(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype}),kM=iy("IE_PROTO"),qb=At.Object,d$=qb.prototype,$c=h$?qb.getPrototypeOf:function(i){var t=Kh(i);if(Yt(t,kM))return t[kM];var s=t.constructor;return pn(s)&&t instanceof s?s.prototype:t instanceof qb?d$:null},Zb=Ln("iterator"),PM=!1;[].keys&&("next"in(AM=[].keys())?(SM=$c($c(AM)))!==Object.prototype&&(Vc=SM):PM=!0);var f$=Vc==null||An(function(){var i={};return Vc[Zb].call(i)!==i});f$&&(Vc={}),pn(Vc[Zb])||Cr(Vc,Zb,function(){return this});var Wb={IteratorPrototype:Vc,BUGGY_SAFARI_ITERATORS:PM},ed={},p$=Wb.IteratorPrototype,m$=function(){return this},_$=At.String,g$=At.TypeError,Ms=Object.setPrototypeOf||("__proto__"in{}?function(){var i,t=!1,s={};try{(i=Ni(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(s,[]),t=s instanceof Array}catch{}return function(h,_){return Xn(h),function(x){if(typeof x=="object"||pn(x))return x;throw g$("Can't set "+_$(x)+" as a prototype")}(_),t?i(h,_):h.__proto__=_,h}}():void 0),y$=Tb.PROPER,v$=Tb.CONFIGURABLE,DM=Wb.IteratorPrototype,dy=Wb.BUGGY_SAFARI_ITERATORS,Lp=Ln("iterator"),x$=function(){return this},Hb=function(i,t,s,h,_,x,E){(function(fe,xe,Be,$e){var Ge=xe+" Iterator";fe.prototype=ul(p$,{next:Pc(+!$e,Be)}),Uc(fe,Ge,!1),ed[Ge]=m$})(s,t,h);var a,S,O,M=function(fe){if(fe===_&&ue)return ue;if(!dy&&fe in q)return q[fe];switch(fe){case"keys":case"values":case"entries":return function(){return new s(this,fe)}}return function(){return new s(this)}},P=t+" Iterator",z=!1,q=i.prototype,se=q[Lp]||q["@@iterator"]||_&&q[_],ue=!dy&&se||M(_),oe=t=="Array"&&q.entries||se;if(oe&&(a=$c(oe.call(new i)))!==Object.prototype&&a.next&&($c(a)!==DM&&(Ms?Ms(a,DM):pn(a[Lp])||Cr(a,Lp,x$)),Uc(a,P,!0)),y$&&_=="values"&&se&&se.name!=="values"&&(v$?cl(q,"name","values"):(z=!0,ue=function(){return Er(se,this)})),_)if(S={values:M("values"),keys:x?ue:M("keys"),entries:M("entries")},E)for(O in S)(dy||z||!(O in q))&&Cr(q,O,S[O]);else mr({target:t,proto:!0,forced:dy||z},S);return q[Lp]!==ue&&Cr(q,Lp,ue,{name:_}),ed[t]=ue,S},b$=u$.charAt,w$=Is.set,E$=Is.getterFor("String Iterator");Hb(String,"String",function(i){w$(this,{type:"String Iterator",string:sa(i),index:0})},function(){var i,t=E$(this),s=t.string,h=t.index;return h>=s.length?{value:void 0,done:!0}:(i=b$(s,h),t.index+=i.length,{value:i,done:!1})});var Xb=function(i,t,s){var h,_;Xn(i);try{if(!(h=Qg(i,"return"))){if(t==="throw")throw s;return s}h=Er(h,i)}catch(x){_=!0,h=x}if(t==="throw")throw s;if(_)throw h;return Xn(h),s},T$=function(i,t,s,h){try{return h?t(Xn(s)[0],s[1]):t(s)}catch(_){Xb(i,"throw",_)}},C$=Ln("iterator"),S$=Array.prototype,LM=function(i){return i!==void 0&&(ed.Array===i||S$[C$]===i)},A$=Ln("iterator"),Kb=function(i){if(i!=null)return Qg(i,A$)||Qg(i,"@@iterator")||ed[Nc(i)]},I$=At.TypeError,zM=function(i,t){var s=arguments.length<2?Kb(i):t;if(gb(s))return Xn(Er(s,i));throw I$(wp(i)+" is not iterable")},OM=At.Array,RM=Ln("iterator"),BM=!1;try{var M$=0,FM={next:function(){return{done:!!M$++}},return:function(){BM=!0}};FM[RM]=function(){return this},Array.from(FM,function(){throw 2})}catch{}var NM=function(i,t){if(!t&&!BM)return!1;var s=!1;try{var h={};h[RM]=function(){return{next:function(){return{done:s=!0}}}},i(h)}catch{}return s},k$=!NM(function(i){Array.from(i)});mr({target:"Array",stat:!0,forced:k$},{from:function(i){var t=Kh(i),s=Db(this),h=arguments.length,_=h>1?arguments[1]:void 0,x=_!==void 0;x&&(_=ly(_,h>2?arguments[2]:void 0));var E,a,S,O,M,P,z=Kb(t),q=0;if(!z||this==OM&&LM(z))for(E=Qh(t),a=s?new this(E):OM(E);E>q;q++)P=x?_(t[q],q):t[q],Ip(a,q,P);else for(M=(O=zM(t,z)).next,a=s?new this:[];!(S=Er(M,O)).done;q++)P=x?T$(O,_,[S.value,q],!0):S.value,Ip(a,q,P);return a.length=q,a}}),kp.Array.from;var Xr,td,fy,P$=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined",D$=Tr.f,py=At.Int8Array,Yb=py&&py.prototype,UM=At.Uint8ClampedArray,jM=UM&&UM.prototype,ks=py&&$c(py),Ho=Yb&&$c(Yb),L$=Object.prototype,Jb=At.TypeError,VM=Ln("toStringTag"),Qb=Oc("TYPED_ARRAY_TAG"),e1=Oc("TYPED_ARRAY_CONSTRUCTOR"),ca=P$&&!!Ms&&Nc(At.opera)!=="Opera",$M=!1,ua={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},t1={BigInt64Array:8,BigUint64Array:8},GM=function(i){if(!In(i))return!1;var t=Nc(i);return Yt(ua,t)||Yt(t1,t)};for(Xr in ua)(fy=(td=At[Xr])&&td.prototype)?cl(fy,e1,td):ca=!1;for(Xr in t1)(fy=(td=At[Xr])&&td.prototype)&&cl(fy,e1,td);if((!ca||!pn(ks)||ks===Function.prototype)&&(ks=function(){throw Jb("Incorrect invocation")},ca))for(Xr in ua)At[Xr]&&Ms(At[Xr],ks);if((!ca||!Ho||Ho===L$)&&(Ho=ks.prototype,ca))for(Xr in ua)At[Xr]&&Ms(At[Xr].prototype,Ho);if(ca&&$c(jM)!==Ho&&Ms(jM,Ho),un&&!Yt(Ho,VM))for(Xr in $M=!0,D$(Ho,VM,{get:function(){return In(this)?this[Qb]:void 0}}),ua)At[Xr]&&cl(At[Xr],Qb,Xr);var my={NATIVE_ARRAY_BUFFER_VIEWS:ca,TYPED_ARRAY_CONSTRUCTOR:e1,TYPED_ARRAY_TAG:$M&&Qb,aTypedArray:function(i){if(GM(i))return i;throw Jb("Target is not a typed array")},aTypedArrayConstructor:function(i){if(pn(i)&&(!Ms||Lc(ks,i)))return i;throw Jb(wp(i)+" is not a typed array constructor")},exportTypedArrayMethod:function(i,t,s,h){if(un){if(s)for(var _ in ua){var x=At[_];if(x&&Yt(x.prototype,i))try{delete x.prototype[i]}catch{try{x.prototype[i]=t}catch{}}}Ho[i]&&!s||Cr(Ho,i,s?t:ca&&Yb[i]||t,h)}},exportTypedArrayStaticMethod:function(i,t,s){var h,_;if(un){if(Ms){if(s){for(h in ua)if((_=At[h])&&Yt(_,i))try{delete _[i]}catch{}}if(ks[i]&&!s)return;try{return Cr(ks,i,s?t:ca&&ks[i]||t)}catch{}}for(h in ua)!(_=At[h])||_[i]&&!s||Cr(_,i,t)}},isView:function(i){if(!In(i))return!1;var t=Nc(i);return t==="DataView"||Yt(ua,t)||Yt(t1,t)},isTypedArray:GM,TypedArray:ks,TypedArrayPrototype:Ho},z$=At.TypeError,O$=Ln("species"),R$=function(i,t){var s,h=Xn(i).constructor;return h===void 0||(s=Xn(h)[O$])==null?t:function(_){if(Db(_))return _;throw z$(wp(_)+" is not a constructor")}(s)},B$=my.TYPED_ARRAY_CONSTRUCTOR,F$=my.aTypedArrayConstructor,N$=my.aTypedArray;(0,my.exportTypedArrayMethod)("slice",function(i,t){for(var s,h=fM(N$(this),i,t),_=F$(R$(s=this,s[B$])),x=0,E=h.length,a=new _(E);E>x;)a[x]=h[x++];return a},An(function(){new Int8Array(1).slice()}));var i1=Ln("unscopables"),n1=Array.prototype;n1[i1]==null&&Tr.f(n1,i1,{configurable:!0,value:ul(null)});var _y=function(i){n1[i1][i]=!0},U$=jI.includes;mr({target:"Array",proto:!0},{includes:function(i){return U$(this,i,arguments.length>1?arguments[1]:void 0)}}),_y("includes"),kb("Array","includes");var j$=Ni("".indexOf);mr({target:"String",proto:!0,forced:!WI("includes")},{includes:function(i){return!!~j$(sa(bp(this)),sa(ZI(i)),arguments.length>1?arguments[1]:void 0)}}),kb("String","includes");var V$=Tr.f,$$=Is.set,G$=Is.getterFor("Array Iterator");Hb(Array,"Array",function(i,t){$$(this,{type:"Array Iterator",target:Ss(i),index:0,kind:t})},function(){var i=G$(this),t=i.target,s=i.kind,h=i.index++;return!t||h>=t.length?(i.target=void 0,{value:void 0,done:!0}):s=="keys"?{value:h,done:!1}:s=="values"?{value:t[h],done:!1}:{value:[h,t[h]],done:!1}},"values");var qM=ed.Arguments=ed.Array;if(_y("keys"),_y("values"),_y("entries"),un&&qM.name!=="values")try{V$(qM,"name",{value:"values"})}catch{}var ZM=An(function(){if(typeof ArrayBuffer=="function"){var i=new ArrayBuffer(8);Object.isExtensible(i)&&Object.defineProperty(i,"a",{value:8})}}),gy=Object.isExtensible,r1=An(function(){gy(1)})||ZM?function(i){return!!In(i)&&(!ZM||oa(i)!="ArrayBuffer")&&(!gy||gy(i))}:gy,q$=!An(function(){return Object.isExtensible(Object.preventExtensions({}))}),id=Hh(function(i){var t=Tr.f,s=!1,h=Oc("meta"),_=0,x=function(a){t(a,h,{value:{objectID:"O"+_++,weakData:{}}})},E=i.exports={enable:function(){E.enable=function(){},s=!0;var a=Sp.f,S=Ni([].splice),O={};O[h]=1,a(O).length&&(Sp.f=function(M){for(var P=a(M),z=0,q=P.length;z<q;z++)if(P[z]===h){S(P,z,1);break}return P},mr({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Ob.f}))},fastKey:function(a,S){if(!In(a))return typeof a=="symbol"?a:(typeof a=="string"?"S":"P")+a;if(!Yt(a,h)){if(!r1(a))return"F";if(!S)return"E";x(a)}return a[h].objectID},getWeakData:function(a,S){if(!Yt(a,h)){if(!r1(a))return!0;if(!S)return!1;x(a)}return a[h].weakData},onFreeze:function(a){return q$&&s&&r1(a)&&!Yt(a,h)&&x(a),a}};Yh[h]=!0});id.enable,id.fastKey,id.getWeakData,id.onFreeze;var Z$=At.TypeError,yy=function(i,t){this.stopped=i,this.result=t},WM=yy.prototype,HM=function(i,t,s){var h,_,x,E,a,S,O,M=s&&s.that,P=!(!s||!s.AS_ENTRIES),z=!(!s||!s.IS_ITERATOR),q=!(!s||!s.INTERRUPTED),se=ly(t,M),ue=function(fe){return h&&Xb(h,"normal",fe),new yy(!0,fe)},oe=function(fe){return P?(Xn(fe),q?se(fe[0],fe[1],ue):se(fe[0],fe[1])):q?se(fe,ue):se(fe)};if(z)h=i;else{if(!(_=Kb(i)))throw Z$(wp(i)+" is not iterable");if(LM(_)){for(x=0,E=Qh(i);E>x;x++)if((a=oe(i[x]))&&Lc(WM,a))return a;return new yy(!1)}h=zM(i,_)}for(S=h.next;!(O=Er(S,h)).done;){try{a=oe(O.value)}catch(fe){Xb(h,"throw",fe)}if(typeof a=="object"&&a&&Lc(WM,a))return a}return new yy(!1)},W$=At.TypeError,XM=function(i,t){if(Lc(t,i))return i;throw W$("Incorrect invocation")},KM=function(i,t,s){for(var h in t)Cr(i,h,t[h],s);return i},YM=Ln("species"),H$=Tr.f,JM=id.fastKey,QM=Is.set,o1=Is.getterFor,X$={getConstructor:function(i,t,s,h){var _=i(function(O,M){XM(O,x),QM(O,{type:t,index:ul(null),first:void 0,last:void 0,size:0}),un||(O.size=0),M!=null&&HM(M,O[h],{that:O,AS_ENTRIES:s})}),x=_.prototype,E=o1(t),a=function(O,M,P){var z,q,se=E(O),ue=S(O,M);return ue?ue.value=P:(se.last=ue={index:q=JM(M,!0),key:M,value:P,previous:z=se.last,next:void 0,removed:!1},se.first||(se.first=ue),z&&(z.next=ue),un?se.size++:O.size++,q!=="F"&&(se.index[q]=ue)),O},S=function(O,M){var P,z=E(O),q=JM(M);if(q!=="F")return z.index[q];for(P=z.first;P;P=P.next)if(P.key==M)return P};return KM(x,{clear:function(){for(var O=E(this),M=O.index,P=O.first;P;)P.removed=!0,P.previous&&(P.previous=P.previous.next=void 0),delete M[P.index],P=P.next;O.first=O.last=void 0,un?O.size=0:this.size=0},delete:function(O){var M=this,P=E(M),z=S(M,O);if(z){var q=z.next,se=z.previous;delete P.index[z.index],z.removed=!0,se&&(se.next=q),q&&(q.previous=se),P.first==z&&(P.first=q),P.last==z&&(P.last=se),un?P.size--:M.size--}return!!z},forEach:function(O){for(var M,P=E(this),z=ly(O,arguments.length>1?arguments[1]:void 0);M=M?M.next:P.first;)for(z(M.value,M.key,this);M&&M.removed;)M=M.previous},has:function(O){return!!S(this,O)}}),KM(x,s?{get:function(O){var M=S(this,O);return M&&M.value},set:function(O,M){return a(this,O===0?0:O,M)}}:{add:function(O){return a(this,O=O===0?0:O,O)}}),un&&H$(x,"size",{get:function(){return E(this).size}}),_},setStrong:function(i,t,s){var h=t+" Iterator",_=o1(t),x=o1(h);Hb(i,t,function(E,a){QM(this,{type:h,target:E,state:_(E),kind:a,last:void 0})},function(){for(var E=x(this),a=E.kind,S=E.last;S&&S.removed;)S=S.previous;return E.target&&(E.last=S=S?S.next:E.state.first)?a=="keys"?{value:S.key,done:!1}:a=="values"?{value:S.value,done:!1}:{value:[S.key,S.value],done:!1}:(E.target=void 0,{value:void 0,done:!0})},s?"entries":"values",!s,!0),function(E){var a=Dc(E),S=Tr.f;un&&a&&!a[YM]&&S(a,YM,{configurable:!0,get:function(){return this}})}(t)}};function ek(i){var t=this.constructor;return this.then(function(s){return t.resolve(i()).then(function(){return s})},function(s){return t.resolve(i()).then(function(){return t.reject(s)})})}function tk(i){return new this(function(t,s){if(!i||i.length===void 0)return s(new TypeError(typeof i+" "+i+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var h=Array.prototype.slice.call(i);if(h.length===0)return t([]);var _=h.length;function x(a,S){if(S&&(typeof S=="object"||typeof S=="function")){var O=S.then;if(typeof O=="function")return void O.call(S,function(M){x(a,M)},function(M){h[a]={status:"rejected",reason:M},--_==0&&t(h)})}h[a]={status:"fulfilled",value:S},--_==0&&t(h)}for(var E=0;E<h.length;E++)x(E,h[E])})}(function(i,t,s){var h=i.indexOf("Map")!==-1,_=i.indexOf("Weak")!==-1,x=h?"set":"add",E=At[i],a=E&&E.prototype,S=E,O={},M=function(oe){var fe=Ni(a[oe]);Cr(a,oe,oe=="add"?function(xe){return fe(this,xe===0?0:xe),this}:oe=="delete"?function(xe){return!(_&&!In(xe))&&fe(this,xe===0?0:xe)}:oe=="get"?function(xe){return _&&!In(xe)?void 0:fe(this,xe===0?0:xe)}:oe=="has"?function(xe){return!(_&&!In(xe))&&fe(this,xe===0?0:xe)}:function(xe,Be){return fe(this,xe===0?0:xe,Be),this})};if(Ab(i,!pn(E)||!(_||a.forEach&&!An(function(){new E().entries().next()}))))S=s.getConstructor(t,i,h,x),id.enable();else if(Ab(i,!0)){var P=new S,z=P[x](_?{}:-0,1)!=P,q=An(function(){P.has(1)}),se=NM(function(oe){new E(oe)}),ue=!_&&An(function(){for(var oe=new E,fe=5;fe--;)oe[x](fe,fe);return!oe.has(-0)});se||((S=t(function(oe,fe){XM(oe,a);var xe=function(Be,$e,Ge){var xt,pt;return Ms&&pn(xt=$e.constructor)&&xt!==Ge&&In(pt=xt.prototype)&&pt!==Ge.prototype&&Ms(Be,pt),Be}(new E,oe,S);return fe!=null&&HM(fe,xe[x],{that:xe,AS_ENTRIES:h}),xe})).prototype=a,a.constructor=S),(q||ue)&&(M("delete"),M("has"),h&&M("get")),(ue||z)&&M(x),_&&a.clear&&delete a.clear}O[i]=S,mr({global:!0,forced:S!=E},O),Uc(S,i),_||s.setStrong(S,i,h)})("Set",function(i){return function(){return i(this,arguments.length?arguments[0]:void 0)}},X$),kp.Set;var K$=setTimeout,ik=typeof setImmediate!="undefined"?setImmediate:null;function nk(i){return Boolean(i&&i.length!==void 0)}function Y$(){}function Mn(i){if(!(this instanceof Mn))throw new TypeError("Promises must be constructed via new");if(typeof i!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],ok(i,this)}function rk(i,t){for(;i._state===3;)i=i._value;i._state!==0?(i._handled=!0,Mn._immediateFn(function(){var s=i._state===1?t.onFulfilled:t.onRejected;if(s!==null){var h;try{h=s(i._value)}catch(_){return void zp(t.promise,_)}s1(t.promise,h)}else(i._state===1?s1:zp)(t.promise,i._value)})):i._deferreds.push(t)}function s1(i,t){try{if(t===i)throw new TypeError("A promise cannot be resolved with itself.");if(t&&(typeof t=="object"||typeof t=="function")){var s=t.then;if(t instanceof Mn)return i._state=3,i._value=t,void a1(i);if(typeof s=="function")return void ok((h=s,_=t,function(){h.apply(_,arguments)}),i)}i._state=1,i._value=t,a1(i)}catch(x){zp(i,x)}var h,_}function zp(i,t){i._state=2,i._value=t,a1(i)}function a1(i){i._state===2&&i._deferreds.length===0&&Mn._immediateFn(function(){i._handled||Mn._unhandledRejectionFn(i._value)});for(var t=0,s=i._deferreds.length;t<s;t++)rk(i,i._deferreds[t]);i._deferreds=null}function J$(i,t,s){this.onFulfilled=typeof i=="function"?i:null,this.onRejected=typeof t=="function"?t:null,this.promise=s}function ok(i,t){var s=!1;try{i(function(h){s||(s=!0,s1(t,h))},function(h){s||(s=!0,zp(t,h))})}catch(h){if(s)return;s=!0,zp(t,h)}}Mn.prototype.catch=function(i){return this.then(null,i)},Mn.prototype.then=function(i,t){var s=new this.constructor(Y$);return rk(this,new J$(i,t,s)),s},Mn.prototype.finally=ek,Mn.all=function(i){return new Mn(function(t,s){if(!nk(i))return s(new TypeError("Promise.all accepts an array"));var h=Array.prototype.slice.call(i);if(h.length===0)return t([]);var _=h.length;function x(a,S){try{if(S&&(typeof S=="object"||typeof S=="function")){var O=S.then;if(typeof O=="function")return void O.call(S,function(M){x(a,M)},s)}h[a]=S,--_==0&&t(h)}catch(M){s(M)}}for(var E=0;E<h.length;E++)x(E,h[E])})},Mn.allSettled=tk,Mn.resolve=function(i){return i&&typeof i=="object"&&i.constructor===Mn?i:new Mn(function(t){t(i)})},Mn.reject=function(i){return new Mn(function(t,s){s(i)})},Mn.race=function(i){return new Mn(function(t,s){if(!nk(i))return s(new TypeError("Promise.race accepts an array"));for(var h=0,_=i.length;h<_;h++)Mn.resolve(i[h]).then(t,s)})},Mn._immediateFn=typeof ik=="function"&&function(i){ik(i)}||function(i){K$(i,0)},Mn._unhandledRejectionFn=function(i){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",i)};var nd=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object")}();typeof nd.Promise!="function"?nd.Promise=Mn:(nd.Promise.prototype.finally||(nd.Promise.prototype.finally=ek),nd.Promise.allSettled||(nd.Promise.allSettled=tk)),function(i){function t(){}function s(E,a){if(E=E===void 0?"utf-8":E,a=a===void 0?{fatal:!1}:a,_.indexOf(E.toLowerCase())===-1)throw new RangeError("Failed to construct 'TextDecoder': The encoding label provided ('"+E+"') is invalid.");if(a.fatal)throw Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}function h(E){for(var a=0,S=Math.min(65536,E.length+1),O=new Uint16Array(S),M=[],P=0;;){var z=a<E.length;if(!z||P>=S-1){if(M.push(String.fromCharCode.apply(null,O.subarray(0,P))),!z)return M.join("");E=E.subarray(a),P=a=0}if((128&(z=E[a++]))==0)O[P++]=z;else if((224&z)==192){var q=63&E[a++];O[P++]=(31&z)<<6|q}else if((240&z)==224){q=63&E[a++];var se=63&E[a++];O[P++]=(31&z)<<12|q<<6|se}else(248&z)==240&&(65535<(z=(7&z)<<18|(q=63&E[a++])<<12|(se=63&E[a++])<<6|63&E[a++])&&(z-=65536,O[P++]=z>>>10&1023|55296,z=56320|1023&z),O[P++]=z)}}if(i.TextEncoder&&i.TextDecoder)return!1;var _=["utf-8","utf8","unicode-1-1-utf-8"];Object.defineProperty(t.prototype,"encoding",{value:"utf-8"}),t.prototype.encode=function(E,a){if((a=a===void 0?{stream:!1}:a).stream)throw Error("Failed to encode: the 'stream' option is unsupported.");a=0;for(var S=E.length,O=0,M=Math.max(32,S+(S>>>1)+7),P=new Uint8Array(M>>>3<<3);a<S;){var z=E.charCodeAt(a++);if(55296<=z&&56319>=z){if(a<S){var q=E.charCodeAt(a);(64512&q)==56320&&(++a,z=((1023&z)<<10)+(1023&q)+65536)}if(55296<=z&&56319>=z)continue}if(O+4>P.length&&(M+=8,M=(M*=1+a/E.length*2)>>>3<<3,(q=new Uint8Array(M)).set(P),P=q),(4294967168&z)==0)P[O++]=z;else{if((4294965248&z)==0)P[O++]=z>>>6&31|192;else if((4294901760&z)==0)P[O++]=z>>>12&15|224,P[O++]=z>>>6&63|128;else{if((4292870144&z)!=0)continue;P[O++]=z>>>18&7|240,P[O++]=z>>>12&63|128,P[O++]=z>>>6&63|128}P[O++]=63&z|128}}return P.slice?P.slice(0,O):P.subarray(0,O)},Object.defineProperty(s.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(s.prototype,"fatal",{value:!1}),Object.defineProperty(s.prototype,"ignoreBOM",{value:!1});var x=h;typeof Buffer=="function"&&Buffer.from?x=function(E){return Buffer.from(E.buffer,E.byteOffset,E.byteLength).toString("utf-8")}:typeof Blob=="function"&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&(x=function(E){var a=URL.createObjectURL(new Blob([E],{type:"text/plain;charset=UTF-8"}));try{var S=new XMLHttpRequest;return S.open("GET",a,!1),S.send(),S.responseText}catch{return h(E)}finally{URL.revokeObjectURL(a)}}),s.prototype.decode=function(E,a){if((a=a===void 0?{stream:!1}:a).stream)throw Error("Failed to decode: the 'stream' option is unsupported.");return E=E instanceof Uint8Array?E:E.buffer instanceof ArrayBuffer?new Uint8Array(E.buffer):new Uint8Array(E),x(E)},i.TextEncoder=t,i.TextDecoder=s}(typeof window!="undefined"?window:Cs),function(){function i(oe,fe){if(!(oe instanceof fe))throw new TypeError("Cannot call a class as a function")}function t(oe,fe){for(var xe=0;xe<fe.length;xe++){var Be=fe[xe];Be.enumerable=Be.enumerable||!1,Be.configurable=!0,"value"in Be&&(Be.writable=!0),Object.defineProperty(oe,Be.key,Be)}}function s(oe,fe,xe){return fe&&t(oe.prototype,fe),xe&&t(oe,xe),oe}function h(oe,fe){if(typeof fe!="function"&&fe!==null)throw new TypeError("Super expression must either be null or a function");oe.prototype=Object.create(fe&&fe.prototype,{constructor:{value:oe,writable:!0,configurable:!0}}),fe&&x(oe,fe)}function _(oe){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(fe){return fe.__proto__||Object.getPrototypeOf(fe)},_(oe)}function x(oe,fe){return x=Object.setPrototypeOf||function(xe,Be){return xe.__proto__=Be,xe},x(oe,fe)}function E(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function a(oe){if(oe===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return oe}function S(oe,fe){return!fe||typeof fe!="object"&&typeof fe!="function"?a(oe):fe}function O(oe){var fe=E();return function(){var xe,Be=_(oe);if(fe){var $e=_(this).constructor;xe=Reflect.construct(Be,arguments,$e)}else xe=Be.apply(this,arguments);return S(this,xe)}}function M(oe,fe){for(;!Object.prototype.hasOwnProperty.call(oe,fe)&&(oe=_(oe))!==null;);return oe}function P(oe,fe,xe){return P=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(Be,$e,Ge){var xt=M(Be,$e);if(xt){var pt=Object.getOwnPropertyDescriptor(xt,$e);return pt.get?pt.get.call(Ge):pt.value}},P(oe,fe,xe||oe)}var z=function(){function oe(){i(this,oe),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return s(oe,[{key:"addEventListener",value:function(fe,xe,Be){fe in this.listeners||(this.listeners[fe]=[]),this.listeners[fe].push({callback:xe,options:Be})}},{key:"removeEventListener",value:function(fe,xe){if(fe in this.listeners){for(var Be=this.listeners[fe],$e=0,Ge=Be.length;$e<Ge;$e++)if(Be[$e].callback===xe)return void Be.splice($e,1)}}},{key:"dispatchEvent",value:function(fe){if(fe.type in this.listeners){for(var xe=this.listeners[fe.type].slice(),Be=0,$e=xe.length;Be<$e;Be++){var Ge=xe[Be];try{Ge.callback.call(this,fe)}catch(xt){Promise.resolve().then(function(){throw xt})}Ge.options&&Ge.options.once&&this.removeEventListener(fe.type,Ge.callback)}return!fe.defaultPrevented}}}]),oe}(),q=function(oe){h(xe,oe);var fe=O(xe);function xe(){var Be;return i(this,xe),(Be=fe.call(this)).listeners||z.call(a(Be)),Object.defineProperty(a(Be),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(a(Be),"onabort",{value:null,writable:!0,configurable:!0}),Be}return s(xe,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(Be){Be.type==="abort"&&(this.aborted=!0,typeof this.onabort=="function"&&this.onabort.call(this,Be)),P(_(xe.prototype),"dispatchEvent",this).call(this,Be)}}]),xe}(z),se=function(){function oe(){i(this,oe),Object.defineProperty(this,"signal",{value:new q,writable:!0,configurable:!0})}return s(oe,[{key:"abort",value:function(){var fe;try{fe=new Event("abort")}catch{typeof document!="undefined"?document.createEvent?(fe=document.createEvent("Event")).initEvent("abort",!1,!1):(fe=document.createEventObject()).type="abort":fe={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(fe)}},{key:"toString",value:function(){return"[object AbortController]"}}]),oe}();function ue(oe){return oe.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):typeof oe.Request=="function"&&!oe.Request.prototype.hasOwnProperty("signal")||!oe.AbortController}typeof Symbol!="undefined"&&Symbol.toStringTag&&(se.prototype[Symbol.toStringTag]="AbortController",q.prototype[Symbol.toStringTag]="AbortSignal"),function(oe){ue(oe)&&(oe.AbortController=se,oe.AbortSignal=q)}(typeof self!="undefined"?self:Cs)}();var Gc=Hh(function(i,t){Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function h(){var _=this;this.locked=new Map,this.addToLocked=function(x,E){var a=_.locked.get(x);a===void 0?E===void 0?_.locked.set(x,[]):_.locked.set(x,[E]):E!==void 0&&(a.unshift(E),_.locked.set(x,a))},this.isLocked=function(x){return _.locked.has(x)},this.lock=function(x){return new Promise(function(E,a){_.isLocked(x)?_.addToLocked(x,E):(_.addToLocked(x),E())})},this.unlock=function(x){var E=_.locked.get(x);if(E!==void 0&&E.length!==0){var a=E.pop();_.locked.set(x,E),a!==void 0&&setTimeout(a,0)}else _.locked.delete(x)}}return h.getInstance=function(){return h.instance===void 0&&(h.instance=new h),h.instance},h}();t.default=function(){return s.getInstance()}});hb(Gc);var Q$=Hh(function(i,t){var s=Cs&&Cs.__awaiter||function(S,O,M,P){return new(M||(M=Promise))(function(z,q){function se(fe){try{oe(P.next(fe))}catch(xe){q(xe)}}function ue(fe){try{oe(P.throw(fe))}catch(xe){q(xe)}}function oe(fe){fe.done?z(fe.value):new M(function(xe){xe(fe.value)}).then(se,ue)}oe((P=P.apply(S,O||[])).next())})},h=Cs&&Cs.__generator||function(S,O){var M,P,z,q,se={label:0,sent:function(){if(1&z[0])throw z[1];return z[1]},trys:[],ops:[]};return q={next:ue(0),throw:ue(1),return:ue(2)},typeof Symbol=="function"&&(q[Symbol.iterator]=function(){return this}),q;function ue(oe){return function(fe){return function(xe){if(M)throw new TypeError("Generator is already executing.");for(;se;)try{if(M=1,P&&(z=2&xe[0]?P.return:xe[0]?P.throw||((z=P.return)&&z.call(P),0):P.next)&&!(z=z.call(P,xe[1])).done)return z;switch(P=0,z&&(xe=[2&xe[0],z.value]),xe[0]){case 0:case 1:z=xe;break;case 4:return se.label++,{value:xe[1],done:!1};case 5:se.label++,P=xe[1],xe=[0];continue;case 7:xe=se.ops.pop(),se.trys.pop();continue;default:if(z=se.trys,!((z=z.length>0&&z[z.length-1])||xe[0]!==6&&xe[0]!==2)){se=0;continue}if(xe[0]===3&&(!z||xe[1]>z[0]&&xe[1]<z[3])){se.label=xe[1];break}if(xe[0]===6&&se.label<z[1]){se.label=z[1],z=xe;break}if(z&&se.label<z[2]){se.label=z[2],se.ops.push(xe);break}z[2]&&se.ops.pop(),se.trys.pop();continue}xe=O.call(S,se)}catch(Be){xe=[6,Be],P=0}finally{M=z=0}if(5&xe[0])throw xe[1];return{value:xe[0]?xe[1]:void 0,done:!0}}([oe,fe])}}};Object.defineProperty(t,"__esModule",{value:!0});var _="browser-tabs-lock-key";function x(S){return new Promise(function(O){return setTimeout(O,S)})}function E(S){for(var O="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",M="",P=0;P<S;P++)M+=O[Math.floor(Math.random()*O.length)];return M}var a=function(){function S(){this.acquiredIatSet=new Set,this.id=Date.now().toString()+E(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),S.waiters===void 0&&(S.waiters=[])}return S.prototype.acquireLock=function(O,M){return M===void 0&&(M=5e3),s(this,void 0,void 0,function(){var P,z,q,se,ue,oe;return h(this,function(fe){switch(fe.label){case 0:P=Date.now()+E(4),z=Date.now()+M,q=_+"-"+O,se=window.localStorage,fe.label=1;case 1:return Date.now()<z?[4,x(30)]:[3,8];case 2:return fe.sent(),se.getItem(q)!==null?[3,5]:(ue=this.id+"-"+O+"-"+P,[4,x(Math.floor(25*Math.random()))]);case 3:return fe.sent(),se.setItem(q,JSON.stringify({id:this.id,iat:P,timeoutKey:ue,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,x(30)];case 4:return fe.sent(),(oe=se.getItem(q))!==null&&(oe=JSON.parse(oe)).id===this.id&&oe.iat===P?(this.acquiredIatSet.add(P),this.refreshLockWhileAcquired(q,P),[2,!0]):[3,7];case 5:return S.lockCorrector(),[4,this.waitForSomethingToChange(z)];case 6:fe.sent(),fe.label=7;case 7:return P=Date.now()+E(4),[3,1];case 8:return[2,!1]}})})},S.prototype.refreshLockWhileAcquired=function(O,M){return s(this,void 0,void 0,function(){var P=this;return h(this,function(z){return setTimeout(function(){return s(P,void 0,void 0,function(){var q,se;return h(this,function(ue){switch(ue.label){case 0:return[4,Gc.default().lock(M)];case 1:return ue.sent(),this.acquiredIatSet.has(M)?(q=window.localStorage,(se=q.getItem(O))===null?(Gc.default().unlock(M),[2]):((se=JSON.parse(se)).timeRefreshed=Date.now(),q.setItem(O,JSON.stringify(se)),Gc.default().unlock(M),this.refreshLockWhileAcquired(O,M),[2])):(Gc.default().unlock(M),[2])}})})},1e3),[2]})})},S.prototype.waitForSomethingToChange=function(O){return s(this,void 0,void 0,function(){return h(this,function(M){switch(M.label){case 0:return[4,new Promise(function(P){var z=!1,q=Date.now(),se=!1;function ue(){if(se||(window.removeEventListener("storage",ue),S.removeFromWaiting(ue),clearTimeout(oe),se=!0),!z){z=!0;var fe=50-(Date.now()-q);fe>0?setTimeout(P,fe):P()}}window.addEventListener("storage",ue),S.addToWaiting(ue);var oe=setTimeout(ue,Math.max(0,O-Date.now()))})];case 1:return M.sent(),[2]}})})},S.addToWaiting=function(O){this.removeFromWaiting(O),S.waiters!==void 0&&S.waiters.push(O)},S.removeFromWaiting=function(O){S.waiters!==void 0&&(S.waiters=S.waiters.filter(function(M){return M!==O}))},S.notifyWaiters=function(){S.waiters!==void 0&&S.waiters.slice().forEach(function(O){return O()})},S.prototype.releaseLock=function(O){return s(this,void 0,void 0,function(){return h(this,function(M){switch(M.label){case 0:return[4,this.releaseLock__private__(O)];case 1:return[2,M.sent()]}})})},S.prototype.releaseLock__private__=function(O){return s(this,void 0,void 0,function(){var M,P,z;return h(this,function(q){switch(q.label){case 0:return M=window.localStorage,P=_+"-"+O,(z=M.getItem(P))===null?[2]:(z=JSON.parse(z)).id!==this.id?[3,2]:[4,Gc.default().lock(z.iat)];case 1:q.sent(),this.acquiredIatSet.delete(z.iat),M.removeItem(P),Gc.default().unlock(z.iat),S.notifyWaiters(),q.label=2;case 2:return[2]}})})},S.lockCorrector=function(){for(var O=Date.now()-5e3,M=window.localStorage,P=Object.keys(M),z=!1,q=0;q<P.length;q++){var se=P[q];if(se.includes(_)){var ue=M.getItem(se);ue!==null&&((ue=JSON.parse(ue)).timeRefreshed===void 0&&ue.timeAcquired<O||ue.timeRefreshed!==void 0&&ue.timeRefreshed<O)&&(M.removeItem(se),z=!0)}}z&&S.notifyWaiters()},S.waiters=void 0,S}();t.default=a}),eG=hb(Q$),tG={timeoutInSeconds:60},iG=["login_required","consent_required","interaction_required","account_selection_required","access_denied"],sk={name:"auth0-spa-js",version:"1.21.0"},ak=function(){return Date.now()},ml=function(i){function t(s,h){var _=i.call(this,h)||this;return _.error=s,_.error_description=h,Object.setPrototypeOf(_,t.prototype),_}return Zh(t,i),t.fromPayload=function(s){return new t(s.error,s.error_description)},t}(Error),nG=function(i){function t(s,h,_,x){x===void 0&&(x=null);var E=i.call(this,s,h)||this;return E.state=_,E.appState=x,Object.setPrototypeOf(E,t.prototype),E}return Zh(t,i),t}(ml),l1=function(i){function t(){var s=i.call(this,"timeout","Timeout")||this;return Object.setPrototypeOf(s,t.prototype),s}return Zh(t,i),t}(ml),rG=function(i){function t(s){var h=i.call(this)||this;return h.popup=s,Object.setPrototypeOf(h,t.prototype),h}return Zh(t,i),t}(l1),oG=function(i){function t(s){var h=i.call(this,"cancelled","Popup closed")||this;return h.popup=s,Object.setPrototypeOf(h,t.prototype),h}return Zh(t,i),t}(ml),sG=function(i){function t(s,h,_){var x=i.call(this,s,h)||this;return x.mfa_token=_,Object.setPrototypeOf(x,t.prototype),x}return Zh(t,i),t}(ml),aG=function(i){return new Promise(function(t,s){var h,_=setInterval(function(){i.popup&&i.popup.closed&&(clearInterval(_),clearTimeout(x),window.removeEventListener("message",h,!1),s(new oG(i.popup)))},1e3),x=setTimeout(function(){clearInterval(_),s(new rG(i.popup)),window.removeEventListener("message",h,!1)},1e3*(i.timeoutInSeconds||60));h=function(E){if(E.data&&E.data.type==="authorization_response"){if(clearTimeout(x),clearInterval(_),window.removeEventListener("message",h,!1),i.popup.close(),E.data.response.error)return s(ml.fromPayload(E.data.response));t(E.data.response)}},window.addEventListener("message",h)})},c1=function(){return window.crypto||window.msCrypto},lk=function(){var i=c1();return i.subtle||i.webkitSubtle},ha=function(){var i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~.",t="";return Array.from(c1().getRandomValues(new Uint8Array(43))).forEach(function(s){return t+=i[s%i.length]}),t},rd=function(i){return btoa(i)},u1=function(i){return Object.keys(i).filter(function(t){return i[t]!==void 0}).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(i[t])}).join("&")},h1=function(i){return Bi(void 0,void 0,void 0,function(){var t;return Fi(this,function(s){switch(s.label){case 0:return t=lk().digest({name:"SHA-256"},new TextEncoder().encode(i)),window.msCrypto?[2,new Promise(function(h,_){t.oncomplete=function(x){h(x.target.result)},t.onerror=function(x){_(x.error)},t.onabort=function(){_("The digest operation was aborted")}})]:[4,t];case 1:return[2,s.sent()]}})})},ck=function(i){return function(t){return decodeURIComponent(atob(t).split("").map(function(s){return"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)}).join(""))}(i.replace(/_/g,"/").replace(/-/g,"+"))},d1=function(i){var t=new Uint8Array(i);return function(s){var h={"+":"-","/":"_","=":""};return s.replace(/[+/=]/g,function(_){return h[_]})}(window.btoa(String.fromCharCode.apply(String,ub([],Wh(Array.from(t)),!1))))},lG=function(i,t){return Bi(void 0,void 0,void 0,function(){var s,h;return Fi(this,function(_){switch(_.label){case 0:return[4,(x=i,E=t,E=E||{},new Promise(function(a,S){var O=new XMLHttpRequest,M=[],P=[],z={},q=function(){return{ok:(O.status/100|0)==2,statusText:O.statusText,status:O.status,url:O.responseURL,text:function(){return Promise.resolve(O.responseText)},json:function(){return Promise.resolve(O.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([O.response]))},clone:q,headers:{keys:function(){return M},entries:function(){return P},get:function(ue){return z[ue.toLowerCase()]},has:function(ue){return ue.toLowerCase()in z}}}};for(var se in O.open(E.method||"get",x,!0),O.onload=function(){O.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(ue,oe,fe){M.push(oe=oe.toLowerCase()),P.push([oe,fe]),z[oe]=z[oe]?z[oe]+","+fe:fe}),a(q())},O.onerror=S,O.withCredentials=E.credentials=="include",E.headers)O.setRequestHeader(se,E.headers[se]);O.send(E.body||null)}))];case 1:return s=_.sent(),h={ok:s.ok},[4,s.json()];case 2:return[2,(h.json=_.sent(),h)]}var x,E})})},cG=function(i,t,s){return Bi(void 0,void 0,void 0,function(){var h,_;return Fi(this,function(x){return h=new AbortController,t.signal=h.signal,[2,Promise.race([lG(i,t),new Promise(function(E,a){_=setTimeout(function(){h.abort(),a(new Error("Timeout when executing 'fetch'"))},s)})]).finally(function(){clearTimeout(_)})]})})},uG=function(i,t,s,h,_,x,E){return Bi(void 0,void 0,void 0,function(){return Fi(this,function(a){return[2,(S={auth:{audience:t,scope:s},timeout:_,fetchUrl:i,fetchOptions:h,useFormData:E},O=x,new Promise(function(M,P){var z=new MessageChannel;z.port1.onmessage=function(q){q.data.error?P(new Error(q.data.error)):M(q.data)},O.postMessage(S,[z.port2])}))];var S,O})})},hG=function(i,t,s,h,_,x,E){return E===void 0&&(E=1e4),Bi(void 0,void 0,void 0,function(){return Fi(this,function(a){return _?[2,uG(i,t,s,h,E,_,x)]:[2,cG(i,h,E)]})})};function dG(i,t,s,h,_,x,E){return Bi(this,void 0,void 0,function(){var a,S,O,M,P,z,q,se,ue;return Fi(this,function(oe){switch(oe.label){case 0:a=null,O=0,oe.label=1;case 1:if(!(O<3))return[3,6];oe.label=2;case 2:return oe.trys.push([2,4,,5]),[4,hG(i,s,h,_,x,E,t)];case 3:return S=oe.sent(),a=null,[3,6];case 4:return M=oe.sent(),a=M,[3,5];case 5:return O++,[3,1];case 6:if(a)throw a.message=a.message||"Failed to fetch",a;if(P=S.json,z=P.error,q=P.error_description,se=Zr(P,["error","error_description"]),!S.ok)throw ue=q||"HTTP error. Unable to fetch ".concat(i),z==="mfa_required"?new sG(z,ue,se.mfa_token):new ml(z||"request_error",ue);return[2,se]}})})}function vy(i,t){var s=i.baseUrl,h=i.timeout,_=i.audience,x=i.scope,E=i.auth0Client,a=i.useFormData,S=Zr(i,["baseUrl","timeout","audience","scope","auth0Client","useFormData"]);return Bi(this,void 0,void 0,function(){var O;return Fi(this,function(M){switch(M.label){case 0:return O=a?u1(S):JSON.stringify(S),[4,dG("".concat(s,"/oauth/token"),h,_||"default",x,{method:"POST",body:O,headers:{"Content-Type":a?"application/x-www-form-urlencoded":"application/json","Auth0-Client":btoa(JSON.stringify(E||sk))}},t,a)];case 1:return[2,M.sent()]}})})}var fG=function(i){return Array.from(new Set(i))},_l=function(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];return fG(i.join(" ").trim().split(/\s+/)).join(" ")},qc=function(){function i(t,s){s===void 0&&(s="@@auth0spajs@@"),this.prefix=s,this.client_id=t.client_id,this.scope=t.scope,this.audience=t.audience}return i.prototype.toKey=function(){return"".concat(this.prefix,"::").concat(this.client_id,"::").concat(this.audience,"::").concat(this.scope)},i.fromKey=function(t){var s=Wh(t.split("::"),4),h=s[0],_=s[1],x=s[2];return new i({client_id:_,scope:s[3],audience:x},h)},i.fromCacheEntry=function(t){return new i({scope:t.scope,audience:t.audience,client_id:t.client_id})},i}(),pG=function(){function i(){}return i.prototype.set=function(t,s){localStorage.setItem(t,JSON.stringify(s))},i.prototype.get=function(t){var s=window.localStorage.getItem(t);if(s)try{return JSON.parse(s)}catch{return}},i.prototype.remove=function(t){localStorage.removeItem(t)},i.prototype.allKeys=function(){return Object.keys(window.localStorage).filter(function(t){return t.startsWith("@@auth0spajs@@")})},i}(),mG=function(){var i;this.enclosedCache=(i={},{set:function(t,s){i[t]=s},get:function(t){var s=i[t];if(s)return s},remove:function(t){delete i[t]},allKeys:function(){return Object.keys(i)}})},_G=function(){function i(t,s,h){this.cache=t,this.keyManifest=s,this.nowProvider=h,this.nowProvider=this.nowProvider||ak}return i.prototype.get=function(t,s){var h;return s===void 0&&(s=0),Bi(this,void 0,void 0,function(){var _,x,E,a,S;return Fi(this,function(O){switch(O.label){case 0:return[4,this.cache.get(t.toKey())];case 1:return(_=O.sent())?[3,4]:[4,this.getCacheKeys()];case 2:return(x=O.sent())?(E=this.matchExistingCacheKey(t,x))?[4,this.cache.get(E)]:[3,4]:[2];case 3:_=O.sent(),O.label=4;case 4:return _?[4,this.nowProvider()]:[2];case 5:return a=O.sent(),S=Math.floor(a/1e3),_.expiresAt-s<S?_.body.refresh_token?(_.body={refresh_token:_.body.refresh_token},[4,this.cache.set(t.toKey(),_)]):[3,7]:[3,10];case 6:return O.sent(),[2,_.body];case 7:return[4,this.cache.remove(t.toKey())];case 8:return O.sent(),[4,(h=this.keyManifest)===null||h===void 0?void 0:h.remove(t.toKey())];case 9:return O.sent(),[2];case 10:return[2,_.body]}})})},i.prototype.set=function(t){var s;return Bi(this,void 0,void 0,function(){var h,_;return Fi(this,function(x){switch(x.label){case 0:return h=new qc({client_id:t.client_id,scope:t.scope,audience:t.audience}),[4,this.wrapCacheEntry(t)];case 1:return _=x.sent(),[4,this.cache.set(h.toKey(),_)];case 2:return x.sent(),[4,(s=this.keyManifest)===null||s===void 0?void 0:s.add(h.toKey())];case 3:return x.sent(),[2]}})})},i.prototype.clear=function(t){var s;return Bi(this,void 0,void 0,function(){var h,_=this;return Fi(this,function(x){switch(x.label){case 0:return[4,this.getCacheKeys()];case 1:return(h=x.sent())?[4,h.filter(function(E){return!t||E.includes(t)}).reduce(function(E,a){return Bi(_,void 0,void 0,function(){return Fi(this,function(S){switch(S.label){case 0:return[4,E];case 1:return S.sent(),[4,this.cache.remove(a)];case 2:return S.sent(),[2]}})})},Promise.resolve())]:[2];case 2:return x.sent(),[4,(s=this.keyManifest)===null||s===void 0?void 0:s.clear()];case 3:return x.sent(),[2]}})})},i.prototype.clearSync=function(t){var s=this,h=this.cache.allKeys();h&&h.filter(function(_){return!t||_.includes(t)}).forEach(function(_){s.cache.remove(_)})},i.prototype.wrapCacheEntry=function(t){return Bi(this,void 0,void 0,function(){var s,h,_;return Fi(this,function(x){switch(x.label){case 0:return[4,this.nowProvider()];case 1:return s=x.sent(),h=Math.floor(s/1e3)+t.expires_in,_=Math.min(h,t.decodedToken.claims.exp),[2,{body:t,expiresAt:_}]}})})},i.prototype.getCacheKeys=function(){var t;return Bi(this,void 0,void 0,function(){var s;return Fi(this,function(h){switch(h.label){case 0:return this.keyManifest?[4,this.keyManifest.get()]:[3,2];case 1:return s=(t=h.sent())===null||t===void 0?void 0:t.keys,[3,4];case 2:return[4,this.cache.allKeys()];case 3:s=h.sent(),h.label=4;case 4:return[2,s]}})})},i.prototype.matchExistingCacheKey=function(t,s){return s.filter(function(h){var _=qc.fromKey(h),x=new Set(_.scope&&_.scope.split(" ")),E=t.scope.split(" "),a=_.scope&&E.reduce(function(S,O){return S&&x.has(O)},!0);return _.prefix==="@@auth0spajs@@"&&_.client_id===t.client_id&&_.audience===t.audience&&a})[0]},i}(),gG=function(){function i(t,s){this.storage=t,this.clientId=s,this.storageKey="".concat("a0.spajs.txs",".").concat(this.clientId),this.transaction=this.storage.get(this.storageKey)}return i.prototype.create=function(t){this.transaction=t,this.storage.save(this.storageKey,t,{daysUntilExpire:1})},i.prototype.get=function(){return this.transaction},i.prototype.remove=function(){delete this.transaction,this.storage.remove(this.storageKey)},i}(),Op=function(i){return typeof i=="number"},yG=["iss","aud","exp","nbf","iat","jti","azp","nonce","auth_time","at_hash","c_hash","acr","amr","sub_jwk","cnf","sip_from_tag","sip_date","sip_callid","sip_cseq_num","sip_via_branch","orig","dest","mky","events","toe","txn","rph","sid","vot","vtm"],vG=function(i){if(!i.id_token)throw new Error("ID token is required but missing");var t=function(a){var S=a.split("."),O=Wh(S,3),M=O[0],P=O[1],z=O[2];if(S.length!==3||!M||!P||!z)throw new Error("ID token could not be decoded");var q=JSON.parse(ck(P)),se={__raw:a},ue={};return Object.keys(q).forEach(function(oe){se[oe]=q[oe],yG.includes(oe)||(ue[oe]=q[oe])}),{encoded:{header:M,payload:P,signature:z},header:JSON.parse(ck(M)),claims:se,user:ue}}(i.id_token);if(!t.claims.iss)throw new Error("Issuer (iss) claim must be a string present in the ID token");if(t.claims.iss!==i.iss)throw new Error('Issuer (iss) claim mismatch in the ID token; expected "'.concat(i.iss,'", found "').concat(t.claims.iss,'"'));if(!t.user.sub)throw new Error("Subject (sub) claim must be a string present in the ID token");if(t.header.alg!=="RS256")throw new Error('Signature algorithm of "'.concat(t.header.alg,'" is not supported. Expected the ID token to be signed with "RS256".'));if(!t.claims.aud||typeof t.claims.aud!="string"&&!Array.isArray(t.claims.aud))throw new Error("Audience (aud) claim must be a string or array of strings present in the ID token");if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(i.aud))throw new Error('Audience (aud) claim mismatch in the ID token; expected "'.concat(i.aud,'" but was not one of "').concat(t.claims.aud.join(", "),'"'));if(t.claims.aud.length>1){if(!t.claims.azp)throw new Error("Authorized Party (azp) claim must be a string present in the ID token when Audience (aud) claim has multiple values");if(t.claims.azp!==i.aud)throw new Error('Authorized Party (azp) claim mismatch in the ID token; expected "'.concat(i.aud,'", found "').concat(t.claims.azp,'"'))}}else if(t.claims.aud!==i.aud)throw new Error('Audience (aud) claim mismatch in the ID token; expected "'.concat(i.aud,'" but found "').concat(t.claims.aud,'"'));if(i.nonce){if(!t.claims.nonce)throw new Error("Nonce (nonce) claim must be a string present in the ID token");if(t.claims.nonce!==i.nonce)throw new Error('Nonce (nonce) claim mismatch in the ID token; expected "'.concat(i.nonce,'", found "').concat(t.claims.nonce,'"'))}if(i.max_age&&!Op(t.claims.auth_time))throw new Error("Authentication Time (auth_time) claim must be a number present in the ID token when Max Age (max_age) is specified");if(!Op(t.claims.exp))throw new Error("Expiration Time (exp) claim must be a number present in the ID token");if(!Op(t.claims.iat))throw new Error("Issued At (iat) claim must be a number present in the ID token");var s=i.leeway||60,h=new Date(i.now||Date.now()),_=new Date(0),x=new Date(0),E=new Date(0);if(E.setUTCSeconds(parseInt(t.claims.auth_time)+i.max_age+s),_.setUTCSeconds(t.claims.exp+s),x.setUTCSeconds(t.claims.nbf-s),h>_)throw new Error("Expiration Time (exp) claim error in the ID token; current time (".concat(h,") is after expiration time (").concat(_,")"));if(Op(t.claims.nbf)&&h<x)throw new Error("Not Before time (nbf) claim in the ID token indicates that this token can't be used just yet. Currrent time (".concat(h,") is before ").concat(x));if(Op(t.claims.auth_time)&&h>E)throw new Error("Authentication Time (auth_time) claim in the ID token indicates that too much time has passed since the last end-user authentication. Currrent time (".concat(h,") is after last auth at ").concat(E));if(i.organizationId){if(!t.claims.org_id)throw new Error("Organization ID (org_id) claim must be a string present in the ID token");if(i.organizationId!==t.claims.org_id)throw new Error('Organization ID (org_id) claim mismatch in the ID token; expected "'.concat(i.organizationId,'", found "').concat(t.claims.org_id,'"'))}return t},Zc=Hh(function(i,t){var s=Cs&&Cs.__assign||function(){return s=Object.assign||function(S){for(var O,M=1,P=arguments.length;M<P;M++)for(var z in O=arguments[M])Object.prototype.hasOwnProperty.call(O,z)&&(S[z]=O[z]);return S},s.apply(this,arguments)};function h(S,O){if(!O)return"";var M="; "+S;return O===!0?M:M+"="+O}function _(S,O,M){return encodeURIComponent(S).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(O).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)+function(P){if(typeof P.expires=="number"){var z=new Date;z.setMilliseconds(z.getMilliseconds()+864e5*P.expires),P.expires=z}return h("Expires",P.expires?P.expires.toUTCString():"")+h("Domain",P.domain)+h("Path",P.path)+h("Secure",P.secure)+h("SameSite",P.sameSite)}(M)}function x(S){for(var O={},M=S?S.split("; "):[],P=/(%[\dA-F]{2})+/gi,z=0;z<M.length;z++){var q=M[z].split("="),se=q.slice(1).join("=");se.charAt(0)==='"'&&(se=se.slice(1,-1));try{O[q[0].replace(P,decodeURIComponent)]=se.replace(P,decodeURIComponent)}catch{}}return O}function E(){return x(document.cookie)}function a(S,O,M){document.cookie=_(S,O,s({path:"/"},M))}t.__esModule=!0,t.encode=_,t.parse=x,t.getAll=E,t.get=function(S){return E()[S]},t.set=a,t.remove=function(S,O){a(S,"",s(s({},O),{expires:-1}))}});hb(Zc),Zc.encode,Zc.parse,Zc.getAll;var xG=Zc.get,uk=Zc.set,bG=Zc.remove,od={get:function(i){var t=xG(i);if(t!==void 0)return JSON.parse(t)},save:function(i,t,s){var h={};window.location.protocol==="https:"&&(h={secure:!0,sameSite:"none"}),(s==null?void 0:s.daysUntilExpire)&&(h.expires=s.daysUntilExpire),(s==null?void 0:s.cookieDomain)&&(h.domain=s.cookieDomain),uk(i,JSON.stringify(t),h)},remove:function(i){bG(i)}},wG={get:function(i){var t=od.get(i);return t||od.get("".concat("_legacy_").concat(i))},save:function(i,t,s){var h={};window.location.protocol==="https:"&&(h={secure:!0}),(s==null?void 0:s.daysUntilExpire)&&(h.expires=s.daysUntilExpire),uk("".concat("_legacy_").concat(i),JSON.stringify(t),h),od.save(i,t,s)},remove:function(i){od.remove(i),od.remove("".concat("_legacy_").concat(i))}},EG={get:function(i){if(typeof sessionStorage!="undefined"){var t=sessionStorage.getItem(i);if(t!==void 0)return JSON.parse(t)}},save:function(i,t){sessionStorage.setItem(i,JSON.stringify(t))},remove:function(i){sessionStorage.removeItem(i)}};function TG(i,t,s){var h=t===void 0?null:t,_=function(S,O){var M=atob(S);if(O){for(var P=new Uint8Array(M.length),z=0,q=M.length;z<q;++z)P[z]=M.charCodeAt(z);return String.fromCharCode.apply(null,new Uint16Array(P.buffer))}return M}(i,s!==void 0&&s),x=_.indexOf(`
`,10)+1,E=_.substring(x)+(h?"//# sourceMappingURL="+h:""),a=new Blob([E],{type:"application/javascript"});return URL.createObjectURL(a)}var hk,dk,fk,f1,CG=(hk="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Ci8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogICAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uCgogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55CiAgICBwdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuCgogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgKICAgIFJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWQogICAgQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULAogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NCiAgICBMT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUgogICAgT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUgogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4KICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovdmFyIGU9ZnVuY3Rpb24oKXtyZXR1cm4gZT1PYmplY3QuYXNzaWdufHxmdW5jdGlvbihlKXtmb3IodmFyIHIsdD0xLG49YXJndW1lbnRzLmxlbmd0aDt0PG47dCsrKWZvcih2YXIgbyBpbiByPWFyZ3VtZW50c1t0XSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocixvKSYmKGVbb109cltvXSk7cmV0dXJuIGV9LGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfTtmdW5jdGlvbiByKGUscix0LG4pe3JldHVybiBuZXcodHx8KHQ9UHJvbWlzZSkpKChmdW5jdGlvbihvLGEpe2Z1bmN0aW9uIHMoZSl7dHJ5e2Mobi5uZXh0KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBpKGUpe3RyeXtjKG4udGhyb3coZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIGMoZSl7dmFyIHI7ZS5kb25lP28oZS52YWx1ZSk6KHI9ZS52YWx1ZSxyIGluc3RhbmNlb2YgdD9yOm5ldyB0KChmdW5jdGlvbihlKXtlKHIpfSkpKS50aGVuKHMsaSl9Yygobj1uLmFwcGx5KGUscnx8W10pKS5uZXh0KCkpfSkpfWZ1bmN0aW9uIHQoZSxyKXt2YXIgdCxuLG8sYSxzPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZigxJm9bMF0pdGhyb3cgb1sxXTtyZXR1cm4gb1sxXX0sdHJ5czpbXSxvcHM6W119O3JldHVybiBhPXtuZXh0OmkoMCksdGhyb3c6aSgxKSxyZXR1cm46aSgyKX0sImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmKGFbU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSksYTtmdW5jdGlvbiBpKGEpe3JldHVybiBmdW5jdGlvbihpKXtyZXR1cm4gZnVuY3Rpb24oYSl7aWYodCl0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7Zm9yKDtzOyl0cnl7aWYodD0xLG4mJihvPTImYVswXT9uLnJldHVybjphWzBdP24udGhyb3d8fCgobz1uLnJldHVybikmJm8uY2FsbChuKSwwKTpuLm5leHQpJiYhKG89by5jYWxsKG4sYVsxXSkpLmRvbmUpcmV0dXJuIG87c3dpdGNoKG49MCxvJiYoYT1bMiZhWzBdLG8udmFsdWVdKSxhWzBdKXtjYXNlIDA6Y2FzZSAxOm89YTticmVhaztjYXNlIDQ6cmV0dXJuIHMubGFiZWwrKyx7dmFsdWU6YVsxXSxkb25lOiExfTtjYXNlIDU6cy5sYWJlbCsrLG49YVsxXSxhPVswXTtjb250aW51ZTtjYXNlIDc6YT1zLm9wcy5wb3AoKSxzLnRyeXMucG9wKCk7Y29udGludWU7ZGVmYXVsdDppZighKG89cy50cnlzLChvPW8ubGVuZ3RoPjAmJm9bby5sZW5ndGgtMV0pfHw2IT09YVswXSYmMiE9PWFbMF0pKXtzPTA7Y29udGludWV9aWYoMz09PWFbMF0mJighb3x8YVsxXT5vWzBdJiZhWzFdPG9bM10pKXtzLmxhYmVsPWFbMV07YnJlYWt9aWYoNj09PWFbMF0mJnMubGFiZWw8b1sxXSl7cy5sYWJlbD1vWzFdLG89YTticmVha31pZihvJiZzLmxhYmVsPG9bMl0pe3MubGFiZWw9b1syXSxzLm9wcy5wdXNoKGEpO2JyZWFrfW9bMl0mJnMub3BzLnBvcCgpLHMudHJ5cy5wb3AoKTtjb250aW51ZX1hPXIuY2FsbChlLHMpfWNhdGNoKGUpe2E9WzYsZV0sbj0wfWZpbmFsbHl7dD1vPTB9aWYoNSZhWzBdKXRocm93IGFbMV07cmV0dXJue3ZhbHVlOmFbMF0/YVsxXTp2b2lkIDAsZG9uZTohMH19KFthLGldKX19fXZhciBuPXt9LG89ZnVuY3Rpb24oZSxyKXtyZXR1cm4iIi5jb25jYXQoZSwifCIpLmNvbmNhdChyKX07YWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKGZ1bmN0aW9uKGEpe3ZhciBzPWEuZGF0YSxpPXMudGltZW91dCxjPXMuYXV0aCx1PXMuZmV0Y2hVcmwsZj1zLmZldGNoT3B0aW9ucyxsPXMudXNlRm9ybURhdGEsaD1mdW5jdGlvbihlLHIpe3ZhciB0PSJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJmVbU3ltYm9sLml0ZXJhdG9yXTtpZighdClyZXR1cm4gZTt2YXIgbixvLGE9dC5jYWxsKGUpLHM9W107dHJ5e2Zvcig7KHZvaWQgMD09PXJ8fHItLSA+MCkmJiEobj1hLm5leHQoKSkuZG9uZTspcy5wdXNoKG4udmFsdWUpfWNhdGNoKGUpe289e2Vycm9yOmV9fWZpbmFsbHl7dHJ5e24mJiFuLmRvbmUmJih0PWEucmV0dXJuKSYmdC5jYWxsKGEpfWZpbmFsbHl7aWYobyl0aHJvdyBvLmVycm9yfX1yZXR1cm4gc30oYS5wb3J0cywxKVswXTtyZXR1cm4gcih2b2lkIDAsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24oKXt2YXIgcixhLHMscCx5LGIsZCx2LHcsZztyZXR1cm4gdCh0aGlzLChmdW5jdGlvbih0KXtzd2l0Y2godC5sYWJlbCl7Y2FzZSAwOnM9KGE9Y3x8e30pLmF1ZGllbmNlLHA9YS5zY29wZSx0LmxhYmVsPTE7Y2FzZSAxOmlmKHQudHJ5cy5wdXNoKFsxLDcsLDhdKSwhKHk9bD8oaz1mLmJvZHksUz1uZXcgVVJMU2VhcmNoUGFyYW1zKGspLF89e30sUy5mb3JFYWNoKChmdW5jdGlvbihlLHIpe19bcl09ZX0pKSxfKTpKU09OLnBhcnNlKGYuYm9keSkpLnJlZnJlc2hfdG9rZW4mJiJyZWZyZXNoX3Rva2VuIj09PXkuZ3JhbnRfdHlwZSl7aWYoYj1mdW5jdGlvbihlLHIpe3JldHVybiBuW28oZSxyKV19KHMscCksIWIpdGhyb3cgbmV3IEVycm9yKCJUaGUgd2ViIHdvcmtlciBpcyBtaXNzaW5nIHRoZSByZWZyZXNoIHRva2VuIik7Zi5ib2R5PWw/bmV3IFVSTFNlYXJjaFBhcmFtcyhlKGUoe30seSkse3JlZnJlc2hfdG9rZW46Yn0pKS50b1N0cmluZygpOkpTT04uc3RyaW5naWZ5KGUoZSh7fSx5KSx7cmVmcmVzaF90b2tlbjpifSkpfWQ9dm9pZCAwLCJmdW5jdGlvbiI9PXR5cGVvZiBBYm9ydENvbnRyb2xsZXImJihkPW5ldyBBYm9ydENvbnRyb2xsZXIsZi5zaWduYWw9ZC5zaWduYWwpLHY9dm9pZCAwLHQubGFiZWw9MjtjYXNlIDI6cmV0dXJuIHQudHJ5cy5wdXNoKFsyLDQsLDVdKSxbNCxQcm9taXNlLnJhY2UoWyhtPWksbmV3IFByb21pc2UoKGZ1bmN0aW9uKGUpe3JldHVybiBzZXRUaW1lb3V0KGUsbSl9KSkpLGZldGNoKHUsZSh7fSxmKSldKV07Y2FzZSAzOnJldHVybiB2PXQuc2VudCgpLFszLDVdO2Nhc2UgNDpyZXR1cm4gdz10LnNlbnQoKSxoLnBvc3RNZXNzYWdlKHtlcnJvcjp3Lm1lc3NhZ2V9KSxbMl07Y2FzZSA1OnJldHVybiB2P1s0LHYuanNvbigpXTooZCYmZC5hYm9ydCgpLGgucG9zdE1lc3NhZ2Uoe2Vycm9yOiJUaW1lb3V0IHdoZW4gZXhlY3V0aW5nICdmZXRjaCcifSksWzJdKTtjYXNlIDY6cmV0dXJuKHI9dC5zZW50KCkpLnJlZnJlc2hfdG9rZW4/KGZ1bmN0aW9uKGUscix0KXtuW28ocix0KV09ZX0oci5yZWZyZXNoX3Rva2VuLHMscCksZGVsZXRlIHIucmVmcmVzaF90b2tlbik6ZnVuY3Rpb24oZSxyKXtkZWxldGUgbltvKGUscildfShzLHApLGgucG9zdE1lc3NhZ2Uoe29rOnYub2ssanNvbjpyfSksWzMsOF07Y2FzZSA3OnJldHVybiBnPXQuc2VudCgpLGgucG9zdE1lc3NhZ2Uoe29rOiExLGpzb246e2Vycm9yX2Rlc2NyaXB0aW9uOmcubWVzc2FnZX19KSxbMyw4XTtjYXNlIDg6cmV0dXJuWzJdfXZhciBtLGssUyxffSkpfSkpfSkpfSgpOwoK",dk=null,fk=!1,function(i){return f1=f1||TG(hk,dk,fk),new Worker(f1,i)}),p1={},SG=function(){function i(t,s){this.cache=t,this.clientId=s,this.manifestKey=this.createManifestKeyFrom(this.clientId)}return i.prototype.add=function(t){var s;return Bi(this,void 0,void 0,function(){var h,_;return Fi(this,function(x){switch(x.label){case 0:return _=Set.bind,[4,this.cache.get(this.manifestKey)];case 1:return(h=new(_.apply(Set,[void 0,((s=x.sent())===null||s===void 0?void 0:s.keys)||[]]))).add(t),[4,this.cache.set(this.manifestKey,{keys:ub([],Wh(h),!1)})];case 2:return x.sent(),[2]}})})},i.prototype.remove=function(t){return Bi(this,void 0,void 0,function(){var s,h;return Fi(this,function(_){switch(_.label){case 0:return[4,this.cache.get(this.manifestKey)];case 1:return(s=_.sent())?((h=new Set(s.keys)).delete(t),h.size>0?[4,this.cache.set(this.manifestKey,{keys:ub([],Wh(h),!1)})]:[3,3]):[3,5];case 2:case 4:return[2,_.sent()];case 3:return[4,this.cache.remove(this.manifestKey)];case 5:return[2]}})})},i.prototype.get=function(){return this.cache.get(this.manifestKey)},i.prototype.clear=function(){return this.cache.remove(this.manifestKey)},i.prototype.createManifestKeyFrom=function(t){return"".concat("@@auth0spajs@@","::").concat(t)},i}(),pk=new eG,AG={memory:function(){return new mG().enclosedCache},localstorage:function(){return new pG}},mk=function(i){return AG[i]},IG=function(){return!/Trident.*rv:11\.0/.test(navigator.userAgent)},MG=function(){function i(t){var s,h,_,x;if(this.options=t,typeof window!="undefined"&&function(){if(!c1())throw new Error("For security reasons, `window.crypto` is required to run `auth0-spa-js`.");if(lk()===void 0)throw new Error(`
      auth0-spa-js must run on a secure origin. See https://github.com/auth0/auth0-spa-js/blob/master/FAQ.md#why-do-i-get-auth0-spa-js-must-run-on-a-secure-origin for more information.
    `)}(),t.cache&&t.cacheLocation&&console.warn("Both `cache` and `cacheLocation` options have been specified in the Auth0Client configuration; ignoring `cacheLocation` and using `cache`."),t.cache)_=t.cache;else{if(this.cacheLocation=t.cacheLocation||"memory",!mk(this.cacheLocation))throw new Error('Invalid cache location "'.concat(this.cacheLocation,'"'));_=mk(this.cacheLocation)()}this.httpTimeoutMs=t.httpTimeoutInSeconds?1e3*t.httpTimeoutInSeconds:1e4,this.cookieStorage=t.legacySameSiteCookie===!1?od:wG,this.orgHintCookieName=(x=this.options.client_id,"auth0.".concat(x,".organization_hint")),this.isAuthenticatedCookieName=function(S){return"auth0.".concat(S,".is.authenticated")}(this.options.client_id),this.sessionCheckExpiryDays=t.sessionCheckExpiryDays||1;var E,a=t.useCookiesForTransactions?this.cookieStorage:EG;this.scope=this.options.scope,this.transactionManager=new gG(a,this.options.client_id),this.nowProvider=this.options.nowProvider||ak,this.cacheManager=new _G(_,_.allKeys?null:new SG(_,this.options.client_id),this.nowProvider),this.domainUrl=(E=this.options.domain,/^https?:\/\//.test(E)?E:"https://".concat(E)),this.tokenIssuer=function(S,O){return S?S.startsWith("https://")?S:"https://".concat(S,"/"):"".concat(O,"/")}(this.options.issuer,this.domainUrl),this.defaultScope=_l("openid",((h=(s=this.options)===null||s===void 0?void 0:s.advancedOptions)===null||h===void 0?void 0:h.defaultScope)!==void 0?this.options.advancedOptions.defaultScope:"openid profile email"),this.options.useRefreshTokens&&(this.scope=_l(this.scope,"offline_access")),typeof window!="undefined"&&window.Worker&&this.options.useRefreshTokens&&this.cacheLocation==="memory"&&IG()&&(this.worker=new CG),this.customOptions=function(S){return S.advancedOptions,S.audience,S.auth0Client,S.authorizeTimeoutInSeconds,S.cacheLocation,S.client_id,S.domain,S.issuer,S.leeway,S.max_age,S.redirect_uri,S.scope,S.useRefreshTokens,S.useCookiesForTransactions,S.useFormData,Zr(S,["advancedOptions","audience","auth0Client","authorizeTimeoutInSeconds","cacheLocation","client_id","domain","issuer","leeway","max_age","redirect_uri","scope","useRefreshTokens","useCookiesForTransactions","useFormData"])}(t)}return i.prototype._url=function(t){var s=encodeURIComponent(btoa(JSON.stringify(this.options.auth0Client||sk)));return"".concat(this.domainUrl).concat(t,"&auth0Client=").concat(s)},i.prototype._getParams=function(t,s,h,_,x){var E=this.options;E.useRefreshTokens,E.useCookiesForTransactions,E.useFormData,E.auth0Client,E.cacheLocation,E.advancedOptions,E.detailedResponse,E.nowProvider,E.authorizeTimeoutInSeconds,E.legacySameSiteCookie,E.sessionCheckExpiryDays,E.domain,E.leeway,E.httpTimeoutInSeconds;var a=Zr(E,["useRefreshTokens","useCookiesForTransactions","useFormData","auth0Client","cacheLocation","advancedOptions","detailedResponse","nowProvider","authorizeTimeoutInSeconds","legacySameSiteCookie","sessionCheckExpiryDays","domain","leeway","httpTimeoutInSeconds"]);return gi(gi(gi({},a),t),{scope:_l(this.defaultScope,this.scope,t.scope),response_type:"code",response_mode:"query",state:s,nonce:h,redirect_uri:x||this.options.redirect_uri,code_challenge:_,code_challenge_method:"S256"})},i.prototype._authorizeUrl=function(t){return this._url("/authorize?".concat(u1(t)))},i.prototype._verifyIdToken=function(t,s,h){return Bi(this,void 0,void 0,function(){var _;return Fi(this,function(x){switch(x.label){case 0:return[4,this.nowProvider()];case 1:return _=x.sent(),[2,vG({iss:this.tokenIssuer,aud:this.options.client_id,id_token:t,nonce:s,organizationId:h,leeway:this.options.leeway,max_age:this._parseNumber(this.options.max_age),now:_})]}})})},i.prototype._parseNumber=function(t){return typeof t!="string"?t:parseInt(t,10)||void 0},i.prototype._processOrgIdHint=function(t){t?this.cookieStorage.save(this.orgHintCookieName,t,{daysUntilExpire:this.sessionCheckExpiryDays}):this.cookieStorage.remove(this.orgHintCookieName)},i.prototype.buildAuthorizeUrl=function(t){return t===void 0&&(t={}),Bi(this,void 0,void 0,function(){var s,h,_,x,E,a,S,O,M,P,z,q;return Fi(this,function(se){switch(se.label){case 0:return s=t.redirect_uri,h=t.appState,_=Zr(t,["redirect_uri","appState"]),x=rd(ha()),E=rd(ha()),a=ha(),[4,h1(a)];case 1:return S=se.sent(),O=d1(S),M=t.fragment?"#".concat(t.fragment):"",P=this._getParams(_,x,E,O,s),z=this._authorizeUrl(P),q=t.organization||this.options.organization,this.transactionManager.create(gi({nonce:E,code_verifier:a,appState:h,scope:P.scope,audience:P.audience||"default",redirect_uri:P.redirect_uri,state:x},q&&{organizationId:q})),[2,z+M]}})})},i.prototype.loginWithPopup=function(t,s){return Bi(this,void 0,void 0,function(){var h,_,x,E,a,S,O,M,P,z,q,se,ue;return Fi(this,function(oe){switch(oe.label){case 0:if(t=t||{},!(s=s||{}).popup&&(s.popup=function(fe){var xe=window.screenX+(window.innerWidth-400)/2,Be=window.screenY+(window.innerHeight-600)/2;return window.open(fe,"auth0:authorize:popup","left=".concat(xe,",top=").concat(Be,",width=").concat(400,",height=").concat(600,",resizable,scrollbars=yes,status=1"))}(""),!s.popup))throw new Error("Unable to open a popup for loginWithPopup - window.open returned `null`");return h=Zr(t,[]),_=rd(ha()),x=rd(ha()),E=ha(),[4,h1(E)];case 1:return a=oe.sent(),S=d1(a),O=this._getParams(h,_,x,S,this.options.redirect_uri||window.location.origin),M=this._authorizeUrl(gi(gi({},O),{response_mode:"web_message"})),s.popup.location.href=M,[4,aG(gi(gi({},s),{timeoutInSeconds:s.timeoutInSeconds||this.options.authorizeTimeoutInSeconds||60}))];case 2:if(P=oe.sent(),_!==P.state)throw new Error("Invalid state");return[4,vy({audience:O.audience,scope:O.scope,baseUrl:this.domainUrl,client_id:this.options.client_id,code_verifier:E,code:P.code,grant_type:"authorization_code",redirect_uri:O.redirect_uri,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs},this.worker)];case 3:return z=oe.sent(),q=t.organization||this.options.organization,[4,this._verifyIdToken(z.id_token,x,q)];case 4:return se=oe.sent(),ue=gi(gi({},z),{decodedToken:se,scope:O.scope,audience:O.audience||"default",client_id:this.options.client_id}),[4,this.cacheManager.set(ue)];case 5:return oe.sent(),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this._processOrgIdHint(se.claims.org_id),[2]}})})},i.prototype.getUser=function(t){return t===void 0&&(t={}),Bi(this,void 0,void 0,function(){var s,h,_;return Fi(this,function(x){switch(x.label){case 0:return s=t.audience||this.options.audience||"default",h=_l(this.defaultScope,this.scope,t.scope),[4,this.cacheManager.get(new qc({client_id:this.options.client_id,audience:s,scope:h}))];case 1:return[2,(_=x.sent())&&_.decodedToken&&_.decodedToken.user]}})})},i.prototype.getIdTokenClaims=function(t){return t===void 0&&(t={}),Bi(this,void 0,void 0,function(){var s,h,_;return Fi(this,function(x){switch(x.label){case 0:return s=t.audience||this.options.audience||"default",h=_l(this.defaultScope,this.scope,t.scope),[4,this.cacheManager.get(new qc({client_id:this.options.client_id,audience:s,scope:h}))];case 1:return[2,(_=x.sent())&&_.decodedToken&&_.decodedToken.claims]}})})},i.prototype.loginWithRedirect=function(t){return t===void 0&&(t={}),Bi(this,void 0,void 0,function(){var s,h,_;return Fi(this,function(x){switch(x.label){case 0:return s=t.redirectMethod,h=Zr(t,["redirectMethod"]),[4,this.buildAuthorizeUrl(h)];case 1:return _=x.sent(),window.location[s||"assign"](_),[2]}})})},i.prototype.handleRedirectCallback=function(t){return t===void 0&&(t=window.location.href),Bi(this,void 0,void 0,function(){var s,h,_,x,E,a,S,O,M,P;return Fi(this,function(z){switch(z.label){case 0:if((s=t.split("?").slice(1)).length===0)throw new Error("There are no query params available for parsing.");if(h=function(q){q.indexOf("#")>-1&&(q=q.substr(0,q.indexOf("#")));var se=q.split("&"),ue={};return se.forEach(function(oe){var fe=Wh(oe.split("="),2),xe=fe[0],Be=fe[1];ue[xe]=decodeURIComponent(Be)}),ue.expires_in&&(ue.expires_in=parseInt(ue.expires_in)),ue}(s.join("")),_=h.state,x=h.code,E=h.error,a=h.error_description,!(S=this.transactionManager.get()))throw new Error("Invalid state");if(this.transactionManager.remove(),E)throw new nG(E,a,_,S.appState);if(!S.code_verifier||S.state&&S.state!==_)throw new Error("Invalid state");return O={audience:S.audience,scope:S.scope,baseUrl:this.domainUrl,client_id:this.options.client_id,code_verifier:S.code_verifier,grant_type:"authorization_code",code:x,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs},S.redirect_uri!==void 0&&(O.redirect_uri=S.redirect_uri),[4,vy(O,this.worker)];case 1:return M=z.sent(),[4,this._verifyIdToken(M.id_token,S.nonce,S.organizationId)];case 2:return P=z.sent(),[4,this.cacheManager.set(gi(gi(gi(gi({},M),{decodedToken:P,audience:S.audience,scope:S.scope}),M.scope?{oauthTokenScope:M.scope}:null),{client_id:this.options.client_id}))];case 3:return z.sent(),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this._processOrgIdHint(P.claims.org_id),[2,{appState:S.appState}]}})})},i.prototype.checkSession=function(t){return Bi(this,void 0,void 0,function(){var s;return Fi(this,function(h){switch(h.label){case 0:if(!this.cookieStorage.get(this.isAuthenticatedCookieName)){if(!this.cookieStorage.get("auth0.is.authenticated"))return[2];this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove("auth0.is.authenticated")}h.label=1;case 1:return h.trys.push([1,3,,4]),[4,this.getTokenSilently(t)];case 2:return h.sent(),[3,4];case 3:if(s=h.sent(),!iG.includes(s.error))throw s;return[3,4];case 4:return[2]}})})},i.prototype.getTokenSilently=function(t){return t===void 0&&(t={}),Bi(this,void 0,void 0,function(){var s,h,_,x=this;return Fi(this,function(E){return s=gi(gi({audience:this.options.audience,ignoreCache:!1},t),{scope:_l(this.defaultScope,this.scope,t.scope)}),h=s.ignoreCache,_=Zr(s,["ignoreCache"]),[2,(a=function(){return x._getTokenSilently(gi({ignoreCache:h},_))},S="".concat(this.options.client_id,"::").concat(_.audience,"::").concat(_.scope),O=p1[S],O||(O=a().finally(function(){delete p1[S],O=null}),p1[S]=O),O)];var a,S,O})})},i.prototype._getTokenSilently=function(t){return t===void 0&&(t={}),Bi(this,void 0,void 0,function(){var s,h,_,x,E,a,S,O,M;return Fi(this,function(P){switch(P.label){case 0:return s=t.ignoreCache,h=Zr(t,["ignoreCache"]),s?[3,2]:[4,this._getEntryFromCache({scope:h.scope,audience:h.audience||"default",client_id:this.options.client_id,getDetailedEntry:t.detailedResponse})];case 1:if(_=P.sent())return[2,_];P.label=2;case 2:return[4,(z=function(){return pk.acquireLock("auth0.lock.getTokenSilently",5e3)},q=10,q===void 0&&(q=3),Bi(void 0,void 0,void 0,function(){var se;return Fi(this,function(ue){switch(ue.label){case 0:se=0,ue.label=1;case 1:return se<q?[4,z()]:[3,4];case 2:if(ue.sent())return[2,!0];ue.label=3;case 3:return se++,[3,1];case 4:return[2,!1]}})}))];case 3:if(!P.sent())return[3,15];P.label=4;case 4:return P.trys.push([4,,12,14]),s?[3,6]:[4,this._getEntryFromCache({scope:h.scope,audience:h.audience||"default",client_id:this.options.client_id,getDetailedEntry:t.detailedResponse})];case 5:if(_=P.sent())return[2,_];P.label=6;case 6:return this.options.useRefreshTokens?[4,this._getTokenUsingRefreshToken(h)]:[3,8];case 7:return E=P.sent(),[3,10];case 8:return[4,this._getTokenFromIFrame(h)];case 9:E=P.sent(),P.label=10;case 10:return x=E,[4,this.cacheManager.set(gi({client_id:this.options.client_id},x))];case 11:return P.sent(),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),t.detailedResponse?(a=x.id_token,S=x.access_token,O=x.oauthTokenScope,M=x.expires_in,[2,gi(gi({id_token:a,access_token:S},O?{scope:O}:null),{expires_in:M})]):[2,x.access_token];case 12:return[4,pk.releaseLock("auth0.lock.getTokenSilently")];case 13:return P.sent(),[7];case 14:return[3,16];case 15:throw new l1;case 16:return[2]}var z,q})})},i.prototype.getTokenWithPopup=function(t,s){return t===void 0&&(t={}),s===void 0&&(s={}),Bi(this,void 0,void 0,function(){return Fi(this,function(h){switch(h.label){case 0:return t.audience=t.audience||this.options.audience,t.scope=_l(this.defaultScope,this.scope,t.scope),s=gi(gi({},tG),s),[4,this.loginWithPopup(t,s)];case 1:return h.sent(),[4,this.cacheManager.get(new qc({scope:t.scope,audience:t.audience||"default",client_id:this.options.client_id}))];case 2:return[2,h.sent().access_token]}})})},i.prototype.isAuthenticated=function(){return Bi(this,void 0,void 0,function(){return Fi(this,function(t){switch(t.label){case 0:return[4,this.getUser()];case 1:return[2,!!t.sent()]}})})},i.prototype.buildLogoutUrl=function(t){t===void 0&&(t={}),t.client_id!==null?t.client_id=t.client_id||this.options.client_id:delete t.client_id;var s=t.federated,h=Zr(t,["federated"]),_=s?"&federated":"";return this._url("/v2/logout?".concat(u1(h)))+_},i.prototype.logout=function(t){var s=this;t===void 0&&(t={});var h=t.localOnly,_=Zr(t,["localOnly"]);if(h&&_.federated)throw new Error("It is invalid to set both the `federated` and `localOnly` options to `true`");var x=function(){if(s.cookieStorage.remove(s.orgHintCookieName),s.cookieStorage.remove(s.isAuthenticatedCookieName),!h){var E=s.buildLogoutUrl(_);window.location.assign(E)}};if(this.options.cache)return this.cacheManager.clear().then(function(){return x()});this.cacheManager.clearSync(),x()},i.prototype._getTokenFromIFrame=function(t){return Bi(this,void 0,void 0,function(){var s,h,_,x,E,a,S,O,M,P,z,q,se,ue,oe,fe,xe;return Fi(this,function(Be){switch(Be.label){case 0:return s=rd(ha()),h=rd(ha()),_=ha(),[4,h1(_)];case 1:x=Be.sent(),E=d1(x),a=Zr(t,["detailedResponse"]),S=this._getParams(a,s,h,E,t.redirect_uri||this.options.redirect_uri||window.location.origin),(O=this.cookieStorage.get(this.orgHintCookieName))&&!S.organization&&(S.organization=O),M=this._authorizeUrl(gi(gi({},S),{prompt:"none",response_mode:"web_message"})),Be.label=2;case 2:if(Be.trys.push([2,6,,7]),window.crossOriginIsolated)throw new ml("login_required","The application is running in a Cross-Origin Isolated context, silently retrieving a token without refresh token is not possible.");return P=t.timeoutInSeconds||this.options.authorizeTimeoutInSeconds,[4,($e=M,Ge=this.domainUrl,xt=P,xt===void 0&&(xt=60),new Promise(function(pt,jt){var Dt=window.document.createElement("iframe");Dt.setAttribute("width","0"),Dt.setAttribute("height","0"),Dt.style.display="none";var Ft,ai=function(){window.document.body.contains(Dt)&&(window.document.body.removeChild(Dt),window.removeEventListener("message",Ft,!1))},wt=setTimeout(function(){jt(new l1),ai()},1e3*xt);Ft=function(Nt){if(Nt.origin==Ge&&Nt.data&&Nt.data.type==="authorization_response"){var qi=Nt.source;qi&&qi.close(),Nt.data.response.error?jt(ml.fromPayload(Nt.data.response)):pt(Nt.data.response),clearTimeout(wt),window.removeEventListener("message",Ft,!1),setTimeout(ai,2e3)}},window.addEventListener("message",Ft,!1),window.document.body.appendChild(Dt),Dt.setAttribute("src",$e)}))];case 3:if(z=Be.sent(),s!==z.state)throw new Error("Invalid state");return q=t.scope,se=t.audience,ue=Zr(t,["scope","audience","redirect_uri","ignoreCache","timeoutInSeconds","detailedResponse"]),[4,vy(gi(gi(gi({},this.customOptions),ue),{scope:q,audience:se,baseUrl:this.domainUrl,client_id:this.options.client_id,code_verifier:_,code:z.code,grant_type:"authorization_code",redirect_uri:S.redirect_uri,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:ue.timeout||this.httpTimeoutMs}),this.worker)];case 4:return oe=Be.sent(),[4,this._verifyIdToken(oe.id_token,h)];case 5:return fe=Be.sent(),this._processOrgIdHint(fe.claims.org_id),[2,gi(gi({},oe),{decodedToken:fe,scope:S.scope,oauthTokenScope:oe.scope,audience:S.audience||"default"})];case 6:throw(xe=Be.sent()).error==="login_required"&&this.logout({localOnly:!0}),xe;case 7:return[2]}var $e,Ge,xt})})},i.prototype._getTokenUsingRefreshToken=function(t){return Bi(this,void 0,void 0,function(){var s,h,_,x,E,a,S,O,M;return Fi(this,function(P){switch(P.label){case 0:return t.scope=_l(this.defaultScope,this.options.scope,t.scope),[4,this.cacheManager.get(new qc({scope:t.scope,audience:t.audience||"default",client_id:this.options.client_id}))];case 1:return(s=P.sent())&&s.refresh_token||this.worker?[3,3]:[4,this._getTokenFromIFrame(t)];case 2:return[2,P.sent()];case 3:h=t.redirect_uri||this.options.redirect_uri||window.location.origin,x=t.scope,E=t.audience,a=Zr(t,["scope","audience","ignoreCache","timeoutInSeconds","detailedResponse"]),S=typeof t.timeoutInSeconds=="number"?1e3*t.timeoutInSeconds:null,P.label=4;case 4:return P.trys.push([4,6,,9]),[4,vy(gi(gi(gi(gi(gi({},this.customOptions),a),{audience:E,scope:x,baseUrl:this.domainUrl,client_id:this.options.client_id,grant_type:"refresh_token",refresh_token:s&&s.refresh_token,redirect_uri:h}),S&&{timeout:S}),{auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs}),this.worker)];case 5:return _=P.sent(),[3,9];case 6:return(O=P.sent()).message==="The web worker is missing the refresh token"||O.message&&O.message.indexOf("invalid refresh token")>-1?[4,this._getTokenFromIFrame(t)]:[3,8];case 7:return[2,P.sent()];case 8:throw O;case 9:return[4,this._verifyIdToken(_.id_token)];case 10:return M=P.sent(),[2,gi(gi({},_),{decodedToken:M,scope:t.scope,oauthTokenScope:_.scope,audience:t.audience||"default"})]}})})},i.prototype._getEntryFromCache=function(t){var s=t.scope,h=t.audience,_=t.client_id,x=t.getDetailedEntry,E=x!==void 0&&x;return Bi(this,void 0,void 0,function(){var a,S,O,M,P;return Fi(this,function(z){switch(z.label){case 0:return[4,this.cacheManager.get(new qc({scope:s,audience:h,client_id:_}),60)];case 1:return(a=z.sent())&&a.access_token?E?(S=a.id_token,O=a.access_token,M=a.oauthTokenScope,P=a.expires_in,[2,gi(gi({id_token:S,access_token:O},M?{scope:M}:null),{expires_in:P})]):[2,a.access_token]:[2]}})})},i}();function kG(i){return Bi(this,void 0,void 0,function(){var t;return Fi(this,function(s){switch(s.label){case 0:return[4,(t=new MG(i)).checkSession()];case 1:return s.sent(),[2,t]}})})}class PG{constructor(){this._listeners={}}on(t,s,h=null){typeof s=="function"&&(this._listeners[t]=this._listeners[t]||[],s.ctx=h,this._listeners[t].push(s))}off(t,s){this._listeners[t]=this._listeners[t]||[];const h=this._listeners[t].indexOf(s);h!==-1&&this._listeners[t].splice(h,1)}emit(t,s){this._listeners[t]=this._listeners[t]||[];let h=this._listeners[t].length;for(let _=0;_<h;_++){let x=this._listeners[t][_];x.ctx?x.call(x.ctx,s):x(s)}}}const DG=()=>window.history.replaceState({},document.title,window.location.pathname);let gl;class LG extends PG{constructor(t={}){if(gl)return gl;super();return gl=this,this.AUTH_EVENTS={LOADING:"LOADING",LOADED:"LOADED",AUTHENTICATED:"AUTHENTICATED",TOKEN_CHANGE:"TOKEN_CHANGE"},this.options=t,this.options.onRedirectCallback=this.options.onRedirectCallback||DG,this.loading=!0,this.isAuthenticated=!1,this.user={},this.userInfo={},this.identity={},this.bearer="",this.auth0Client=null,this.popupOpen=!1,this.error=null,this.created(t),gl}async loginWithPopup(t={returnTo:window.location.origin}){this.popupOpen=!0;try{await this.auth0Client.loginWithPopup(t),this.user=await this.auth0Client.getUser(),await this.getUserData(),this.isAuthenticated=!0}catch(s){console.error(s)}finally{this.popupOpen=!1}}async handleRedirectCallback(){this.loading=!0;try{await this.auth0Client.handleRedirectCallback(),this.user=await this.auth0Client.getUser(),await this.getUserData(),this.isAuthenticated=!0}catch(t){this.error=t}finally{this.loading=!1}}loginWithRedirect(t={}){return t.appState||(t.redirectUri=t.redirectUri||window.location.href),this.auth0Client.loginWithRedirect(t)}getIdTokenClaims(t){return this.auth0Client.getIdTokenClaims(t)}async getTokenSilently(t){const s=await this.auth0Client.getTokenSilently(t);return this.getIdentityClaims(s),this.emit(this.AUTH_EVENTS.TOKEN_CHANGE,this),s}hasPermissions(t){if(Array.isArray(t)||(t=[t]),!this.identity.permissions)return!1;for(;t.length;){const s=t.pop();if(!this.identity.permissions.find(_=>_===s))return!1}return!0}hasRoles(t){if(Array.isArray(t)||(t=[t]),!this.userInfo.roles)return!1;for(;t.length;){const s=t.pop();if(!this.userInfo.roles.find(_=>_===s))return!1}return!0}async getIdentityClaims(t){return this.identity=JSON.parse(OG(t)),this.identity}async getTokenWithPopup(t){const s=await this.auth0Client.getTokenWithPopup(t);return this.getIdentityClaims(s),this.emit(this.AUTH_EVENTS.TOKEN_CHANGE,this),s}async getUserData(){try{const t=await this.getTokenSilently();await this.getIdentityClaims(t),this.bearer="Bearer "+t;const h=await(await fetch(`https://${this.options.domain}/userinfo`,{headers:{authorization:this.bearer}})).json();for(const _ in h){let x=_;_.includes("https")&&(x=x.slice(x.lastIndexOf("/")+1)),this.userInfo[x]=h[_]}this.user.isAuthenticated=!0,this.emit(this.AUTH_EVENTS.AUTHENTICATED,this)}catch(t){console.error("[AUTH0-PROVIDER-ERROR] unable to retrieve user data",t)}}logout(t={returnTo:window.location.origin}){const s=this.auth0Client.logout(t);return this.bearer="",this.user={},this.userInfo={},this.identity={},this.isAuthenticated=!1,s}async created(t){this.emit(this.AUTH_EVENTS.LOADING),this.auth0Client=await kG({domain:t.domain,client_id:t.clientId,audience:t.audience,redirect_uri:t.redirectUri||window.location.origin,useRefreshTokens:t.useRefreshTokens||!1});try{if(window.location.search.includes("code=")&&window.location.search.includes("state=")){const{appState:s}=await this.auth0Client.handleRedirectCallback();t.onRedirectCallback(s)}}catch(s){this.error=s}finally{this.isAuthenticated=await this.auth0Client.isAuthenticated(),this.user=await this.auth0Client.getUser(),await this.getUserData(),this.loading=!1,this.emit(this.AUTH_EVENTS.LOADED)}}}const _k=i=>new Promise((t,s)=>{const h=gl;if(!h.loading)return typeof i=="function"&&i(h),t(h);h.on(h.AUTH_EVENTS.LOADED,()=>{t(h),typeof i=="function"&&i(h)})});function zG(i="."){try{return decodeURIComponent(atob(i).replace(/(.)/g,function(t,s){let h=s.charCodeAt(0).toString(16).toUpperCase();return h.length<2&&(h="0"+h),"%"+h}))}catch(t){console.error("[AUTH0-PROVIDER-ERROR] unable to decode token",t)}}function OG(i="."){try{i=i.split(".")[1];let t=i.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Illegal base64url string!")}return zG(t)}catch(t){console.error("[AUTH0-PROVIDER-ERROR] unable to decode token",t)}}function Y8(i){return new LG(i)}async function J8(i,t,s){try{return await _k(),gl.isAuthenticated?s():gl.loginWithRedirect({appState:{targetUrl:i.fullPath}})}catch{return gl.loginWithRedirect({appState:{targetUrl:i.fullPath}})}}async function Q8(i,t,s){try{await _k(),s()}catch(h){return console.error("[AUTH_SETTLED]",h),s()}}var m1={exports:{}},xy={},RG=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,BG=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],gk=function(t){var s=t,h=t.indexOf("["),_=t.indexOf("]");h!=-1&&_!=-1&&(t=t.substring(0,h)+t.substring(h,_).replace(/:/g,";")+t.substring(_,t.length));for(var x=RG.exec(t||""),E={},a=14;a--;)E[BG[a]]=x[a]||"";return h!=-1&&_!=-1&&(E.source=s,E.host=E.host.substring(1,E.host.length-1).replace(/;/g,":"),E.authority=E.authority.replace("[","").replace("]","").replace(/;/g,":"),E.ipv6uri=!0),E.pathNames=FG(E,E.path),E.queryKey=NG(E,E.query),E};function FG(i,t){var s=/\/{2,9}/g,h=t.replace(s,"/").split("/");return(t.substr(0,1)=="/"||t.length===0)&&h.splice(0,1),t.substr(t.length-1,1)=="/"&&h.splice(h.length-1,1),h}function NG(i,t){var s={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(h,_,x){_&&(s[_]=x)}),s}var sd={exports:{}},ad=1e3,ld=ad*60,cd=ld*60,Wc=cd*24,UG=Wc*7,jG=Wc*365.25,VG=function(i,t){t=t||{};var s=typeof i;if(s==="string"&&i.length>0)return $G(i);if(s==="number"&&isFinite(i))return t.long?qG(i):GG(i);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(i))};function $G(i){if(i=String(i),!(i.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(!!t){var s=parseFloat(t[1]),h=(t[2]||"ms").toLowerCase();switch(h){case"years":case"year":case"yrs":case"yr":case"y":return s*jG;case"weeks":case"week":case"w":return s*UG;case"days":case"day":case"d":return s*Wc;case"hours":case"hour":case"hrs":case"hr":case"h":return s*cd;case"minutes":case"minute":case"mins":case"min":case"m":return s*ld;case"seconds":case"second":case"secs":case"sec":case"s":return s*ad;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}function GG(i){var t=Math.abs(i);return t>=Wc?Math.round(i/Wc)+"d":t>=cd?Math.round(i/cd)+"h":t>=ld?Math.round(i/ld)+"m":t>=ad?Math.round(i/ad)+"s":i+"ms"}function qG(i){var t=Math.abs(i);return t>=Wc?by(i,t,Wc,"day"):t>=cd?by(i,t,cd,"hour"):t>=ld?by(i,t,ld,"minute"):t>=ad?by(i,t,ad,"second"):i+" ms"}function by(i,t,s,h){var _=t>=s*1.5;return Math.round(i/s)+" "+h+(_?"s":"")}function ZG(i){s.debug=s,s.default=s,s.coerce=S,s.disable=x,s.enable=_,s.enabled=E,s.humanize=VG,s.destroy=O,Object.keys(i).forEach(M=>{s[M]=i[M]}),s.names=[],s.skips=[],s.formatters={};function t(M){let P=0;for(let z=0;z<M.length;z++)P=(P<<5)-P+M.charCodeAt(z),P|=0;return s.colors[Math.abs(P)%s.colors.length]}s.selectColor=t;function s(M){let P,z=null;function q(...se){if(!q.enabled)return;const ue=q,oe=Number(new Date),fe=oe-(P||oe);ue.diff=fe,ue.prev=P,ue.curr=oe,P=oe,se[0]=s.coerce(se[0]),typeof se[0]!="string"&&se.unshift("%O");let xe=0;se[0]=se[0].replace(/%([a-zA-Z%])/g,($e,Ge)=>{if($e==="%%")return"%";xe++;const xt=s.formatters[Ge];if(typeof xt=="function"){const pt=se[xe];$e=xt.call(ue,pt),se.splice(xe,1),xe--}return $e}),s.formatArgs.call(ue,se),(ue.log||s.log).apply(ue,se)}return q.namespace=M,q.useColors=s.useColors(),q.color=s.selectColor(M),q.extend=h,q.destroy=s.destroy,Object.defineProperty(q,"enabled",{enumerable:!0,configurable:!1,get:()=>z===null?s.enabled(M):z,set:se=>{z=se}}),typeof s.init=="function"&&s.init(q),q}function h(M,P){const z=s(this.namespace+(typeof P=="undefined"?":":P)+M);return z.log=this.log,z}function _(M){s.save(M),s.names=[],s.skips=[];let P;const z=(typeof M=="string"?M:"").split(/[\s,]+/),q=z.length;for(P=0;P<q;P++)!z[P]||(M=z[P].replace(/\*/g,".*?"),M[0]==="-"?s.skips.push(new RegExp("^"+M.substr(1)+"$")):s.names.push(new RegExp("^"+M+"$")))}function x(){const M=[...s.names.map(a),...s.skips.map(a).map(P=>"-"+P)].join(",");return s.enable(""),M}function E(M){if(M[M.length-1]==="*")return!0;let P,z;for(P=0,z=s.skips.length;P<z;P++)if(s.skips[P].test(M))return!1;for(P=0,z=s.names.length;P<z;P++)if(s.names[P].test(M))return!0;return!1}function a(M){return M.toString().substring(2,M.toString().length-2).replace(/\.\*\?$/,"*")}function S(M){return M instanceof Error?M.stack||M.message:M}function O(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return s.enable(s.load()),s}var WG=ZG;(function(i,t){t.formatArgs=h,t.save=_,t.load=x,t.useColors=s,t.storage=E(),t.destroy=(()=>{let S=!1;return()=>{S||(S=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function s(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function h(S){if(S[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+S[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),!this.useColors)return;const O="color: "+this.color;S.splice(1,0,O,"color: inherit");let M=0,P=0;S[0].replace(/%[a-zA-Z%]/g,z=>{z!=="%%"&&(M++,z==="%c"&&(P=M))}),S.splice(P,0,O)}t.log=console.debug||console.log||(()=>{});function _(S){try{S?t.storage.setItem("debug",S):t.storage.removeItem("debug")}catch{}}function x(){let S;try{S=t.storage.getItem("debug")}catch{}return!S&&typeof process!="undefined"&&"env"in process&&(S={}.DEBUG),S}function E(){try{return localStorage}catch{}}i.exports=WG(t);const{formatters:a}=i.exports;a.j=function(S){try{return JSON.stringify(S)}catch(O){return"[UnexpectedJSONParseError]: "+O.message}}})(sd,sd.exports);Object.defineProperty(xy,"__esModule",{value:!0});xy.url=void 0;const HG=gk,yk=sd.exports("socket.io-client:url");function XG(i,t="",s){let h=i;s=s||typeof location!="undefined"&&location,i==null&&(i=s.protocol+"//"+s.host),typeof i=="string"&&(i.charAt(0)==="/"&&(i.charAt(1)==="/"?i=s.protocol+i:i=s.host+i),/^(https?|wss?):\/\//.test(i)||(yk("protocol-less url %s",i),typeof s!="undefined"?i=s.protocol+"//"+i:i="https://"+i),yk("parse %s",i),h=HG(i)),h.port||(/^(http|ws)$/.test(h.protocol)?h.port="80":/^(http|ws)s$/.test(h.protocol)&&(h.port="443")),h.path=h.path||"/";const x=h.host.indexOf(":")!==-1?"["+h.host+"]":h.host;return h.id=h.protocol+"://"+x+":"+h.port+t,h.href=h.protocol+"://"+x+(s&&s.port===h.port?"":":"+h.port),h}xy.url=XG;var Rp={},Hc={exports:{}},wy={},_1={exports:{}};try{_1.exports=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch{_1.exports=!1}var Ey=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:Function("return this")())();const KG=_1.exports,YG=Ey;var vk=function(i){const t=i.xdomain,s=i.xscheme,h=i.enablesXDR;try{if(typeof XMLHttpRequest!="undefined"&&(!t||KG))return new XMLHttpRequest}catch{}try{if(typeof XDomainRequest!="undefined"&&!s&&h)return new XDomainRequest}catch{}if(!t)try{return new YG[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}},g1={exports:{}};const Ps=Object.create(null);Ps.open="0";Ps.close="1";Ps.ping="2";Ps.pong="3";Ps.message="4";Ps.upgrade="5";Ps.noop="6";const xk=Object.create(null);Object.keys(Ps).forEach(i=>{xk[Ps[i]]=i});const JG={type:"error",data:"parser error"};var bk={PACKET_TYPES:Ps,PACKET_TYPES_REVERSE:xk,ERROR_PACKET:JG};const{PACKET_TYPES:QG}=bk,eq=typeof Blob=="function"||typeof Blob!="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",tq=typeof ArrayBuffer=="function",iq=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i&&i.buffer instanceof ArrayBuffer,nq=({type:i,data:t},s,h)=>eq&&t instanceof Blob?s?h(t):wk(t,h):tq&&(t instanceof ArrayBuffer||iq(t))?s?h(t instanceof ArrayBuffer?t:t.buffer):wk(new Blob([t]),h):h(QG[i]+(t||"")),wk=(i,t)=>{const s=new FileReader;return s.onload=function(){const h=s.result.split(",")[1];t("b"+h)},s.readAsDataURL(i)};var rq=nq,y1={};(function(i){y1.encode=function(t){var s=new Uint8Array(t),h,_=s.length,x="";for(h=0;h<_;h+=3)x+=i[s[h]>>2],x+=i[(s[h]&3)<<4|s[h+1]>>4],x+=i[(s[h+1]&15)<<2|s[h+2]>>6],x+=i[s[h+2]&63];return _%3==2?x=x.substring(0,x.length-1)+"=":_%3==1&&(x=x.substring(0,x.length-2)+"=="),x},y1.decode=function(t){var s=t.length*.75,h=t.length,_,x=0,E,a,S,O;t[t.length-1]==="="&&(s--,t[t.length-2]==="="&&s--);var M=new ArrayBuffer(s),P=new Uint8Array(M);for(_=0;_<h;_+=4)E=i.indexOf(t[_]),a=i.indexOf(t[_+1]),S=i.indexOf(t[_+2]),O=i.indexOf(t[_+3]),P[x++]=E<<2|a>>4,P[x++]=(a&15)<<4|S>>2,P[x++]=(S&3)<<6|O&63;return M}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");const{PACKET_TYPES_REVERSE:v1,ERROR_PACKET:oq}=bk,sq=typeof ArrayBuffer=="function";let x1;sq&&(x1=y1);const aq=(i,t)=>{if(typeof i!="string")return{type:"message",data:Ek(i,t)};const s=i.charAt(0);return s==="b"?{type:"message",data:lq(i.substring(1),t)}:v1[s]?i.length>1?{type:v1[s],data:i.substring(1)}:{type:v1[s]}:oq},lq=(i,t)=>{if(x1){const s=x1.decode(i);return Ek(s,t)}else return{base64:!0,data:i}},Ek=(i,t)=>{switch(t){case"blob":return i instanceof ArrayBuffer?new Blob([i]):i;case"arraybuffer":default:return i}};var cq=aq;const Tk=rq,Ck=cq,Sk=String.fromCharCode(30),uq=(i,t)=>{const s=i.length,h=new Array(s);let _=0;i.forEach((x,E)=>{Tk(x,!1,a=>{h[E]=a,++_===s&&t(h.join(Sk))})})},hq=(i,t)=>{const s=i.split(Sk),h=[];for(let _=0;_<s.length;_++){const x=Ck(s[_],t);if(h.push(x),x.type==="error")break}return h};var Bp={protocol:4,encodePacket:Tk,encodePayload:uq,decodePacket:Ck,decodePayload:hq},ud={exports:{}};(function(i){i.exports=t;function t(h){if(h)return s(h)}function s(h){for(var _ in t.prototype)h[_]=t.prototype[_];return h}t.prototype.on=t.prototype.addEventListener=function(h,_){return this._callbacks=this._callbacks||{},(this._callbacks["$"+h]=this._callbacks["$"+h]||[]).push(_),this},t.prototype.once=function(h,_){function x(){this.off(h,x),_.apply(this,arguments)}return x.fn=_,this.on(h,x),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(h,_){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var x=this._callbacks["$"+h];if(!x)return this;if(arguments.length==1)return delete this._callbacks["$"+h],this;for(var E,a=0;a<x.length;a++)if(E=x[a],E===_||E.fn===_){x.splice(a,1);break}return x.length===0&&delete this._callbacks["$"+h],this},t.prototype.emit=function(h){this._callbacks=this._callbacks||{};for(var _=new Array(arguments.length-1),x=this._callbacks["$"+h],E=1;E<arguments.length;E++)_[E-1]=arguments[E];if(x){x=x.slice(0);for(var E=0,a=x.length;E<a;++E)x[E].apply(this,_)}return this},t.prototype.listeners=function(h){return this._callbacks=this._callbacks||{},this._callbacks["$"+h]||[]},t.prototype.hasListeners=function(h){return!!this.listeners(h).length}})(ud);var Xc={exports:{}},hd=1e3,dd=hd*60,fd=dd*60,Kc=fd*24,dq=Kc*7,fq=Kc*365.25,pq=function(i,t){t=t||{};var s=typeof i;if(s==="string"&&i.length>0)return mq(i);if(s==="number"&&isFinite(i))return t.long?gq(i):_q(i);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(i))};function mq(i){if(i=String(i),!(i.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(!!t){var s=parseFloat(t[1]),h=(t[2]||"ms").toLowerCase();switch(h){case"years":case"year":case"yrs":case"yr":case"y":return s*fq;case"weeks":case"week":case"w":return s*dq;case"days":case"day":case"d":return s*Kc;case"hours":case"hour":case"hrs":case"hr":case"h":return s*fd;case"minutes":case"minute":case"mins":case"min":case"m":return s*dd;case"seconds":case"second":case"secs":case"sec":case"s":return s*hd;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}function _q(i){var t=Math.abs(i);return t>=Kc?Math.round(i/Kc)+"d":t>=fd?Math.round(i/fd)+"h":t>=dd?Math.round(i/dd)+"m":t>=hd?Math.round(i/hd)+"s":i+"ms"}function gq(i){var t=Math.abs(i);return t>=Kc?Ty(i,t,Kc,"day"):t>=fd?Ty(i,t,fd,"hour"):t>=dd?Ty(i,t,dd,"minute"):t>=hd?Ty(i,t,hd,"second"):i+" ms"}function Ty(i,t,s,h){var _=t>=s*1.5;return Math.round(i/s)+" "+h+(_?"s":"")}function yq(i){s.debug=s,s.default=s,s.coerce=S,s.disable=x,s.enable=_,s.enabled=E,s.humanize=pq,s.destroy=O,Object.keys(i).forEach(M=>{s[M]=i[M]}),s.names=[],s.skips=[],s.formatters={};function t(M){let P=0;for(let z=0;z<M.length;z++)P=(P<<5)-P+M.charCodeAt(z),P|=0;return s.colors[Math.abs(P)%s.colors.length]}s.selectColor=t;function s(M){let P,z=null;function q(...se){if(!q.enabled)return;const ue=q,oe=Number(new Date),fe=oe-(P||oe);ue.diff=fe,ue.prev=P,ue.curr=oe,P=oe,se[0]=s.coerce(se[0]),typeof se[0]!="string"&&se.unshift("%O");let xe=0;se[0]=se[0].replace(/%([a-zA-Z%])/g,($e,Ge)=>{if($e==="%%")return"%";xe++;const xt=s.formatters[Ge];if(typeof xt=="function"){const pt=se[xe];$e=xt.call(ue,pt),se.splice(xe,1),xe--}return $e}),s.formatArgs.call(ue,se),(ue.log||s.log).apply(ue,se)}return q.namespace=M,q.useColors=s.useColors(),q.color=s.selectColor(M),q.extend=h,q.destroy=s.destroy,Object.defineProperty(q,"enabled",{enumerable:!0,configurable:!1,get:()=>z===null?s.enabled(M):z,set:se=>{z=se}}),typeof s.init=="function"&&s.init(q),q}function h(M,P){const z=s(this.namespace+(typeof P=="undefined"?":":P)+M);return z.log=this.log,z}function _(M){s.save(M),s.names=[],s.skips=[];let P;const z=(typeof M=="string"?M:"").split(/[\s,]+/),q=z.length;for(P=0;P<q;P++)!z[P]||(M=z[P].replace(/\*/g,".*?"),M[0]==="-"?s.skips.push(new RegExp("^"+M.substr(1)+"$")):s.names.push(new RegExp("^"+M+"$")))}function x(){const M=[...s.names.map(a),...s.skips.map(a).map(P=>"-"+P)].join(",");return s.enable(""),M}function E(M){if(M[M.length-1]==="*")return!0;let P,z;for(P=0,z=s.skips.length;P<z;P++)if(s.skips[P].test(M))return!1;for(P=0,z=s.names.length;P<z;P++)if(s.names[P].test(M))return!0;return!1}function a(M){return M.toString().substring(2,M.toString().length-2).replace(/\.\*\?$/,"*")}function S(M){return M instanceof Error?M.stack||M.message:M}function O(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return s.enable(s.load()),s}var vq=yq;(function(i,t){t.formatArgs=h,t.save=_,t.load=x,t.useColors=s,t.storage=E(),t.destroy=(()=>{let S=!1;return()=>{S||(S=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function s(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function h(S){if(S[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+S[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),!this.useColors)return;const O="color: "+this.color;S.splice(1,0,O,"color: inherit");let M=0,P=0;S[0].replace(/%[a-zA-Z%]/g,z=>{z!=="%%"&&(M++,z==="%c"&&(P=M))}),S.splice(P,0,O)}t.log=console.debug||console.log||(()=>{});function _(S){try{S?t.storage.setItem("debug",S):t.storage.removeItem("debug")}catch{}}function x(){let S;try{S=t.storage.getItem("debug")}catch{}return!S&&typeof process!="undefined"&&"env"in process&&(S={}.DEBUG),S}function E(){try{return localStorage}catch{}}i.exports=vq(t);const{formatters:a}=i.exports;a.j=function(S){try{return JSON.stringify(S)}catch(O){return"[UnexpectedJSONParseError]: "+O.message}}})(Xc,Xc.exports);const xq=Bp,bq=ud.exports,wq=Xc.exports("engine.io-client:transport");class Eq extends bq{constructor(t){super();this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,s){const h=new Error(t);return h.type="TransportError",h.description=s,this.emit("error",h),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"?this.write(t):wq("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,this.emit("open")}onData(t){const s=xq.decodePacket(t,this.socket.binaryType);this.onPacket(s)}onPacket(t){this.emit("packet",t)}onClose(){this.readyState="closed",this.emit("close")}}var b1=Eq,Fp={};Fp.encode=function(i){var t="";for(var s in i)i.hasOwnProperty(s)&&(t.length&&(t+="&"),t+=encodeURIComponent(s)+"="+encodeURIComponent(i[s]));return t};Fp.decode=function(i){for(var t={},s=i.split("&"),h=0,_=s.length;h<_;h++){var x=s[h].split("=");t[decodeURIComponent(x[0])]=decodeURIComponent(x[1])}return t};var Ak="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Cy=64,Ik={},Mk=0,yl=0,kk;function w1(i){var t="";do t=Ak[i%Cy]+t,i=Math.floor(i/Cy);while(i>0);return t}function Tq(i){var t=0;for(yl=0;yl<i.length;yl++)t=t*Cy+Ik[i.charAt(yl)];return t}function E1(){var i=w1(+new Date);return i!==kk?(Mk=0,kk=i):i+"."+w1(Mk++)}for(;yl<Cy;yl++)Ik[Ak[yl]]=yl;E1.encode=w1;E1.decode=Tq;var Pk=E1;const Cq=b1,Sq=Fp,Dk=Bp,Aq=Pk,Xo=Xc.exports("engine.io-client:polling");class Iq extends Cq{get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const s=()=>{Xo("paused"),this.readyState="paused",t()};if(this.polling||!this.writable){let h=0;this.polling&&(Xo("we are currently polling - waiting to pause"),h++,this.once("pollComplete",function(){Xo("pre-pause polling complete"),--h||s()})),this.writable||(Xo("we are currently writing - waiting to pause"),h++,this.once("drain",function(){Xo("pre-pause writing complete"),--h||s()}))}else s()}poll(){Xo("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}onData(t){Xo("polling got data %s",t);const s=h=>{if(this.readyState==="opening"&&h.type==="open"&&this.onOpen(),h.type==="close")return this.onClose(),!1;this.onPacket(h)};Dk.decodePayload(t,this.socket.binaryType).forEach(s),this.readyState!=="closed"&&(this.polling=!1,this.emit("pollComplete"),this.readyState==="open"?this.poll():Xo('ignoring poll - transport state "%s"',this.readyState))}doClose(){const t=()=>{Xo("writing close packet"),this.write([{type:"close"}])};this.readyState==="open"?(Xo("transport open - closing"),t()):(Xo("transport not open - deferring close"),this.once("open",t))}write(t){this.writable=!1,Dk.encodePayload(t,s=>{this.doWrite(s,()=>{this.writable=!0,this.emit("drain")})})}uri(){let t=this.query||{};const s=this.opts.secure?"https":"http";let h="";this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Aq()),!this.supportsBinary&&!t.sid&&(t.b64=1),t=Sq.encode(t),this.opts.port&&(s==="https"&&Number(this.opts.port)!==443||s==="http"&&Number(this.opts.port)!==80)&&(h=":"+this.opts.port),t.length&&(t="?"+t);const _=this.opts.hostname.indexOf(":")!==-1;return s+"://"+(_?"["+this.opts.hostname+"]":this.opts.hostname)+h+this.opts.path+t}}var Lk=Iq,T1={};T1.pick=(i,...t)=>t.reduce((s,h)=>(i.hasOwnProperty(h)&&(s[h]=i[h]),s),{});const zk=vk,Mq=Lk,kq=ud.exports,{pick:Pq}=T1,Dq=Ey,C1=Xc.exports("engine.io-client:polling-xhr");function Ok(){}const Lq=function(){return new zk({xdomain:!1}).responseType!=null}();class zq extends Mq{constructor(t){super(t);if(typeof location!="undefined"){const h=location.protocol==="https:";let _=location.port;_||(_=h?443:80),this.xd=typeof location!="undefined"&&t.hostname!==location.hostname||_!==t.port,this.xs=t.secure!==h}const s=t&&t.forceBase64;this.supportsBinary=Lq&&!s}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new Ko(this.uri(),t)}doWrite(t,s){const h=this.request({method:"POST",data:t});h.on("success",s),h.on("error",_=>{this.onError("xhr post error",_)})}doPoll(){C1("xhr poll");const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",s=>{this.onError("xhr poll error",s)}),this.pollXhr=t}}class Ko extends kq{constructor(t,s){super();this.opts=s,this.method=s.method||"GET",this.uri=t,this.async=s.async!==!1,this.data=s.data!==void 0?s.data:null,this.create()}create(){const t=Pq(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const s=this.xhr=new zk(t);try{C1("xhr open %s: %s",this.method,this.uri),s.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let h in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(h)&&s.setRequestHeader(h,this.opts.extraHeaders[h])}}catch{}if(this.method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in s&&(s.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(s.timeout=this.opts.requestTimeout),this.hasXDR()?(s.onload=()=>{this.onLoad()},s.onerror=()=>{this.onError(s.responseText)}):s.onreadystatechange=()=>{s.readyState===4&&(s.status===200||s.status===1223?this.onLoad():setTimeout(()=>{this.onError(typeof s.status=="number"?s.status:0)},0))},C1("xhr data %s",this.data),s.send(this.data)}catch(h){setTimeout(()=>{this.onError(h)},0);return}typeof document!="undefined"&&(this.index=Ko.requestsCount++,Ko.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(t){this.emit("data",t),this.onSuccess()}onError(t){this.emit("error",t),this.cleanup(!0)}cleanup(t){if(!(typeof this.xhr=="undefined"||this.xhr===null)){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=Ok:this.xhr.onreadystatechange=Ok,t)try{this.xhr.abort()}catch{}typeof document!="undefined"&&delete Ko.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;t!==null&&this.onData(t)}hasXDR(){return typeof XDomainRequest!="undefined"&&!this.xs&&this.enablesXDR}abort(){this.cleanup()}}Ko.requestsCount=0;Ko.requests={};if(typeof document!="undefined"){if(typeof attachEvent=="function")attachEvent("onunload",Rk);else if(typeof addEventListener=="function"){const i="onpagehide"in Dq?"pagehide":"unload";addEventListener(i,Rk,!1)}}function Rk(){for(let i in Ko.requests)Ko.requests.hasOwnProperty(i)&&Ko.requests[i].abort()}g1.exports=zq;g1.exports.Request=Ko;const Oq=Lk,Bk=Ey,Rq=/\n/g,Bq=/\\n/g;let Sy;class Fq extends Oq{constructor(t){super(t);this.query=this.query||{},Sy||(Sy=Bk.___eio=Bk.___eio||[]),this.index=Sy.length,Sy.push(this.onData.bind(this)),this.query.j=this.index}get supportsBinary(){return!1}doClose(){this.script&&(this.script.onerror=()=>{},this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),super.doClose()}doPoll(){const t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=_=>{this.onError("jsonp poll error",_)};const s=document.getElementsByTagName("script")[0];s?s.parentNode.insertBefore(t,s):(document.head||document.body).appendChild(t),this.script=t,typeof navigator!="undefined"&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){const _=document.createElement("iframe");document.body.appendChild(_),document.body.removeChild(_)},100)}doWrite(t,s){let h;if(!this.form){const E=document.createElement("form"),a=document.createElement("textarea"),S=this.iframeId="eio_iframe_"+this.index;E.className="socketio",E.style.position="absolute",E.style.top="-1000px",E.style.left="-1000px",E.target=S,E.method="POST",E.setAttribute("accept-charset","utf-8"),a.name="d",E.appendChild(a),document.body.appendChild(E),this.form=E,this.area=a}this.form.action=this.uri();function _(){x(),s()}const x=()=>{if(this.iframe)try{this.form.removeChild(this.iframe)}catch(E){this.onError("jsonp polling iframe removal error",E)}try{const E='<iframe src="javascript:0" name="'+this.iframeId+'">';h=document.createElement(E)}catch{h=document.createElement("iframe"),h.name=this.iframeId,h.src="javascript:0"}h.id=this.iframeId,this.form.appendChild(h),this.iframe=h};x(),t=t.replace(Bq,`\\
`),this.area.value=t.replace(Rq,"\\n");try{this.form.submit()}catch{}this.iframe.attachEvent?this.iframe.onreadystatechange=()=>{this.iframe.readyState==="complete"&&_()}:this.iframe.onload=_}}var Nq=Fq;const Fk=Ey;var Uq={WebSocket:Fk.WebSocket||Fk.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer"};const Nk=b1,jq=Bp,Vq=Fp,$q=Pk,{pick:Gq}=T1,{WebSocket:Np,usingBrowserWebSocket:S1,defaultBinaryType:qq}=Uq,Zq=Xc.exports("engine.io-client:websocket"),Uk=typeof navigator!="undefined"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class A1 extends Nk{constructor(t){super(t);this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),s=this.opts.protocols,h=Uk?{}:Gq(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(h.headers=this.opts.extraHeaders);try{this.ws=S1&&!Uk?s?new Np(t,s):new Np(t):new Np(t,s,h)}catch(_){return this.emit("error",_)}this.ws.binaryType=this.socket.binaryType||qq,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let s=0;s<t.length;s++){const h=t[s],_=s===t.length-1;jq.encodePacket(h,this.supportsBinary,x=>{const E={};S1||(h.options&&(E.compress=h.options.compress),this.opts.perMessageDeflate&&(typeof x=="string"?Buffer.byteLength(x):x.length)<this.opts.perMessageDeflate.threshold&&(E.compress=!1));try{S1?this.ws.send(x):this.ws.send(x,E)}catch{Zq("websocket closed before onclose event")}_&&setTimeout(()=>{this.writable=!0,this.emit("drain")},0)})}}onClose(){Nk.prototype.onClose.call(this)}doClose(){typeof this.ws!="undefined"&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const s=this.opts.secure?"wss":"ws";let h="";this.opts.port&&(s==="wss"&&Number(this.opts.port)!==443||s==="ws"&&Number(this.opts.port)!==80)&&(h=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=$q()),this.supportsBinary||(t.b64=1),t=Vq.encode(t),t.length&&(t="?"+t);const _=this.opts.hostname.indexOf(":")!==-1;return s+"://"+(_?"["+this.opts.hostname+"]":this.opts.hostname)+h+this.opts.path+t}check(){return!!Np&&!("__initialize"in Np&&this.name===A1.prototype.name)}}var Wq=A1;const Hq=vk,Xq=g1.exports,Kq=Nq,Yq=Wq;wy.polling=Jq;wy.websocket=Yq;function Jq(i){let t,s=!1,h=!1;const _=i.jsonp!==!1;if(typeof location!="undefined"){const x=location.protocol==="https:";let E=location.port;E||(E=x?443:80),s=i.hostname!==location.hostname||E!==i.port,h=i.secure!==x}if(i.xdomain=s,i.xscheme=h,t=new Hq(i),"open"in t&&!i.forceJSONP)return new Xq(i);if(!_)throw new Error("JSONP disabled");return new Kq(i)}const Qq=wy,e8=ud.exports,zn=Xc.exports("engine.io-client:socket"),jk=Bp,Vk=gk,t8=Fp;class da extends e8{constructor(t,s={}){super();t&&typeof t=="object"&&(s=t,t=null),t?(t=Vk(t),s.hostname=t.host,s.secure=t.protocol==="https"||t.protocol==="wss",s.port=t.port,t.query&&(s.query=t.query)):s.host&&(s.hostname=Vk(s.host).host),this.secure=s.secure!=null?s.secure:typeof location!="undefined"&&location.protocol==="https:",s.hostname&&!s.port&&(s.port=this.secure?"443":"80"),this.hostname=s.hostname||(typeof location!="undefined"?location.hostname:"localhost"),this.port=s.port||(typeof location!="undefined"&&location.port?location.port:this.secure?443:80),this.transports=s.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},s),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=t8.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){zn('creating transport "%s"',t);const s=i8(this.opts.query);s.EIO=jk.protocol,s.transport=t,this.id&&(s.sid=this.id);const h=Object.assign({},this.opts.transportOptions[t],this.opts,{query:s,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return zn("options: %j",h),new Qq[t](h)}open(){let t;if(this.opts.rememberUpgrade&&da.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else if(this.transports.length===0){setTimeout(()=>{this.emit("error","No transports available")},0);return}else t=this.transports[0];this.readyState="opening";try{t=this.createTransport(t)}catch(s){zn("error while creating transport: %s",s),this.transports.shift(),this.open();return}t.open(),this.setTransport(t)}setTransport(t){zn("setting transport %s",t.name),this.transport&&(zn("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",()=>{this.onClose("transport close")})}probe(t){zn('probing transport "%s"',t);let s=this.createTransport(t,{probe:1}),h=!1;da.priorWebsocketSuccess=!1;const _=()=>{h||(zn('probe transport "%s" opened',t),s.send([{type:"ping",data:"probe"}]),s.once("packet",P=>{if(!h)if(P.type==="pong"&&P.data==="probe"){if(zn('probe transport "%s" pong',t),this.upgrading=!0,this.emit("upgrading",s),!s)return;da.priorWebsocketSuccess=s.name==="websocket",zn('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{h||this.readyState!=="closed"&&(zn("changing transport and sending upgrade packet"),M(),this.setTransport(s),s.send([{type:"upgrade"}]),this.emit("upgrade",s),s=null,this.upgrading=!1,this.flush())})}else{zn('probe transport "%s" failed',t);const z=new Error("probe error");z.transport=s.name,this.emit("upgradeError",z)}}))};function x(){h||(h=!0,M(),s.close(),s=null)}const E=P=>{const z=new Error("probe error: "+P);z.transport=s.name,x(),zn('probe transport "%s" failed because of error: %s',t,P),this.emit("upgradeError",z)};function a(){E("transport closed")}function S(){E("socket closed")}function O(P){s&&P.name!==s.name&&(zn('"%s" works - aborting "%s"',P.name,s.name),x())}const M=()=>{s.removeListener("open",_),s.removeListener("error",E),s.removeListener("close",a),this.removeListener("close",S),this.removeListener("upgrading",O)};s.once("open",_),s.once("error",E),s.once("close",a),this.once("close",S),this.once("upgrading",O),s.open()}onOpen(){if(zn("socket open"),this.readyState="open",da.priorWebsocketSuccess=this.transport.name==="websocket",this.emit("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){zn("starting upgrade probes");let t=0;const s=this.upgrades.length;for(;t<s;t++)this.probe(this.upgrades[t])}}onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(zn('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("pong");break;case"error":const s=new Error("server error");s.code=t.data,this.onError(s);break;case"message":this.emit("data",t.data),this.emit("message",t.data);break}else zn('packet received with socket readyState "%s"',this.readyState)}onHandshake(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=setTimeout(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emit("drain"):this.flush()}flush(){this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(zn("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}write(t,s,h){return this.sendPacket("message",t,s,h),this}send(t,s,h){return this.sendPacket("message",t,s,h),this}sendPacket(t,s,h,_){if(typeof s=="function"&&(_=s,s=void 0),typeof h=="function"&&(_=h,h=null),this.readyState==="closing"||this.readyState==="closed")return;h=h||{},h.compress=h.compress!==!1;const x={type:t,data:s,options:h};this.emit("packetCreate",x),this.writeBuffer.push(x),_&&this.once("flush",_),this.flush()}close(){const t=()=>{this.onClose("forced close"),zn("socket closing - telling transport to close"),this.transport.close()},s=()=>{this.removeListener("upgrade",s),this.removeListener("upgradeError",s),t()},h=()=>{this.once("upgrade",s),this.once("upgradeError",s)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?h():t()}):this.upgrading?h():t()),this}onError(t){zn("socket error %j",t),da.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)}onClose(t,s){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(zn('socket close with reason: "%s"',t),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emit("close",t,s),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const s=[];let h=0;const _=t.length;for(;h<_;h++)~this.transports.indexOf(t[h])&&s.push(t[h]);return s}}da.priorWebsocketSuccess=!1;da.protocol=jk.protocol;function i8(i){const t={};for(let s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);return t}var n8=da;const I1=n8;Hc.exports=(i,t)=>new I1(i,t);Hc.exports.Socket=I1;Hc.exports.protocol=I1.protocol;Hc.exports.Transport=b1;Hc.exports.transports=wy;Hc.exports.parser=Bp;var Up={},Ay={},pd={},Yc={};Object.defineProperty(Yc,"__esModule",{value:!0});Yc.hasBinary=Yc.isBinary=void 0;const r8=typeof ArrayBuffer=="function",o8=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i.buffer instanceof ArrayBuffer,$k=Object.prototype.toString,s8=typeof Blob=="function"||typeof Blob!="undefined"&&$k.call(Blob)==="[object BlobConstructor]",a8=typeof File=="function"||typeof File!="undefined"&&$k.call(File)==="[object FileConstructor]";function Gk(i){return r8&&(i instanceof ArrayBuffer||o8(i))||s8&&i instanceof Blob||a8&&i instanceof File}Yc.isBinary=Gk;function Iy(i,t){if(!i||typeof i!="object")return!1;if(Array.isArray(i)){for(let s=0,h=i.length;s<h;s++)if(Iy(i[s]))return!0;return!1}if(Gk(i))return!0;if(i.toJSON&&typeof i.toJSON=="function"&&arguments.length===1)return Iy(i.toJSON(),!0);for(const s in i)if(Object.prototype.hasOwnProperty.call(i,s)&&Iy(i[s]))return!0;return!1}Yc.hasBinary=Iy;Object.defineProperty(pd,"__esModule",{value:!0});pd.reconstructPacket=pd.deconstructPacket=void 0;const l8=Yc;function c8(i){const t=[],s=i.data,h=i;return h.data=M1(s,t),h.attachments=t.length,{packet:h,buffers:t}}pd.deconstructPacket=c8;function M1(i,t){if(!i)return i;if(l8.isBinary(i)){const s={_placeholder:!0,num:t.length};return t.push(i),s}else if(Array.isArray(i)){const s=new Array(i.length);for(let h=0;h<i.length;h++)s[h]=M1(i[h],t);return s}else if(typeof i=="object"&&!(i instanceof Date)){const s={};for(const h in i)i.hasOwnProperty(h)&&(s[h]=M1(i[h],t));return s}return i}function u8(i,t){return i.data=k1(i.data,t),i.attachments=void 0,i}pd.reconstructPacket=u8;function k1(i,t){if(!i)return i;if(i&&i._placeholder)return t[i.num];if(Array.isArray(i))for(let s=0;s<i.length;s++)i[s]=k1(i[s],t);else if(typeof i=="object")for(const s in i)i.hasOwnProperty(s)&&(i[s]=k1(i[s],t));return i}var P1={exports:{}},md=1e3,_d=md*60,gd=_d*60,Jc=gd*24,h8=Jc*7,d8=Jc*365.25,f8=function(i,t){t=t||{};var s=typeof i;if(s==="string"&&i.length>0)return p8(i);if(s==="number"&&isFinite(i))return t.long?_8(i):m8(i);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(i))};function p8(i){if(i=String(i),!(i.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(!!t){var s=parseFloat(t[1]),h=(t[2]||"ms").toLowerCase();switch(h){case"years":case"year":case"yrs":case"yr":case"y":return s*d8;case"weeks":case"week":case"w":return s*h8;case"days":case"day":case"d":return s*Jc;case"hours":case"hour":case"hrs":case"hr":case"h":return s*gd;case"minutes":case"minute":case"mins":case"min":case"m":return s*_d;case"seconds":case"second":case"secs":case"sec":case"s":return s*md;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}function m8(i){var t=Math.abs(i);return t>=Jc?Math.round(i/Jc)+"d":t>=gd?Math.round(i/gd)+"h":t>=_d?Math.round(i/_d)+"m":t>=md?Math.round(i/md)+"s":i+"ms"}function _8(i){var t=Math.abs(i);return t>=Jc?My(i,t,Jc,"day"):t>=gd?My(i,t,gd,"hour"):t>=_d?My(i,t,_d,"minute"):t>=md?My(i,t,md,"second"):i+" ms"}function My(i,t,s,h){var _=t>=s*1.5;return Math.round(i/s)+" "+h+(_?"s":"")}function g8(i){s.debug=s,s.default=s,s.coerce=S,s.disable=x,s.enable=_,s.enabled=E,s.humanize=f8,s.destroy=O,Object.keys(i).forEach(M=>{s[M]=i[M]}),s.names=[],s.skips=[],s.formatters={};function t(M){let P=0;for(let z=0;z<M.length;z++)P=(P<<5)-P+M.charCodeAt(z),P|=0;return s.colors[Math.abs(P)%s.colors.length]}s.selectColor=t;function s(M){let P,z=null;function q(...se){if(!q.enabled)return;const ue=q,oe=Number(new Date),fe=oe-(P||oe);ue.diff=fe,ue.prev=P,ue.curr=oe,P=oe,se[0]=s.coerce(se[0]),typeof se[0]!="string"&&se.unshift("%O");let xe=0;se[0]=se[0].replace(/%([a-zA-Z%])/g,($e,Ge)=>{if($e==="%%")return"%";xe++;const xt=s.formatters[Ge];if(typeof xt=="function"){const pt=se[xe];$e=xt.call(ue,pt),se.splice(xe,1),xe--}return $e}),s.formatArgs.call(ue,se),(ue.log||s.log).apply(ue,se)}return q.namespace=M,q.useColors=s.useColors(),q.color=s.selectColor(M),q.extend=h,q.destroy=s.destroy,Object.defineProperty(q,"enabled",{enumerable:!0,configurable:!1,get:()=>z===null?s.enabled(M):z,set:se=>{z=se}}),typeof s.init=="function"&&s.init(q),q}function h(M,P){const z=s(this.namespace+(typeof P=="undefined"?":":P)+M);return z.log=this.log,z}function _(M){s.save(M),s.names=[],s.skips=[];let P;const z=(typeof M=="string"?M:"").split(/[\s,]+/),q=z.length;for(P=0;P<q;P++)!z[P]||(M=z[P].replace(/\*/g,".*?"),M[0]==="-"?s.skips.push(new RegExp("^"+M.substr(1)+"$")):s.names.push(new RegExp("^"+M+"$")))}function x(){const M=[...s.names.map(a),...s.skips.map(a).map(P=>"-"+P)].join(",");return s.enable(""),M}function E(M){if(M[M.length-1]==="*")return!0;let P,z;for(P=0,z=s.skips.length;P<z;P++)if(s.skips[P].test(M))return!1;for(P=0,z=s.names.length;P<z;P++)if(s.names[P].test(M))return!0;return!1}function a(M){return M.toString().substring(2,M.toString().length-2).replace(/\.\*\?$/,"*")}function S(M){return M instanceof Error?M.stack||M.message:M}function O(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return s.enable(s.load()),s}var y8=g8;(function(i,t){t.formatArgs=h,t.save=_,t.load=x,t.useColors=s,t.storage=E(),t.destroy=(()=>{let S=!1;return()=>{S||(S=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function s(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function h(S){if(S[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+S[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),!this.useColors)return;const O="color: "+this.color;S.splice(1,0,O,"color: inherit");let M=0,P=0;S[0].replace(/%[a-zA-Z%]/g,z=>{z!=="%%"&&(M++,z==="%c"&&(P=M))}),S.splice(P,0,O)}t.log=console.debug||console.log||(()=>{});function _(S){try{S?t.storage.setItem("debug",S):t.storage.removeItem("debug")}catch{}}function x(){let S;try{S=t.storage.getItem("debug")}catch{}return!S&&typeof process!="undefined"&&"env"in process&&(S={}.DEBUG),S}function E(){try{return localStorage}catch{}}i.exports=y8(t);const{formatters:a}=i.exports;a.j=function(S){try{return JSON.stringify(S)}catch(O){return"[UnexpectedJSONParseError]: "+O.message}}})(P1,P1.exports);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.Decoder=i.Encoder=i.PacketType=i.protocol=void 0;const t=ud.exports,s=pd,h=Yc,_=P1.exports("socket.io-parser");i.protocol=5;var x;(function(M){M[M.CONNECT=0]="CONNECT",M[M.DISCONNECT=1]="DISCONNECT",M[M.EVENT=2]="EVENT",M[M.ACK=3]="ACK",M[M.CONNECT_ERROR=4]="CONNECT_ERROR",M[M.BINARY_EVENT=5]="BINARY_EVENT",M[M.BINARY_ACK=6]="BINARY_ACK"})(x=i.PacketType||(i.PacketType={}));class E{encode(P){return _("encoding packet %j",P),(P.type===x.EVENT||P.type===x.ACK)&&h.hasBinary(P)?(P.type=P.type===x.EVENT?x.BINARY_EVENT:x.BINARY_ACK,this.encodeAsBinary(P)):[this.encodeAsString(P)]}encodeAsString(P){let z=""+P.type;return(P.type===x.BINARY_EVENT||P.type===x.BINARY_ACK)&&(z+=P.attachments+"-"),P.nsp&&P.nsp!=="/"&&(z+=P.nsp+","),P.id!=null&&(z+=P.id),P.data!=null&&(z+=JSON.stringify(P.data)),_("encoded %j as %s",P,z),z}encodeAsBinary(P){const z=s.deconstructPacket(P),q=this.encodeAsString(z.packet),se=z.buffers;return se.unshift(q),se}}i.Encoder=E;class a extends t{constructor(){super()}add(P){let z;if(typeof P=="string")z=this.decodeString(P),z.type===x.BINARY_EVENT||z.type===x.BINARY_ACK?(this.reconstructor=new O(z),z.attachments===0&&super.emit("decoded",z)):super.emit("decoded",z);else if(h.isBinary(P)||P.base64)if(this.reconstructor)z=this.reconstructor.takeBinaryData(P),z&&(this.reconstructor=null,super.emit("decoded",z));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+P)}decodeString(P){let z=0;const q={type:Number(P.charAt(0))};if(x[q.type]===void 0)throw new Error("unknown packet type "+q.type);if(q.type===x.BINARY_EVENT||q.type===x.BINARY_ACK){const ue=z+1;for(;P.charAt(++z)!=="-"&&z!=P.length;);const oe=P.substring(ue,z);if(oe!=Number(oe)||P.charAt(z)!=="-")throw new Error("Illegal attachments");q.attachments=Number(oe)}if(P.charAt(z+1)==="/"){const ue=z+1;for(;++z&&!(P.charAt(z)===","||z===P.length););q.nsp=P.substring(ue,z)}else q.nsp="/";const se=P.charAt(z+1);if(se!==""&&Number(se)==se){const ue=z+1;for(;++z;){const oe=P.charAt(z);if(oe==null||Number(oe)!=oe){--z;break}if(z===P.length)break}q.id=Number(P.substring(ue,z+1))}if(P.charAt(++z)){const ue=S(P.substr(z));if(a.isPayloadValid(q.type,ue))q.data=ue;else throw new Error("invalid payload")}return _("decoded %s as %j",P,q),q}static isPayloadValid(P,z){switch(P){case x.CONNECT:return typeof z=="object";case x.DISCONNECT:return z===void 0;case x.CONNECT_ERROR:return typeof z=="string"||typeof z=="object";case x.EVENT:case x.BINARY_EVENT:return Array.isArray(z)&&z.length>0;case x.ACK:case x.BINARY_ACK:return Array.isArray(z)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}i.Decoder=a;function S(M){try{return JSON.parse(M)}catch{return!1}}class O{constructor(P){this.packet=P,this.buffers=[],this.reconPack=P}takeBinaryData(P){if(this.buffers.push(P),this.buffers.length===this.reconPack.attachments){const z=s.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),z}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}})(Ay);var jp={};Object.defineProperty(jp,"__esModule",{value:!0});jp.on=void 0;function v8(i,t,s){return i.on(t,s),function(){i.off(t,s)}}jp.on=v8;var Vp={};Object.defineProperty(Vp,"__esModule",{value:!0});Vp.StrictEventEmitter=void 0;const x8=ud.exports;class b8 extends x8{on(t,s){return super.on(t,s),this}once(t,s){return super.once(t,s),this}emit(t,...s){return super.emit(t,...s),this}emitReserved(t,...s){return super.emit(t,...s),this}listeners(t){return super.listeners(t)}}Vp.StrictEventEmitter=b8;Object.defineProperty(Up,"__esModule",{value:!0});Up.Socket=void 0;const Po=Ay,ky=jp,w8=Vp,Do=sd.exports("socket.io-client:socket"),E8=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class T8 extends w8.StrictEventEmitter{constructor(t,s,h){super();this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=s,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},h&&h.auth&&(this.auth=h.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;const t=this.io;this.subs=[ky.on(t,"open",this.onopen.bind(this)),ky.on(t,"packet",this.onpacket.bind(this)),ky.on(t,"error",this.onerror.bind(this)),ky.on(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...s){if(E8.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');s.unshift(t);const h={type:Po.PacketType.EVENT,data:s};h.options={},h.options.compress=this.flags.compress!==!1,typeof s[s.length-1]=="function"&&(Do("emitting packet with ack id %d",this.ids),this.acks[this.ids]=s.pop(),h.id=this.ids++);const _=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!_||!this.connected)?Do("discard packet as the transport is not currently writable"):this.connected?this.packet(h):this.sendBuffer.push(h),this.flags={},this}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){Do("transport is open - connecting"),typeof this.auth=="function"?this.auth(t=>{this.packet({type:Po.PacketType.CONNECT,data:t})}):this.packet({type:Po.PacketType.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t){Do("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",t)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case Po.PacketType.CONNECT:if(t.data&&t.data.sid){const _=t.data.sid;this.onconnect(_)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Po.PacketType.EVENT:this.onevent(t);break;case Po.PacketType.BINARY_EVENT:this.onevent(t);break;case Po.PacketType.ACK:this.onack(t);break;case Po.PacketType.BINARY_ACK:this.onack(t);break;case Po.PacketType.DISCONNECT:this.ondisconnect();break;case Po.PacketType.CONNECT_ERROR:const h=new Error(t.data.message);h.data=t.data.data,this.emitReserved("connect_error",h);break}}onevent(t){const s=t.data||[];Do("emitting event %j",s),t.id!=null&&(Do("attaching ack callback to event"),s.push(this.ack(t.id))),this.connected?this.emitEvent(s):this.receiveBuffer.push(Object.freeze(s))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const s=this._anyListeners.slice();for(const h of s)h.apply(this,t)}super.emit.apply(this,t)}ack(t){const s=this;let h=!1;return function(..._){h||(h=!0,Do("sending ack %j",_),s.packet({type:Po.PacketType.ACK,id:t,data:_}))}}onack(t){const s=this.acks[t.id];typeof s=="function"?(Do("calling ack %s with %j",t.id,t.data),s.apply(this,t.data),delete this.acks[t.id]):Do("bad ack %s",t.id)}onconnect(t){Do("socket connected with id %s",t),this.id=t,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>this.packet(t)),this.sendBuffer=[]}ondisconnect(){Do("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(Do("performing disconnect (%s)",this.nsp),this.packet({type:Po.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const s=this._anyListeners;for(let h=0;h<s.length;h++)if(t===s[h])return s.splice(h,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}}Up.Socket=T8;var C8=yd;function yd(i){i=i||{},this.ms=i.min||100,this.max=i.max||1e4,this.factor=i.factor||2,this.jitter=i.jitter>0&&i.jitter<=1?i.jitter:0,this.attempts=0}yd.prototype.duration=function(){var i=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),s=Math.floor(t*this.jitter*i);i=(Math.floor(t*10)&1)==0?i-s:i+s}return Math.min(i,this.max)|0};yd.prototype.reset=function(){this.attempts=0};yd.prototype.setMin=function(i){this.ms=i};yd.prototype.setMax=function(i){this.max=i};yd.prototype.setJitter=function(i){this.jitter=i};Object.defineProperty(Rp,"__esModule",{value:!0});Rp.Manager=void 0;const S8=Hc.exports,A8=Up,I8=Ay,Qc=jp,M8=C8,k8=Vp,nr=sd.exports("socket.io-client:manager");class P8 extends k8.StrictEventEmitter{constructor(t,s){super();this.nsps={},this.subs=[],t&&typeof t=="object"&&(s=t,t=void 0),s=s||{},s.path=s.path||"/socket.io",this.opts=s,this.reconnection(s.reconnection!==!1),this.reconnectionAttempts(s.reconnectionAttempts||1/0),this.reconnectionDelay(s.reconnectionDelay||1e3),this.reconnectionDelayMax(s.reconnectionDelayMax||5e3),this.randomizationFactor(s.randomizationFactor||.5),this.backoff=new M8({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(s.timeout==null?2e4:s.timeout),this._readyState="closed",this.uri=t;const h=s.parser||I8;this.encoder=new h.Encoder,this.decoder=new h.Decoder,this._autoConnect=s.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var s;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(s=this.backoff)===null||s===void 0||s.setMin(t),this)}randomizationFactor(t){var s;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(s=this.backoff)===null||s===void 0||s.setJitter(t),this)}reconnectionDelayMax(t){var s;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(s=this.backoff)===null||s===void 0||s.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(nr("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;nr("opening %s",this.uri),this.engine=S8(this.uri,this.opts);const s=this.engine,h=this;this._readyState="opening",this.skipReconnect=!1;const _=Qc.on(s,"open",function(){h.onopen(),t&&t()}),x=Qc.on(s,"error",E=>{nr("error"),h.cleanup(),h._readyState="closed",this.emitReserved("error",E),t?t(E):h.maybeReconnectOnOpen()});if(this._timeout!==!1){const E=this._timeout;nr("connect attempt will timeout after %d",E),E===0&&_();const a=setTimeout(()=>{nr("connect attempt timed out after %d",E),_(),s.close(),s.emit("error",new Error("timeout"))},E);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(_),this.subs.push(x),this}connect(t){return this.open(t)}onopen(){nr("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Qc.on(t,"ping",this.onping.bind(this)),Qc.on(t,"data",this.ondata.bind(this)),Qc.on(t,"error",this.onerror.bind(this)),Qc.on(t,"close",this.onclose.bind(this)),Qc.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){nr("error",t),this.emitReserved("error",t)}socket(t,s){let h=this.nsps[t];return h||(h=new A8.Socket(this,t,s),this.nsps[t]=h),h}_destroy(t){const s=Object.keys(this.nsps);for(const h of s)if(this.nsps[h].active){nr("socket %s is still active, skipping close",h);return}this._close()}_packet(t){nr("writing packet %j",t);const s=this.encoder.encode(t);for(let h=0;h<s.length;h++)this.engine.write(s[h],t.options)}cleanup(){nr("cleanup"),this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){nr("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this._readyState==="opening"&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t){nr("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)nr("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const s=this.backoff.duration();nr("will wait %dms before reconnect attempt",s),this._reconnecting=!0;const h=setTimeout(()=>{t.skipReconnect||(nr("attempting reconnect"),this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(_=>{_?(nr("reconnect attempt error"),t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",_)):(nr("reconnect success"),t.onreconnect())}))},s);this.opts.autoUnref&&h.unref(),this.subs.push(function(){clearTimeout(h)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}Rp.Manager=P8;(function(i,t){Object.defineProperty(t,"__esModule",{value:!0}),t.io=t.Socket=t.Manager=t.protocol=void 0;const s=xy,h=Rp,_=sd.exports("socket.io-client");i.exports=t=E;const x=t.managers={};function E(M,P){typeof M=="object"&&(P=M,M=void 0),P=P||{};const z=s.url(M,P.path||"/socket.io"),q=z.source,se=z.id,ue=z.path,oe=x[se]&&ue in x[se].nsps,fe=P.forceNew||P["force new connection"]||P.multiplex===!1||oe;let xe;return fe?(_("ignoring socket cache for %s",q),xe=new h.Manager(q,P)):(x[se]||(_("new io instance for %s",q),x[se]=new h.Manager(q,P)),xe=x[se]),z.query&&!P.query&&(P.query=z.queryKey),xe.socket(z.path,P)}t.io=E;var a=Ay;Object.defineProperty(t,"protocol",{enumerable:!0,get:function(){return a.protocol}}),t.connect=E;var S=Rp;Object.defineProperty(t,"Manager",{enumerable:!0,get:function(){return S.Manager}});var O=Up;Object.defineProperty(t,"Socket",{enumerable:!0,get:function(){return O.Socket}}),t.default=E})(m1,m1.exports);var qk=aU(m1.exports);qk.Manager;qk.Socket;var Zk={exports:{}};(function(i,t){(function(s,h){i.exports=h()})(sU,function(){var s,h,_;function x(a,S){if(!s)s=S;else if(!h)h=S;else{var O="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+s+")(sharedChunk); ("+h+")(sharedChunk); self.onerror = null;",M={};s(M),_=S(M),typeof window!="undefined"&&window&&window.URL&&window.URL.createObjectURL&&(_.workerUrl=window.URL.createObjectURL(new Blob([O],{type:"text/javascript"})))}}x(["exports"],function(a){var S=typeof self!="undefined"?self:{},O=M;function M(r,e,o,l){this.cx=3*r,this.bx=3*(o-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(l-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=l,this.p2x=o,this.p2y=l}M.prototype.sampleCurveX=function(r){return((this.ax*r+this.bx)*r+this.cx)*r},M.prototype.sampleCurveY=function(r){return((this.ay*r+this.by)*r+this.cy)*r},M.prototype.sampleCurveDerivativeX=function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},M.prototype.solveCurveX=function(r,e){var o,l,u,f,m;for(e===void 0&&(e=1e-6),u=r,m=0;m<8;m++){if(f=this.sampleCurveX(u)-r,Math.abs(f)<e)return u;var y=this.sampleCurveDerivativeX(u);if(Math.abs(y)<1e-6)break;u-=f/y}if((u=r)<(o=0))return o;if(u>(l=1))return l;for(;o<l;){if(f=this.sampleCurveX(u),Math.abs(f-r)<e)return u;r>f?o=u:l=u,u=.5*(l-o)+o}return u},M.prototype.solve=function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))};var P=z;function z(r,e){this.x=r,this.y=e}z.prototype={clone:function(){return new z(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,e){return this.clone()._rotateAround(r,e)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var e=r.x-this.x,o=r.y-this.y;return e*e+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,e){return Math.atan2(this.x*e-this.y*r,this.x*r+this.y*e)},_matMult:function(r){var e=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=e,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var e=Math.cos(r),o=Math.sin(r),l=o*this.x+e*this.y;return this.x=e*this.x-o*this.y,this.y=l,this},_rotateAround:function(r,e){var o=Math.cos(r),l=Math.sin(r),u=e.y+l*(this.x-e.x)+o*(this.y-e.y);return this.x=e.x+o*(this.x-e.x)-l*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},z.convert=function(r){return r instanceof z?r:Array.isArray(r)?new z(r[0],r[1]):r};const q=Math.PI/180,se=180/Math.PI;function ue(r){return r*q}function oe(r){return r*se}const fe=[[0,0],[1,0],[1,1],[0,1]];function xe(r){if(r<=0)return 0;if(r>=1)return 1;const e=r*r,o=e*r;return 4*(r<.5?o:3*(r-e)+o-.75)}function Be(r,e,o,l){const u=new O(r,e,o,l);return function(f){return u.solve(f)}}const $e=Be(.25,.1,.25,1);function Ge(r,e,o){return Math.min(o,Math.max(e,r))}function xt(r,e,o){return(o=Ge((o-r)/(e-r),0,1))*o*(3-2*o)}function pt(r,e,o){const l=o-e,u=((r-e)%l+l)%l+e;return u===e?o:u}function jt(r,e,o){if(!r.length)return o(null,[]);let l=r.length;const u=new Array(r.length);let f=null;r.forEach((m,y)=>{e(m,(b,w)=>{b&&(f=b),u[y]=w,--l==0&&o(f,u)})})}function Dt(r){const e=[];for(const o in r)e.push(r[o]);return e}function Ft(r,...e){for(const o of e)for(const l in o)r[l]=o[l];return r}let ai=1;function wt(){return ai++}function Nt(){return function r(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function qi(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function bn(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function hi(r,e){r.forEach(o=>{e[o]&&(e[o]=e[o].bind(e))})}function ri(r,e){return r.indexOf(e,r.length-e.length)!==-1}function ei(r,e,o){const l={};for(const u in r)l[u]=e.call(o||this,r[u],u,r);return l}function Wi(r,e,o){const l={};for(const u in r)e.call(o||this,r[u],u,r)&&(l[u]=r[u]);return l}function sn(r){return Array.isArray(r)?r.map(sn):typeof r=="object"&&r?ei(r,sn):r}const kn={};function oi(r){kn[r]||(typeof console!="undefined"&&console.warn(r),kn[r]=!0)}function Si(r,e,o){return(o.y-r.y)*(e.x-r.x)>(e.y-r.y)*(o.x-r.x)}function yn(r){let e=0;for(let o,l,u=0,f=r.length,m=f-1;u<f;m=u++)o=r[u],l=r[m],e+=(l.x-o.x)*(o.y+l.y);return e}function Ne(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function bt(r){const e={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,l,u,f)=>{const m=u||f;return e[l]=!m||m.toLowerCase(),""}),e["max-age"]){const o=parseInt(e["max-age"],10);isNaN(o)?delete e["max-age"]:e["max-age"]=o}return e}let ct=null;function It(r){if(ct==null){const e=r.navigator?r.navigator.userAgent:null;ct=!!r.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return ct}function wi(r){try{const e=S[r];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function di(r,e){return[r[4*e],r[4*e+1],r[4*e+2],r[4*e+3]]}const ti=S.performance;function Wt(r){const e=r?r.url.toString():void 0;return ti.getEntriesByName(e)}var de="2.9.1";let me,Le,He,Ze;const et={now:()=>He!==void 0?He:S.performance.now(),setNow(r){He=r},restoreNow(){He=void 0},frame(r){const e=S.requestAnimationFrame(r);return{cancel:()=>S.cancelAnimationFrame(e)}},getImageData(r,e=0){const{width:o,height:l}=r;Ze||(Ze=S.document.createElement("canvas"));const u=Ze.getContext("2d");if(!u)throw new Error("failed to create canvas 2d context");return(o>Ze.width||l>Ze.height)&&(Ze.width=o,Ze.height=l),u.clearRect(-e,-e,o+2*e,l+2*e),u.drawImage(r,0,0,o,l),u.getImageData(-e,-e,o+2*e,l+2*e)},resolveURL:r=>(me||(me=S.document.createElement("a")),me.href=r,me.href),get devicePixelRatio(){return S.devicePixelRatio},get prefersReducedMotion(){return!!S.matchMedia&&(Le==null&&(Le=S.matchMedia("(prefers-reduced-motion: reduce)")),Le.matches)}};let vt;const Ue={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(vt==null){const r=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{vt={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):r}catch{vt=r}}return vt},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},rt={supported:!1,testSupport:function(r){!Tt&&Mt&&(zt?Vt(r):Qe=r)}};let Qe,Mt,Tt=!1,zt=!1;function Vt(r){const e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,Mt),r.isContextLost())return;rt.supported=!0}catch{}r.deleteTexture(e),Tt=!0}S.document&&(Mt=S.document.createElement("img"),Mt.onload=function(){Qe&&Vt(Qe),Qe=null,zt=!0},Mt.onerror=function(){Tt=!0,Qe=null},Mt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const li="01",fi="NO_ACCESS_TOKEN";function pi(r){return r.indexOf("mapbox:")===0}function Ii(r){return Ue.API_URL_REGEX.test(r)}const Un=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function wn(r){const e=r.match(Un);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Sr(r){const e=r.params.length?`?${r.params.join("&")}`:"";return`${r.protocol}://${r.authority}${r.path}${e}`}function co(r){if(!r)return null;const e=r.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(S.atob(e[1]).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Yo{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const o=co(Ue.ACCESS_TOKEN);let l="";return l=o&&o.u?S.btoa(encodeURIComponent(o.u).replace(/%([0-9A-F]{2})/g,(u,f)=>String.fromCharCode(Number("0x"+f)))):Ue.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${l}`:`mapbox.eventData:${l}`}fetchEventData(){const e=wi("localStorage"),o=this.getStorageKey(),l=this.getStorageKey("uuid");if(e)try{const u=S.localStorage.getItem(o);u&&(this.eventData=JSON.parse(u));const f=S.localStorage.getItem(l);f&&(this.anonId=f)}catch{oi("Unable to read from LocalStorage")}}saveEventData(){const e=wi("localStorage"),o=this.getStorageKey(),l=this.getStorageKey("uuid");if(e)try{S.localStorage.setItem(l,this.anonId),Object.keys(this.eventData).length>=1&&S.localStorage.setItem(o,JSON.stringify(this.eventData))}catch{oi("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,o,l,u){if(!Ue.EVENTS_URL)return;const f=wn(Ue.EVENTS_URL);f.params.push(`access_token=${u||Ue.ACCESS_TOKEN||""}`);const m={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:de,skuId:li,userId:this.anonId},y=o?Ft(m,o):m,b={url:Sr(f),headers:{"Content-Type":"text/plain"},body:JSON.stringify([y])};this.pendingRequest=Se(b,w=>{this.pendingRequest=null,l(w),this.saveEventData(),this.processRequests(u)})}queueRequest(e,o){this.queue.push(e),this.processRequests(o)}}const Pn=new class extends Yo{constructor(r){super("appUserTurnstile"),this._customAccessToken=r}postTurnstileEvent(r,e){Ue.EVENTS_URL&&Ue.ACCESS_TOKEN&&Array.isArray(r)&&r.some(o=>pi(o)||Ii(o))&&this.queueRequest(Date.now(),e)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=co(Ue.ACCESS_TOKEN),o=e?e.u:Ue.ACCESS_TOKEN;let l=o!==this.eventData.tokenU;bn(this.anonId)||(this.anonId=Nt(),l=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const f=new Date(this.eventData.lastSuccess),m=new Date(u),y=(u-this.eventData.lastSuccess)/864e5;l=l||y>=1||y<-1||f.getDate()!==m.getDate()}else l=!0;l?this.postEvent(u,{"enabled.telemetry":!1},f=>{f||(this.eventData.lastSuccess=u,this.eventData.tokenU=o)},r):this.processRequests()}},jn=Pn.postTurnstileEvent.bind(Pn),Jo=new class extends Yo{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(r,e,o,l){this.skuToken=e,this.errorCb=l,Ue.EVENTS_URL&&(o||Ue.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},o):this.errorCb(new Error(fi)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:o}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),bn(this.anonId)||(this.anonId=Nt()),this.postEvent(o,{skuToken:this.skuToken},l=>{l?this.errorCb(l):e&&(this.success[e]=!0)},r))}},eu=Jo.postMapLoadEvent.bind(Jo),tu=new class extends Yo{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(r,e,o,l){if(!Ue.API_URL||!Ue.SESSION_PATH)return;const u=wn(Ue.API_URL+Ue.SESSION_PATH);u.params.push(`sku=${e||""}`),u.params.push(`access_token=${l||Ue.ACCESS_TOKEN||""}`);const f={url:Sr(u),headers:{"Content-Type":"text/plain"}};this.pendingRequest=je(f,m=>{this.pendingRequest=null,o(m),this.saveEventData(),this.processRequests(l)})}getSessionAPI(r,e,o,l){this.skuToken=e,this.errorCb=l,Ue.SESSION_PATH&&Ue.API_URL&&(o||Ue.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},o):this.errorCb(new Error(fi)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:o}=this.queue.shift();e&&this.success[e]||this.getSession(o,this.skuToken,l=>{l?this.errorCb(l):e&&(this.success[e]=!0)},r)}},vd=tu.getSessionAPI.bind(tu),Qo=new Set;let Lo,fa=500,iu=50,rr={};function vl(r){const e=U(r);let o,l;e&&e.forEach(f=>{const m=f.split("=");m[0]==="language"?o=m[1]:m[0]==="worldview"&&(l=m[1])});let u="mapbox-tiles";return o&&(u+=`-${o}`),l&&(u+=`-${l}`),u}function J(r){S.caches&&!rr[r]&&(rr[r]=S.caches.open(r))}function U(r){const e=r.indexOf("?");return e>0?r.slice(e+1).split("&"):[]}function j(r){const e=r.indexOf("?");if(e<0)return r;const o=U(r).filter(l=>{const u=l.split("=");return u[0]==="language"||u[0]==="worldview"});return o.length?`${r.slice(0,e)}?${o.join("&")}`:r.slice(0,e)}let Y=1/0;const re={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(re);class ge extends Error{constructor(e,o,l){o===401&&Ii(l)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=o,this.url=l}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Te=Ne()?()=>self.worker&&self.worker.referrer:()=>(S.location.protocol==="blob:"?S.parent:S).location.href,we=function(r,e){if(!(/^file:/.test(o=r.url)||/^file:/.test(Te())&&!/^\w+:/.test(o))){if(S.fetch&&S.Request&&S.AbortController&&S.Request.prototype.hasOwnProperty("signal"))return function(l,u){const f=new S.AbortController,m=new S.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:Te(),signal:f.signal});let y=!1,b=!1;const w=(A=m.url).indexOf("sku=")>0&&Ii(A);var A;l.type==="json"&&m.headers.set("Accept","application/json");const k=(R,F,V)=>{if(b)return;if(R&&R.message!=="SecurityError"&&oi(R),F&&V)return D(F);const K=Date.now();S.fetch(m).then(ee=>{if(ee.ok){const he=w?ee.clone():null;return D(ee,he,K)}return u(new ge(ee.statusText,ee.status,l.url))}).catch(ee=>{ee.code!==20&&u(new Error(ee.message))})},D=(R,F,V)=>{(l.type==="arrayBuffer"?R.arrayBuffer():l.type==="json"?R.json():R.text()).then(K=>{b||(F&&V&&function(ee,he,ce){const pe=vl(ee.url);if(J(pe),!rr[pe])return;const ye={status:he.status,statusText:he.statusText,headers:new S.Headers};he.headers.forEach((Pe,Fe)=>ye.headers.set(Fe,Pe));const be=bt(he.headers.get("Cache-Control")||"");if(be["no-store"])return;be["max-age"]&&ye.headers.set("Expires",new Date(ce+1e3*be["max-age"]).toUTCString());const ke=ye.headers.get("Expires");ke&&(new Date(ke).getTime()-ce<42e4||function(Pe,Fe){if(Lo===void 0)try{new Response(new ReadableStream),Lo=!0}catch{Lo=!1}Lo?Fe(Pe.body):Pe.blob().then(Fe)}(he,Pe=>{const Fe=new S.Response(Pe,ye);J(pe),rr[pe]&&rr[pe].then(Xe=>Xe.put(j(ee.url),Fe)).catch(Xe=>oi(Xe.message))}))}(m,F,V),y=!0,u(null,K,R.headers.get("Cache-Control"),R.headers.get("Expires")))}).catch(K=>{b||u(new Error(K.message))})};return w?function(R,F){const V=vl(R.url);if(J(V),!rr[V])return F(null);const K=j(R.url);rr[V].then(ee=>{ee.match(K).then(he=>{const ce=function(pe){if(!pe)return!1;const ye=new Date(pe.headers.get("Expires")||0),be=bt(pe.headers.get("Cache-Control")||"");return ye>Date.now()&&!be["no-cache"]}(he);ee.delete(K),ce&&ee.put(K,he.clone()),F(null,he,ce)}).catch(F)}).catch(F)}(m,k):k(null,null),{cancel:()=>{b=!0,y||f.abort()}}}(r,e);if(Ne()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e,void 0,!0)}var o;return function(l,u){const f=new S.XMLHttpRequest;f.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(f.responseType="arraybuffer");for(const m in l.headers)f.setRequestHeader(m,l.headers[m]);return l.type==="json"&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials=l.credentials==="include",f.onerror=()=>{u(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||f.status===0)&&f.response!==null){let m=f.response;if(l.type==="json")try{m=JSON.parse(f.response)}catch(y){return u(y)}u(null,m,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else u(new ge(f.statusText,f.status,l.url))},f.send(l.body),{cancel:()=>f.abort()}}(r,e)},ve=function(r,e){return we(Ft(r,{type:"arrayBuffer"}),e)},Se=function(r,e){return we(Ft(r,{method:"POST"}),e)},je=function(r,e){return we(Ft(r,{method:"GET"}),e)};function dt(r){const e=S.document.createElement("a");return e.href=r,e.protocol===S.document.location.protocol&&e.host===S.document.location.host}const We="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let kt,Lt;kt=[],Lt=0;const Pt=function(r,e){if(rt.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),Lt>=Ue.MAX_PARALLEL_IMAGE_REQUESTS){const f={requestParameters:r,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return kt.push(f),f}Lt++;let o=!1;const l=()=>{if(!o)for(o=!0,Lt--;kt.length&&Lt<Ue.MAX_PARALLEL_IMAGE_REQUESTS;){const f=kt.shift(),{requestParameters:m,callback:y,cancelled:b}=f;b||(f.cancel=Pt(m,y).cancel)}},u=ve(r,(f,m,y,b)=>{l(),f?e(f):m&&(S.createImageBitmap?function(w,A){const k=new S.Blob([new Uint8Array(w)],{type:"image/png"});S.createImageBitmap(k).then(D=>{A(null,D)}).catch(D=>{A(new Error(`Could not load image because of ${D.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(m,(w,A)=>e(w,A,y,b)):function(w,A){const k=new S.Image,D=S.URL;k.onload=()=>{A(null,k),D.revokeObjectURL(k.src),k.onload=null,S.requestAnimationFrame(()=>{k.src=We})},k.onerror=()=>A(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const R=new S.Blob([new Uint8Array(w)],{type:"image/png"});k.src=w.byteLength?D.createObjectURL(R):We}(m,(w,A)=>e(w,A,y,b)))});return{cancel:()=>{u.cancel(),l()}}};function Rt(r,e,o){o[r]&&o[r].indexOf(e)!==-1||(o[r]=o[r]||[],o[r].push(e))}function Ht(r,e,o){if(o&&o[r]){const l=o[r].indexOf(e);l!==-1&&o[r].splice(l,1)}}class Ei{constructor(e,o={}){Ft(this,o),this.type=e}}class Zi extends Ei{constructor(e,o={}){super("error",Ft({error:e},o))}}class Mi{on(e,o){return this._listeners=this._listeners||{},Rt(e,o,this._listeners),this}off(e,o){return Ht(e,o,this._listeners),Ht(e,o,this._oneTimeListeners),this}once(e,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Rt(e,o,this._oneTimeListeners),this):new Promise(l=>this.once(e,l))}fire(e,o){typeof e=="string"&&(e=new Ei(e,o||{}));const l=e.type;if(this.listens(l)){e.target=this;const u=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const y of u)y.call(this,e);const f=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const y of f)Ht(l,y,this._oneTimeListeners),y.call(this,e);const m=this._eventedParent;m&&(Ft(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),m.fire(e))}else e instanceof Zi&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,o){return this._eventedParent=e,this._eventedParentData=o,this}}var Ee=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function _r(r,...e){for(const o of e)for(const l in o)r[l]=o[l];return r}function Qi(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Ar(r){if(Array.isArray(r))return r.map(Ar);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const o in r)e[o]=Ar(r[o]);return e}return Qi(r)}class Py extends Error{constructor(e,o){super(o),this.message=o,this.key=e}}var gr=Py;class nu{constructor(e,o=[]){this.parent=e,this.bindings={};for(const[l,u]of o)this.bindings[l]=u}concat(e){return new nu(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var $p=nu;const xl={kind:"null"},ut={kind:"number"},ci={kind:"string"},Xt={kind:"boolean"},Kr={kind:"color"},Ds={kind:"object"},qt={kind:"value"},zo={kind:"collator"},pa={kind:"formatted"},bl={kind:"resolvedImage"};function Ir(r,e){return{kind:"array",itemType:r,N:e}}function en(r){if(r.kind==="array"){const e=en(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}return r.kind}const Gp=[xl,ut,ci,Xt,Kr,pa,Ds,Ir(qt),bl];function ma(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!ma(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const o of Gp)if(!ma(o,e))return null}}return`Expected ${en(r)} but found ${en(e)} instead.`}function ru(r,e){return e.some(o=>o.kind===r.kind)}function _a(r,e){return e.some(o=>o==="null"?r===null:o==="array"?Array.isArray(r):o==="object"?r&&!Array.isArray(r)&&typeof r=="object":o===typeof r)}function ga(r){var e={exports:{}};return r(e,e.exports),e.exports}var qp=ga(function(r,e){var o={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(y){return(y=Math.round(y))<0?0:y>255?255:y}function u(y){return l(y[y.length-1]==="%"?parseFloat(y)/100*255:parseInt(y))}function f(y){return(b=y[y.length-1]==="%"?parseFloat(y)/100:parseFloat(y))<0?0:b>1?1:b;var b}function m(y,b,w){return w<0?w+=1:w>1&&(w-=1),6*w<1?y+(b-y)*w*6:2*w<1?b:3*w<2?y+(b-y)*(2/3-w)*6:y}try{e.parseCSSColor=function(y){var b,w=y.replace(/ /g,"").toLowerCase();if(w in o)return o[w].slice();if(w[0]==="#")return w.length===4?(b=parseInt(w.substr(1),16))>=0&&b<=4095?[(3840&b)>>4|(3840&b)>>8,240&b|(240&b)>>4,15&b|(15&b)<<4,1]:null:w.length===7&&(b=parseInt(w.substr(1),16))>=0&&b<=16777215?[(16711680&b)>>16,(65280&b)>>8,255&b,1]:null;var A=w.indexOf("("),k=w.indexOf(")");if(A!==-1&&k+1===w.length){var D=w.substr(0,A),R=w.substr(A+1,k-(A+1)).split(","),F=1;switch(D){case"rgba":if(R.length!==4)return null;F=f(R.pop());case"rgb":return R.length!==3?null:[u(R[0]),u(R[1]),u(R[2]),F];case"hsla":if(R.length!==4)return null;F=f(R.pop());case"hsl":if(R.length!==3)return null;var V=(parseFloat(R[0])%360+360)%360/360,K=f(R[1]),ee=f(R[2]),he=ee<=.5?ee*(K+1):ee+K-ee*K,ce=2*ee-he;return[l(255*m(ce,he,V+1/3)),l(255*m(ce,he,V)),l(255*m(ce,he,V-1/3)),F];default:return null}}return null}}catch{}});class En{constructor(e,o,l,u=1){this.r=e,this.g=o,this.b=l,this.a=u}static parse(e){if(!e)return;if(e instanceof En)return e;if(typeof e!="string")return;const o=qp.parseCSSColor(e);return o?new En(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toString(){const[e,o,l,u]=this.toArray();return`rgba(${Math.round(e)},${Math.round(o)},${Math.round(l)},${u})`}toArray(){const{r:e,g:o,b:l,a:u}=this;return u===0?[0,0,0,0]:[255*e/u,255*o/u,255*l/u,u]}toArray01(){const{r:e,g:o,b:l,a:u}=this;return u===0?[0,0,0,0]:[e/u,o/u,l/u,u]}toArray01PremultipliedAlpha(){const{r:e,g:o,b:l,a:u}=this;return[e,o,l,u]}}En.black=new En(0,0,0,1),En.white=new En(1,1,1,1),En.transparent=new En(0,0,0,0),En.red=new En(1,0,0,1),En.blue=new En(0,0,1,1);var hn=En;class Mr{constructor(e,o,l){this.sensitivity=e?o?"variant":"case":o?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,o){return this.collator.compare(e,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class xd{constructor(e,o,l,u,f){this.text=e.normalize?e.normalize():e,this.image=o,this.scale=l,this.fontStack=u,this.textColor=f}}class Vn{constructor(e){this.sections=e}static fromString(e){return new Vn([new xd(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Vn?e:Vn.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const o of this.sections){if(o.image){e.push(["image",o.image.name]);continue}e.push(o.text);const l={};o.fontStack&&(l["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(l["font-scale"]=o.scale),o.textColor&&(l["text-color"]=["rgba"].concat(o.textColor.toArray())),e.push(l)}return e}}class kr{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new kr({name:e,available:!1}):null}serialize(){return["image",this.name]}}function ou(r,e,o,l){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof o=="number"&&o>=0&&o<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[r,e,o,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[r,e,o,l]:[r,e,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function wl(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof hn||r instanceof Mr||r instanceof Vn||r instanceof kr)return!0;if(Array.isArray(r)){for(const e of r)if(!wl(e))return!1;return!0}if(typeof r=="object"){for(const e in r)if(!wl(r[e]))return!1;return!0}return!1}function an(r){if(r===null)return xl;if(typeof r=="string")return ci;if(typeof r=="boolean")return Xt;if(typeof r=="number")return ut;if(r instanceof hn)return Kr;if(r instanceof Mr)return zo;if(r instanceof Vn)return pa;if(r instanceof kr)return bl;if(Array.isArray(r)){const e=r.length;let o;for(const l of r){const u=an(l);if(o){if(o===u)continue;o=qt;break}o=u}return Ir(o||qt,e)}return Ds}function Ls(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof hn||r instanceof Vn||r instanceof kr?r.toString():JSON.stringify(r)}class bd{constructor(e,o){this.type=e,this.value=o}static parse(e,o){if(e.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!wl(e[1]))return o.error("invalid value");const l=e[1];let u=an(l);const f=o.expectedType;return u.kind!=="array"||u.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(u=f),new bd(u,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof hn?["rgba"].concat(this.value.toArray()):this.value instanceof Vn?this.value.serialize():this.value}}var El=bd,Rn=class{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}};const su={string:ci,number:ut,boolean:Xt,object:Ds};class Tl{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");let l,u=1;const f=e[0];if(f==="array"){let y,b;if(e.length>2){const w=e[1];if(typeof w!="string"||!(w in su)||w==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);y=su[w],u++}else y=qt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return o.error('The length argument to "array" must be a positive integer literal',2);b=e[2],u++}l=Ir(y,b)}else l=su[f];const m=[];for(;u<e.length;u++){const y=o.parse(e[u],u,qt);if(!y)return null;m.push(y)}return new Tl(l,m)}evaluate(e){for(let o=0;o<this.args.length;o++){const l=this.args[o].evaluate(e);if(!ma(this.type,an(l)))return l;if(o===this.args.length-1)throw new Rn(`Expected value to be of type ${en(this.type)}, but found ${en(an(l))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,o=[e.kind];if(e.kind==="array"){const l=e.itemType;if(l.kind==="string"||l.kind==="number"||l.kind==="boolean"){o.push(l.kind);const u=e.N;(typeof u=="number"||this.args.length>1)&&o.push(u)}}return o.concat(this.args.map(l=>l.serialize()))}}var Oo=Tl;class es{constructor(e){this.type=pa,this.sections=e}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const l=e[1];if(!Array.isArray(l)&&typeof l=="object")return o.error("First argument must be an image or text section.");const u=[];let f=!1;for(let m=1;m<=e.length-1;++m){const y=e[m];if(f&&typeof y=="object"&&!Array.isArray(y)){f=!1;let b=null;if(y["font-scale"]&&(b=o.parse(y["font-scale"],1,ut),!b))return null;let w=null;if(y["text-font"]&&(w=o.parse(y["text-font"],1,Ir(ci)),!w))return null;let A=null;if(y["text-color"]&&(A=o.parse(y["text-color"],1,Kr),!A))return null;const k=u[u.length-1];k.scale=b,k.font=w,k.textColor=A}else{const b=o.parse(e[m],1,qt);if(!b)return null;const w=b.type.kind;if(w!=="string"&&w!=="value"&&w!=="null"&&w!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:b,scale:null,font:null,textColor:null})}}return new es(u)}evaluate(e){return new Vn(this.sections.map(o=>{const l=o.content.evaluate(e);return an(l)===bl?new xd("",l,null,null,null):new xd(Ls(l),null,o.scale?o.scale.evaluate(e):null,o.font?o.font.evaluate(e).join(","):null,o.textColor?o.textColor.evaluate(e):null)}))}eachChild(e){for(const o of this.sections)e(o.content),o.scale&&e(o.scale),o.font&&e(o.font),o.textColor&&e(o.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const o of this.sections){e.push(o.content.serialize());const l={};o.scale&&(l["font-scale"]=o.scale.serialize()),o.font&&(l["text-font"]=o.font.serialize()),o.textColor&&(l["text-color"]=o.textColor.serialize()),e.push(l)}return e}}class au{constructor(e){this.type=bl,this.input=e}static parse(e,o){if(e.length!==2)return o.error("Expected two arguments.");const l=o.parse(e[1],1,ci);return l?new au(l):o.error("No image name provided.")}evaluate(e){const o=this.input.evaluate(e),l=kr.fromString(o);return l&&e.availableImages&&(l.available=e.availableImages.indexOf(o)>-1),l}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Dy={"to-boolean":Xt,"to-color":Kr,"to-number":ut,"to-string":ci};class wd{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const l=e[0];if((l==="to-boolean"||l==="to-string")&&e.length!==2)return o.error("Expected one argument.");const u=Dy[l],f=[];for(let m=1;m<e.length;m++){const y=o.parse(e[m],m,qt);if(!y)return null;f.push(y)}return new wd(u,f)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let o,l;for(const u of this.args){if(o=u.evaluate(e),l=null,o instanceof hn)return o;if(typeof o=="string"){const f=e.parseColor(o);if(f)return f}else if(Array.isArray(o)&&(l=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:ou(o[0],o[1],o[2],o[3]),!l))return new hn(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Rn(l||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const l of this.args){if(o=l.evaluate(e),o===null)return 0;const u=Number(o);if(!isNaN(u))return u}throw new Rn(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?Vn.fromString(Ls(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?kr.fromString(Ls(this.args[0].evaluate(e))):Ls(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new es([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new au(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(o=>{e.push(o.serialize())}),e}}var ya=wd;const Ly=["Unknown","Point","LineString","Polygon"];var Zp=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ly[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:o,y:l}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(o*e-r[0])+this.featureDistanceData.bearing[1]*(l*e-r[1])}return 0}parseColor(r){let e=this._parseColorCache[r];return e||(e=this._parseColorCache[r]=hn.parse(r)),e}};class va{constructor(e,o,l,u){this.name=e,this.type=o,this._evaluate=l,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,o){const l=e[0],u=va.definitions[l];if(!u)return o.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(u)?u[0]:u.type,m=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,y=m.filter(([w])=>!Array.isArray(w)||w.length===e.length-1);let b=null;for(const[w,A]of y){b=new Kp(o.registry,o.path,null,o.scope);const k=[];let D=!1;for(let R=1;R<e.length;R++){const F=e[R],V=Array.isArray(w)?w[R-1]:w.type,K=b.parse(F,1+k.length,V);if(!K){D=!0;break}k.push(K)}if(!D)if(Array.isArray(w)&&w.length!==k.length)b.error(`Expected ${w.length} arguments, but found ${k.length} instead.`);else{for(let R=0;R<k.length;R++){const F=Array.isArray(w)?w[R]:w.type,V=k[R];b.concat(R+1).checkSubtype(F,V.type)}if(b.errors.length===0)return new va(l,f,A,k)}}if(y.length===1)o.errors.push(...b.errors);else{const w=(y.length?y:m).map(([k])=>{return D=k,Array.isArray(D)?`(${D.map(en).join(", ")})`:`(${en(D.type)}...)`;var D}).join(" | "),A=[];for(let k=1;k<e.length;k++){const D=o.parse(e[k],1+A.length);if(!D)return null;A.push(en(D.type))}o.error(`Expected arguments of type ${w}, but found (${A.join(", ")}) instead.`)}return null}static register(e,o){va.definitions=o;for(const l in o)e[l]=va}}var Ro=va;class zs{constructor(e,o,l){this.type=zo,this.locale=l,this.caseSensitive=e,this.diacriticSensitive=o}static parse(e,o){if(e.length!==2)return o.error("Expected one argument.");const l=e[1];if(typeof l!="object"||Array.isArray(l))return o.error("Collator options argument must be an object.");const u=o.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,Xt);if(!u)return null;const f=o.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,Xt);if(!f)return null;let m=null;return l.locale&&(m=o.parse(l.locale,1,ci),!m)?null:new zs(u,f,m)}evaluate(e){return new Mr(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const ts=8192;function Ed(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function lu(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function zy(r,e){const o=(180+r[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(o*u*ts),Math.round(l*u*ts)]}function Oy(r,e,o){const l=r[0]-e[0],u=r[1]-e[1],f=r[0]-o[0],m=r[1]-o[1];return l*m-f*u==0&&l*f<=0&&u*m<=0}function Td(r,e){let o=!1;for(let m=0,y=e.length;m<y;m++){const b=e[m];for(let w=0,A=b.length;w<A-1;w++){if(Oy(r,b[w],b[w+1]))return!1;(u=b[w])[1]>(l=r)[1]!=(f=b[w+1])[1]>l[1]&&l[0]<(f[0]-u[0])*(l[1]-u[1])/(f[1]-u[1])+u[0]&&(o=!o)}}var l,u,f;return o}function Wp(r,e){for(let o=0;o<e.length;o++)if(Td(r,e[o]))return!0;return!1}function Cl(r,e,o,l){const u=l[0]-o[0],f=l[1]-o[1],m=(r[0]-o[0])*f-u*(r[1]-o[1]),y=(e[0]-o[0])*f-u*(e[1]-o[1]);return m>0&&y<0||m<0&&y>0}function Ry(r,e,o){for(const w of o)for(let A=0;A<w.length-1;++A)if((y=[(m=w[A+1])[0]-(f=w[A])[0],m[1]-f[1]])[0]*(b=[(u=e)[0]-(l=r)[0],u[1]-l[1]])[1]-y[1]*b[0]!=0&&Cl(l,u,f,m)&&Cl(f,m,l,u))return!0;var l,u,f,m,y,b;return!1}function Hp(r,e){for(let o=0;o<r.length;++o)if(!Td(r[o],e))return!1;for(let o=0;o<r.length-1;++o)if(Ry(r[o],r[o+1],e))return!1;return!0}function By(r,e){for(let o=0;o<e.length;o++)if(Hp(r,e[o]))return!0;return!1}function Cd(r,e,o){const l=[];for(let u=0;u<r.length;u++){const f=[];for(let m=0;m<r[u].length;m++){const y=zy(r[u][m],o);Ed(e,y),f.push(y)}l.push(f)}return l}function Yr(r,e,o){const l=[];for(let u=0;u<r.length;u++){const f=Cd(r[u],e,o);l.push(f)}return l}function Sd(r,e,o,l){if(r[0]<o[0]||r[0]>o[2]){const u=.5*l;let f=r[0]-o[0]>u?-l:o[0]-r[0]>u?l:0;f===0&&(f=r[0]-o[2]>u?-l:o[2]-r[0]>u?l:0),r[0]+=f}Ed(e,r)}function Ad(r,e,o,l){const u=Math.pow(2,l.z)*ts,f=[l.x*ts,l.y*ts],m=[];if(!r)return m;for(const y of r)for(const b of y){const w=[b.x+f[0],b.y+f[1]];Sd(w,e,o,u),m.push(w)}return m}function Sl(r,e,o,l){const u=Math.pow(2,l.z)*ts,f=[l.x*ts,l.y*ts],m=[];if(!r)return m;for(const b of r){const w=[];for(const A of b){const k=[A.x+f[0],A.y+f[1]];Ed(e,k),w.push(k)}m.push(w)}if(e[2]-e[0]<=u/2){(y=e)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(const b of m)for(const w of b)Sd(w,e,o,u)}var y;return m}class Bo{constructor(e,o){this.type=Xt,this.geojson=e,this.geometries=o}static parse(e,o){if(e.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(wl(e[1])){const l=e[1];if(l.type==="FeatureCollection")for(let u=0;u<l.features.length;++u){const f=l.features[u].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Bo(l,l.features[u].geometry)}else if(l.type==="Feature"){const u=l.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new Bo(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Bo(l,l)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(o,l){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=o.canonicalID();if(!m)return!1;if(l.type==="Polygon"){const y=Cd(l.coordinates,f,m),b=Ad(o.geometry(),u,f,m);if(!lu(u,f))return!1;for(const w of b)if(!Td(w,y))return!1}if(l.type==="MultiPolygon"){const y=Yr(l.coordinates,f,m),b=Ad(o.geometry(),u,f,m);if(!lu(u,f))return!1;for(const w of b)if(!Wp(w,y))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(o,l){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=o.canonicalID();if(!m)return!1;if(l.type==="Polygon"){const y=Cd(l.coordinates,f,m),b=Sl(o.geometry(),u,f,m);if(!lu(u,f))return!1;for(const w of b)if(!Hp(w,y))return!1}if(l.type==="MultiPolygon"){const y=Yr(l.coordinates,f,m),b=Sl(o.geometry(),u,f,m);if(!lu(u,f))return!1;for(const w of b)if(!By(w,y))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var cu=Bo;function xa(r){if(r instanceof Ro&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof cu)return!1;let e=!0;return r.eachChild(o=>{e&&!xa(o)&&(e=!1)}),e}function ba(r){if(r instanceof Ro&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(o=>{e&&!ba(o)&&(e=!1)}),e}function uu(r,e){if(r instanceof Ro&&e.indexOf(r.name)>=0)return!1;let o=!0;return r.eachChild(l=>{o&&!uu(l,e)&&(o=!1)}),o}class Ti{constructor(e,o){this.type=o.type,this.name=e,this.boundExpression=o}static parse(e,o){if(e.length!==2||typeof e[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const l=e[1];return o.scope.has(l)?new Ti(l,o.scope.get(l)):o.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Xp=Ti;class Id{constructor(e,o=[],l,u=new $p,f=[]){this.registry=e,this.path=o,this.key=o.map(m=>`[${m}]`).join(""),this.scope=u,this.errors=f,this.expectedType=l}parse(e,o,l,u,f={}){return o?this.concat(o,l,u)._parse(e,f):this._parse(e,f)}_parse(e,o){function l(u,f,m){return m==="assert"?new Oo(f,[u]):m==="coerce"?new ya(f,[u]):u}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if(typeof u!="string")return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[u];if(f){let m=f.parse(e,this);if(!m)return null;if(this.expectedType){const y=this.expectedType,b=m.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||b.kind!=="value")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string"){if(this.checkSubtype(y,b))return null}else m=l(m,y,o.typeAnnotation||"coerce");else m=l(m,y,o.typeAnnotation||"assert")}if(!(m instanceof El)&&m.type.kind!=="resolvedImage"&&hu(m)){const y=new Zp;try{m=new El(m.type,m.evaluate(y))}catch(b){return this.error(b.message),null}}return m}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,o,l){const u=typeof e=="number"?this.path.concat(e):this.path,f=l?this.scope.concat(l):this.scope;return new Id(this.registry,u,o||null,f,this.errors)}error(e,...o){const l=`${this.key}${o.map(u=>`[${u}]`).join("")}`;this.errors.push(new gr(l,e))}checkSubtype(e,o){const l=ma(e,o);return l&&this.error(l),l}}var Kp=Id;function hu(r){if(r instanceof Xp)return hu(r.boundExpression);if(r instanceof Ro&&r.name==="error"||r instanceof zs||r instanceof cu)return!1;const e=r instanceof ya||r instanceof Oo;let o=!0;return r.eachChild(l=>{o=e?o&&hu(l):o&&l instanceof El}),!!o&&xa(r)&&uu(r,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function du(r,e){const o=r.length-1;let l,u,f=0,m=o,y=0;for(;f<=m;)if(y=Math.floor((f+m)/2),l=r[y],u=r[y+1],l<=e){if(y===o||e<u)return y;f=y+1}else{if(!(l>e))throw new Rn("Input is not a number.");m=y-1}return 0}class fu{constructor(e,o,l){this.type=e,this.input=o,this.labels=[],this.outputs=[];for(const[u,f]of l)this.labels.push(u),this.outputs.push(f)}static parse(e,o){if(e.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return o.error("Expected an even number of arguments.");const l=o.parse(e[1],1,ut);if(!l)return null;const u=[];let f=null;o.expectedType&&o.expectedType.kind!=="value"&&(f=o.expectedType);for(let m=1;m<e.length;m+=2){const y=m===1?-1/0:e[m],b=e[m+1],w=m,A=m+1;if(typeof y!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',w);if(u.length&&u[u.length-1][0]>=y)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',w);const k=o.parse(b,A,f);if(!k)return null;f=f||k.type,u.push([y,k])}return new fu(f,l,u)}evaluate(e){const o=this.labels,l=this.outputs;if(o.length===1)return l[0].evaluate(e);const u=this.input.evaluate(e);if(u<=o[0])return l[0].evaluate(e);const f=o.length;return u>=o[f-1]?l[f-1].evaluate(e):l[du(o,u)].evaluate(e)}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&e.push(this.labels[o]),e.push(this.outputs[o].serialize());return e}}var pu=fu;function yi(r,e,o){return r*(1-o)+e*o}var Al=Object.freeze({__proto__:null,number:yi,color:function(r,e,o){return new hn(yi(r.r,e.r,o),yi(r.g,e.g,o),yi(r.b,e.b,o),yi(r.a,e.a,o))},array:function(r,e,o){return r.map((l,u)=>yi(l,e[u],o))}});const Os=.95047,Il=1.08883,Yp=4/29,Ml=6/29,Md=3*Ml*Ml,Fy=Math.PI/180,Ny=180/Math.PI;function mu(r){return r>.008856451679035631?Math.pow(r,1/3):r/Md+Yp}function kd(r){return r>Ml?r*r*r:Md*(r-Yp)}function _u(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function gu(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Pd(r){const e=gu(r.r),o=gu(r.g),l=gu(r.b),u=mu((.4124564*e+.3575761*o+.1804375*l)/Os),f=mu((.2126729*e+.7151522*o+.072175*l)/1);return{l:116*f-16,a:500*(u-f),b:200*(f-mu((.0193339*e+.119192*o+.9503041*l)/Il)),alpha:r.a}}function Jp(r){let e=(r.l+16)/116,o=isNaN(r.a)?e:e+r.a/500,l=isNaN(r.b)?e:e-r.b/200;return e=1*kd(e),o=Os*kd(o),l=Il*kd(l),new hn(_u(3.2404542*o-1.5371385*e-.4985314*l),_u(-.969266*o+1.8760108*e+.041556*l),_u(.0556434*o-.2040259*e+1.0572252*l),r.alpha)}function Qp(r,e,o){const l=e-r;return r+o*(l>180||l<-180?l-360*Math.round(l/360):l)}const kl={forward:Pd,reverse:Jp,interpolate:function(r,e,o){return{l:yi(r.l,e.l,o),a:yi(r.a,e.a,o),b:yi(r.b,e.b,o),alpha:yi(r.alpha,e.alpha,o)}}},wa={forward:function(r){const{l:e,a:o,b:l}=Pd(r),u=Math.atan2(l,o)*Ny;return{h:u<0?u+360:u,c:Math.sqrt(o*o+l*l),l:e,alpha:r.a}},reverse:function(r){const e=r.h*Fy,o=r.c;return Jp({l:r.l,a:Math.cos(e)*o,b:Math.sin(e)*o,alpha:r.alpha})},interpolate:function(r,e,o){return{h:Qp(r.h,e.h,o),c:yi(r.c,e.c,o),l:yi(r.l,e.l,o),alpha:yi(r.alpha,e.alpha,o)}}};var Dd=Object.freeze({__proto__:null,lab:kl,hcl:wa});class yu{constructor(e,o,l,u,f){this.type=e,this.operator=o,this.interpolation=l,this.input=u,this.labels=[],this.outputs=[];for(const[m,y]of f)this.labels.push(m),this.outputs.push(y)}static interpolationFactor(e,o,l,u){let f=0;if(e.name==="exponential")f=Ld(o,e.base,l,u);else if(e.name==="linear")f=Ld(o,1,l,u);else if(e.name==="cubic-bezier"){const m=e.controlPoints;f=new O(m[0],m[1],m[2],m[3]).solve(Ld(o,1,l,u))}return f}static parse(e,o){let[l,u,f,...m]=e;if(!Array.isArray(u)||u.length===0)return o.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const w=u[1];if(typeof w!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:w}}else{if(u[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const w=u.slice(1);if(w.length!==4||w.some(A=>typeof A!="number"||A<0||A>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:w}}}if(e.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(f=o.parse(f,2,ut),!f)return null;const y=[];let b=null;l==="interpolate-hcl"||l==="interpolate-lab"?b=Kr:o.expectedType&&o.expectedType.kind!=="value"&&(b=o.expectedType);for(let w=0;w<m.length;w+=2){const A=m[w],k=m[w+1],D=w+3,R=w+4;if(typeof A!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(y.length&&y[y.length-1][0]>=A)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const F=o.parse(k,R,b);if(!F)return null;b=b||F.type,y.push([A,F])}return b.kind==="number"||b.kind==="color"||b.kind==="array"&&b.itemType.kind==="number"&&typeof b.N=="number"?new yu(b,l,u,f,y):o.error(`Type ${en(b)} is not interpolatable.`)}evaluate(e){const o=this.labels,l=this.outputs;if(o.length===1)return l[0].evaluate(e);const u=this.input.evaluate(e);if(u<=o[0])return l[0].evaluate(e);const f=o.length;if(u>=o[f-1])return l[f-1].evaluate(e);const m=du(o,u),y=yu.interpolationFactor(this.interpolation,u,o[m],o[m+1]),b=l[m].evaluate(e),w=l[m+1].evaluate(e);return this.operator==="interpolate"?Al[this.type.kind.toLowerCase()](b,w,y):this.operator==="interpolate-hcl"?wa.reverse(wa.interpolate(wa.forward(b),wa.forward(w),y)):kl.reverse(kl.interpolate(kl.forward(b),kl.forward(w),y))}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const o=[this.operator,e,this.input.serialize()];for(let l=0;l<this.labels.length;l++)o.push(this.labels[l],this.outputs[l].serialize());return o}}function Ld(r,e,o,l){const u=l-o,f=r-o;return u===0?0:e===1?f/u:(Math.pow(e,f)-1)/(Math.pow(e,u)-1)}var uo=yu;class zd{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expectected at least one argument.");let l=null;const u=o.expectedType;u&&u.kind!=="value"&&(l=u);const f=[];for(const y of e.slice(1)){const b=o.parse(y,1+f.length,l,void 0,{typeAnnotation:"omit"});if(!b)return null;l=l||b.type,f.push(b)}const m=u&&f.some(y=>ma(u,y.type));return new zd(m?qt:l,f)}evaluate(e){let o,l=null,u=0;for(const f of this.args){if(u++,l=f.evaluate(e),l&&l instanceof kr&&!l.available&&(o||(o=l),l=null,u===this.args.length))return o;if(l!==null)break}return l}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(o=>{e.push(o.serialize())}),e}}var em=zd;class Od{constructor(e,o){this.type=o.type,this.bindings=[].concat(e),this.result=o}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const o of this.bindings)e(o[1]);e(this.result)}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const l=[];for(let f=1;f<e.length-1;f+=2){const m=e[f];if(typeof m!="string")return o.error(`Expected string, but found ${typeof m} instead.`,f);if(/[^a-zA-Z0-9_]/.test(m))return o.error("Variable names must contain only alphanumeric characters or '_'.",f);const y=o.parse(e[f+1],f+1);if(!y)return null;l.push([m,y])}const u=o.parse(e[e.length-1],e.length-1,o.expectedType,l);return u?new Od(l,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[o,l]of this.bindings)e.push(o,l.serialize());return e.push(this.result.serialize()),e}}var Rd=Od;class Bd{constructor(e,o,l){this.type=e,this.index=o,this.input=l}static parse(e,o){if(e.length!==3)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,ut),u=o.parse(e[2],2,Ir(o.expectedType||qt));return l&&u?new Bd(u.type.itemType,l,u):null}evaluate(e){const o=this.index.evaluate(e),l=this.input.evaluate(e);if(o<0)throw new Rn(`Array index out of bounds: ${o} < 0.`);if(o>=l.length)throw new Rn(`Array index out of bounds: ${o} > ${l.length-1}.`);if(o!==Math.floor(o))throw new Rn(`Array index must be an integer, but found ${o} instead.`);return l[o]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Uy=Bd;class Fd{constructor(e,o){this.type=Xt,this.needle=e,this.haystack=o}static parse(e,o){if(e.length!==3)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,qt),u=o.parse(e[2],2,qt);return l&&u?ru(l.type,[Xt,ci,ut,xl,qt])?new Fd(l,u):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${en(l.type)} instead`):null}evaluate(e){const o=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(l==null)return!1;if(!_a(o,["boolean","string","number","null"]))throw new Rn(`Expected first argument to be of type boolean, string, number or null, but found ${en(an(o))} instead.`);if(!_a(l,["string","array"]))throw new Rn(`Expected second argument to be of type array or string, but found ${en(an(l))} instead.`);return l.indexOf(o)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var jy=Fd;class Pl{constructor(e,o,l){this.type=ut,this.needle=e,this.haystack=o,this.fromIndex=l}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,qt),u=o.parse(e[2],2,qt);if(!l||!u)return null;if(!ru(l.type,[Xt,ci,ut,xl,qt]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${en(l.type)} instead`);if(e.length===4){const f=o.parse(e[3],3,ut);return f?new Pl(l,u,f):null}return new Pl(l,u)}evaluate(e){const o=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!_a(o,["boolean","string","number","null"]))throw new Rn(`Expected first argument to be of type boolean, string, number or null, but found ${en(an(o))} instead.`);if(!_a(l,["string","array"]))throw new Rn(`Expected second argument to be of type array or string, but found ${en(an(l))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(e);return l.indexOf(o,u)}return l.indexOf(o)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var tm=Pl;class vu{constructor(e,o,l,u,f,m){this.inputType=e,this.type=o,this.input=l,this.cases=u,this.outputs=f,this.otherwise=m}static parse(e,o){if(e.length<5)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return o.error("Expected an even number of arguments.");let l,u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);const f={},m=[];for(let w=2;w<e.length-1;w+=2){let A=e[w];const k=e[w+1];Array.isArray(A)||(A=[A]);const D=o.concat(w);if(A.length===0)return D.error("Expected at least one branch label.");for(const F of A){if(typeof F!="number"&&typeof F!="string")return D.error("Branch labels must be numbers or strings.");if(typeof F=="number"&&Math.abs(F)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof F=="number"&&Math.floor(F)!==F)return D.error("Numeric branch labels must be integer values.");if(l){if(D.checkSubtype(l,an(F)))return null}else l=an(F);if(f[String(F)]!==void 0)return D.error("Branch labels must be unique.");f[String(F)]=m.length}const R=o.parse(k,w,u);if(!R)return null;u=u||R.type,m.push(R)}const y=o.parse(e[1],1,qt);if(!y)return null;const b=o.parse(e[e.length-1],e.length-1,u);return b?y.type.kind!=="value"&&o.concat(1).checkSubtype(l,y.type)?null:new vu(l,u,y,f,m,b):null}evaluate(e){const o=this.input.evaluate(e);return(an(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),l=[],u={};for(const m of o){const y=u[this.cases[m]];y===void 0?(u[this.cases[m]]=l.length,l.push([this.cases[m],[m]])):l[y][1].push(m)}const f=m=>this.inputType.kind==="number"?Number(m):m;for(const[m,y]of l)e.push(y.length===1?f(y[0]):y.map(f)),e.push(this.outputs[m].serialize());return e.push(this.otherwise.serialize()),e}}var Vy=vu;class Nd{constructor(e,o,l){this.type=e,this.branches=o,this.otherwise=l}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return o.error("Expected an odd number of arguments.");let l;o.expectedType&&o.expectedType.kind!=="value"&&(l=o.expectedType);const u=[];for(let m=1;m<e.length-1;m+=2){const y=o.parse(e[m],m,Xt);if(!y)return null;const b=o.parse(e[m+1],m+1,l);if(!b)return null;u.push([y,b]),l=l||b.type}const f=o.parse(e[e.length-1],e.length-1,l);return f?new Nd(l,u,f):null}evaluate(e){for(const[o,l]of this.branches)if(o.evaluate(e))return l.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[o,l]of this.branches)e(o),e(l);e(this.otherwise)}outputDefined(){return this.branches.every(([e,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(o=>{e.push(o.serialize())}),e}}var im=Nd;class Dl{constructor(e,o,l,u){this.type=e,this.input=o,this.beginIndex=l,this.endIndex=u}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,qt),u=o.parse(e[2],2,ut);if(!l||!u)return null;if(!ru(l.type,[Ir(qt),ci,qt]))return o.error(`Expected first argument to be of type array or string, but found ${en(l.type)} instead`);if(e.length===4){const f=o.parse(e[3],3,ut);return f?new Dl(l.type,l,u,f):null}return new Dl(l.type,l,u)}evaluate(e){const o=this.input.evaluate(e),l=this.beginIndex.evaluate(e);if(!_a(o,["string","array"]))throw new Rn(`Expected first argument to be of type array or string, but found ${en(an(o))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(e);return o.slice(l,u)}return o.slice(l)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var nm=Dl;function rm(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function om(r,e,o,l){return l.compare(e,o)===0}function Ea(r,e,o){const l=r!=="=="&&r!=="!=";return class Wk{constructor(f,m,y){this.type=Xt,this.lhs=f,this.rhs=m,this.collator=y,this.hasUntypedArgument=f.type.kind==="value"||m.type.kind==="value"}static parse(f,m){if(f.length!==3&&f.length!==4)return m.error("Expected two or three arguments.");const y=f[0];let b=m.parse(f[1],1,qt);if(!b)return null;if(!rm(y,b.type))return m.concat(1).error(`"${y}" comparisons are not supported for type '${en(b.type)}'.`);let w=m.parse(f[2],2,qt);if(!w)return null;if(!rm(y,w.type))return m.concat(2).error(`"${y}" comparisons are not supported for type '${en(w.type)}'.`);if(b.type.kind!==w.type.kind&&b.type.kind!=="value"&&w.type.kind!=="value")return m.error(`Cannot compare types '${en(b.type)}' and '${en(w.type)}'.`);l&&(b.type.kind==="value"&&w.type.kind!=="value"?b=new Oo(w.type,[b]):b.type.kind!=="value"&&w.type.kind==="value"&&(w=new Oo(b.type,[w])));let A=null;if(f.length===4){if(b.type.kind!=="string"&&w.type.kind!=="string"&&b.type.kind!=="value"&&w.type.kind!=="value")return m.error("Cannot use collator to compare non-string types.");if(A=m.parse(f[3],3,zo),!A)return null}return new Wk(b,w,A)}evaluate(f){const m=this.lhs.evaluate(f),y=this.rhs.evaluate(f);if(l&&this.hasUntypedArgument){const b=an(m),w=an(y);if(b.kind!==w.kind||b.kind!=="string"&&b.kind!=="number")throw new Rn(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${b.kind}, ${w.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const b=an(m),w=an(y);if(b.kind!=="string"||w.kind!=="string")return e(f,m,y)}return this.collator?o(f,m,y,this.collator.evaluate(f)):e(f,m,y)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}serialize(){const f=[r];return this.eachChild(m=>{f.push(m.serialize())}),f}}}const $y=Ea("==",function(r,e,o){return e===o},om),xu=Ea("!=",function(r,e,o){return e!==o},function(r,e,o,l){return!om(0,e,o,l)}),sm=Ea("<",function(r,e,o){return e<o},function(r,e,o,l){return l.compare(e,o)<0}),am=Ea(">",function(r,e,o){return e>o},function(r,e,o,l){return l.compare(e,o)>0}),Gy=Ea("<=",function(r,e,o){return e<=o},function(r,e,o,l){return l.compare(e,o)<=0}),qy=Ea(">=",function(r,e,o){return e>=o},function(r,e,o,l){return l.compare(e,o)>=0});class Ud{constructor(e,o,l,u,f){this.type=ci,this.number=e,this.locale=o,this.currency=l,this.minFractionDigits=u,this.maxFractionDigits=f}static parse(e,o){if(e.length!==3)return o.error("Expected two arguments.");const l=o.parse(e[1],1,ut);if(!l)return null;const u=e[2];if(typeof u!="object"||Array.isArray(u))return o.error("NumberFormat options argument must be an object.");let f=null;if(u.locale&&(f=o.parse(u.locale,1,ci),!f))return null;let m=null;if(u.currency&&(m=o.parse(u.currency,1,ci),!m))return null;let y=null;if(u["min-fraction-digits"]&&(y=o.parse(u["min-fraction-digits"],1,ut),!y))return null;let b=null;return u["max-fraction-digits"]&&(b=o.parse(u["max-fraction-digits"],1,ut),!b)?null:new Ud(l,f,m,y,b)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class bu{constructor(e){this.type=ut,this.input=e}static parse(e,o){if(e.length!==2)return o.error(`Expected 1 argument, but found ${e.length-1} instead.`);const l=o.parse(e[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${en(l.type)} instead.`):new bu(l):null}evaluate(e){const o=this.input.evaluate(e);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Rn(`Expected value to be of type string or array, but found ${en(an(o))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(o=>{e.push(o.serialize())}),e}}const jd={"==":$y,"!=":xu,">":am,"<":sm,">=":qy,"<=":Gy,array:Oo,at:Uy,boolean:Oo,case:im,coalesce:em,collator:zs,format:es,image:au,in:jy,"index-of":tm,interpolate:uo,"interpolate-hcl":uo,"interpolate-lab":uo,length:bu,let:Rd,literal:El,match:Vy,number:Oo,"number-format":Ud,object:Oo,slice:nm,step:pu,string:Oo,"to-boolean":ya,"to-color":ya,"to-number":ya,"to-string":ya,var:Xp,within:cu};function Vd(r,[e,o,l,u]){e=e.evaluate(r),o=o.evaluate(r),l=l.evaluate(r);const f=u?u.evaluate(r):1,m=ou(e,o,l,f);if(m)throw new Rn(m);return new hn(e/255*f,o/255*f,l/255*f,f)}function wu(r,e){return r in e}function $d(r,e){const o=e[r];return o===void 0?null:o}function Rs(r){return{type:r}}Ro.register(jd,{error:[{kind:"error"},[ci],(r,[e])=>{throw new Rn(e.evaluate(r))}],typeof:[ci,[qt],(r,[e])=>en(an(e.evaluate(r)))],"to-rgba":[Ir(ut,4),[Kr],(r,[e])=>e.evaluate(r).toArray()],rgb:[Kr,[ut,ut,ut],Vd],rgba:[Kr,[ut,ut,ut,ut],Vd],has:{type:Xt,overloads:[[[ci],(r,[e])=>wu(e.evaluate(r),r.properties())],[[ci,Ds],(r,[e,o])=>wu(e.evaluate(r),o.evaluate(r))]]},get:{type:qt,overloads:[[[ci],(r,[e])=>$d(e.evaluate(r),r.properties())],[[ci,Ds],(r,[e,o])=>$d(e.evaluate(r),o.evaluate(r))]]},"feature-state":[qt,[ci],(r,[e])=>$d(e.evaluate(r),r.featureState||{})],properties:[Ds,[],r=>r.properties()],"geometry-type":[ci,[],r=>r.geometryType()],id:[qt,[],r=>r.id()],zoom:[ut,[],r=>r.globals.zoom],pitch:[ut,[],r=>r.globals.pitch||0],"distance-from-center":[ut,[],r=>r.distanceFromCenter()],"heatmap-density":[ut,[],r=>r.globals.heatmapDensity||0],"line-progress":[ut,[],r=>r.globals.lineProgress||0],"sky-radial-progress":[ut,[],r=>r.globals.skyRadialProgress||0],accumulated:[qt,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[ut,Rs(ut),(r,e)=>{let o=0;for(const l of e)o+=l.evaluate(r);return o}],"*":[ut,Rs(ut),(r,e)=>{let o=1;for(const l of e)o*=l.evaluate(r);return o}],"-":{type:ut,overloads:[[[ut,ut],(r,[e,o])=>e.evaluate(r)-o.evaluate(r)],[[ut],(r,[e])=>-e.evaluate(r)]]},"/":[ut,[ut,ut],(r,[e,o])=>e.evaluate(r)/o.evaluate(r)],"%":[ut,[ut,ut],(r,[e,o])=>e.evaluate(r)%o.evaluate(r)],ln2:[ut,[],()=>Math.LN2],pi:[ut,[],()=>Math.PI],e:[ut,[],()=>Math.E],"^":[ut,[ut,ut],(r,[e,o])=>Math.pow(e.evaluate(r),o.evaluate(r))],sqrt:[ut,[ut],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[ut,[ut],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[ut,[ut],(r,[e])=>Math.log(e.evaluate(r))],log2:[ut,[ut],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[ut,[ut],(r,[e])=>Math.sin(e.evaluate(r))],cos:[ut,[ut],(r,[e])=>Math.cos(e.evaluate(r))],tan:[ut,[ut],(r,[e])=>Math.tan(e.evaluate(r))],asin:[ut,[ut],(r,[e])=>Math.asin(e.evaluate(r))],acos:[ut,[ut],(r,[e])=>Math.acos(e.evaluate(r))],atan:[ut,[ut],(r,[e])=>Math.atan(e.evaluate(r))],min:[ut,Rs(ut),(r,e)=>Math.min(...e.map(o=>o.evaluate(r)))],max:[ut,Rs(ut),(r,e)=>Math.max(...e.map(o=>o.evaluate(r)))],abs:[ut,[ut],(r,[e])=>Math.abs(e.evaluate(r))],round:[ut,[ut],(r,[e])=>{const o=e.evaluate(r);return o<0?-Math.round(-o):Math.round(o)}],floor:[ut,[ut],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[ut,[ut],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[Xt,[ci,qt],(r,[e,o])=>r.properties()[e.value]===o.value],"filter-id-==":[Xt,[qt],(r,[e])=>r.id()===e.value],"filter-type-==":[Xt,[ci],(r,[e])=>r.geometryType()===e.value],"filter-<":[Xt,[ci,qt],(r,[e,o])=>{const l=r.properties()[e.value],u=o.value;return typeof l==typeof u&&l<u}],"filter-id-<":[Xt,[qt],(r,[e])=>{const o=r.id(),l=e.value;return typeof o==typeof l&&o<l}],"filter->":[Xt,[ci,qt],(r,[e,o])=>{const l=r.properties()[e.value],u=o.value;return typeof l==typeof u&&l>u}],"filter-id->":[Xt,[qt],(r,[e])=>{const o=r.id(),l=e.value;return typeof o==typeof l&&o>l}],"filter-<=":[Xt,[ci,qt],(r,[e,o])=>{const l=r.properties()[e.value],u=o.value;return typeof l==typeof u&&l<=u}],"filter-id-<=":[Xt,[qt],(r,[e])=>{const o=r.id(),l=e.value;return typeof o==typeof l&&o<=l}],"filter->=":[Xt,[ci,qt],(r,[e,o])=>{const l=r.properties()[e.value],u=o.value;return typeof l==typeof u&&l>=u}],"filter-id->=":[Xt,[qt],(r,[e])=>{const o=r.id(),l=e.value;return typeof o==typeof l&&o>=l}],"filter-has":[Xt,[qt],(r,[e])=>e.value in r.properties()],"filter-has-id":[Xt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Xt,[Ir(ci)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[Xt,[Ir(qt)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[Xt,[ci,Ir(qt)],(r,[e,o])=>o.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[Xt,[ci,Ir(qt)],(r,[e,o])=>function(l,u,f,m){for(;f<=m;){const y=f+m>>1;if(u[y]===l)return!0;u[y]>l?m=y-1:f=y+1}return!1}(r.properties()[e.value],o.value,0,o.value.length-1)],all:{type:Xt,overloads:[[[Xt,Xt],(r,[e,o])=>e.evaluate(r)&&o.evaluate(r)],[Rs(Xt),(r,e)=>{for(const o of e)if(!o.evaluate(r))return!1;return!0}]]},any:{type:Xt,overloads:[[[Xt,Xt],(r,[e,o])=>e.evaluate(r)||o.evaluate(r)],[Rs(Xt),(r,e)=>{for(const o of e)if(o.evaluate(r))return!0;return!1}]]},"!":[Xt,[Xt],(r,[e])=>!e.evaluate(r)],"is-supported-script":[Xt,[ci],(r,[e])=>{const o=r.globals&&r.globals.isSupportedScript;return!o||o(e.evaluate(r))}],upcase:[ci,[ci],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[ci,[ci],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[ci,Rs(qt),(r,e)=>e.map(o=>Ls(o.evaluate(r))).join("")],"resolved-locale":[ci,[zo],(r,[e])=>e.evaluate(r).resolvedLocale()]});var Ll=jd;function lm(r){return{result:"success",value:r}}function Ta(r){return{result:"error",value:r}}function Ca(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function Gd(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function Eu(r){return!!r.expression&&r.expression.interpolated}function vi(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function Tu(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function Zy(r){return r}function cm(r,e){const o=e.type==="color",l=r.stops&&typeof r.stops[0][0]=="object",u=l||!(l||r.property!==void 0),f=r.type||(Eu(e)?"exponential":"interval");if(o&&((r=_r({},r)).stops&&(r.stops=r.stops.map(w=>[w[0],hn.parse(w[1])])),r.default=hn.parse(r.default?r.default:e.default)),r.colorSpace&&r.colorSpace!=="rgb"&&!Dd[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let m,y,b;if(f==="exponential")m=hm;else if(f==="interval")m=Sa;else if(f==="categorical"){m=um,y=Object.create(null);for(const w of r.stops)y[w[0]]=w[1];b=typeof r.stops[0][0]}else{if(f!=="identity")throw new Error(`Unknown function type "${f}"`);m=Wy}if(l){const w={},A=[];for(let R=0;R<r.stops.length;R++){const F=r.stops[R],V=F[0].zoom;w[V]===void 0&&(w[V]={zoom:V,type:r.type,property:r.property,default:r.default,stops:[]},A.push(V)),w[V].stops.push([F[0].value,F[1]])}const k=[];for(const R of A)k.push([w[R].zoom,cm(w[R],e)]);const D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:uo.interpolationFactor.bind(void 0,D),zoomStops:k.map(R=>R[0]),evaluate:({zoom:R},F)=>hm({stops:k,base:r.base},e,R).evaluate(R,F)}}if(u){const w=f==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:w,interpolationFactor:uo.interpolationFactor.bind(void 0,w),zoomStops:r.stops.map(A=>A[0]),evaluate:({zoom:A})=>m(r,e,A,y,b)}}return{kind:"source",evaluate(w,A){const k=A&&A.properties?A.properties[r.property]:void 0;return k===void 0?Pr(r.default,e.default):m(r,e,k,y,b)}}}function Pr(r,e,o){return r!==void 0?r:e!==void 0?e:o!==void 0?o:void 0}function um(r,e,o,l,u){return Pr(typeof o===u?l[o]:void 0,r.default,e.default)}function Sa(r,e,o){if(vi(o)!=="number")return Pr(r.default,e.default);const l=r.stops.length;if(l===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[l-1][0])return r.stops[l-1][1];const u=du(r.stops.map(f=>f[0]),o);return r.stops[u][1]}function hm(r,e,o){const l=r.base!==void 0?r.base:1;if(vi(o)!=="number")return Pr(r.default,e.default);const u=r.stops.length;if(u===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[u-1][0])return r.stops[u-1][1];const f=du(r.stops.map(A=>A[0]),o),m=function(A,k,D,R){const F=R-D,V=A-D;return F===0?0:k===1?V/F:(Math.pow(k,V)-1)/(Math.pow(k,F)-1)}(o,l,r.stops[f][0],r.stops[f+1][0]),y=r.stops[f][1],b=r.stops[f+1][1];let w=Al[e.type]||Zy;if(r.colorSpace&&r.colorSpace!=="rgb"){const A=Dd[r.colorSpace];w=(k,D)=>A.reverse(A.interpolate(A.forward(k),A.forward(D),m))}return typeof y.evaluate=="function"?{evaluate(...A){const k=y.evaluate.apply(void 0,A),D=b.evaluate.apply(void 0,A);if(k!==void 0&&D!==void 0)return w(k,D,m)}}:w(y,b,m)}function Wy(r,e,o){return e.type==="color"?o=hn.parse(o):e.type==="formatted"?o=Vn.fromString(o.toString()):e.type==="resolvedImage"?o=kr.fromString(o.toString()):vi(o)===e.type||e.type==="enum"&&e.values[o]||(o=void 0),Pr(o,r.default,e.default)}class Cu{constructor(e,o){this.expression=e,this._warningHistory={},this._evaluator=new Zp,this._defaultValue=o?function(l){return l.type==="color"&&(Tu(l.default)||Array.isArray(l.default))?new hn(0,0,0,0):l.type==="color"?hn.parse(l.default)||null:l.default===void 0?null:l.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(e,o,l,u,f,m,y,b){return this._evaluator.globals=e,this._evaluator.feature=o,this._evaluator.featureState=l,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=b||null,this.expression.evaluate(this._evaluator)}evaluate(e,o,l,u,f,m,y,b){this._evaluator.globals=e,this._evaluator.feature=o||null,this._evaluator.featureState=l||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m||null,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=b||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new Rn(`Expected value to be one of ${Object.keys(this._enumValues).map(A=>JSON.stringify(A)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console!="undefined"&&console.warn(w.message)),this._defaultValue}}}function Su(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Ll}function Bs(r,e){const o=new Kp(Ll,[],e?function(u){const f={color:Kr,string:ci,number:ut,enum:ci,boolean:Xt,formatted:pa,resolvedImage:bl};return u.type==="array"?Ir(f[u.value]||qt,u.length):f[u.type]}(e):void 0),l=o.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?lm(new Cu(l,e)):Ta(o.errors)}class Au{constructor(e,o){this.kind=e,this._styleExpression=o,this.isStateDependent=e!=="constant"&&!ba(o.expression)}evaluateWithoutErrorHandling(e,o,l,u,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,o,l,u,f,m)}evaluate(e,o,l,u,f,m){return this._styleExpression.evaluate(e,o,l,u,f,m)}}class zl{constructor(e,o,l,u){this.kind=e,this.zoomStops=l,this._styleExpression=o,this.isStateDependent=e!=="camera"&&!ba(o.expression),this.interpolationType=u}evaluateWithoutErrorHandling(e,o,l,u,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,o,l,u,f,m)}evaluate(e,o,l,u,f,m){return this._styleExpression.evaluate(e,o,l,u,f,m)}interpolationFactor(e,o,l){return this.interpolationType?uo.interpolationFactor(this.interpolationType,e,o,l):0}}function Iu(r,e){if((r=Bs(r,e)).result==="error")return r;const o=r.value.expression,l=xa(o);if(!l&&!Ca(e))return Ta([new gr("","data expressions not supported")]);const u=uu(o,["zoom","pitch","distance-from-center"]);if(!u&&!Gd(e))return Ta([new gr("","zoom expressions not supported")]);const f=Aa(o);return f||u?f instanceof gr?Ta([f]):f instanceof uo&&!Eu(e)?Ta([new gr("",'"interpolate" expressions cannot be used with this property')]):lm(f?new zl(l?"camera":"composite",r.value,f.labels,f instanceof uo?f.interpolation:void 0):new Au(l?"constant":"source",r.value)):Ta([new gr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ol{constructor(e,o){this._parameters=e,this._specification=o,_r(this,cm(this._parameters,this._specification))}static deserialize(e){return new Ol(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Aa(r){let e=null;if(r instanceof Rd)e=Aa(r.result);else if(r instanceof em){for(const o of r.args)if(e=Aa(o),e)break}else(r instanceof pu||r instanceof uo)&&r.input instanceof Ro&&r.input.name==="zoom"&&(e=r);return e instanceof gr||r.eachChild(o=>{const l=Aa(o);l instanceof gr?e=l:!e&&l?e=new gr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&l&&e!==l&&(e=new gr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class ft{constructor(e,o,l,u){this.message=(e?`${e}: `:"")+l,u&&(this.identifier=u),o!=null&&o.__line__&&(this.line=o.__line__)}}function Dr(r){const e=r.key,o=r.value,l=r.valueSpec||{},u=r.objectElementValidators||{},f=r.style,m=r.styleSpec;let y=[];const b=vi(o);if(b!=="object")return[new ft(e,o,`object expected, ${b} found`)];for(const w in o){const A=w.split(".")[0],k=l[A]||l["*"];let D;u[A]?D=u[A]:l[A]?D=Dn:u["*"]?D=u["*"]:l["*"]&&(D=Dn),D?y=y.concat(D({key:(e&&`${e}.`)+w,value:o[w],valueSpec:k,style:f,styleSpec:m,object:o,objectKey:w},o)):y.push(new ft(e,o[w],`unknown property "${w}"`))}for(const w in l)u[w]||l[w].required&&l[w].default===void 0&&o[w]===void 0&&y.push(new ft(e,o,`missing required property "${w}"`));return y}function Rl(r){const e=r.value,o=r.valueSpec,l=r.style,u=r.styleSpec,f=r.key,m=r.arrayElementValidator||Dn;if(vi(e)!=="array")return[new ft(f,e,`array expected, ${vi(e)} found`)];if(o.length&&e.length!==o.length)return[new ft(f,e,`array length ${o.length} expected, length ${e.length} found`)];if(o["min-length"]&&e.length<o["min-length"])return[new ft(f,e,`array length at least ${o["min-length"]} expected, length ${e.length} found`)];let y={type:o.value,values:o.values,minimum:o.minimum,maximum:o.maximum,function:void 0};u.$version<7&&(y.function=o.function),vi(o.value)==="object"&&(y=o.value);let b=[];for(let w=0;w<e.length;w++)b=b.concat(m({array:e,arrayIndex:w,value:e[w],valueSpec:y,style:l,styleSpec:u,key:`${f}[${w}]`}));return b}function Fs(r){const e=r.key,o=r.value,l=r.valueSpec;let u=vi(o);if(u==="number"&&o!=o&&(u="NaN"),u!=="number")return[new ft(e,o,`number expected, ${u} found`)];if("minimum"in l){let f=l.minimum;if(vi(l.minimum)==="array"&&(f=l.minimum[r.arrayIndex]),o<f)return[new ft(e,o,`${o} is less than the minimum value ${f}`)]}if("maximum"in l){let f=l.maximum;if(vi(l.maximum)==="array"&&(f=l.maximum[r.arrayIndex]),o>f)return[new ft(e,o,`${o} is greater than the maximum value ${f}`)]}return[]}function qd(r){const e=r.valueSpec,o=Qi(r.value.type);let l,u,f,m={};const y=o!=="categorical"&&r.value.property===void 0,b=!y,w=vi(r.value.stops)==="array"&&vi(r.value.stops[0])==="array"&&vi(r.value.stops[0][0])==="object",A=Dr({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(R){if(o==="identity")return[new ft(R.key,R.value,'identity function may not have a "stops" property')];let F=[];const V=R.value;return F=F.concat(Rl({key:R.key,value:V,valueSpec:R.valueSpec,style:R.style,styleSpec:R.styleSpec,arrayElementValidator:k})),vi(V)==="array"&&V.length===0&&F.push(new ft(R.key,V,"array must have at least one stop")),F},default:function(R){return Dn({key:R.key,value:R.value,valueSpec:e,style:R.style,styleSpec:R.styleSpec})}}});return o==="identity"&&y&&A.push(new ft(r.key,r.value,'missing required property "property"')),o==="identity"||r.value.stops||A.push(new ft(r.key,r.value,'missing required property "stops"')),o==="exponential"&&r.valueSpec.expression&&!Eu(r.valueSpec)&&A.push(new ft(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(b&&!Ca(r.valueSpec)?A.push(new ft(r.key,r.value,"property functions not supported")):y&&!Gd(r.valueSpec)&&A.push(new ft(r.key,r.value,"zoom functions not supported"))),o!=="categorical"&&!w||r.value.property!==void 0||A.push(new ft(r.key,r.value,'"property" property is required')),A;function k(R){let F=[];const V=R.value,K=R.key;if(vi(V)!=="array")return[new ft(K,V,`array expected, ${vi(V)} found`)];if(V.length!==2)return[new ft(K,V,`array length 2 expected, length ${V.length} found`)];if(w){if(vi(V[0])!=="object")return[new ft(K,V,`object expected, ${vi(V[0])} found`)];if(V[0].zoom===void 0)return[new ft(K,V,"object stop key must have zoom")];if(V[0].value===void 0)return[new ft(K,V,"object stop key must have value")];const ee=Qi(V[0].zoom);if(typeof ee!="number")return[new ft(K,V[0].zoom,"stop zoom values must be numbers")];if(f&&f>ee)return[new ft(K,V[0].zoom,"stop zoom values must appear in ascending order")];ee!==f&&(f=ee,u=void 0,m={}),F=F.concat(Dr({key:`${K}[0]`,value:V[0],valueSpec:{zoom:{}},style:R.style,styleSpec:R.styleSpec,objectElementValidators:{zoom:Fs,value:D}}))}else F=F.concat(D({key:`${K}[0]`,value:V[0],valueSpec:{},style:R.style,styleSpec:R.styleSpec},V));return Su(Ar(V[1]))?F.concat([new ft(`${K}[1]`,V[1],"expressions are not allowed in function stops.")]):F.concat(Dn({key:`${K}[1]`,value:V[1],valueSpec:e,style:R.style,styleSpec:R.styleSpec}))}function D(R,F){const V=vi(R.value),K=Qi(R.value),ee=R.value!==null?R.value:F;if(l){if(V!==l)return[new ft(R.key,ee,`${V} stop domain type must match previous stop domain type ${l}`)]}else l=V;if(V!=="number"&&V!=="string"&&V!=="boolean"&&typeof K!="number"&&typeof K!="string"&&typeof K!="boolean")return[new ft(R.key,ee,"stop domain value must be a number, string, or boolean")];if(V!=="number"&&o!=="categorical"){let he=`number expected, ${V} found`;return Ca(e)&&o===void 0&&(he+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ft(R.key,ee,he)]}return o!=="categorical"||V!=="number"||typeof K=="number"&&isFinite(K)&&Math.floor(K)===K?o!=="categorical"&&V==="number"&&typeof K=="number"&&typeof u=="number"&&u!==void 0&&K<u?[new ft(R.key,ee,"stop domain values must appear in ascending order")]:(u=K,o==="categorical"&&K in m?[new ft(R.key,ee,"stop domain values must be unique")]:(m[K]=!0,[])):[new ft(R.key,ee,`integer expected, found ${String(K)}`)]}}function Ns(r){const e=(r.expressionContext==="property"?Iu:Bs)(Ar(r.value),r.valueSpec);if(e.result==="error")return e.value.map(l=>new ft(`${r.key}${l.key}`,r.value,l.message));const o=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!o.outputDefined())return[new ft(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!ba(o))return[new ft(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter")return Mu(o,r);if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!uu(o,["zoom","feature-state"]))return[new ft(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!xa(o))return[new ft(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Mu(r,e){const o=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const u of e.valueSpec.expression.parameters)o.delete(u);if(o.size===0)return[];const l=[];return r instanceof Ro&&o.has(r.name)?[new ft(e.key,e.value,`["${r.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(r.eachChild(u=>{l.push(...Mu(u,e))}),l)}function Bl(r){const e=r.key,o=r.value,l=r.valueSpec,u=[];return Array.isArray(l.values)?l.values.indexOf(Qi(o))===-1&&u.push(new ft(e,o,`expected one of [${l.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(l.values).indexOf(Qi(o))===-1&&u.push(new ft(e,o,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(o)} found`)),u}function Zd(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!Zd(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function Us(r,e="fill"){if(r==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Zd(r)||(r=js(r));const o=r;let l=!0;try{l=function(w){if(!Ia(w))return w;let A=Ar(w);return fm(A),A=dm(A),A}(o)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(o,null,2)}
        `)}const u=Ee[`filter_${e}`],f=Bs(l,u);let m=null;if(f.result==="error")throw new Error(f.value.map(w=>`${w.key}: ${w.message}`).join(", "));m=(w,A,k)=>f.value.evaluate(w,A,{},k);let y=null,b=null;if(l!==o){const w=Bs(o,u);if(w.result==="error")throw new Error(w.value.map(A=>`${A.key}: ${A.message}`).join(", "));y=(A,k,D,R,F)=>w.value.evaluate(A,k,{},D,void 0,void 0,R,F),b=!xa(w.value.expression)}return m=m,{filter:m,dynamicFilter:y||void 0,needGeometry:Fl(l),needFeature:!!b}}function dm(r){if(!Array.isArray(r))return r;const e=function(o){if(Hy.has(o[0])){for(let l=1;l<o.length;l++)if(Ia(o[l]))return!0}return o}(r);return e===!0?e:e.map(o=>dm(o))}function fm(r){let e=!1;const o=[];if(r[0]==="case"){for(let l=1;l<r.length-1;l+=2)e=e||Ia(r[l]),o.push(r[l+1]);o.push(r[r.length-1])}else if(r[0]==="match"){e=e||Ia(r[1]);for(let l=2;l<r.length-1;l+=2)o.push(r[l+1]);o.push(r[r.length-1])}else if(r[0]==="step"){e=e||Ia(r[1]);for(let l=1;l<r.length-1;l+=2)o.push(r[l+1])}e&&(r.length=0,r.push("any",...o));for(let l=1;l<r.length;l++)fm(r[l])}function Ia(r){if(!Array.isArray(r))return!1;if((e=r[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let o=1;o<r.length;o++)if(Ia(r[o]))return!0;return!1}const Hy=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Xy(r,e){return r<e?-1:r>e?1:0}function Fl(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let e=1;e<r.length;e++)if(Fl(r[e]))return!0;return!1}function js(r){if(!r)return!0;const e=r[0];return r.length<=1?e!=="any":e==="=="?Kn(r[1],r[2],"=="):e==="!="?ku(Kn(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Kn(r[1],r[2],e):e==="any"?(o=r.slice(1),["any"].concat(o.map(js))):e==="all"?["all"].concat(r.slice(1).map(js)):e==="none"?["all"].concat(r.slice(1).map(js).map(ku)):e==="in"?Nl(r[1],r.slice(2)):e==="!in"?ku(Nl(r[1],r.slice(2))):e==="has"?pm(r[1]):e==="!has"?ku(pm(r[1])):e!=="within"||r;var o}function Kn(r,e,o){switch(r){case"$type":return[`filter-type-${o}`,e];case"$id":return[`filter-id-${o}`,e];default:return[`filter-${o}`,r,e]}}function Nl(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(o=>typeof o!=typeof e[0])?["filter-in-large",r,["literal",e.sort(Xy)]]:["filter-in-small",r,["literal",e]]}}function pm(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function ku(r){return["!",r]}function Wd(r){return Zd(Ar(r.value))?Ns(_r({},r,{expressionContext:"filter",valueSpec:r.styleSpec[`filter_${r.layerType||"fill"}`]})):mm(r)}function mm(r){const e=r.value,o=r.key;if(vi(e)!=="array")return[new ft(o,e,`array expected, ${vi(e)} found`)];const l=r.styleSpec;let u,f=[];if(e.length<1)return[new ft(o,e,"filter array must have at least 1 element")];switch(f=f.concat(Bl({key:`${o}[0]`,value:e[0],valueSpec:l.filter_operator,style:r.style,styleSpec:r.styleSpec})),Qi(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Qi(e[1])==="$type"&&f.push(new ft(o,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&f.push(new ft(o,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=vi(e[1]),u!=="string"&&f.push(new ft(`${o}[1]`,e[1],`string expected, ${u} found`)));for(let m=2;m<e.length;m++)u=vi(e[m]),Qi(e[1])==="$type"?f=f.concat(Bl({key:`${o}[${m}]`,value:e[m],valueSpec:l.geometry_type,style:r.style,styleSpec:r.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&f.push(new ft(`${o}[${m}]`,e[m],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let m=1;m<e.length;m++)f=f.concat(mm({key:`${o}[${m}]`,value:e[m],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":u=vi(e[1]),e.length!==2?f.push(new ft(o,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="string"&&f.push(new ft(`${o}[1]`,e[1],`string expected, ${u} found`));break;case"within":u=vi(e[1]),e.length!==2?f.push(new ft(o,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="object"&&f.push(new ft(`${o}[1]`,e[1],`object expected, ${u} found`))}return f}function Pu(r,e){const o=r.key,l=r.style,u=r.styleSpec,f=r.value,m=r.objectKey,y=u[`${e}_${r.layerType}`];if(!y)return[];const b=m.match(/^(.*)-transition$/);if(e==="paint"&&b&&y[b[1]]&&y[b[1]].transition)return Dn({key:o,value:f,valueSpec:u.transition,style:l,styleSpec:u});const w=r.valueSpec||y[m];if(!w)return[new ft(o,f,`unknown property "${m}"`)];let A;if(vi(f)==="string"&&Ca(w)&&!w.tokens&&(A=/^{([^}]+)}$/.exec(f)))return[new ft(o,f,`"${m}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(A[1])} }\`.`)];const k=[];return r.layerType==="symbol"&&(m==="text-field"&&l&&!l.glyphs&&k.push(new ft(o,f,'use of "text-field" requires a style "glyphs" property')),m==="text-font"&&Tu(Ar(f))&&Qi(f.type)==="identity"&&k.push(new ft(o,f,'"text-font" does not support identity functions'))),k.concat(Dn({key:r.key,value:f,valueSpec:w,style:l,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:m}))}function _m(r){return Pu(r,"paint")}function Du(r){return Pu(r,"layout")}function gm(r){let e=[];const o=r.value,l=r.key,u=r.style,f=r.styleSpec;o.type||o.ref||e.push(new ft(l,o,'either "type" or "ref" is required'));let m=Qi(o.type);const y=Qi(o.ref);if(o.id){const b=Qi(o.id);for(let w=0;w<r.arrayIndex;w++){const A=u.layers[w];Qi(A.id)===b&&e.push(new ft(l,o.id,`duplicate layer id "${o.id}", previously used at line ${A.id.__line__}`))}}if("ref"in o){let b;["type","source","source-layer","filter","layout"].forEach(w=>{w in o&&e.push(new ft(l,o[w],`"${w}" is prohibited for ref layers`))}),u.layers.forEach(w=>{Qi(w.id)===y&&(b=w)}),b?b.ref?e.push(new ft(l,o.ref,"ref cannot reference another ref layer")):m=Qi(b.type):typeof y=="string"&&e.push(new ft(l,o.ref,`ref layer "${y}" not found`))}else if(m!=="background"&&m!=="sky")if(o.source){const b=u.sources&&u.sources[o.source],w=b&&Qi(b.type);b?w==="vector"&&m==="raster"?e.push(new ft(l,o.source,`layer "${o.id}" requires a raster source`)):w==="raster"&&m!=="raster"?e.push(new ft(l,o.source,`layer "${o.id}" requires a vector source`)):w!=="vector"||o["source-layer"]?w==="raster-dem"&&m!=="hillshade"?e.push(new ft(l,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):m!=="line"||!o.paint||!o.paint["line-gradient"]&&!o.paint["line-trim-offset"]||w==="geojson"&&b.lineMetrics||e.push(new ft(l,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new ft(l,o,`layer "${o.id}" must specify a "source-layer"`)):e.push(new ft(l,o.source,`source "${o.source}" not found`))}else e.push(new ft(l,o,'missing required property "source"'));return e=e.concat(Dr({key:l,value:o,valueSpec:f.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Dn({key:`${l}.type`,value:o.type,valueSpec:f.layer.type,style:r.style,styleSpec:r.styleSpec,object:o,objectKey:"type"}),filter:b=>Wd(_r({layerType:m},b)),layout:b=>Dr({layer:o,key:b.key,value:b.value,valueSpec:{},style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":w=>Du(_r({layerType:m},w))}}),paint:b=>Dr({layer:o,key:b.key,value:b.value,valueSpec:{},style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":w=>_m(_r({layerType:m},w))}})}})),e}function Ma(r){const e=r.value,o=r.key,l=vi(e);return l!=="string"?[new ft(o,e,`string expected, ${l} found`)]:[]}const Lu={promoteId:function({key:r,value:e}){if(vi(e)==="string")return Ma({key:r,value:e});{const o=[];for(const l in e)o.push(...Ma({key:`${r}.${l}`,value:e[l]}));return o}}};function ym(r){const e=r.value,o=r.key,l=r.styleSpec,u=r.style;if(!e.type)return[new ft(o,e,'"type" is required')];const f=Qi(e.type);let m;switch(f){case"vector":case"raster":case"raster-dem":return m=Dr({key:o,value:e,valueSpec:l[`source_${f.replace("-","_")}`],style:r.style,styleSpec:l,objectElementValidators:Lu}),m;case"geojson":if(m=Dr({key:o,value:e,valueSpec:l.source_geojson,style:u,styleSpec:l,objectElementValidators:Lu}),e.cluster)for(const y in e.clusterProperties){const[b,w]=e.clusterProperties[y],A=typeof b=="string"?[b,["accumulated"],["get",y]]:b;m.push(...Ns({key:`${o}.${y}.map`,value:w,expressionContext:"cluster-map"})),m.push(...Ns({key:`${o}.${y}.reduce`,value:A,expressionContext:"cluster-reduce"}))}return m;case"video":return Dr({key:o,value:e,valueSpec:l.source_video,style:u,styleSpec:l});case"image":return Dr({key:o,value:e,valueSpec:l.source_image,style:u,styleSpec:l});case"canvas":return[new ft(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Bl({key:`${o}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:u,styleSpec:l})}}function Hd(r){const e=r.value,o=r.styleSpec,l=o.light,u=r.style;let f=[];const m=vi(e);if(e===void 0)return f;if(m!=="object")return f=f.concat([new ft("light",e,`object expected, ${m} found`)]),f;for(const y in e){const b=y.match(/^(.*)-transition$/);f=f.concat(b&&l[b[1]]&&l[b[1]].transition?Dn({key:y,value:e[y],valueSpec:o.transition,style:u,styleSpec:o}):l[y]?Dn({key:y,value:e[y],valueSpec:l[y],style:u,styleSpec:o}):[new ft(y,e[y],`unknown property "${y}"`)])}return f}function Xd(r){const e=r.value,o=r.key,l=r.style,u=r.styleSpec,f=u.terrain;let m=[];const y=vi(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new ft("terrain",e,`object expected, ${y} found`)]),m;for(const b in e){const w=b.match(/^(.*)-transition$/);m=m.concat(w&&f[w[1]]&&f[w[1]].transition?Dn({key:b,value:e[b],valueSpec:u.transition,style:l,styleSpec:u}):f[b]?Dn({key:b,value:e[b],valueSpec:f[b],style:l,styleSpec:u}):[new ft(b,e[b],`unknown property "${b}"`)])}if(e.source){const b=l.sources&&l.sources[e.source],w=b&&Qi(b.type);b?w!=="raster-dem"&&m.push(new ft(o,e.source,`terrain cannot be used with a source of type ${String(w)}, it only be used with a "raster-dem" source type`)):m.push(new ft(o,e.source,`source "${e.source}" not found`))}else m.push(new ft(o,e,'terrain is missing required property "source"'));return m}function vm(r){const e=r.value,o=r.style,l=r.styleSpec,u=l.fog;let f=[];const m=vi(e);if(e===void 0)return f;if(m!=="object")return f=f.concat([new ft("fog",e,`object expected, ${m} found`)]),f;for(const y in e){const b=y.match(/^(.*)-transition$/);f=f.concat(b&&u[b[1]]&&u[b[1]].transition?Dn({key:y,value:e[y],valueSpec:l.transition,style:o,styleSpec:l}):u[y]?Dn({key:y,value:e[y],valueSpec:u[y],style:o,styleSpec:l}):[new ft(y,e[y],`unknown property "${y}"`)])}return f}const zu={"*":()=>[],array:Rl,boolean:function(r){const e=r.value,o=r.key,l=vi(e);return l!=="boolean"?[new ft(o,e,`boolean expected, ${l} found`)]:[]},number:Fs,color:function(r){const e=r.key,o=r.value,l=vi(o);return l!=="string"?[new ft(e,o,`color expected, ${l} found`)]:qp.parseCSSColor(o)===null?[new ft(e,o,`color expected, "${o}" found`)]:[]},enum:Bl,filter:Wd,function:qd,layer:gm,object:Dr,source:ym,light:Hd,terrain:Xd,fog:vm,string:Ma,formatted:function(r){return Ma(r).length===0?[]:Ns(r)},resolvedImage:function(r){return Ma(r).length===0?[]:Ns(r)},projection:function(r){const e=r.value,o=r.styleSpec,l=o.projection,u=r.style;let f=[];const m=vi(e);if(m==="object")for(const y in e)f=f.concat(Dn({key:y,value:e[y],valueSpec:l[y],style:u,styleSpec:o}));else m!=="string"&&(f=f.concat([new ft("projection",e,`object or string expected, ${m} found`)]));return f}};function Dn(r){const e=r.value,o=r.valueSpec,l=r.styleSpec;return o.expression&&Tu(Qi(e))?qd(r):o.expression&&Su(Ar(e))?Ns(r):o.type&&zu[o.type]?zu[o.type](r):Dr(_r({},r,{valueSpec:o.type?l[o.type]:o}))}function xm(r){const e=r.value,o=r.key,l=Ma(r);return l.length||(e.indexOf("{fontstack}")===-1&&l.push(new ft(o,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&l.push(new ft(o,e,'"glyphs" url must include a "{range}" token'))),l}function bm(r,e=Ee){return Jr(Dn({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,objectElementValidators:{glyphs:xm,"*":()=>[]}}))}const wm=r=>Jr(_m(r)),Ky=r=>Jr(Du(r));function Jr(r){return r.slice().sort((e,o)=>e.line&&o.line?e.line-o.line:0)}function Em(r,e){let o=!1;if(e&&e.length)for(const l of e)r.fire(new Zi(new Error(l.message))),o=!0;return o}var ka=ho;function ho(r,e,o){var l=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var u=new Int32Array(this.arrayBuffer);r=u[0],this.d=(e=u[1])+2*(o=u[2]);for(var f=0;f<this.d*this.d;f++){var m=u[3+f],y=u[3+f+1];l.push(m===y?null:u.subarray(m,y))}var b=u[3+l.length+1];this.keys=u.subarray(u[3+l.length],b),this.bboxes=u.subarray(b),this.insert=this._insertReadonly}else{this.d=e+2*o;for(var w=0;w<this.d*this.d;w++)l.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=r,this.padding=o,this.scale=e/r,this.uid=0;var A=o/e*r;this.min=-A,this.max=r+A}ho.prototype.insert=function(r,e,o,l,u){this._forEachCell(e,o,l,u,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(e),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(u)},ho.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ho.prototype._insertCell=function(r,e,o,l,u,f){this.cells[u].push(f)},ho.prototype.query=function(r,e,o,l,u){var f=this.min,m=this.max;if(r<=f&&e<=f&&m<=o&&m<=l&&!u)return Array.prototype.slice.call(this.keys);var y=[];return this._forEachCell(r,e,o,l,this._queryCell,y,{},u),y},ho.prototype._queryCell=function(r,e,o,l,u,f,m,y){var b=this.cells[u];if(b!==null)for(var w=this.keys,A=this.bboxes,k=0;k<b.length;k++){var D=b[k];if(m[D]===void 0){var R=4*D;(y?y(A[R+0],A[R+1],A[R+2],A[R+3]):r<=A[R+2]&&e<=A[R+3]&&o>=A[R+0]&&l>=A[R+1])?(m[D]=!0,f.push(w[D])):m[D]=!1}}},ho.prototype._forEachCell=function(r,e,o,l,u,f,m,y){for(var b=this._convertToCellCoord(r),w=this._convertToCellCoord(e),A=this._convertToCellCoord(o),k=this._convertToCellCoord(l),D=b;D<=A;D++)for(var R=w;R<=k;R++){var F=this.d*R+D;if((!y||y(this._convertFromCellCoord(D),this._convertFromCellCoord(R),this._convertFromCellCoord(D+1),this._convertFromCellCoord(R+1)))&&u.call(this,r,e,o,l,F,f,m,y))return}},ho.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},ho.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},ho.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,e=3+this.cells.length+1+1,o=0,l=0;l<this.cells.length;l++)o+=this.cells[l].length;var u=new Int32Array(e+o+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var f=e,m=0;m<r.length;m++){var y=r[m];u[3+m]=f,u.set(y,f),f+=y.length}return u[3+r.length]=f,u.set(this.keys,f),u[3+r.length+1]=f+=this.keys.length,u.set(this.bboxes,f),f+=this.bboxes.length,u.buffer};const Ou={};function mt(r,e,o={}){Object.defineProperty(r,"_classRegistryKey",{value:e,writeable:!1}),Ou[e]={klass:r,omit:o.omit||[]}}mt(Object,"Object"),ka.serialize=function(r,e){const o=r.toArrayBuffer();return e&&e.push(o),{buffer:o}},ka.deserialize=function(r){return new ka(r.buffer)},Object.defineProperty(ka,"name",{value:"Grid"}),mt(ka,"Grid"),mt(hn,"Color"),mt(Error,"Error"),mt(ge,"AJAXError"),mt(kr,"ResolvedImage"),mt(Ol,"StylePropertyFunction"),mt(Cu,"StyleExpression",{omit:["_evaluator"]}),mt(zl,"ZoomDependentExpression"),mt(Au,"ZoomConstantExpression"),mt(Ro,"CompoundExpression",{omit:["_evaluate"]});for(const r in Ll)Ou[Ll[r]._classRegistryKey]||mt(Ll[r],`Expression${r}`);function Tm(r){return r&&typeof ArrayBuffer!="undefined"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Cm(r){return S.ImageBitmap&&r instanceof S.ImageBitmap}function Ul(r,e){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(Tm(r)||Cm(r))return e&&e.push(r),r;if(ArrayBuffer.isView(r)){const o=r;return e&&e.push(o.buffer),o}if(r instanceof S.ImageData)return e&&e.push(r.data.buffer),r;if(Array.isArray(r)){const o=[];for(const l of r)o.push(Ul(l,e));return o}if(typeof r=="object"){const o=r.constructor,l=o._classRegistryKey;if(!l)throw new Error(`can't serialize object of unregistered class ${l}`);const u=o.serialize?o.serialize(r,e):{};if(!o.serialize){for(const f in r)r.hasOwnProperty(f)&&(Ou[l].omit.indexOf(f)>=0||(u[f]=Ul(r[f],e)));r instanceof Error&&(u.message=r.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(u.$name=l),u}throw new Error("can't serialize object of type "+typeof r)}function jl(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||Tm(r)||Cm(r)||ArrayBuffer.isView(r)||r instanceof S.ImageData)return r;if(Array.isArray(r))return r.map(jl);if(typeof r=="object"){const e=r.$name||"Object",{klass:o}=Ou[e];if(!o)throw new Error(`can't deserialize unregistered class ${e}`);if(o.deserialize)return o.deserialize(r);const l=Object.create(o.prototype);for(const u of Object.keys(r))u!=="$name"&&(l[u]=jl(r[u]));return l}throw new Error("can't deserialize object of type "+typeof r)}class Sm{constructor(){this.first=!0}update(e,o){const l=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=o),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=l,!0))}}const Am=r=>r>=1536&&r<=1791,Im=r=>r>=1872&&r<=1919,Vl=r=>r>=2208&&r<=2303,Mm=r=>r>=11904&&r<=12031,km=r=>r>=12032&&r<=12255,$l=r=>r>=12272&&r<=12287,Ru=r=>r>=12288&&r<=12351,Bu=r=>r>=12352&&r<=12447,Fu=r=>r>=12448&&r<=12543,Kd=r=>r>=12544&&r<=12591,Yd=r=>r>=12704&&r<=12735,Jd=r=>r>=12736&&r<=12783,Qd=r=>r>=12784&&r<=12799,Nu=r=>r>=12800&&r<=13055,Uu=r=>r>=13056&&r<=13311,Pm=r=>r>=13312&&r<=19903,ef=r=>r>=19968&&r<=40959,Dm=r=>r>=40960&&r<=42127,ju=r=>r>=42128&&r<=42191,Lm=r=>r>=44032&&r<=55215,zm=r=>r>=63744&&r<=64255,tf=r=>r>=64336&&r<=65023,Om=r=>r>=65040&&r<=65055,Vs=r=>r>=65072&&r<=65103,Rm=r=>r>=65104&&r<=65135,nf=r=>r>=65136&&r<=65279,Vu=r=>r>=65280&&r<=65519;function Pa(r){for(const e of r)if(c(e.charCodeAt(0)))return!0;return!1}function d(r){for(const e of r)if(!n(e.charCodeAt(0)))return!1;return!0}function n(r){return!(Am(r)||Im(r)||Vl(r)||tf(r)||nf(r))}function c(r){return!(r!==746&&r!==747&&(r<4352||!(Yd(r)||Kd(r)||Vs(r)&&!(r>=65097&&r<=65103)||zm(r)||Uu(r)||Mm(r)||Jd(r)||!(!Ru(r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||Pm(r)||ef(r)||Nu(r)||(e=>e>=12592&&e<=12687)(r)||(e=>e>=43360&&e<=43391)(r)||(e=>e>=55216&&e<=55295)(r)||(e=>e>=4352&&e<=4607)(r)||Lm(r)||Bu(r)||$l(r)||(e=>e>=12688&&e<=12703)(r)||km(r)||Qd(r)||Fu(r)&&r!==12540||!(!Vu(r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!Rm(r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||(e=>e>=5120&&e<=5759)(r)||(e=>e>=6320&&e<=6399)(r)||Om(r)||(e=>e>=19904&&e<=19967)(r)||Dm(r)||ju(r))))}function p(r){return!(c(r)||function(e){return!!((o=>o>=128&&o<=255)(e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||(o=>o>=8192&&o<=8303)(e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||(o=>o>=8448&&o<=8527)(e)||(o=>o>=8528&&o<=8591)(e)||(o=>o>=8960&&o<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||(o=>o>=9216&&o<=9279)(e)&&e!==9251||(o=>o>=9280&&o<=9311)(e)||(o=>o>=9312&&o<=9471)(e)||(o=>o>=9632&&o<=9727)(e)||(o=>o>=9728&&o<=9983)(e)&&!(e>=9754&&e<=9759)||(o=>o>=11008&&o<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ru(e)||Fu(e)||(o=>o>=57344&&o<=63743)(e)||Vs(e)||Rm(e)||Vu(e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(r))}function g(r){return r>=1424&&r<=2303||tf(r)||nf(r)}function v(r,e){return!(!e&&g(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||(o=>o>=6016&&o<=6143)(r))}function T(r){for(const e of r)if(g(e.charCodeAt(0)))return!0;return!1}const C="deferred",I="loading",L="loaded";let B=null,N="unavailable",$=null;const Z=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(N="error"),B&&B(r)};function H(){G.fire(new Ei("pluginStateChange",{pluginStatus:N,pluginURL:$}))}const G=new Mi,ie=function(){return N},X=function(){if(N!==C||!$)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");N=I,H(),$&&ve({url:$},r=>{r?Z(r):(N=L,H())})},Q={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>N===L||Q.applyArabicShaping!=null,isLoading:()=>N===I,setState(r){N=r.pluginStatus,$=r.pluginURL},isParsed:()=>Q.applyArabicShaping!=null&&Q.processBidirectionalText!=null&&Q.processStyledBidirectionalText!=null,getPluginURL:()=>$};class W{constructor(e,o){this.zoom=e,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition,this.pitch=o.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Sm,this.transition={},this.pitch=0)}isSupportedScript(e){return function(o,l){for(const u of o)if(!v(u.charCodeAt(0),l))return!1;return!0}(e,Q.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,o=e-Math.floor(e),l=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*o}}}class le{constructor(e,o){this.property=e,this.value=o,this.expression=function(l,u){if(Tu(l))return new Ol(l,u);if(Su(l)){const f=Iu(l,u);if(f.result==="error")throw new Error(f.value.map(m=>`${m.key}: ${m.message}`).join(", "));return f.value}{let f=l;return typeof l=="string"&&u.type==="color"&&(f=hn.parse(l)),{kind:"constant",evaluate:()=>f}}}(o===void 0?e.specification.default:o,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,o,l){return this.property.possiblyEvaluate(this,e,o,l)}}class te{constructor(e){this.property=e,this.value=new le(e,void 0)}transitioned(e,o){return new _e(this.property,this.value,o,Ft({},e.transition,this.transition),e.now)}untransitioned(){return new _e(this.property,this.value,null,{},0)}}class ne{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return sn(this._values[e].value.value)}setValue(e,o){this._values.hasOwnProperty(e)||(this._values[e]=new te(this._values[e].property)),this._values[e].value=new le(this._values[e].property,o===null?void 0:sn(o))}getTransition(e){return sn(this._values[e].transition)}setTransition(e,o){this._values.hasOwnProperty(e)||(this._values[e]=new te(this._values[e].property)),this._values[e].transition=sn(o)||void 0}serialize(){const e={};for(const o of Object.keys(this._values)){const l=this.getValue(o);l!==void 0&&(e[o]=l);const u=this.getTransition(o);u!==void 0&&(e[`${o}-transition`]=u)}return e}transitioned(e,o){const l=new Me(this._properties);for(const u of Object.keys(this._values))l._values[u]=this._values[u].transitioned(e,o._values[u]);return l}untransitioned(){const e=new Me(this._properties);for(const o of Object.keys(this._values))e._values[o]=this._values[o].untransitioned();return e}}class _e{constructor(e,o,l,u,f){const m=u.delay||0,y=u.duration||0;f=f||0,this.property=e,this.value=o,this.begin=f+m,this.end=this.begin+y,e.specification.transition&&(u.delay||u.duration)&&(this.prior=l)}possiblyEvaluate(e,o,l){const u=e.now||0,f=this.value.possiblyEvaluate(e,o,l),m=this.prior;if(m){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return m.possiblyEvaluate(e,o,l);{const y=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,o,l),f,xe(y))}}return f}}class Me{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,o,l){const u=new Je(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,o,l);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class De{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return sn(this._values[e].value)}setValue(e,o){this._values[e]=new le(this._values[e].property,o===null?void 0:sn(o))}serialize(){const e={};for(const o of Object.keys(this._values)){const l=this.getValue(o);l!==void 0&&(e[o]=l)}return e}possiblyEvaluate(e,o,l){const u=new Je(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,o,l);return u}}class Ie{constructor(e,o,l){this.property=e,this.value=o,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,o,l,u){return this.property.evaluate(this.value,this.parameters,e,o,l,u)}}class Je{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class ae{constructor(e){this.specification=e}possiblyEvaluate(e,o){return e.expression.evaluate(o)}interpolate(e,o,l){const u=Al[this.specification.type];return u?u(e,o,l):e}}class Ce{constructor(e,o){this.specification=e,this.overrides=o}possiblyEvaluate(e,o,l,u){return new Ie(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(o,null,{},l,u)}:e.expression,o)}interpolate(e,o,l){if(e.value.kind!=="constant"||o.value.kind!=="constant")return e;if(e.value.value===void 0||o.value.value===void 0)return new Ie(this,{kind:"constant",value:void 0},e.parameters);const u=Al[this.specification.type];return u?new Ie(this,{kind:"constant",value:u(e.value.value,o.value.value,l)},e.parameters):e}evaluate(e,o,l,u,f,m){return e.kind==="constant"?e.value:e.evaluate(o,l,u,f,m)}}class Re extends Ce{possiblyEvaluate(e,o,l,u){if(e.value===void 0)return new Ie(this,{kind:"constant",value:void 0},o);if(e.expression.kind==="constant"){const f=e.expression.evaluate(o,null,{},l,u),m=e.property.specification.type==="resolvedImage"&&typeof f!="string"?f.name:f,y=this._calculate(m,m,m,o);return new Ie(this,{kind:"constant",value:y},o)}if(e.expression.kind==="camera"){const f=this._calculate(e.expression.evaluate({zoom:o.zoom-1}),e.expression.evaluate({zoom:o.zoom}),e.expression.evaluate({zoom:o.zoom+1}),o);return new Ie(this,{kind:"constant",value:f},o)}return new Ie(this,e.expression,o)}evaluate(e,o,l,u,f,m){if(e.kind==="source"){const y=e.evaluate(o,l,u,f,m);return this._calculate(y,y,y,o)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(o.zoom)-1},l,u),e.evaluate({zoom:Math.floor(o.zoom)},l,u),e.evaluate({zoom:Math.floor(o.zoom)+1},l,u),o):e.value}_calculate(e,o,l,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:o,other:l}:{from:l,to:o,other:e}}interpolate(e){return e}}class ot{constructor(e){this.specification=e}possiblyEvaluate(e,o,l,u){if(e.value!==void 0){if(e.expression.kind==="constant"){const f=e.expression.evaluate(o,null,{},l,u);return this._calculate(f,f,f,o)}return this._calculate(e.expression.evaluate(new W(Math.floor(o.zoom-1),o)),e.expression.evaluate(new W(Math.floor(o.zoom),o)),e.expression.evaluate(new W(Math.floor(o.zoom+1),o)),o)}}_calculate(e,o,l,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:o}:{from:l,to:o}}interpolate(e){return e}}class Oe{constructor(e){this.specification=e}possiblyEvaluate(e,o,l,u){return!!e.expression.evaluate(o,null,{},l,u)}interpolate(){return!1}}class gt{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new W(0,{});for(const l in e){const u=e[l];u.specification.overridable&&this.overridableProperties.push(l);const f=this.defaultPropertyValues[l]=new le(u,void 0),m=this.defaultTransitionablePropertyValues[l]=new te(u);this.defaultTransitioningPropertyValues[l]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=f.possiblyEvaluate(o)}}}function tt(r,e){return 256*(r=Ge(Math.floor(r),0,255))+Ge(Math.floor(e),0,255)}mt(Ce,"DataDrivenProperty"),mt(ae,"DataConstantProperty"),mt(Re,"CrossFadedDataDrivenProperty"),mt(ot,"CrossFadedProperty"),mt(Oe,"ColorRampProperty");const st={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class at{constructor(e,o){this._structArray=e,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class nt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,o){return e._trim(),o&&(e.isTransferred=!0,o.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const o=Object.create(this.prototype);return o.arrayBuffer=e.arrayBuffer,o.length=e.length,o.capacity=e.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function _t(r,e=1){let o=0,l=0;return{members:r.map(u=>{const f=st[u.type].BYTES_PER_ELEMENT,m=o=Bt(o,Math.max(e,f)),y=u.components||1;return l=Math.max(l,f),o+=f*y,{name:u.name,type:u.type,components:y,offset:m}}),size:Bt(o,Math.max(l,e)),alignment:e}}function Bt(r,e){return Math.ceil(r/e)*e}class $t extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,o)}emplace(e,o,l){const u=2*e;return this.int16[u+0]=o,this.int16[u+1]=l,e}}$t.prototype.bytesPerElement=4,mt($t,"StructArrayLayout2i4");class Ct extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,o,l)}emplace(e,o,l,u){const f=3*e;return this.int16[f+0]=o,this.int16[f+1]=l,this.int16[f+2]=u,e}}Ct.prototype.bytesPerElement=6,mt(Ct,"StructArrayLayout3i6");class Ut extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,l,u)}emplace(e,o,l,u,f){const m=4*e;return this.int16[m+0]=o,this.int16[m+1]=l,this.int16[m+2]=u,this.int16[m+3]=f,e}}Ut.prototype.bytesPerElement=8,mt(Ut,"StructArrayLayout4i8");class ki extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,u,f,m,y){const b=this.length;return this.resize(b+1),this.emplace(b,e,o,l,u,f,m,y)}emplace(e,o,l,u,f,m,y,b){const w=6*e,A=12*e,k=3*e;return this.int16[w+0]=o,this.int16[w+1]=l,this.uint8[A+4]=u,this.uint8[A+5]=f,this.uint8[A+6]=m,this.uint8[A+7]=y,this.float32[k+2]=b,e}}ki.prototype.bytesPerElement=12,mt(ki,"StructArrayLayout2i4ub1f12");class Ui extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,l,u)}emplace(e,o,l,u,f){const m=4*e;return this.float32[m+0]=o,this.float32[m+1]=l,this.float32[m+2]=u,this.float32[m+3]=f,e}}Ui.prototype.bytesPerElement=16,mt(Ui,"StructArrayLayout4f16");class Ki extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,u,f,m,y,b,w,A){const k=this.length;return this.resize(k+1),this.emplace(k,e,o,l,u,f,m,y,b,w,A)}emplace(e,o,l,u,f,m,y,b,w,A,k){const D=10*e;return this.uint16[D+0]=o,this.uint16[D+1]=l,this.uint16[D+2]=u,this.uint16[D+3]=f,this.uint16[D+4]=m,this.uint16[D+5]=y,this.uint16[D+6]=b,this.uint16[D+7]=w,this.uint16[D+8]=A,this.uint16[D+9]=k,e}}Ki.prototype.bytesPerElement=20,mt(Ki,"StructArrayLayout10ui20");class zi extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,u,f,m,y,b){const w=this.length;return this.resize(w+1),this.emplace(w,e,o,l,u,f,m,y,b)}emplace(e,o,l,u,f,m,y,b,w){const A=8*e;return this.uint16[A+0]=o,this.uint16[A+1]=l,this.uint16[A+2]=u,this.uint16[A+3]=f,this.uint16[A+4]=m,this.uint16[A+5]=y,this.uint16[A+6]=b,this.uint16[A+7]=w,e}}zi.prototype.bytesPerElement=16,mt(zi,"StructArrayLayout8ui16");class or extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,u,f,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,o,l,u,f,m)}emplace(e,o,l,u,f,m,y){const b=6*e;return this.int16[b+0]=o,this.int16[b+1]=l,this.int16[b+2]=u,this.int16[b+3]=f,this.int16[b+4]=m,this.int16[b+5]=y,e}}or.prototype.bytesPerElement=12,mt(or,"StructArrayLayout6i12");class fo extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,u,f,m,y,b,w,A,k,D){const R=this.length;return this.resize(R+1),this.emplace(R,e,o,l,u,f,m,y,b,w,A,k,D)}emplace(e,o,l,u,f,m,y,b,w,A,k,D,R){const F=12*e;return this.int16[F+0]=o,this.int16[F+1]=l,this.int16[F+2]=u,this.int16[F+3]=f,this.uint16[F+4]=m,this.uint16[F+5]=y,this.uint16[F+6]=b,this.uint16[F+7]=w,this.int16[F+8]=A,this.int16[F+9]=k,this.int16[F+10]=D,this.int16[F+11]=R,e}}fo.prototype.bytesPerElement=24,mt(fo,"StructArrayLayout4i4ui4i24");class Fo extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,u,f,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,o,l,u,f,m)}emplace(e,o,l,u,f,m,y){const b=10*e,w=5*e;return this.int16[b+0]=o,this.int16[b+1]=l,this.int16[b+2]=u,this.float32[w+2]=f,this.float32[w+3]=m,this.float32[w+4]=y,e}}Fo.prototype.bytesPerElement=20,mt(Fo,"StructArrayLayout3i3f20");class Hi extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint32[1*e+0]=o,e}}Hi.prototype.bytesPerElement=4,mt(Hi,"StructArrayLayout1ul4");class tn extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,u,f,m,y,b,w,A,k,D,R){const F=this.length;return this.resize(F+1),this.emplace(F,e,o,l,u,f,m,y,b,w,A,k,D,R)}emplace(e,o,l,u,f,m,y,b,w,A,k,D,R,F){const V=20*e,K=10*e;return this.int16[V+0]=o,this.int16[V+1]=l,this.int16[V+2]=u,this.int16[V+3]=f,this.int16[V+4]=m,this.float32[K+3]=y,this.float32[K+4]=b,this.float32[K+5]=w,this.float32[K+6]=A,this.int16[V+14]=k,this.uint32[K+8]=D,this.uint16[V+18]=R,this.uint16[V+19]=F,e}}tn.prototype.bytesPerElement=40,mt(tn,"StructArrayLayout5i4f1i1ul2ui40");class Ci extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,u,f,m,y){const b=this.length;return this.resize(b+1),this.emplace(b,e,o,l,u,f,m,y)}emplace(e,o,l,u,f,m,y,b){const w=8*e;return this.int16[w+0]=o,this.int16[w+1]=l,this.int16[w+2]=u,this.int16[w+4]=f,this.int16[w+5]=m,this.int16[w+6]=y,this.int16[w+7]=b,e}}Ci.prototype.bytesPerElement=16,mt(Ci,"StructArrayLayout3i2i2i16");class vn extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,u,f){const m=this.length;return this.resize(m+1),this.emplace(m,e,o,l,u,f)}emplace(e,o,l,u,f,m){const y=4*e,b=8*e;return this.float32[y+0]=o,this.float32[y+1]=l,this.float32[y+2]=u,this.int16[b+6]=f,this.int16[b+7]=m,e}}vn.prototype.bytesPerElement=16,mt(vn,"StructArrayLayout2f1f2i16");class $n extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,l,u)}emplace(e,o,l,u,f){const m=12*e,y=3*e;return this.uint8[m+0]=o,this.uint8[m+1]=l,this.float32[y+1]=u,this.float32[y+2]=f,e}}$n.prototype.bytesPerElement=12,mt($n,"StructArrayLayout2ub2f12");class ji extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,o,l)}emplace(e,o,l,u){const f=3*e;return this.float32[f+0]=o,this.float32[f+1]=l,this.float32[f+2]=u,e}}ji.prototype.bytesPerElement=12,mt(ji,"StructArrayLayout3f12");class ln extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,o,l)}emplace(e,o,l,u){const f=3*e;return this.uint16[f+0]=o,this.uint16[f+1]=l,this.uint16[f+2]=u,e}}ln.prototype.bytesPerElement=6,mt(ln,"StructArrayLayout3ui6");class $s extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,o,l,u,f,m,y,b,w,A,k,D,R,F,V,K,ee,he,ce,pe,ye){const be=this.length;return this.resize(be+1),this.emplace(be,e,o,l,u,f,m,y,b,w,A,k,D,R,F,V,K,ee,he,ce,pe,ye)}emplace(e,o,l,u,f,m,y,b,w,A,k,D,R,F,V,K,ee,he,ce,pe,ye,be){const ke=30*e,Pe=15*e,Fe=60*e;return this.int16[ke+0]=o,this.int16[ke+1]=l,this.int16[ke+2]=u,this.float32[Pe+2]=f,this.float32[Pe+3]=m,this.uint16[ke+8]=y,this.uint16[ke+9]=b,this.uint32[Pe+5]=w,this.uint32[Pe+6]=A,this.uint32[Pe+7]=k,this.uint16[ke+16]=D,this.uint16[ke+17]=R,this.uint16[ke+18]=F,this.float32[Pe+10]=V,this.float32[Pe+11]=K,this.uint8[Fe+48]=ee,this.uint8[Fe+49]=he,this.uint8[Fe+50]=ce,this.uint32[Pe+13]=pe,this.int16[ke+28]=ye,this.uint8[Fe+58]=be,e}}$s.prototype.bytesPerElement=60,mt($s,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class po extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,o,l,u,f,m,y,b,w,A,k,D,R,F,V,K,ee,he,ce,pe,ye,be,ke,Pe,Fe,Xe,Ae,ze,Ke,Ye){const ht=this.length;return this.resize(ht+1),this.emplace(ht,e,o,l,u,f,m,y,b,w,A,k,D,R,F,V,K,ee,he,ce,pe,ye,be,ke,Pe,Fe,Xe,Ae,ze,Ke,Ye)}emplace(e,o,l,u,f,m,y,b,w,A,k,D,R,F,V,K,ee,he,ce,pe,ye,be,ke,Pe,Fe,Xe,Ae,ze,Ke,Ye,ht){const qe=38*e,lt=19*e;return this.int16[qe+0]=o,this.int16[qe+1]=l,this.int16[qe+2]=u,this.float32[lt+2]=f,this.float32[lt+3]=m,this.int16[qe+8]=y,this.int16[qe+9]=b,this.int16[qe+10]=w,this.int16[qe+11]=A,this.int16[qe+12]=k,this.int16[qe+13]=D,this.uint16[qe+14]=R,this.uint16[qe+15]=F,this.uint16[qe+16]=V,this.uint16[qe+17]=K,this.uint16[qe+18]=ee,this.uint16[qe+19]=he,this.uint16[qe+20]=ce,this.uint16[qe+21]=pe,this.uint16[qe+22]=ye,this.uint16[qe+23]=be,this.uint16[qe+24]=ke,this.uint16[qe+25]=Pe,this.uint16[qe+26]=Fe,this.uint16[qe+27]=Xe,this.uint16[qe+28]=Ae,this.uint32[lt+15]=ze,this.float32[lt+16]=Ke,this.float32[lt+17]=Ye,this.float32[lt+18]=ht,e}}po.prototype.bytesPerElement=76,mt(po,"StructArrayLayout3i2f6i15ui1ul3f76");class Da extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.float32[1*e+0]=o,e}}Da.prototype.bytesPerElement=4,mt(Da,"StructArrayLayout1f4");class Gs extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,u,f,m,y){const b=this.length;return this.resize(b+1),this.emplace(b,e,o,l,u,f,m,y)}emplace(e,o,l,u,f,m,y,b){const w=7*e;return this.float32[w+0]=o,this.float32[w+1]=l,this.float32[w+2]=u,this.float32[w+3]=f,this.float32[w+4]=m,this.float32[w+5]=y,this.float32[w+6]=b,e}}Gs.prototype.bytesPerElement=28,mt(Gs,"StructArrayLayout7f28");class is extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,u,f){const m=this.length;return this.resize(m+1),this.emplace(m,e,o,l,u,f)}emplace(e,o,l,u,f,m){const y=5*e;return this.float32[y+0]=o,this.float32[y+1]=l,this.float32[y+2]=u,this.float32[y+3]=f,this.float32[y+4]=m,e}}is.prototype.bytesPerElement=20,mt(is,"StructArrayLayout5f20");class Gn extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,l,u)}emplace(e,o,l,u,f){const m=6*e;return this.uint32[3*e+0]=o,this.uint16[m+2]=l,this.uint16[m+3]=u,this.uint16[m+4]=f,e}}Gn.prototype.bytesPerElement=12,mt(Gn,"StructArrayLayout1ul3ui12");class yr extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,o)}emplace(e,o,l){const u=2*e;return this.uint16[u+0]=o,this.uint16[u+1]=l,e}}yr.prototype.bytesPerElement=4,mt(yr,"StructArrayLayout2ui4");class mo extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint16[1*e+0]=o,e}}mo.prototype.bytesPerElement=2,mt(mo,"StructArrayLayout1ui2");class qs extends nt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,o)}emplace(e,o,l){const u=2*e;return this.float32[u+0]=o,this.float32[u+1]=l,e}}qs.prototype.bytesPerElement=8,mt(qs,"StructArrayLayout2f8");class D1 extends at{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}D1.prototype.size=12;class L1 extends or{get(e){return new D1(this,e)}}mt(L1,"FillExtrusionExtArray");class z1 extends at{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}z1.prototype.size=40;class Yy extends tn{get(e){return new z1(this,e)}}mt(Yy,"CollisionBoxArray");class O1 extends at{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}O1.prototype.size=60;class R1 extends $s{get(e){return new O1(this,e)}}mt(R1,"PlacedSymbolArray");class B1 extends at{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}B1.prototype.size=76;class F1 extends po{get(e){return new B1(this,e)}}mt(F1,"SymbolInstanceArray");class N1 extends Da{getoffsetX(e){return this.float32[1*e+0]}}mt(N1,"GlyphOffsetArray");class U1 extends Ct{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}mt(U1,"SymbolLineVertexArray");class j1 extends at{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}j1.prototype.size=12;class V1 extends Gn{get(e){return new j1(this,e)}}mt(V1,"FeatureIndexArray");class $1 extends at{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}$1.prototype.size=4;class G1 extends yr{get(e){return new $1(this,e)}}mt(G1,"FillExtrusionCentroidArray");class q1 extends at{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}q1.prototype.size=12;class Z1 extends or{get(e){return new q1(this,e)}}mt(Z1,"CircleGlobeExtArray");const Hk=_t([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),Xk=_t([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var W1=ga(function(r){r.exports=function(e,o){var l,u,f,m,y,b,w,A;for(u=e.length-(l=3&e.length),f=o,y=3432918353,b=461845907,A=0;A<u;)w=255&e.charCodeAt(A)|(255&e.charCodeAt(++A))<<8|(255&e.charCodeAt(++A))<<16|(255&e.charCodeAt(++A))<<24,++A,f=27492+(65535&(m=5*(65535&(f=(f^=w=(65535&(w=(w=(65535&w)*y+(((w>>>16)*y&65535)<<16)&4294967295)<<15|w>>>17))*b+(((w>>>16)*b&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(w=0,l){case 3:w^=(255&e.charCodeAt(A+2))<<16;case 2:w^=(255&e.charCodeAt(A+1))<<8;case 1:f^=w=(65535&(w=(w=(65535&(w^=255&e.charCodeAt(A)))*y+(((w>>>16)*y&65535)<<16)&4294967295)<<15|w>>>17))*b+(((w>>>16)*b&65535)<<16)&4294967295}return f^=e.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0}}),Kk=ga(function(r){r.exports=function(e,o){for(var l,u=e.length,f=o^u,m=0;u>=4;)l=1540483477*(65535&(l=255&e.charCodeAt(m)|(255&e.charCodeAt(++m))<<8|(255&e.charCodeAt(++m))<<16|(255&e.charCodeAt(++m))<<24))+((1540483477*(l>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),u-=4,++m;switch(u){case 3:f^=(255&e.charCodeAt(m+2))<<16;case 2:f^=(255&e.charCodeAt(m+1))<<8;case 1:f=1540483477*(65535&(f^=255&e.charCodeAt(m)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0}}),rf=W1,Yk=Kk;rf.murmur3=W1,rf.murmur2=Yk;class Bm{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,o,l,u){this.ids.push(H1(e)),this.positions.push(o,l,u)}getPositions(e){const o=H1(e);let l=0,u=this.ids.length-1;for(;l<u;){const m=l+u>>1;this.ids[m]>=o?u=m:l=m+1}const f=[];for(;this.ids[l]===o;)f.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return f}static serialize(e,o){const l=new Float64Array(e.ids),u=new Uint32Array(e.positions);return Jy(l,u,0,l.length-1),o&&o.push(l.buffer,u.buffer),{ids:l,positions:u}}static deserialize(e){const o=new Bm;return o.ids=e.ids,o.positions=e.positions,o.indexed=!0,o}}function H1(r){const e=+r;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:rf(String(r))}function Jy(r,e,o,l){for(;o<l;){const u=r[o+l>>1];let f=o-1,m=l+1;for(;;){do f++;while(r[f]<u);do m--;while(r[m]>u);if(f>=m)break;Fm(r,f,m),Fm(e,3*f,3*m),Fm(e,3*f+1,3*m+1),Fm(e,3*f+2,3*m+2)}m-o<l-m?(Jy(r,e,o,m),o=m+1):(Jy(r,e,m+1,l),l=m)}}function Fm(r,e,o){const l=r[e];r[e]=r[o],r[o]=l}mt(Bm,"FeaturePositionMap");class Zs{constructor(e,o){this.gl=e.gl,this.location=o}}class Nm extends Zs{constructor(e,o){super(e,o),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class X1 extends Zs{constructor(e,o){super(e,o),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class K1 extends Zs{constructor(e,o){super(e,o),this.current=hn.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Jk=new Float32Array(16),Qk=new Float32Array(9),eP=new Float32Array(4);function Qy(r){return[tt(255*r.r,255*r.g),tt(255*r.b,255*r.a)]}class of{constructor(e,o,l){this.value=e,this.uniformNames=o.map(u=>`u_${u}`),this.type=l}setUniform(e,o,l){e.set(l.constantOr(this.value))}getBinding(e,o,l){return this.type==="color"?new K1(e,o):new Nm(e,o)}}class $u{constructor(e,o){this.uniformNames=o.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,o){this.pixelRatioFrom=o.pixelRatio||1,this.pixelRatioTo=e.pixelRatio||1,this.patternFrom=o.tl.concat(o.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,o,l,u){const f=u==="u_pattern_to"||u==="u_dash_to"?this.patternTo:u==="u_pattern_from"||u==="u_dash_from"?this.patternFrom:u==="u_pixel_ratio_to"?this.pixelRatioTo:u==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)}getBinding(e,o,l){return l==="u_pattern_from"||l==="u_pattern_to"||l==="u_dash_from"||l==="u_dash_to"?new X1(e,o):new Nm(e,o)}}class Ws{constructor(e,o,l,u){this.expression=e,this.type=l,this.maxValue=0,this.paintVertexAttributes=o.map(f=>({name:`a_${f}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,o,l,u,f,m){const y=this.paintVertexArray.length,b=this.expression.evaluate(new W(0),o,{},f,u,m);this.paintVertexArray.resize(e),this._setPaintValue(y,e,b)}updatePaintArray(e,o,l,u,f){const m=this.expression.evaluate({zoom:0},l,u,void 0,f);this._setPaintValue(e,o,m)}_setPaintValue(e,o,l){if(this.type==="color"){const u=Qy(l);for(let f=e;f<o;f++)this.paintVertexArray.emplace(f,u[0],u[1])}else{for(let u=e;u<o;u++)this.paintVertexArray.emplace(u,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class No{constructor(e,o,l,u,f,m){this.expression=e,this.uniformNames=o.map(y=>`u_${y}_t`),this.type=l,this.useIntegerZoom=u,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=o.map(y=>({name:`a_${y}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new m}populatePaintArray(e,o,l,u,f,m){const y=this.expression.evaluate(new W(this.zoom),o,{},f,u,m),b=this.expression.evaluate(new W(this.zoom+1),o,{},f,u,m),w=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(w,e,y,b)}updatePaintArray(e,o,l,u,f){const m=this.expression.evaluate({zoom:this.zoom},l,u,void 0,f),y=this.expression.evaluate({zoom:this.zoom+1},l,u,void 0,f);this._setPaintValue(e,o,m,y)}_setPaintValue(e,o,l,u){if(this.type==="color"){const f=Qy(l),m=Qy(u);for(let y=e;y<o;y++)this.paintVertexArray.emplace(y,f[0],f[1],m[0],m[1])}else{for(let f=e;f<o;f++)this.paintVertexArray.emplace(f,l,u);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,o){const l=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,u=Ge(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);e.set(u)}getBinding(e,o,l){return new Nm(e,o)}}class La{constructor(e,o,l,u,f,m,y){this.expression=e,this.type=l,this.useIntegerZoom=u,this.zoom=f,this.layerId=y,this.paintVertexAttributes=(l==="array"?Xk:Hk).members;for(let b=0;b<o.length;++b);this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(e,o,l){const u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,o.patterns&&o.patterns[this.layerId],l)}updatePaintArray(e,o,l,u,f,m){this._setPaintValues(e,o,l.patterns&&l.patterns[this.layerId],m)}_setPaintValues(e,o,l,u){if(!u||!l)return;const{min:f,mid:m,max:y}=l,b=u[f],w=u[m],A=u[y];if(b&&w&&A)for(let k=e;k<o;k++)this._setPaintValue(this.zoomInPaintVertexArray,k,w,b),this._setPaintValue(this.zoomOutPaintVertexArray,k,w,A)}_setPaintValue(e,o,l,u){e.emplace(o,l.tl[0],l.tl[1],l.br[0],l.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],l.pixelRatio,u.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class za{constructor(e,o,l=()=>!0){this.binders={},this._buffers=[];const u=[];for(const f in e.paint._values){if(!l(f))continue;const m=e.paint.get(f);if(!(m instanceof Ie&&Ca(m.property.specification)))continue;const y=iP(f,e.type),b=m.value,w=m.property.specification.type,A=m.property.useIntegerZoom,k=m.property.specification["property-type"],D=k==="cross-faded"||k==="cross-faded-data-driven",R=String(f)==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(b.kind!=="constant"||R)if(b.kind==="source"||R||D){const F=Y1(f,w,"source");this.binders[f]=D?new La(b,y,w,A,o,F,e.id):new Ws(b,y,w,F),u.push(`/a_${f}`)}else{const F=Y1(f,w,"composite");this.binders[f]=new No(b,y,w,A,o,F),u.push(`/z_${f}`)}else this.binders[f]=D?new $u(b.value,y):new of(b.value,y,w),u.push(`/u_${f}`)}this.cacheKey=u.sort().join("")}getMaxValue(e){const o=this.binders[e];return o instanceof Ws||o instanceof No?o.maxValue:0}populatePaintArrays(e,o,l,u,f,m){for(const y in this.binders){const b=this.binders[y];(b instanceof Ws||b instanceof No||b instanceof La)&&b.populatePaintArray(e,o,l,u,f,m)}}setConstantPatternPositions(e,o){for(const l in this.binders){const u=this.binders[l];u instanceof $u&&u.setConstantPatternPositions(e,o)}}updatePaintArrays(e,o,l,u,f,m){let y=!1;for(const b in e){const w=o.getPositions(b);for(const A of w){const k=l.feature(A.index);for(const D in this.binders){const R=this.binders[D];if((R instanceof Ws||R instanceof No||R instanceof La)&&R.expression.isStateDependent===!0){const F=u.paint.get(D);R.expression=F.value,R.updatePaintArray(A.start,A.end,k,e[b],f,m),y=!0}}}}return y}defines(){const e=[];for(const o in this.binders){const l=this.binders[o];(l instanceof of||l instanceof $u)&&e.push(...l.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return e}getBinderAttributes(){const e=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof Ws||l instanceof No||l instanceof La)for(let u=0;u<l.paintVertexAttributes.length;u++)e.push(l.paintVertexAttributes[u].name)}return e}getBinderUniforms(){const e=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof of||l instanceof $u||l instanceof No)for(const u of l.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,o){const l=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof of||f instanceof $u||f instanceof No){for(const m of f.uniformNames)if(o[m]){const y=f.getBinding(e,o[m],m);l.push({name:m,property:u,binding:y})}}}return l}setUniforms(e,o,l,u){for(const{name:f,property:m,binding:y}of o)this.binders[m].setUniform(y,u,l.get(m),f)}updatePaintBuffers(e){this._buffers=[];for(const o in this.binders){const l=this.binders[o];if(e&&l instanceof La){const u=e.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(l instanceof Ws||l instanceof No)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(e){for(const o in this.binders){const l=this.binders[o];(l instanceof Ws||l instanceof No||l instanceof La)&&l.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const o=this.binders[e];(o instanceof Ws||o instanceof No||o instanceof La)&&o.destroy()}}}class Gl{constructor(e,o,l=()=>!0){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new za(u,o,l);this.needsUpload=!1,this._featureMap=new Bm,this._bufferOffset=0}populatePaintArrays(e,o,l,u,f,m,y){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(e,o,u,f,m,y);o.id!==void 0&&this._featureMap.add(o.id,l,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,o,l,u,f){for(const m of l)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,o,m,u,f)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const tP={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function iP(r,e){return tP[r]||[r.replace(`${e}-`,"").replace(/-/g,"_")]}const nP={"line-pattern":{source:Ki,composite:Ki},"fill-pattern":{source:Ki,composite:Ki},"fill-extrusion-pattern":{source:Ki,composite:Ki},"line-dasharray":{source:zi,composite:zi}},rP={color:{source:qs,composite:Ui},number:{source:Da,composite:qs}};function Y1(r,e,o){const l=nP[r];return l&&l[o]||rP[e][o]}mt(of,"ConstantBinder"),mt($u,"CrossFadedConstantBinder"),mt(Ws,"SourceExpressionBinder"),mt(La,"CrossFadedCompositeBinder"),mt(No,"CompositeExpressionBinder"),mt(za,"ProgramConfiguration",{omit:["_buffers"]}),mt(Gl,"ProgramConfigurationSet");const Um="-transition";class Uo extends Mi{constructor(e,o){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),o.layout&&(this._unevaluatedLayout=new De(o.layout)),o.paint)){this._transitionablePaint=new ne(o.paint);for(const l in e.paint)this.setPaintProperty(l,e.paint[l],{validate:!1});for(const l in e.layout)this.setLayoutProperty(l,e.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Je(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,o,l={}){o!=null&&this._validate(Ky,`layers.${this.id}.layout.${e}`,e,o,l)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,o):this.visibility=o)}getPaintProperty(e){return ri(e,Um)?this._transitionablePaint.getTransition(e.slice(0,-Um.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,o,l={}){if(o!=null&&this._validate(wm,`layers.${this.id}.paint.${e}`,e,o,l))return!1;if(ri(e,Um))return this._transitionablePaint.setTransition(e.slice(0,-Um.length),o||void 0),!1;{const u=this._transitionablePaint._values[e],f=u.property.specification["property-type"]==="cross-faded-data-driven",m=u.value.isDataDriven(),y=u.value;this._transitionablePaint.setValue(e,o),this._handleSpecialPaintPropertyUpdate(e);const b=this._transitionablePaint._values[e].value;return b.isDataDriven()||m||f||this._handleOverridablePaintPropertyUpdate(e,y,b)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,o,l){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,o){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,o)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Wi(e,(o,l)=>!(o===void 0||l==="layout"&&!Object.keys(o).length||l==="paint"&&!Object.keys(o).length))}_validate(e,o,l,u,f={}){return(!f||f.validate!==!1)&&Em(this,e.call(bm,{key:o,layerType:this.type,objectKey:l,value:u,styleSpec:Ee,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const o=this.paint.get(e);if(o instanceof Ie&&Ca(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Us(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const oP=_t([{name:"a_pos",components:2,type:"Int16"}],4),sP=_t([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class mn{constructor(e=[]){this.segments=e}prepareSegment(e,o,l,u){let f=this.segments[this.segments.length-1];return e>mn.MAX_VERTEX_ARRAY_LENGTH&&oi(`Max vertices per segment is ${mn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!f||f.vertexLength+e>mn.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:o.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},u!==void 0&&(f.sortKey=u),this.segments.push(f)),f}get(){return this.segments}destroy(){for(const e of this.segments)for(const o in e.vaos)e.vaos[o].destroy()}static simpleSegment(e,o,l,u){return new mn([{vertexOffset:e,primitiveOffset:o,vertexLength:l,primitiveLength:u,vaos:{},sortKey:0}])}}mn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,mt(mn,"SegmentVector");var Ot=8192;class Oa{constructor(e,o){e&&(o?this.setSouthWest(e).setNorthEast(o):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Di?new Di(e.lng,e.lat):Di.convert(e),this}setSouthWest(e){return this._sw=e instanceof Di?new Di(e.lng,e.lat):Di.convert(e),this}extend(e){const o=this._sw,l=this._ne;let u,f;if(e instanceof Di)u=e,f=e;else{if(!(e instanceof Oa))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Oa.convert(e)):this.extend(Di.convert(e)):this;if(u=e._sw,f=e._ne,!u||!f)return this}return o||l?(o.lng=Math.min(u.lng,o.lng),o.lat=Math.min(u.lat,o.lat),l.lng=Math.max(f.lng,l.lng),l.lat=Math.max(f.lat,l.lat)):(this._sw=new Di(u.lng,u.lat),this._ne=new Di(f.lng,f.lat)),this}getCenter(){return new Di((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Di(this.getWest(),this.getNorth())}getSouthEast(){return new Di(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:o,lat:l}=Di.convert(e);let u=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&u}static convert(e){return!e||e instanceof Oa?e:new Oa(e)}}const ev=63710088e-1;class Di{constructor(e,o){if(isNaN(e)||isNaN(o))throw new Error(`Invalid LngLat object: (${e}, ${o})`);if(this.lng=+e,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Di(pt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const o=Math.PI/180,l=this.lat*o,u=e.lat*o,f=Math.sin(l)*Math.sin(u)+Math.cos(l)*Math.cos(u)*Math.cos((e.lng-this.lng)*o);return ev*Math.acos(Math.min(f,1))}toBounds(e=0){const o=360*e/40075017,l=o/Math.cos(Math.PI/180*this.lat);return new Oa(new Di(this.lng-l,this.lat-o),new Di(this.lng+l,this.lat+o))}static convert(e){if(e instanceof Di)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Di(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Di(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const J1=2*Math.PI*ev;function tv(r){return J1*Math.cos(r*Math.PI/180)}function ql(r){return(180+r)/360}function Zl(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function _o(r,e){return r/tv(e)}function sr(r){return 360*r-180}function Tn(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function Q1(r,e){return r*tv(Tn(e))}const ns=85.051129;class Gu{constructor(e,o,l=0){this.x=+e,this.y=+o,this.z=+l}static fromLngLat(e,o=0){const l=Di.convert(e);return new Gu(ql(l.lng),Zl(l.lat),_o(o,l.lat))}toLngLat(){return new Di(sr(this.x),Tn(this.y))}toAltitude(){return Q1(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/J1*(e=Tn(this.y),1/Math.cos(e*Math.PI/180));var e}}function iv(r,e,o,l,u,f,m,y,b){const w=(e+l)/2,A=(o+u)/2,k=new P(w,A);y(k),function(D,R,F,V,K,ee){const he=F-K,ce=V-ee;return Math.abs((V-R)*he-(F-D)*ce)/Math.hypot(he,ce)}(k.x,k.y,f.x,f.y,m.x,m.y)>=b?(iv(r,e,o,w,A,f,k,y,b),iv(r,w,A,l,u,k,m,y,b)):r.push(m)}function ew(r,e,o){let l=r[0],u=l.x,f=l.y;e(l);const m=[l];for(let y=1;y<r.length;y++){const b=r[y],{x:w,y:A}=b;e(b),iv(m,u,f,w,A,l,b,e,o),u=w,f=A,l=b}return m}function nv(r,e,o,l,u){if(u(e,o)){const f=e.add(o).mult(.5);l(f),nv(r,e,f,l,u),nv(r,f,o,l,u)}else r.push(o)}function aP(r,e,o){let l=r[0];e(l);const u=[l];for(let f=1;f<r.length;f++){const m=r[f];e(m),nv(u,l,m,e,o),l=m}return u}const rv=Math.pow(2,14)-1,tw=-rv-1;function lP(r,e){const o=Math.round(r.x*e),l=Math.round(r.y*e);return r.x=Ge(o,tw,rv),r.y=Ge(l,tw,rv),(o<r.x||o>r.x+1||l<r.y||l>r.y+1)&&oi("Geometry exceeds allowed extent, reduce your vector tile buffer size"),r}function Hs(r,e,o){const l=r.loadGeometry(),u=r.extent,f=Ot/u;if(e&&o&&o.projection.isReprojectedInTileSpace){const m=1<<e.z,{scale:y,x:b,y:w,projection:A}=o,k=D=>{const R=sr((e.x+D.x/u)/m),F=Tn((e.y+D.y/u)/m),V=A.project(R,F);D.x=(V.x*y-b)*u,D.y=(V.y*y-w)*u};for(let D=0;D<l.length;D++)if(r.type!==1)l[D]=ew(l[D],k,1);else{const R=[];for(const F of l[D])F.x<0||F.x>=u||F.y<0||F.y>=u||(k(F),R.push(F));l[D]=R}}for(const m of l)for(const y of m)lP(y,f);return l}function Wl(r,e){return{type:r.type,id:r.id,properties:r.properties,geometry:e?Hs(r):[]}}function jm(r,e,o,l,u){r.emplaceBack(2*e+(l+1)/2,2*o+(u+1)/2)}function Vm(r,e,o){const l=16384;r.emplaceBack(e.x,e.y,e.z,o[0]*l,o[1]*l,o[2]*l)}class ov{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new $t,this.indexArray=new ln,this.segments=new mn,this.programConfigurations=new Gl(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,l,u){const f=this.layers[0],m=[];let y=null;f.type==="circle"&&(y=f.layout.get("circle-sort-key"));for(const{feature:w,id:A,index:k,sourceLayerIndex:D}of e){const R=this.layers[0]._featureFilter.needGeometry,F=Wl(w,R);if(!this.layers[0]._featureFilter.filter(new W(this.zoom),F,l))continue;const V=y?y.evaluate(F,{},l):void 0,K={id:A,properties:w.properties,type:w.type,sourceLayerIndex:D,index:k,geometry:R?F.geometry:Hs(w,l,u),patterns:{},sortKey:V};m.push(K)}y&&m.sort((w,A)=>w.sortKey-A.sortKey);let b=null;u.projection.name==="globe"&&(this.globeExtVertexArray=new Z1,b=u.projection);for(const w of m){const{geometry:A,index:k,sourceLayerIndex:D}=w,R=e[k].feature;this.addFeature(w,A,k,o.availableImages,l,b),o.featureIndex.insert(R,A,k,D,this.index)}}update(e,o,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,oP.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,sP.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,o,l,u,f,m){for(const y of o)for(const b of y){const w=b.x,A=b.y;if(w<0||w>=Ot||A<0||A>=Ot)continue;if(m){const R=m.projectTilePoint(w,A,f),F=m.upVector(f,w,A),V=this.globeExtVertexArray;Vm(V,R,F),Vm(V,R,F),Vm(V,R,F),Vm(V,R,F)}const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),D=k.vertexLength;jm(this.layoutVertexArray,w,A,-1,-1),jm(this.layoutVertexArray,w,A,1,-1),jm(this.layoutVertexArray,w,A,1,1),jm(this.layoutVertexArray,w,A,-1,1),this.indexArray.emplaceBack(D,D+1,D+2),this.indexArray.emplaceBack(D,D+2,D+3),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,{},u,f)}}function iw(r,e){for(let o=0;o<r.length;o++)if(Hl(e,r[o]))return!0;for(let o=0;o<e.length;o++)if(Hl(r,e[o]))return!0;return!!sv(r,e)}function cP(r,e,o){return!!Hl(r,e)||!!av(e,r,o)}function nw(r,e){if(r.length===1)return ow(e,r[0]);for(let o=0;o<e.length;o++){const l=e[o];for(let u=0;u<l.length;u++)if(Hl(r,l[u]))return!0}for(let o=0;o<r.length;o++)if(ow(e,r[o]))return!0;for(let o=0;o<e.length;o++)if(sv(r,e[o]))return!0;return!1}function uP(r,e,o){if(r.length>1){if(sv(r,e))return!0;for(let l=0;l<e.length;l++)if(av(e[l],r,o))return!0}for(let l=0;l<r.length;l++)if(av(r[l],e,o))return!0;return!1}function sv(r,e){if(r.length===0||e.length===0)return!1;for(let o=0;o<r.length-1;o++){const l=r[o],u=r[o+1];for(let f=0;f<e.length-1;f++)if(hP(l,u,e[f],e[f+1]))return!0}return!1}function hP(r,e,o,l){return Si(r,o,l)!==Si(e,o,l)&&Si(r,e,o)!==Si(r,e,l)}function av(r,e,o){const l=o*o;if(e.length===1)return r.distSqr(e[0])<l;for(let u=1;u<e.length;u++)if(rw(r,e[u-1],e[u])<l)return!0;return!1}function rw(r,e,o){const l=e.distSqr(o);if(l===0)return r.distSqr(e);const u=((r.x-e.x)*(o.x-e.x)+(r.y-e.y)*(o.y-e.y))/l;return r.distSqr(u<0?e:u>1?o:o.sub(e)._mult(u)._add(e))}function ow(r,e){let o,l,u,f=!1;for(let m=0;m<r.length;m++){o=r[m];for(let y=0,b=o.length-1;y<o.length;b=y++)l=o[y],u=o[b],l.y>e.y!=u.y>e.y&&e.x<(u.x-l.x)*(e.y-l.y)/(u.y-l.y)+l.x&&(f=!f)}return f}function Hl(r,e){let o=!1;for(let l=0,u=r.length-1;l<r.length;u=l++){const f=r[l],m=r[u];f.y>e.y!=m.y>e.y&&e.x<(m.x-f.x)*(e.y-f.y)/(m.y-f.y)+f.x&&(o=!o)}return o}function sw(r,e,o,l,u){for(const m of r)if(e<=m.x&&o<=m.y&&l>=m.x&&u>=m.y)return!0;const f=[new P(e,o),new P(e,u),new P(l,u),new P(l,o)];if(r.length>2){for(const m of f)if(Hl(r,m))return!0}for(let m=0;m<r.length-1;m++)if(dP(r[m],r[m+1],f))return!0;return!1}function dP(r,e,o){const l=o[0],u=o[2];if(r.x<l.x&&e.x<l.x||r.x>u.x&&e.x>u.x||r.y<l.y&&e.y<l.y||r.y>u.y&&e.y>u.y)return!1;const f=Si(r,e,o[0]);return f!==Si(r,e,o[1])||f!==Si(r,e,o[2])||f!==Si(r,e,o[3])}function qu(r,e,o){const l=e.paint.get(r).value;return l.kind==="constant"?l.value:o.programConfigurations.get(e.id).getMaxValue(r)}function $m(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function aw(r,e,o,l,u){if(!e[0]&&!e[1])return r;const f=P.convert(e)._mult(u);o==="viewport"&&f._rotate(-l);const m=[];for(let y=0;y<r.length;y++)m.push(r[y].sub(f));return m}function lw(r,e,o,l){const u=P.convert(r)._mult(l);return e==="viewport"&&u._rotate(-o),u}mt(ov,"CircleBucket",{omit:["layers"]});const fP=new gt({"circle-sort-key":new Ce(Ee.layout_circle["circle-sort-key"])});var pP={paint:new gt({"circle-radius":new Ce(Ee.paint_circle["circle-radius"]),"circle-color":new Ce(Ee.paint_circle["circle-color"]),"circle-blur":new Ce(Ee.paint_circle["circle-blur"]),"circle-opacity":new Ce(Ee.paint_circle["circle-opacity"]),"circle-translate":new ae(Ee.paint_circle["circle-translate"]),"circle-translate-anchor":new ae(Ee.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ae(Ee.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ae(Ee.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ce(Ee.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ce(Ee.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ce(Ee.paint_circle["circle-stroke-opacity"])}),layout:fP},Gm=1e-6,Lr=typeof Float32Array!="undefined"?Float32Array:Array;function cw(){var r=new Lr(9);return Lr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function zr(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Ra(r,e,o){var l=e[0],u=e[1],f=e[2],m=e[3],y=e[4],b=e[5],w=e[6],A=e[7],k=e[8],D=e[9],R=e[10],F=e[11],V=e[12],K=e[13],ee=e[14],he=e[15],ce=o[0],pe=o[1],ye=o[2],be=o[3];return r[0]=ce*l+pe*y+ye*k+be*V,r[1]=ce*u+pe*b+ye*D+be*K,r[2]=ce*f+pe*w+ye*R+be*ee,r[3]=ce*m+pe*A+ye*F+be*he,r[4]=(ce=o[4])*l+(pe=o[5])*y+(ye=o[6])*k+(be=o[7])*V,r[5]=ce*u+pe*b+ye*D+be*K,r[6]=ce*f+pe*w+ye*R+be*ee,r[7]=ce*m+pe*A+ye*F+be*he,r[8]=(ce=o[8])*l+(pe=o[9])*y+(ye=o[10])*k+(be=o[11])*V,r[9]=ce*u+pe*b+ye*D+be*K,r[10]=ce*f+pe*w+ye*R+be*ee,r[11]=ce*m+pe*A+ye*F+be*he,r[12]=(ce=o[12])*l+(pe=o[13])*y+(ye=o[14])*k+(be=o[15])*V,r[13]=ce*u+pe*b+ye*D+be*K,r[14]=ce*f+pe*w+ye*R+be*ee,r[15]=ce*m+pe*A+ye*F+be*he,r}function Xl(r,e,o){var l,u,f,m,y,b,w,A,k,D,R,F,V=o[0],K=o[1],ee=o[2];return e===r?(r[12]=e[0]*V+e[4]*K+e[8]*ee+e[12],r[13]=e[1]*V+e[5]*K+e[9]*ee+e[13],r[14]=e[2]*V+e[6]*K+e[10]*ee+e[14],r[15]=e[3]*V+e[7]*K+e[11]*ee+e[15]):(u=e[1],f=e[2],m=e[3],y=e[4],b=e[5],w=e[6],A=e[7],k=e[8],D=e[9],R=e[10],F=e[11],r[0]=l=e[0],r[1]=u,r[2]=f,r[3]=m,r[4]=y,r[5]=b,r[6]=w,r[7]=A,r[8]=k,r[9]=D,r[10]=R,r[11]=F,r[12]=l*V+y*K+k*ee+e[12],r[13]=u*V+b*K+D*ee+e[13],r[14]=f*V+w*K+R*ee+e[14],r[15]=m*V+A*K+F*ee+e[15]),r}function rs(r,e,o){var l=o[0],u=o[1],f=o[2];return r[0]=e[0]*l,r[1]=e[1]*l,r[2]=e[2]*l,r[3]=e[3]*l,r[4]=e[4]*u,r[5]=e[5]*u,r[6]=e[6]*u,r[7]=e[7]*u,r[8]=e[8]*f,r[9]=e[9]*f,r[10]=e[10]*f,r[11]=e[11]*f,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function qm(r,e,o){var l=Math.sin(o),u=Math.cos(o),f=e[4],m=e[5],y=e[6],b=e[7],w=e[8],A=e[9],k=e[10],D=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=f*u+w*l,r[5]=m*u+A*l,r[6]=y*u+k*l,r[7]=b*u+D*l,r[8]=w*u-f*l,r[9]=A*u-m*l,r[10]=k*u-y*l,r[11]=D*u-b*l,r}function Zm(r,e,o){var l=Math.sin(o),u=Math.cos(o),f=e[0],m=e[1],y=e[2],b=e[3],w=e[8],A=e[9],k=e[10],D=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=f*u-w*l,r[1]=m*u-A*l,r[2]=y*u-k*l,r[3]=b*u-D*l,r[8]=f*l+w*u,r[9]=m*l+A*u,r[10]=y*l+k*u,r[11]=b*l+D*u,r}function uw(r,e,o){var l,u,f,m=o[0],y=o[1],b=o[2],w=Math.hypot(m,y,b);return w<Gm?null:(m*=w=1/w,y*=w,b*=w,l=Math.sin(e),u=Math.cos(e),r[0]=m*m*(f=1-u)+u,r[1]=y*m*f+b*l,r[2]=b*m*f-y*l,r[3]=0,r[4]=m*y*f-b*l,r[5]=y*y*f+u,r[6]=b*y*f+m*l,r[7]=0,r[8]=m*b*f+y*l,r[9]=y*b*f-m*l,r[10]=b*b*f+u,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var mP=Ra;function lv(){var r=new Lr(3);return Lr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function hw(r){var e=new Lr(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function sf(r){return Math.hypot(r[0],r[1],r[2])}function Zu(r,e,o){var l=new Lr(3);return l[0]=r,l[1]=e,l[2]=o,l}function Ba(r,e,o){return r[0]=e[0]+o[0],r[1]=e[1]+o[1],r[2]=e[2]+o[2],r}function cv(r,e,o){return r[0]=e[0]-o[0],r[1]=e[1]-o[1],r[2]=e[2]-o[2],r}function dw(r,e,o){return r[0]=e[0]*o[0],r[1]=e[1]*o[1],r[2]=e[2]*o[2],r}function Wm(r,e,o){return r[0]=Math.min(e[0],o[0]),r[1]=Math.min(e[1],o[1]),r[2]=Math.min(e[2],o[2]),r}function Hm(r,e,o){return r[0]=Math.max(e[0],o[0]),r[1]=Math.max(e[1],o[1]),r[2]=Math.max(e[2],o[2]),r}function os(r,e,o){return r[0]=e[0]*o,r[1]=e[1]*o,r[2]=e[2]*o,r}function Xm(r,e,o,l){return r[0]=e[0]+o[0]*l,r[1]=e[1]+o[1]*l,r[2]=e[2]+o[2]*l,r}function ar(r,e){var o=e[0],l=e[1],u=e[2],f=o*o+l*l+u*u;return f>0&&(f=1/Math.sqrt(f)),r[0]=e[0]*f,r[1]=e[1]*f,r[2]=e[2]*f,r}function go(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function uv(r,e,o){var l=e[0],u=e[1],f=e[2],m=o[0],y=o[1],b=o[2];return r[0]=u*b-f*y,r[1]=f*m-l*b,r[2]=l*y-u*m,r}function qn(r,e,o){var l=e[0],u=e[1],f=e[2],m=o[3]*l+o[7]*u+o[11]*f+o[15];return r[0]=(o[0]*l+o[4]*u+o[8]*f+o[12])/(m=m||1),r[1]=(o[1]*l+o[5]*u+o[9]*f+o[13])/m,r[2]=(o[2]*l+o[6]*u+o[10]*f+o[14])/m,r}function fw(r,e,o){var l=o[0],u=o[1],f=o[2],m=e[0],y=e[1],b=e[2],w=u*b-f*y,A=f*m-l*b,k=l*y-u*m,D=u*k-f*A,R=f*w-l*k,F=l*A-u*w,V=2*o[3];return A*=V,k*=V,R*=2,F*=2,r[0]=m+(w*=V)+(D*=2),r[1]=y+A+R,r[2]=b+k+F,r}var af,yo=cv,_P=dw,gP=sf;function pw(r,e,o){return r[0]=e[0]*o,r[1]=e[1]*o,r[2]=e[2]*o,r[3]=e[3]*o,r}function Kl(r,e,o){var l=e[0],u=e[1],f=e[2],m=e[3];return r[0]=o[0]*l+o[4]*u+o[8]*f+o[12]*m,r[1]=o[1]*l+o[5]*u+o[9]*f+o[13]*m,r[2]=o[2]*l+o[6]*u+o[10]*f+o[14]*m,r[3]=o[3]*l+o[7]*u+o[11]*f+o[15]*m,r}function mw(){var r=new Lr(4);return Lr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function _w(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function gw(r,e,o){o*=.5;var l=e[0],u=e[1],f=e[2],m=e[3],y=Math.sin(o),b=Math.cos(o);return r[0]=l*b+m*y,r[1]=u*b+f*y,r[2]=f*b-u*y,r[3]=m*b-l*y,r}function yw(r,e,o){o*=.5;var l=e[0],u=e[1],f=e[2],m=e[3],y=Math.sin(o),b=Math.cos(o);return r[0]=l*b-f*y,r[1]=u*b+m*y,r[2]=f*b+l*y,r[3]=m*b-u*y,r}lv(),af=new Lr(4),Lr!=Float32Array&&(af[0]=0,af[1]=0,af[2]=0,af[3]=0),lv(),Zu(1,0,0),Zu(0,1,0),mw(),mw(),cw();class hv{constructor(e,o){this.pos=e,this.dir=o}intersectsPlane(e,o,l){const u=go(o,this.dir);if(Math.abs(u)<1e-6)return!1;const f=((e[0]-this.pos[0])*o[0]+(e[1]-this.pos[1])*o[1]+(e[2]-this.pos[2])*o[2])/u;return l[0]=this.pos[0]+this.dir[0]*f,l[1]=this.pos[1]+this.dir[1]*f,l[2]=this.pos[2]+this.dir[2]*f,!0}closestPointOnSphere(e,o,l){if(function(R,F){var V=R[0],K=R[1],ee=R[2],he=F[0],ce=F[1],pe=F[2];return Math.abs(V-he)<=Gm*Math.max(1,Math.abs(V),Math.abs(he))&&Math.abs(K-ce)<=Gm*Math.max(1,Math.abs(K),Math.abs(ce))&&Math.abs(ee-pe)<=Gm*Math.max(1,Math.abs(ee),Math.abs(pe))}(this.pos,e)||o===0)return l[0]=l[1]=l[2]=0,!1;const[u,f,m]=this.dir,y=this.pos[0]-e[0],b=this.pos[1]-e[1],w=this.pos[2]-e[2],A=u*u+f*f+m*m,k=2*(y*u+b*f+w*m),D=k*k-4*A*(y*y+b*b+w*w-o*o);if(D<0){const R=Math.max(-k/2,0),F=y+u*R,V=b+f*R,K=w+m*R,ee=Math.hypot(F,V,K);return l[0]=F*o/ee,l[1]=V*o/ee,l[2]=K*o/ee,!1}{const R=(-k-Math.sqrt(D))/(2*A);if(R<0){const F=Math.hypot(y,b,w);return l[0]=y*o/F,l[1]=b*o/F,l[2]=w*o/F,!1}return l[0]=y+u*R,l[1]=b+f*R,l[2]=w+m*R,!0}}}class dv{constructor(e,o,l,u,f){this.TL=e,this.TR=o,this.BR=l,this.BL=u,this.horizon=f}static fromInvProjectionMatrix(e,o,l){const u=[-1,1,1],f=[1,1,1],m=[1,-1,1],y=[-1,-1,1],b=qn(u,u,e),w=qn(f,f,e),A=qn(m,m,e),k=qn(y,y,e);return new dv(b,w,A,k,o/l)}}class fv{constructor(e,o){this.points=e,this.planes=o}static fromInvProjectionMatrix(e,o,l,u){const f=Math.pow(2,l),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const w=Kl([],b,e),A=1/w[3]/o*f;return function(k,D,R){return k[0]=D[0]*R[0],k[1]=D[1]*R[1],k[2]=D[2]*R[2],k[3]=D[3]*R[3],k}(w,w,[A,A,u?1/w[3]:A,A])}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const w=ar([],uv([],yo([],m[b[0]],m[b[1]]),yo([],m[b[2]],m[b[1]]))),A=-go(w,m[b[1]]);return w.concat(A)});return new fv(m,y)}}class Qr{constructor(e,o){this.min=e,this.max=o,this.center=os([],Ba([],this.min,this.max),.5)}quadrant(e){const o=[e%2==0,e<2],l=hw(this.min),u=hw(this.max);for(let f=0;f<o.length;f++)l[f]=o[f]?this.min[f]:this.center[f],u[f]=o[f]?this.center[f]:this.max[f];return u[2]=this.max[2],new Qr(l,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,o=this.max;return[[e[0],e[1],e[2]],[o[0],e[1],e[2]],[o[0],o[1],e[2]],[e[0],o[1],e[2]],[e[0],e[1],o[2]],[o[0],e[1],o[2]],[o[0],o[1],o[2]],[e[0],o[1],o[2]]]}intersects(e){const o=this.getCorners();let l=!0;for(let u=0;u<e.planes.length;u++){const f=e.planes[u];let m=0;for(let y=0;y<o.length;y++)m+=go(f,o[y])+f[3]>=0;if(m===0)return 0;m!==o.length&&(l=!1)}if(l)return 2;for(let u=0;u<3;u++){let f=Number.MAX_VALUE,m=-Number.MAX_VALUE;for(let y=0;y<e.points.length;y++){const b=e.points[y][u]-this.min[u];f=Math.min(f,b),m=Math.max(m,b)}if(m<0||f>this.max[u]-this.min[u])return 0}return 1}}function vw(r,e,o,l,u,f,m,y,b){if(f&&r.queryGeometry.isAboveHorizon)return!1;f&&(b*=r.pixelToTileUnitsFactor);const w=r.tileID.canonical,A=o.projection.upVectorScale(w,o.center.lat,o.worldSize).metersToTile;for(const k of e)for(const D of k){const R=D.add(y),F=u&&o.elevation?o.elevation.exaggeration()*u.getElevationAt(R.x,R.y,!0):0,V=o.projection.projectTilePoint(R.x,R.y,w);if(F>0){const ce=o.projection.upVector(w,R.x,R.y);V.x+=ce[0]*A*F,V.y+=ce[1]*A*F,V.z+=ce[2]*A*F}const K=f?R:yP(V.x,V.y,V.z,l),ee=f?r.tilespaceRays.map(ce=>xP(ce,F)):r.queryGeometry.screenGeometry,he=Kl([],[V.x,V.y,V.z,1],l);if(!m&&f?b*=he[3]/o.cameraToCenterDistance:m&&!f&&(b*=o.cameraToCenterDistance/he[3]),f){const ce=Tn((D.y/Ot+w.y)/(1<<w.z));b/=o.projection.pixelsPerMeter(ce,1)/_o(1,ce)}if(cP(ee,K,b))return!0}return!1}function yP(r,e,o,l){const u=Kl([],[r,e,o,1],l);return new P(u[0]/u[3],u[1]/u[3])}const xw=Zu(0,0,0),vP=Zu(0,0,1);function xP(r,e){const o=lv();return xw[2]=e,r.intersectsPlane(xw,vP,o),new P(o[0],o[1])}class bw extends ov{}function ww(r,{width:e,height:o},l,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*o*l)throw new RangeError("mismatched image size")}else u=new Uint8Array(e*o*l);return r.width=e,r.height=o,r.data=u,r}function Ew(r,e,o){const{width:l,height:u}=e;l===r.width&&u===r.height||(pv(r,e,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,l),height:Math.min(r.height,u)},o),r.width=l,r.height=u,r.data=e.data)}function pv(r,e,o,l,u,f){if(u.width===0||u.height===0)return e;if(u.width>r.width||u.height>r.height||o.x>r.width-u.width||o.y>r.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||l.x>e.width-u.width||l.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const m=r.data,y=e.data;for(let b=0;b<u.height;b++){const w=((o.y+b)*r.width+o.x)*f,A=((l.y+b)*e.width+l.x)*f;for(let k=0;k<u.width*f;k++)y[A+k]=m[w+k]}return e}mt(bw,"HeatmapBucket",{omit:["layers"]});class Xs{constructor(e,o){ww(this,e,1,o)}resize(e){Ew(this,new Xs(e),1)}clone(){return new Xs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,l,u,f){pv(e,o,l,u,f,1)}}class Or{constructor(e,o){ww(this,e,4,o)}resize(e){Ew(this,new Or(e),4)}replace(e,o){o?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Or({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,l,u,f){pv(e,o,l,u,f,4)}}mt(Xs,"AlphaImage"),mt(Or,"RGBAImage");var bP={paint:new gt({"heatmap-radius":new Ce(Ee.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ce(Ee.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ae(Ee.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Oe(Ee.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ae(Ee.paint_heatmap["heatmap-opacity"])})};function mv(r){const e={},o=r.resolution||256,l=r.clips?r.clips.length:1,u=r.image||new Or({width:o,height:l}),f=(m,y,b)=>{e[r.evaluationKey]=b;const w=r.expression.evaluate(e);u.data[m+y+0]=Math.floor(255*w.r/w.a),u.data[m+y+1]=Math.floor(255*w.g/w.a),u.data[m+y+2]=Math.floor(255*w.b/w.a),u.data[m+y+3]=Math.floor(255*w.a)};if(r.clips)for(let m=0,y=0;m<l;++m,y+=4*o)for(let b=0,w=0;b<o;b++,w+=4){const A=b/(o-1),{start:k,end:D}=r.clips[m];f(y,w,k*(1-A)+D*A)}else for(let m=0,y=0;m<o;m++,y+=4)f(0,y,m/(o-1));return u}var wP={paint:new gt({"hillshade-illumination-direction":new ae(Ee.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ae(Ee.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ae(Ee.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ae(Ee.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ae(Ee.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ae(Ee.paint_hillshade["hillshade-accent-color"])})};const EP=_t([{name:"a_pos",components:2,type:"Int16"}],4),{members:TP}=EP;var Km=Ym,CP=Ym;function Ym(r,e,o){o=o||2;var l,u,f,m,y,b,w,A=e&&e.length,k=A?e[0]*o:r.length,D=Tw(r,0,k,o,!0),R=[];if(!D||D.next===D.prev)return R;if(A&&(D=function(V,K,ee,he){var ce,pe,ye,be=[];for(ce=0,pe=K.length;ce<pe;ce++)(ye=Tw(V,K[ce]*he,ce<pe-1?K[ce+1]*he:V.length,he,!1))===ye.next&&(ye.steiner=!0),be.push(LP(ye));for(be.sort(kP),ce=0;ce<be.length;ce++)ee=Fa(ee=PP(be[ce],ee),ee.next);return ee}(r,e,D,o)),r.length>80*o){l=f=r[0],u=m=r[1];for(var F=o;F<k;F+=o)(y=r[F])<l&&(l=y),(b=r[F+1])<u&&(u=b),y>f&&(f=y),b>m&&(m=b);w=(w=Math.max(f-l,m-u))!==0?1/w:0}return lf(D,R,o,l,u,w),R}function Tw(r,e,o,l,u){var f,m;if(u===yv(r,e,o,l)>0)for(f=e;f<o;f+=l)m=Aw(f,r[f],r[f+1],m);else for(f=o-l;f>=e;f-=l)m=Aw(f,r[f],r[f+1],m);return m&&Jm(m,m.next)&&(uf(m),m=m.next),m}function Fa(r,e){if(!r)return r;e||(e=r);var o,l=r;do if(o=!1,l.steiner||!Jm(l,l.next)&&xn(l.prev,l,l.next)!==0)l=l.next;else{if(uf(l),(l=e=l.prev)===l.next)break;o=!0}while(o||l!==e);return e}function lf(r,e,o,l,u,f,m){if(r){!m&&f&&function(A,k,D,R){var F=A;do F.z===null&&(F.z=_v(F.x,F.y,k,D,R)),F.prevZ=F.prev,F.nextZ=F.next,F=F.next;while(F!==A);F.prevZ.nextZ=null,F.prevZ=null,function(V){var K,ee,he,ce,pe,ye,be,ke,Pe=1;do{for(ee=V,V=null,pe=null,ye=0;ee;){for(ye++,he=ee,be=0,K=0;K<Pe&&(be++,he=he.nextZ);K++);for(ke=Pe;be>0||ke>0&&he;)be!==0&&(ke===0||!he||ee.z<=he.z)?(ce=ee,ee=ee.nextZ,be--):(ce=he,he=he.nextZ,ke--),pe?pe.nextZ=ce:V=ce,ce.prevZ=pe,pe=ce;ee=he}pe.nextZ=null,Pe*=2}while(ye>1)}(F)}(r,l,u,f);for(var y,b,w=r;r.prev!==r.next;)if(y=r.prev,b=r.next,f?AP(r,l,u,f):SP(r))e.push(y.i/o),e.push(r.i/o),e.push(b.i/o),uf(r),r=b.next,w=b.next;else if((r=b)===w){m?m===1?lf(r=IP(Fa(r),e,o),e,o,l,u,f,2):m===2&&MP(r,e,o,l,u,f):lf(Fa(r),e,o,l,u,f,1);break}}}function SP(r){var e=r.prev,o=r,l=r.next;if(xn(e,o,l)>=0)return!1;for(var u=r.next.next;u!==r.prev;){if(Wu(e.x,e.y,o.x,o.y,l.x,l.y,u.x,u.y)&&xn(u.prev,u,u.next)>=0)return!1;u=u.next}return!0}function AP(r,e,o,l){var u=r.prev,f=r,m=r.next;if(xn(u,f,m)>=0)return!1;for(var y=u.x>f.x?u.x>m.x?u.x:m.x:f.x>m.x?f.x:m.x,b=u.y>f.y?u.y>m.y?u.y:m.y:f.y>m.y?f.y:m.y,w=_v(u.x<f.x?u.x<m.x?u.x:m.x:f.x<m.x?f.x:m.x,u.y<f.y?u.y<m.y?u.y:m.y:f.y<m.y?f.y:m.y,e,o,l),A=_v(y,b,e,o,l),k=r.prevZ,D=r.nextZ;k&&k.z>=w&&D&&D.z<=A;){if(k!==r.prev&&k!==r.next&&Wu(u.x,u.y,f.x,f.y,m.x,m.y,k.x,k.y)&&xn(k.prev,k,k.next)>=0||(k=k.prevZ,D!==r.prev&&D!==r.next&&Wu(u.x,u.y,f.x,f.y,m.x,m.y,D.x,D.y)&&xn(D.prev,D,D.next)>=0))return!1;D=D.nextZ}for(;k&&k.z>=w;){if(k!==r.prev&&k!==r.next&&Wu(u.x,u.y,f.x,f.y,m.x,m.y,k.x,k.y)&&xn(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;D&&D.z<=A;){if(D!==r.prev&&D!==r.next&&Wu(u.x,u.y,f.x,f.y,m.x,m.y,D.x,D.y)&&xn(D.prev,D,D.next)>=0)return!1;D=D.nextZ}return!0}function IP(r,e,o){var l=r;do{var u=l.prev,f=l.next.next;!Jm(u,f)&&Cw(u,l,l.next,f)&&cf(u,f)&&cf(f,u)&&(e.push(u.i/o),e.push(l.i/o),e.push(f.i/o),uf(l),uf(l.next),l=r=f),l=l.next}while(l!==r);return Fa(l)}function MP(r,e,o,l,u,f){var m=r;do{for(var y=m.next.next;y!==m.prev;){if(m.i!==y.i&&zP(m,y)){var b=Sw(m,y);return m=Fa(m,m.next),b=Fa(b,b.next),lf(m,e,o,l,u,f),void lf(b,e,o,l,u,f)}y=y.next}m=m.next}while(m!==r)}function kP(r,e){return r.x-e.x}function PP(r,e){var o=function(f,m){var y,b=m,w=f.x,A=f.y,k=-1/0;do{if(A<=b.y&&A>=b.next.y&&b.next.y!==b.y){var D=b.x+(A-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(D<=w&&D>k){if(k=D,D===w){if(A===b.y)return b;if(A===b.next.y)return b.next}y=b.x<b.next.x?b:b.next}}b=b.next}while(b!==m);if(!y)return null;if(w===k)return y;var R,F=y,V=y.x,K=y.y,ee=1/0;b=y;do w>=b.x&&b.x>=V&&w!==b.x&&Wu(A<K?w:k,A,V,K,A<K?k:w,A,b.x,b.y)&&(R=Math.abs(A-b.y)/(w-b.x),cf(b,f)&&(R<ee||R===ee&&(b.x>y.x||b.x===y.x&&DP(y,b)))&&(y=b,ee=R)),b=b.next;while(b!==F);return y}(r,e);if(!o)return e;var l=Sw(o,r),u=Fa(o,o.next);return Fa(l,l.next),e===o?u:e}function DP(r,e){return xn(r.prev,r,e.prev)<0&&xn(e.next,r,r.next)<0}function _v(r,e,o,l,u){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-o)*u)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-l)*u)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function LP(r){var e=r,o=r;do(e.x<o.x||e.x===o.x&&e.y<o.y)&&(o=e),e=e.next;while(e!==r);return o}function Wu(r,e,o,l,u,f,m,y){return(u-m)*(e-y)-(r-m)*(f-y)>=0&&(r-m)*(l-y)-(o-m)*(e-y)>=0&&(o-m)*(f-y)-(u-m)*(l-y)>=0}function zP(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!function(o,l){var u=o;do{if(u.i!==o.i&&u.next.i!==o.i&&u.i!==l.i&&u.next.i!==l.i&&Cw(u,u.next,o,l))return!0;u=u.next}while(u!==o);return!1}(r,e)&&(cf(r,e)&&cf(e,r)&&function(o,l){var u=o,f=!1,m=(o.x+l.x)/2,y=(o.y+l.y)/2;do u.y>y!=u.next.y>y&&u.next.y!==u.y&&m<(u.next.x-u.x)*(y-u.y)/(u.next.y-u.y)+u.x&&(f=!f),u=u.next;while(u!==o);return f}(r,e)&&(xn(r.prev,r,e.prev)||xn(r,e.prev,e))||Jm(r,e)&&xn(r.prev,r,r.next)>0&&xn(e.prev,e,e.next)>0)}function xn(r,e,o){return(e.y-r.y)*(o.x-e.x)-(e.x-r.x)*(o.y-e.y)}function Jm(r,e){return r.x===e.x&&r.y===e.y}function Cw(r,e,o,l){var u=e_(xn(r,e,o)),f=e_(xn(r,e,l)),m=e_(xn(o,l,r)),y=e_(xn(o,l,e));return u!==f&&m!==y||!(u!==0||!Qm(r,o,e))||!(f!==0||!Qm(r,l,e))||!(m!==0||!Qm(o,r,l))||!(y!==0||!Qm(o,e,l))}function Qm(r,e,o){return e.x<=Math.max(r.x,o.x)&&e.x>=Math.min(r.x,o.x)&&e.y<=Math.max(r.y,o.y)&&e.y>=Math.min(r.y,o.y)}function e_(r){return r>0?1:r<0?-1:0}function cf(r,e){return xn(r.prev,r,r.next)<0?xn(r,e,r.next)>=0&&xn(r,r.prev,e)>=0:xn(r,e,r.prev)<0||xn(r,r.next,e)<0}function Sw(r,e){var o=new gv(r.i,r.x,r.y),l=new gv(e.i,e.x,e.y),u=r.next,f=e.prev;return r.next=e,e.prev=r,o.next=u,u.prev=o,l.next=o,o.prev=l,f.next=l,l.prev=f,l}function Aw(r,e,o,l){var u=new gv(r,e,o);return l?(u.next=l.next,u.prev=l,l.next.prev=u,l.next=u):(u.prev=u,u.next=u),u}function uf(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function gv(r,e,o){this.i=r,this.x=e,this.y=o,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function yv(r,e,o,l){for(var u=0,f=e,m=o-l;f<o;f+=l)u+=(r[m]-r[f])*(r[f+1]+r[m+1]),m=f;return u}function OP(r,e,o,l,u){Iw(r,e,o||0,l||r.length-1,u||RP)}function Iw(r,e,o,l,u){for(;l>o;){if(l-o>600){var f=l-o+1,m=e-o+1,y=Math.log(f),b=.5*Math.exp(2*y/3),w=.5*Math.sqrt(y*b*(f-b)/f)*(m-f/2<0?-1:1);Iw(r,e,Math.max(o,Math.floor(e-m*b/f+w)),Math.min(l,Math.floor(e+(f-m)*b/f+w)),u)}var A=r[e],k=o,D=l;for(hf(r,o,e),u(r[l],A)>0&&hf(r,o,l);k<D;){for(hf(r,k,D),k++,D--;u(r[k],A)<0;)k++;for(;u(r[D],A)>0;)D--}u(r[o],A)===0?hf(r,o,D):hf(r,++D,l),D<=e&&(o=D+1),e<=D&&(l=D-1)}}function hf(r,e,o){var l=r[e];r[e]=r[o],r[o]=l}function RP(r,e){return r<e?-1:r>e?1:0}function vv(r,e){const o=r.length;if(o<=1)return[r];const l=[];let u,f;for(let m=0;m<o;m++){const y=yn(r[m]);y!==0&&(r[m].area=Math.abs(y),f===void 0&&(f=y<0),f===y<0?(u&&l.push(u),u=[r[m]]):u.push(r[m]))}if(u&&l.push(u),e>1)for(let m=0;m<l.length;m++)l[m].length<=e||(OP(l[m],e,1,l[m].length-1,BP),l[m]=l[m].slice(0,e));return l}function BP(r,e){return e.area-r.area}function xv(r,e,o){const l=o.patternDependencies;let u=!1;for(const f of e){const m=f.paint.get(`${r}-pattern`);m.isConstant()||(u=!0);const y=m.constantOr(null);y&&(u=!0,l[y.to]=!0,l[y.from]=!0)}return u}function bv(r,e,o,l,u){const f=u.patternDependencies;for(const m of e){const y=m.paint.get(`${r}-pattern`).value;if(y.kind!=="constant"){let b=y.evaluate({zoom:l-1},o,{},u.availableImages),w=y.evaluate({zoom:l},o,{},u.availableImages),A=y.evaluate({zoom:l+1},o,{},u.availableImages);b=b&&b.name?b.name:b,w=w&&w.name?w.name:w,A=A&&A.name?A.name:A,f[b]=!0,f[w]=!0,f[A]=!0,o.patterns[m.id]={min:b,mid:w,max:A}}}return o}Ym.deviation=function(r,e,o,l){var u=e&&e.length,f=Math.abs(yv(r,0,u?e[0]*o:r.length,o));if(u)for(var m=0,y=e.length;m<y;m++)f-=Math.abs(yv(r,e[m]*o,m<y-1?e[m+1]*o:r.length,o));var b=0;for(m=0;m<l.length;m+=3){var w=l[m]*o,A=l[m+1]*o,k=l[m+2]*o;b+=Math.abs((r[w]-r[k])*(r[A+1]-r[w+1])-(r[w]-r[A])*(r[k+1]-r[w+1]))}return f===0&&b===0?0:Math.abs((b-f)/f)},Ym.flatten=function(r){for(var e=r[0][0].length,o={vertices:[],holes:[],dimensions:e},l=0,u=0;u<r.length;u++){for(var f=0;f<r[u].length;f++)for(var m=0;m<e;m++)o.vertices.push(r[u][f][m]);u>0&&o.holes.push(l+=r[u-1].length)}return o},Km.default=CP;class t_{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new $t,this.indexArray=new ln,this.indexArray2=new yr,this.programConfigurations=new Gl(e.layers,e.zoom),this.segments=new mn,this.segments2=new mn,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=e.projection}populate(e,o,l,u){this.hasPattern=xv("fill",this.layers,o);const f=this.layers[0].layout.get("fill-sort-key"),m=[];for(const{feature:y,id:b,index:w,sourceLayerIndex:A}of e){const k=this.layers[0]._featureFilter.needGeometry,D=Wl(y,k);if(!this.layers[0]._featureFilter.filter(new W(this.zoom),D,l))continue;const R=f?f.evaluate(D,{},l,o.availableImages):void 0,F={id:b,properties:y.properties,type:y.type,sourceLayerIndex:A,index:w,geometry:k?D.geometry:Hs(y,l,u),patterns:{},sortKey:R};m.push(F)}f&&m.sort((y,b)=>y.sortKey-b.sortKey);for(const y of m){const{geometry:b,index:w,sourceLayerIndex:A}=y;if(this.hasPattern){const k=bv("fill",this.layers,y,this.zoom,o);this.patternFeatures.push(k)}else this.addFeature(y,b,w,l,{},o.availableImages);o.featureIndex.insert(e[w].feature,b,w,A,this.index)}}update(e,o,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l,u)}addFeatures(e,o,l,u,f){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,o,l,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,TP),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,o,l,u,f,m=[]){for(const y of vv(o,500)){let b=0;for(const F of y)b+=F.length;const w=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),A=w.vertexLength,k=[],D=[];for(const F of y){if(F.length===0)continue;F!==y[0]&&D.push(k.length/2);const V=this.segments2.prepareSegment(F.length,this.layoutVertexArray,this.indexArray2),K=V.vertexLength;this.layoutVertexArray.emplaceBack(F[0].x,F[0].y),this.indexArray2.emplaceBack(K+F.length-1,K),k.push(F[0].x),k.push(F[0].y);for(let ee=1;ee<F.length;ee++)this.layoutVertexArray.emplaceBack(F[ee].x,F[ee].y),this.indexArray2.emplaceBack(K+ee-1,K+ee),k.push(F[ee].x),k.push(F[ee].y);V.vertexLength+=F.length,V.primitiveLength+=F.length}const R=Km(k,D);for(let F=0;F<R.length;F+=3)this.indexArray.emplaceBack(A+R[F],A+R[F+1],A+R[F+2]);w.vertexLength+=b,w.primitiveLength+=R.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,f,m,u)}}mt(t_,"FillBucket",{omit:["layers","patternFeatures"]});const FP=new gt({"fill-sort-key":new Ce(Ee.layout_fill["fill-sort-key"])});var NP={paint:new gt({"fill-antialias":new ae(Ee.paint_fill["fill-antialias"]),"fill-opacity":new Ce(Ee.paint_fill["fill-opacity"]),"fill-color":new Ce(Ee.paint_fill["fill-color"]),"fill-outline-color":new Ce(Ee.paint_fill["fill-outline-color"]),"fill-translate":new ae(Ee.paint_fill["fill-translate"]),"fill-translate-anchor":new ae(Ee.paint_fill["fill-translate-anchor"]),"fill-pattern":new Re(Ee.paint_fill["fill-pattern"])}),layout:FP};const UP=_t([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),jP=_t([{name:"a_centroid_pos",components:2,type:"Uint16"}]),VP=_t([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:$P}=UP;var Mw=Hu;function Hu(r,e,o,l,u){this.properties={},this.extent=o,this.type=0,this._pbf=r,this._geometry=-1,this._keys=l,this._values=u,r.readFields(GP,this,e)}function GP(r,e,o){r==1?e.id=o.readVarint():r==2?function(l,u){for(var f=l.readVarint()+l.pos;l.pos<f;){var m=u._keys[l.readVarint()],y=u._values[l.readVarint()];u.properties[m]=y}}(o,e):r==3?e.type=o.readVarint():r==4&&(e._geometry=o.pos)}function qP(r){for(var e,o,l=0,u=0,f=r.length,m=f-1;u<f;m=u++)l+=((o=r[m]).x-(e=r[u]).x)*(e.y+o.y);return l}Hu.types=["Unknown","Point","LineString","Polygon"],Hu.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var e,o=r.readVarint()+r.pos,l=1,u=0,f=0,m=0,y=[];r.pos<o;){if(u<=0){var b=r.readVarint();l=7&b,u=b>>3}if(u--,l===1||l===2)f+=r.readSVarint(),m+=r.readSVarint(),l===1&&(e&&y.push(e),e=[]),e.push(new P(f,m));else{if(l!==7)throw new Error("unknown command "+l);e&&e.push(e[0].clone())}}return e&&y.push(e),y},Hu.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var e=r.readVarint()+r.pos,o=1,l=0,u=0,f=0,m=1/0,y=-1/0,b=1/0,w=-1/0;r.pos<e;){if(l<=0){var A=r.readVarint();o=7&A,l=A>>3}if(l--,o===1||o===2)(u+=r.readSVarint())<m&&(m=u),u>y&&(y=u),(f+=r.readSVarint())<b&&(b=f),f>w&&(w=f);else if(o!==7)throw new Error("unknown command "+o)}return[m,b,y,w]},Hu.prototype.toGeoJSON=function(r,e,o){var l,u,f=this.extent*Math.pow(2,o),m=this.extent*r,y=this.extent*e,b=this.loadGeometry(),w=Hu.types[this.type];function A(R){for(var F=0;F<R.length;F++){var V=R[F];R[F]=[360*(V.x+m)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(V.y+y)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var k=[];for(l=0;l<b.length;l++)k[l]=b[l][0];A(b=k);break;case 2:for(l=0;l<b.length;l++)A(b[l]);break;case 3:for(b=function(R){var F=R.length;if(F<=1)return[R];for(var V,K,ee=[],he=0;he<F;he++){var ce=qP(R[he]);ce!==0&&(K===void 0&&(K=ce<0),K===ce<0?(V&&ee.push(V),V=[R[he]]):V.push(R[he]))}return V&&ee.push(V),ee}(b),l=0;l<b.length;l++)for(u=0;u<b[l].length;u++)A(b[l][u])}b.length===1?b=b[0]:w="Multi"+w;var D={type:"Feature",geometry:{type:w,coordinates:b},properties:this.properties};return"id"in this&&(D.id=this.id),D};var kw=Pw;function Pw(r,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(ZP,this,e),this.length=this._features.length}function ZP(r,e,o){r===15?e.version=o.readVarint():r===1?e.name=o.readString():r===5?e.extent=o.readVarint():r===2?e._features.push(o.pos):r===3?e._keys.push(o.readString()):r===4&&e._values.push(function(l){for(var u=null,f=l.readVarint()+l.pos;l.pos<f;){var m=l.readVarint()>>3;u=m===1?l.readString():m===2?l.readFloat():m===3?l.readDouble():m===4?l.readVarint64():m===5?l.readVarint():m===6?l.readSVarint():m===7?l.readBoolean():null}return u}(o))}function WP(r,e,o){if(r===3){var l=new kw(o,o.readVarint()+o.pos);l.length&&(e[l.name]=l)}}Pw.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var e=this._pbf.readVarint()+this._pbf.pos;return new Mw(this._pbf,e,this.extent,this._keys,this._values)};var Yl={VectorTile:function(r,e){this.layers=r.readFields(WP,{},e)},VectorTileFeature:Mw,VectorTileLayer:kw};function i_(r,e,o,l){const u=[],f=l===0?(m,y,b,w,A,k)=>{m.push(new P(k,b+(k-y)/(w-y)*(A-b)))}:(m,y,b,w,A,k)=>{m.push(new P(y+(k-b)/(A-b)*(w-y),k))};for(const m of r){const y=[];for(const b of m){if(b.length<=2)continue;const w=[];for(let D=0;D<b.length-1;D++){const R=b[D].x,F=b[D].y,V=b[D+1].x,K=b[D+1].y,ee=l===0?R:F,he=l===0?V:K;ee<e?he>e&&f(w,R,F,V,K,e):ee>o?he<o&&f(w,R,F,V,K,o):w.push(b[D]),he<e&&ee>=e&&f(w,R,F,V,K,e),he>o&&ee<=o&&f(w,R,F,V,K,o)}let A=b[b.length-1];const k=l===0?A.x:A.y;k>=e&&k<=o&&w.push(A),w.length&&(A=w[w.length-1],w[0].x===A.x&&w[0].y===A.y||w.push(w[0]),y.push(w))}y.length&&u.push(y)}return u}const HP=Yl.VectorTileFeature.types,XP=Math.pow(2,13);function df(r,e,o,l,u,f,m,y){r.emplaceBack((e<<1)+m,(o<<1)+f,(Math.floor(l*XP)<<1)+u,Math.round(y))}function ff(r,e,o){const l=16384;r.emplaceBack(e.x,e.y,e.z,o[0]*l,o[1]*l,o[2]*l)}class Dw{constructor(){this.acc=new P(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new P(e.x,e.y),this.max=new P(e.x,e.y))}append(e,o){this.currentPolyCount.edges++,this.acc._add(e);const l=this.min,u=this.max;e.x<l.x?l.x=e.x:e.x>u.x&&(u.x=e.x),e.y<l.y?l.y=e.y:e.y>u.y&&(u.y=e.y),((e.x===0||e.x===Ot)&&e.x===o.x)!=((e.y===0||e.y===Ot)&&e.y===o.y)&&this.processBorderOverlap(e,o),o.x<0!=e.x<0&&this.addBorderIntersection(0,yi(o.y,e.y,(0-o.x)/(e.x-o.x))),o.x>Ot!=e.x>Ot&&this.addBorderIntersection(1,yi(o.y,e.y,(Ot-o.x)/(e.x-o.x))),o.y<0!=e.y<0&&this.addBorderIntersection(2,yi(o.x,e.x,(0-o.y)/(e.y-o.y))),o.y>Ot!=e.y>Ot&&this.addBorderIntersection(3,yi(o.x,e.x,(Ot-o.y)/(e.y-o.y)))}addBorderIntersection(e,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const l=this.borders[e];o<l[0]&&(l[0]=o),o>l[1]&&(l[1]=o)}processBorderOverlap(e,o){if(e.x===o.x){if(e.y===o.y)return;const l=e.x===0?0:1;this.addBorderIntersection(l,o.y),this.addBorderIntersection(l,e.y)}else{const l=e.y===0?2:3;this.addBorderIntersection(l,o.x),this.addBorderIntersection(l,e.x)}}centroid(){const e=this.polyCount.reduce((o,l)=>o+l.edges,0);return e!==0?this.acc.div(e)._round():new P(0,0)}span(){return new P(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,o)=>e+ +(o[0]!==Number.MAX_VALUE),0)}}class pf{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Ut,this.centroidVertexArray=new G1,this.indexArray=new ln,this.programConfigurations=new Gl(e.layers,e.zoom),this.segments=new mn,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.enableTerrain=e.enableTerrain}populate(e,o,l,u){this.features=[],this.hasPattern=xv("fill-extrusion",this.layers,o),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(f){const m=Math.exp(Math.PI*(1-f.y/(1<<f.z)*2));return 80150034*m/(m*m+1)/Ot/(1<<f.z)}(l);for(const{feature:f,id:m,index:y,sourceLayerIndex:b}of e){const w=this.layers[0]._featureFilter.needGeometry,A=Wl(f,w);if(!this.layers[0]._featureFilter.filter(new W(this.zoom),A,l))continue;const k={id:m,sourceLayerIndex:b,index:y,geometry:w?A.geometry:Hs(f,l,u),properties:f.properties,type:f.type,patterns:{}},D=this.layoutVertexArray.length;this.hasPattern?this.features.push(bv("fill-extrusion",this.layers,k,this.zoom,o)):this.addFeature(k,k.geometry,y,l,{},o.availableImages,u),o.featureIndex.insert(f,k.geometry,y,b,this.index,D)}this.sortBorders()}addFeatures(e,o,l,u,f){for(const m of this.features){const{geometry:y}=m;this.addFeature(m,y,m.index,o,l,u,f)}this.sortBorders()}update(e,o,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$P),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,VP.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,jP.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,o,l,u,f,m,y){const b=[new P(0,0),new P(Ot,Ot)],w=y.projection,A=w.name==="globe",k=this.enableTerrain&&!A?new Dw:null;A&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new L1);const D=vv(o,500);for(let V=D.length-1;V>=0;V--){const K=D[V];(K.length===0||(R=K[0]).every(ee=>ee.x<=0)||R.every(ee=>ee.x>=Ot)||R.every(ee=>ee.y<=0)||R.every(ee=>ee.y>=Ot))&&D.splice(V,1)}var R;let F;if(A)F=zw(D,b,u);else{F=[];for(const V of D)F.push({polygon:V,bounds:b})}for(const V of F){const K=V.polygon;let ee=0,he=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let ke=0;ke<K.length;ke++){const Pe=K[ke];if(Pe.length===0)continue;ee+=Pe.length;let Fe=0;k&&k.startRing(Pe[0]);for(let Xe=0;Xe<Pe.length;Xe++){const Ae=Pe[Xe];if(Xe>=1){const ze=Pe[Xe-1];if(!KP(Ae,ze,V.bounds)){k&&k.append(Ae,ze),he.vertexLength+4>mn.MAX_VERTEX_ARRAY_LENGTH&&(he=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ke=Ae.sub(ze)._perp(),Ye=Ke.x/(Math.abs(Ke.x)+Math.abs(Ke.y)),ht=Ke.y>0?1:0,qe=ze.dist(Ae);Fe+qe>32768&&(Fe=0),df(this.layoutVertexArray,Ae.x,Ae.y,Ye,ht,0,0,Fe),df(this.layoutVertexArray,Ae.x,Ae.y,Ye,ht,0,1,Fe),Fe+=qe,df(this.layoutVertexArray,ze.x,ze.y,Ye,ht,0,0,Fe),df(this.layoutVertexArray,ze.x,ze.y,Ye,ht,0,1,Fe);const lt=he.vertexLength;if(this.indexArray.emplaceBack(lt,lt+2,lt+1),this.indexArray.emplaceBack(lt+1,lt+2,lt+3),he.vertexLength+=4,he.primitiveLength+=2,A){const Gt=this.layoutVertexExtArray,Kt=w.projectTilePoint(Ae.x,Ae.y,u),St=w.projectTilePoint(ze.x,ze.y,u),yt=w.upVector(u,Ae.x,Ae.y),ii=w.upVector(u,ze.x,ze.y);ff(Gt,Kt,yt),ff(Gt,Kt,yt),ff(Gt,St,ii),ff(Gt,St,ii)}}}}}if(he.vertexLength+ee>mn.MAX_VERTEX_ARRAY_LENGTH&&(he=this.segments.prepareSegment(ee,this.layoutVertexArray,this.indexArray)),HP[e.type]!=="Polygon")continue;const ce=[],pe=[],ye=he.vertexLength;for(let ke=0;ke<K.length;ke++){const Pe=K[ke];if(Pe.length!==0){Pe!==K[0]&&pe.push(ce.length/2);for(let Fe=0;Fe<Pe.length;Fe++){const Xe=Pe[Fe];df(this.layoutVertexArray,Xe.x,Xe.y,0,0,1,1,0),ce.push(Xe.x),ce.push(Xe.y),k&&k.currentPolyCount.top++,A&&ff(this.layoutVertexExtArray,w.projectTilePoint(Xe.x,Xe.y,u),w.upVector(u,Xe.x,Xe.y))}}}const be=Km(ce,pe);for(let ke=0;ke<be.length;ke+=3)this.indexArray.emplaceBack(ye+be[ke],ye+be[ke+2],ye+be[ke+1]);he.primitiveLength+=be.length/3,he.vertexLength+=ee}if(k&&k.polyCount.length>0){if(k.borders){k.vertexArrayOffset=this.centroidVertexArray.length;const V=k.borders,K=this.featuresOnBorder.push(k)-1;for(let ee=0;ee<4;ee++)V[ee][0]!==Number.MAX_VALUE&&this.borders[ee].push(K)}this.encodeCentroid(k.borders?void 0:k.centroid(),k)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,f,m,u)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((o,l)=>this.featuresOnBorder[o].borders[e][0]-this.featuresOnBorder[l].borders[e][0])}encodeCentroid(e,o,l=!0){let u,f;if(e)if(e.y!==0){const y=o.span()._mult(this.tileToMeter);u=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(y.x/10)),f=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(y.y/10))}else u=Math.ceil(7*(e.x+450)),f=0;else u=0,f=+l;let m=l?this.centroidVertexArray.length:o.vertexArrayOffset;for(const y of o.polyCount){l&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*y.edges+y.top);for(let b=0;b<2*y.edges;b++)this.centroidVertexArray.emplace(m++,0,f),this.centroidVertexArray.emplace(m++,u,f);for(let b=0;b<y.top;b++)this.centroidVertexArray.emplace(m++,u,f)}}}function KP(r,e,o){return r.x===e.x&&(r.x<o[0].x||r.x>o[1].x)||r.y===e.y&&(r.y<o[0].y||r.y>o[1].y)}function Lw(){const r=Math.PI/32,e=Math.tan(r),o=ev;return o*Math.sqrt(1+2*e*e)-o}function zw(r,e,o){const l=1<<o.z,u=sr(o.x/l),f=sr((o.x+1)/l),m=Tn(o.y/l),y=Tn((o.y+1)/l);return function(b,w,A,k,D=0,R){const F=[];if(!b.length||!A||!k)return F;const V=(be,ke)=>{for(const Pe of be)F.push({polygon:Pe,bounds:ke})},K=Math.ceil(Math.log2(A)),ee=Math.ceil(Math.log2(k)),he=K-ee,ce=[];for(let be=0;be<Math.abs(he);be++)ce.push(he>0?0:1);for(let be=0;be<Math.min(K,ee);be++)ce.push(0),ce.push(1);let pe=b;if(pe=i_(pe,w[0].y-D,w[1].y+D,1),pe=i_(pe,w[0].x-D,w[1].x+D,0),!pe.length)return F;const ye=[];for(ce.length?ye.push({polygons:pe,bounds:w,depth:0}):V(pe,w);ye.length;){const be=ye.pop(),ke=be.depth,Pe=ce[ke],Fe=be.bounds[0],Xe=be.bounds[1],Ae=Pe===0?Fe.x:Fe.y,ze=Pe===0?Xe.x:Xe.y,Ke=R?R(Pe,Ae,ze):.5*(Ae+ze),Ye=i_(be.polygons,Ae-D,Ke+D,Pe),ht=i_(be.polygons,Ke-D,ze+D,Pe);if(Ye.length){const qe=[Fe,new P(Pe===0?Ke:Xe.x,Pe===1?Ke:Xe.y)];ce.length>ke+1?ye.push({polygons:Ye,bounds:qe,depth:ke+1}):V(Ye,qe)}if(ht.length){const qe=[new P(Pe===0?Ke:Fe.x,Pe===1?Ke:Fe.y),Xe];ce.length>ke+1?ye.push({polygons:ht,bounds:qe,depth:ke+1}):V(ht,qe)}}return F}(r,e,Math.ceil((f-u)/11.25),Math.ceil((m-y)/11.25),1,(b,w,A)=>{if(b===0)return .5*(w+A);{const k=Tn((o.y+w/Ot)/l);return(Zl(.5*(Tn((o.y+A/Ot)/l)+k))*l-o.y)*Ot}})}mt(pf,"FillExtrusionBucket",{omit:["layers","features"]}),mt(Dw,"PartMetadata");var YP={paint:new gt({"fill-extrusion-opacity":new ae(Ee["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ce(Ee["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ae(Ee["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ae(Ee["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Re(Ee["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ce(Ee["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ce(Ee["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ae(Ee["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Ow(r,e,o){var l=2*Math.PI*6378137/256/Math.pow(2,o);return[r*l-2*Math.PI*6378137/2,e*l-2*Math.PI*6378137/2]}class n_{constructor(e,o,l){this.z=e,this.x=o,this.y=l,this.key=mf(0,e,e,o,l)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,o){const l=function(f,m,y){var b=Ow(256*f,256*(m=Math.pow(2,y)-m-1),y),w=Ow(256*(f+1),256*(m+1),y);return b[0]+","+b[1]+","+w[0]+","+w[1]}(this.x,this.y,this.z),u=function(f,m,y){let b,w="";for(let A=f;A>0;A--)b=1<<A-1,w+=(m&b?1:0)+(y&b?2:0);return w}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",l)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Rw{constructor(e,o){this.wrap=e,this.canonical=o,this.key=mf(e,o.z,o.z,o.x,o.y)}}class lr{constructor(e,o,l,u,f){this.overscaledZ=e,this.wrap=o,this.canonical=new n_(l,+u,+f),this.key=o===0&&e===l?this.canonical.key:mf(o,e,l,u,f)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const o=this.canonical.z-e;return e>this.canonical.z?new lr(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new lr(e,this.wrap,e,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(e,o=!0){if(this.overscaledZ===e&&o)return this.key;if(e>this.canonical.z)return mf(this.wrap*+o,e,this.canonical.z,this.canonical.x,this.canonical.y);{const l=this.canonical.z-e;return mf(this.wrap*+o,e,e,this.canonical.x>>l,this.canonical.y>>l)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const o=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>o&&e.canonical.y===this.canonical.y>>o}children(e){if(this.overscaledZ>=e)return[new lr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,l=2*this.canonical.x,u=2*this.canonical.y;return[new lr(o,this.wrap,o,l,u),new lr(o,this.wrap,o,l+1,u),new lr(o,this.wrap,o,l,u+1),new lr(o,this.wrap,o,l+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new lr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new lr(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Rw(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function mf(r,e,o,l,u){const f=1<<Math.min(o,22);let m=f*(u%f)+l%f;return r&&o<22&&(m+=f*f*((r<0?-2*r-1:2*r)%(1<<2*(22-o)))),16*(32*m+o)+(e-o)}function _f(r,e){return r.x*e.x+r.y*e.y}function Bw(r,e){if(r.length===1){let o=0;const l=e[o++];let u;for(;!u||l.equals(u);)if(u=e[o++],!u)return 1/0;for(;o<e.length;o++){const f=e[o],m=r[0],y=u.sub(l),b=f.sub(l),w=m.sub(l),A=_f(y,y),k=_f(y,b),D=_f(b,b),R=_f(w,y),F=_f(w,b),V=A*D-k*k,K=(D*R-k*F)/V,ee=(A*F-k*R)/V,he=l.z*(1-K-ee)+u.z*K+f.z*ee;if(isFinite(he))return he}return 1/0}{let o=1/0;for(const l of e)o=Math.min(o,l.z);return o}}function r_(r){const e=new P(r[0],r[1]);return e.z=r[2],e}function Fw(r,e,o,l,u,f,m,y){const b=m*u.getElevationAt(r,e,!0,!0),w=f[0]!==0,A=w?f[1]===0?m*(f[0]/7-450):m*function(k,D,R){const F=Math.floor(D[0]/8),V=Math.floor(D[1]/8),K=10*(D[0]-8*F),ee=10*(D[1]-8*V),he=k.getElevationAt(F,V,!0,!0),ce=k.getMeterToDEM(R),pe=Math.floor(.5*(K*ce-1)),ye=Math.floor(.5*(ee*ce-1)),be=k.tileCoordToPixel(F,V),ke=2*pe+1,Pe=2*ye+1,Fe=function(ht,qe,lt,Gt,Kt){return[ht.getElevationAtPixel(qe,lt,!0),ht.getElevationAtPixel(qe+Kt,lt,!0),ht.getElevationAtPixel(qe,lt+Kt,!0),ht.getElevationAtPixel(qe+Gt,lt+Kt,!0)]}(k,be.x-pe,be.y-ye,ke,Pe),Xe=Math.abs(Fe[0]-Fe[1]),Ae=Math.abs(Fe[2]-Fe[3]),ze=Math.abs(Fe[0]-Fe[2])+Math.abs(Fe[1]-Fe[3]),Ke=Math.min(.25,.5*ce*(Xe+Ae)/ke),Ye=Math.min(.25,.5*ce*ze/Pe);return he+Math.max(Ke*K,Ye*ee)}(u,f,y):b;return{base:b+(o===0)?-1:o,top:w?Math.max(A+l,b+o+2):b+l}}mt(n_,"CanonicalTileID"),mt(lr,"OverscaledTileID",{omit:["projMatrix"]});const JP=_t([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:QP}=JP,eD=_t([{name:"a_packed",components:4,type:"Float32"}]),{members:tD}=eD,iD=Yl.VectorTileFeature.types,nD=Math.cos(Math.PI/180*37.5);class o_{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new ki,this.layoutVertexArray2=new Ui,this.indexArray=new ln,this.programConfigurations=new Gl(e.layers,e.zoom),this.segments=new mn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,l,u){this.hasPattern=xv("line",this.layers,o);const f=this.layers[0].layout.get("line-sort-key"),m=[];for(const{feature:A,id:k,index:D,sourceLayerIndex:R}of e){const F=this.layers[0]._featureFilter.needGeometry,V=Wl(A,F);if(!this.layers[0]._featureFilter.filter(new W(this.zoom),V,l))continue;const K=f?f.evaluate(V,{},l):void 0,ee={id:k,properties:A.properties,type:A.type,sourceLayerIndex:R,index:D,geometry:F?V.geometry:Hs(A,l,u),patterns:{},sortKey:K};m.push(ee)}f&&m.sort((A,k)=>A.sortKey-k.sortKey);const{lineAtlas:y,featureIndex:b}=o,w=this.addConstantDashes(y);for(const A of m){const{geometry:k,index:D,sourceLayerIndex:R}=A;if(w&&this.addFeatureDashes(A,y),this.hasPattern){const F=bv("line",this.layers,A,this.zoom,o);this.patternFeatures.push(F)}else this.addFeature(A,k,D,l,y.positions,o.availableImages);b.insert(e[D].feature,k,D,R,this.index)}}addConstantDashes(e){let o=!1;for(const l of this.layers){const u=l.paint.get("line-dasharray").value,f=l.layout.get("line-cap").value;if(u.kind!=="constant"||f.kind!=="constant")o=!0;else{const m=f.value,y=u.value;if(!y)continue;e.addDash(y.from,m),e.addDash(y.to,m),y.other&&e.addDash(y.other,m)}}return o}addFeatureDashes(e,o){const l=this.zoom;for(const u of this.layers){const f=u.paint.get("line-dasharray").value,m=u.layout.get("line-cap").value;if(f.kind==="constant"&&m.kind==="constant")continue;let y,b,w,A,k,D;if(f.kind==="constant"){const K=f.value;if(!K)continue;y=K.other||K.to,b=K.to,w=K.from}else y=f.evaluate({zoom:l-1},e),b=f.evaluate({zoom:l},e),w=f.evaluate({zoom:l+1},e);m.kind==="constant"?A=k=D=m.value:(A=m.evaluate({zoom:l-1},e),k=m.evaluate({zoom:l},e),D=m.evaluate({zoom:l+1},e)),o.addDash(y,A),o.addDash(b,k),o.addDash(w,D);const R=o.getKey(y,A),F=o.getKey(b,k),V=o.getKey(w,D);e.patterns[u.id]={min:R,mid:F,max:V}}}update(e,o,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l,u)}addFeatures(e,o,l,u,f){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,o,l,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,tD)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,QP),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,o,l,u,f,m){const y=this.layers[0].layout,b=y.get("line-join").evaluate(e,{}),w=y.get("line-cap").evaluate(e,{}),A=y.get("line-miter-limit"),k=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const D of o)this.addLine(D,e,b,w,A,k);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,f,m,u)}addLine(e,o,l,u,f,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ee=0;ee<e.length-1;ee++)this.totalDistance+=e[ee].dist(e[ee+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const y=iD[o.type]==="Polygon";let b=e.length;for(;b>=2&&e[b-1].equals(e[b-2]);)b--;let w=0;for(;w<b-1&&e[w].equals(e[w+1]);)w++;if(b<(y?3:2))return;l==="bevel"&&(f=1.05);const A=this.overscaling<=16?122880/(512*this.overscaling):0,k=this.segments.prepareSegment(10*b,this.layoutVertexArray,this.indexArray);let D,R,F,V,K;this.e1=this.e2=-1,y&&(D=e[b-2],K=e[w].sub(D)._unit()._perp());for(let ee=w;ee<b;ee++){if(F=ee===b-1?y?e[w+1]:void 0:e[ee+1],F&&e[ee].equals(F))continue;K&&(V=K),D&&(R=D),D=e[ee],K=F?F.sub(D)._unit()._perp():V,V=V||K;let he=V.add(K);he.x===0&&he.y===0||he._unit();const ce=V.x*K.x+V.y*K.y,pe=he.x*K.x+he.y*K.y,ye=pe!==0?1/pe:1/0,be=2*Math.sqrt(2-2*pe),ke=pe<nD&&R&&F,Pe=V.x*K.y-V.y*K.x>0;if(ke&&ee>w){const Ae=D.dist(R);if(Ae>2*A){const ze=D.sub(D.sub(R)._mult(A/Ae)._round());this.updateDistance(R,ze),this.addCurrentVertex(ze,V,0,0,k),R=ze}}const Fe=R&&F;let Xe=Fe?l:y?"butt":u;if(Fe&&Xe==="round"&&(ye<m?Xe="miter":ye<=2&&(Xe="fakeround")),Xe==="miter"&&ye>f&&(Xe="bevel"),Xe==="bevel"&&(ye>2&&(Xe="flipbevel"),ye<f&&(Xe="miter")),R&&this.updateDistance(R,D),Xe==="miter")he._mult(ye),this.addCurrentVertex(D,he,0,0,k);else if(Xe==="flipbevel"){if(ye>100)he=K.mult(-1);else{const Ae=ye*V.add(K).mag()/V.sub(K).mag();he._perp()._mult(Ae*(Pe?-1:1))}this.addCurrentVertex(D,he,0,0,k),this.addCurrentVertex(D,he.mult(-1),0,0,k)}else if(Xe==="bevel"||Xe==="fakeround"){const Ae=-Math.sqrt(ye*ye-1),ze=Pe?Ae:0,Ke=Pe?0:Ae;if(R&&this.addCurrentVertex(D,V,ze,Ke,k),Xe==="fakeround"){const Ye=Math.round(180*be/Math.PI/20);for(let ht=1;ht<Ye;ht++){let qe=ht/Ye;if(qe!==.5){const Gt=qe-.5;qe+=qe*Gt*(qe-1)*((1.0904+ce*(ce*(3.55645-1.43519*ce)-3.2452))*Gt*Gt+(.848013+ce*(.215638*ce-1.06021)))}const lt=K.sub(V)._mult(qe)._add(V)._unit()._mult(Pe?-1:1);this.addHalfVertex(D,lt.x,lt.y,!1,Pe,0,k)}}F&&this.addCurrentVertex(D,K,-ze,-Ke,k)}else if(Xe==="butt")this.addCurrentVertex(D,he,0,0,k);else if(Xe==="square"){const Ae=R?1:-1;R||this.addCurrentVertex(D,he,Ae,Ae,k),this.addCurrentVertex(D,he,0,0,k),R&&this.addCurrentVertex(D,he,Ae,Ae,k)}else Xe==="round"&&(R&&(this.addCurrentVertex(D,V,0,0,k),this.addCurrentVertex(D,V,1,1,k,!0)),F&&(this.addCurrentVertex(D,K,-1,-1,k,!0),this.addCurrentVertex(D,K,0,0,k)));if(ke&&ee<b-1){const Ae=D.dist(F);if(Ae>2*A){const ze=D.add(F.sub(D)._mult(A/Ae)._round());this.updateDistance(D,ze),this.addCurrentVertex(ze,K,0,0,k),D=ze}}}}addCurrentVertex(e,o,l,u,f,m=!1){const y=o.y*u-o.x,b=-o.y-o.x*u;this.addHalfVertex(e,o.x+o.y*l,o.y-o.x*l,m,!1,l,f),this.addHalfVertex(e,y,b,m,!0,-u,f)}addHalfVertex({x:e,y:o},l,u,f,m,y,b){this.layoutVertexArray.emplaceBack((e<<1)+(f?1:0),(o<<1)+(m?1:0),Math.round(63*l)+128,Math.round(63*u)+128,1+(y===0?0:y<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const w=b.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,w),b.primitiveLength++),m?this.e2=w:this.e1=w}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,o){this.distance+=e.dist(o),this.updateScaledDistance()}}mt(o_,"LineBucket",{omit:["layers","patternFeatures"]});const rD=new gt({"line-cap":new Ce(Ee.layout_line["line-cap"]),"line-join":new Ce(Ee.layout_line["line-join"]),"line-miter-limit":new ae(Ee.layout_line["line-miter-limit"]),"line-round-limit":new ae(Ee.layout_line["line-round-limit"]),"line-sort-key":new Ce(Ee.layout_line["line-sort-key"])});var Nw={paint:new gt({"line-opacity":new Ce(Ee.paint_line["line-opacity"]),"line-color":new Ce(Ee.paint_line["line-color"]),"line-translate":new ae(Ee.paint_line["line-translate"]),"line-translate-anchor":new ae(Ee.paint_line["line-translate-anchor"]),"line-width":new Ce(Ee.paint_line["line-width"]),"line-gap-width":new Ce(Ee.paint_line["line-gap-width"]),"line-offset":new Ce(Ee.paint_line["line-offset"]),"line-blur":new Ce(Ee.paint_line["line-blur"]),"line-dasharray":new Re(Ee.paint_line["line-dasharray"]),"line-pattern":new Re(Ee.paint_line["line-pattern"]),"line-gradient":new Oe(Ee.paint_line["line-gradient"]),"line-trim-offset":new ae(Ee.paint_line["line-trim-offset"])}),layout:rD};const Uw=new class extends Ce{possiblyEvaluate(r,e){return e=new W(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(r,e)}evaluate(r,e,o,l){return e=Ft({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(r,e,o,l)}}(Nw.paint.properties["line-width"].specification);function jw(r,e){return e>0?e+2*r:r}Uw.useIntegerZoom=!0;const oD=_t([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),sD=_t([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),aD=_t([{name:"a_projected_pos",components:4,type:"Float32"}],4);_t([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const lD=_t([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),cD=_t([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);_t([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Vw=_t([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),uD=_t([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);_t([{name:"triangle",components:3,type:"Uint16"}]),_t([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),_t([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),_t([{type:"Float32",name:"offsetX"}]),_t([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Zn=24;const ss=128;function wv(r,e){const{expression:o}=e;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new W(r+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:u}=o;let f=0;for(;f<l.length&&l[f]<=r;)f++;f=Math.max(0,f-1);let m=f;for(;m<l.length&&l[m]<r+1;)m++;m=Math.min(l.length-1,m);const y=l[f],b=l[m];return o.kind==="composite"?{kind:"composite",minZoom:y,maxZoom:b,interpolationType:u}:{kind:"camera",minZoom:y,maxZoom:b,minSize:o.evaluate(new W(y)),maxSize:o.evaluate(new W(b)),interpolationType:u}}}function s_(r,{uSize:e,uSizeT:o},{lowerSize:l,upperSize:u}){return r.kind==="source"?l/ss:r.kind==="composite"?yi(l/ss,u/ss,o):e}function Xu(r,e){let o=0,l=0;if(r.kind==="constant")l=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:u,minZoom:f,maxZoom:m}=r,y=u?Ge(uo.interpolationFactor(u,e,f,m),0,1):0;r.kind==="camera"?l=yi(r.minSize,r.maxSize,y):o=y}return{uSizeT:o,uSize:l}}var hD=Object.freeze({__proto__:null,getSizeData:wv,evaluateSizeForFeature:s_,evaluateSizeForZoom:Xu,SIZE_PACK_FACTOR:ss});function dD(r,e,o){return r.sections.forEach(l=>{l.text=function(u,f,m){const y=f.layout.get("text-transform").evaluate(m,{});return y==="uppercase"?u=u.toLocaleUpperCase():y==="lowercase"&&(u=u.toLocaleLowerCase()),Q.applyArabicShaping&&(u=Q.applyArabicShaping(u)),u}(l.text,e,o)}),r}const gf={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function fD(r){return r==="\uFE36"||r==="\uFE48"||r==="\uFE38"||r==="\uFE44"||r==="\uFE42"||r==="\uFE3E"||r==="\uFE3C"||r==="\uFE3A"||r==="\uFE18"||r==="\uFE40"||r==="\uFE10"||r==="\uFE13"||r==="\uFE14"||r==="\uFF40"||r==="\uFFE3"||r==="\uFE11"||r==="\uFE12"}function pD(r){return r==="\uFE35"||r==="\uFE47"||r==="\uFE37"||r==="\uFE43"||r==="\uFE41"||r==="\uFE3D"||r==="\uFE3B"||r==="\uFE39"||r==="\uFE17"||r==="\uFE3F"}var $w=function(r,e,o,l,u){var f,m,y=8*u-l-1,b=(1<<y)-1,w=b>>1,A=-7,k=o?u-1:0,D=o?-1:1,R=r[e+k];for(k+=D,f=R&(1<<-A)-1,R>>=-A,A+=y;A>0;f=256*f+r[e+k],k+=D,A-=8);for(m=f&(1<<-A)-1,f>>=-A,A+=l;A>0;m=256*m+r[e+k],k+=D,A-=8);if(f===0)f=1-w;else{if(f===b)return m?NaN:1/0*(R?-1:1);m+=Math.pow(2,l),f-=w}return(R?-1:1)*m*Math.pow(2,f-l)},Gw=function(r,e,o,l,u,f){var m,y,b,w=8*f-u-1,A=(1<<w)-1,k=A>>1,D=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,R=l?0:f-1,F=l?1:-1,V=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(y=isNaN(e)?1:0,m=A):(m=Math.floor(Math.log(e)/Math.LN2),e*(b=Math.pow(2,-m))<1&&(m--,b*=2),(e+=m+k>=1?D/b:D*Math.pow(2,1-k))*b>=2&&(m++,b/=2),m+k>=A?(y=0,m=A):m+k>=1?(y=(e*b-1)*Math.pow(2,u),m+=k):(y=e*Math.pow(2,k-1)*Math.pow(2,u),m=0));u>=8;r[o+R]=255&y,R+=F,y/=256,u-=8);for(m=m<<u|y,w+=u;w>0;r[o+R]=255&m,R+=F,m/=256,w-=8);r[o+R-F]|=128*V},yf=Vi;function Vi(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Vi.Varint=0,Vi.Fixed64=1,Vi.Bytes=2,Vi.Fixed32=5;var Ev=4294967296,qw=1/Ev,Zw=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Ks(r){return r.type===Vi.Bytes?r.readVarint()+r.pos:r.pos+1}function Ku(r,e,o){return o?4294967296*e+(r>>>0):4294967296*(e>>>0)+(r>>>0)}function Ww(r,e,o){var l=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));o.realloc(l);for(var u=o.pos-1;u>=r;u--)o.buf[u+l]=o.buf[u]}function mD(r,e){for(var o=0;o<r.length;o++)e.writeVarint(r[o])}function _D(r,e){for(var o=0;o<r.length;o++)e.writeSVarint(r[o])}function gD(r,e){for(var o=0;o<r.length;o++)e.writeFloat(r[o])}function yD(r,e){for(var o=0;o<r.length;o++)e.writeDouble(r[o])}function vD(r,e){for(var o=0;o<r.length;o++)e.writeBoolean(r[o])}function xD(r,e){for(var o=0;o<r.length;o++)e.writeFixed32(r[o])}function bD(r,e){for(var o=0;o<r.length;o++)e.writeSFixed32(r[o])}function wD(r,e){for(var o=0;o<r.length;o++)e.writeFixed64(r[o])}function ED(r,e){for(var o=0;o<r.length;o++)e.writeSFixed64(r[o])}function a_(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+16777216*r[e+3]}function Yu(r,e,o){r[o]=e,r[o+1]=e>>>8,r[o+2]=e>>>16,r[o+3]=e>>>24}function Hw(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+(r[e+3]<<24)}function TD(r,e,o){e.glyphs=[],r===1&&o.readMessage(CD,e)}function CD(r,e,o){if(r===3){const{id:l,bitmap:u,width:f,height:m,left:y,top:b,advance:w}=o.readMessage(SD,{});e.glyphs.push({id:l,bitmap:new Xs({width:f+6,height:m+6},u),metrics:{width:f,height:m,left:y,top:b,advance:w}})}else r===4?e.ascender=o.readSVarint():r===5&&(e.descender=o.readSVarint())}function SD(r,e,o){r===1?e.id=o.readVarint():r===2?e.bitmap=o.readBytes():r===3?e.width=o.readVarint():r===4?e.height=o.readVarint():r===5?e.left=o.readSVarint():r===6?e.top=o.readSVarint():r===7&&(e.advance=o.readVarint())}function Tv(r){let e=0,o=0;for(const m of r)e+=m.w*m.h,o=Math.max(o,m.w);r.sort((m,y)=>y.h-m.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),o),h:1/0}];let u=0,f=0;for(const m of r)for(let y=l.length-1;y>=0;y--){const b=l[y];if(!(m.w>b.w||m.h>b.h)){if(m.x=b.x,m.y=b.y,f=Math.max(f,m.y+m.h),u=Math.max(u,m.x+m.w),m.w===b.w&&m.h===b.h){const w=l.pop();y<l.length&&(l[y]=w)}else m.h===b.h?(b.x+=m.w,b.w-=m.w):m.w===b.w?(b.y+=m.h,b.h-=m.h):(l.push({x:b.x+m.w,y:b.y,w:b.w-m.w,h:m.h}),b.y+=m.h,b.h-=m.h);break}}return{w:u,h:f,fill:e/(u*f)||0}}Vi.prototype={destroy:function(){this.buf=null},readFields:function(r,e,o){for(o=o||this.length;this.pos<o;){var l=this.readVarint(),u=l>>3,f=this.pos;this.type=7&l,r(u,e,this),this.pos===f&&this.skip(l)}return e},readMessage:function(r,e){return this.readFields(r,e,this.readVarint()+this.pos)},readFixed32:function(){var r=a_(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=Hw(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=a_(this.buf,this.pos)+a_(this.buf,this.pos+4)*Ev;return this.pos+=8,r},readSFixed64:function(){var r=a_(this.buf,this.pos)+Hw(this.buf,this.pos+4)*Ev;return this.pos+=8,r},readFloat:function(){var r=$w(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=$w(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var e,o,l=this.buf;return e=127&(o=l[this.pos++]),o<128?e:(e|=(127&(o=l[this.pos++]))<<7,o<128?e:(e|=(127&(o=l[this.pos++]))<<14,o<128?e:(e|=(127&(o=l[this.pos++]))<<21,o<128?e:function(u,f,m){var y,b,w=m.buf;if(y=(112&(b=w[m.pos++]))>>4,b<128||(y|=(127&(b=w[m.pos++]))<<3,b<128)||(y|=(127&(b=w[m.pos++]))<<10,b<128)||(y|=(127&(b=w[m.pos++]))<<17,b<128)||(y|=(127&(b=w[m.pos++]))<<24,b<128)||(y|=(1&(b=w[m.pos++]))<<31,b<128))return Ku(u,y,f);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(o=l[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var r=this.readVarint()+this.pos,e=this.pos;return this.pos=r,r-e>=12&&Zw?function(o,l,u){return Zw.decode(o.subarray(l,u))}(this.buf,e,r):function(o,l,u){for(var f="",m=l;m<u;){var y,b,w,A=o[m],k=null,D=A>239?4:A>223?3:A>191?2:1;if(m+D>u)break;D===1?A<128&&(k=A):D===2?(192&(y=o[m+1]))==128&&(k=(31&A)<<6|63&y)<=127&&(k=null):D===3?(b=o[m+2],(192&(y=o[m+1]))==128&&(192&b)==128&&((k=(15&A)<<12|(63&y)<<6|63&b)<=2047||k>=55296&&k<=57343)&&(k=null)):D===4&&(b=o[m+2],w=o[m+3],(192&(y=o[m+1]))==128&&(192&b)==128&&(192&w)==128&&((k=(15&A)<<18|(63&y)<<12|(63&b)<<6|63&w)<=65535||k>=1114112)&&(k=null)),k===null?(k=65533,D=1):k>65535&&(k-=65536,f+=String.fromCharCode(k>>>10&1023|55296),k=56320|1023&k),f+=String.fromCharCode(k),m+=D}return f}(this.buf,e,r)},readBytes:function(){var r=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,r);return this.pos=r,e},readPackedVarint:function(r,e){if(this.type!==Vi.Bytes)return r.push(this.readVarint(e));var o=Ks(this);for(r=r||[];this.pos<o;)r.push(this.readVarint(e));return r},readPackedSVarint:function(r){if(this.type!==Vi.Bytes)return r.push(this.readSVarint());var e=Ks(this);for(r=r||[];this.pos<e;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Vi.Bytes)return r.push(this.readBoolean());var e=Ks(this);for(r=r||[];this.pos<e;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Vi.Bytes)return r.push(this.readFloat());var e=Ks(this);for(r=r||[];this.pos<e;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Vi.Bytes)return r.push(this.readDouble());var e=Ks(this);for(r=r||[];this.pos<e;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Vi.Bytes)return r.push(this.readFixed32());var e=Ks(this);for(r=r||[];this.pos<e;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Vi.Bytes)return r.push(this.readSFixed32());var e=Ks(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Vi.Bytes)return r.push(this.readFixed64());var e=Ks(this);for(r=r||[];this.pos<e;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Vi.Bytes)return r.push(this.readSFixed64());var e=Ks(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed64());return r},skip:function(r){var e=7&r;if(e===Vi.Varint)for(;this.buf[this.pos++]>127;);else if(e===Vi.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Vi.Fixed32)this.pos+=4;else{if(e!==Vi.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(r,e){this.writeVarint(r<<3|e)},realloc:function(r){for(var e=this.length||16;e<this.pos+r;)e*=2;if(e!==this.length){var o=new Uint8Array(e);o.set(this.buf),this.buf=o,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),Yu(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),Yu(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),Yu(this.buf,-1&r,this.pos),Yu(this.buf,Math.floor(r*qw),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),Yu(this.buf,-1&r,this.pos),Yu(this.buf,Math.floor(r*qw),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(e,o){var l,u;if(e>=0?(l=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(l=~(-e%4294967296))?l=l+1|0:(l=0,u=u+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(f,m,y){y.buf[y.pos++]=127&f|128,f>>>=7,y.buf[y.pos++]=127&f|128,f>>>=7,y.buf[y.pos++]=127&f|128,f>>>=7,y.buf[y.pos++]=127&f|128,y.buf[y.pos]=127&(f>>>=7)}(l,0,o),function(f,m){var y=(7&f)<<4;m.buf[m.pos++]|=y|((f>>>=3)?128:0),f&&(m.buf[m.pos++]=127&f|((f>>>=7)?128:0),f&&(m.buf[m.pos++]=127&f|((f>>>=7)?128:0),f&&(m.buf[m.pos++]=127&f|((f>>>=7)?128:0),f&&(m.buf[m.pos++]=127&f|((f>>>=7)?128:0),f&&(m.buf[m.pos++]=127&f)))))}(u,o)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(Boolean(r))},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var e=this.pos;this.pos=function(l,u,f){for(var m,y,b=0;b<u.length;b++){if((m=u.charCodeAt(b))>55295&&m<57344){if(!y){m>56319||b+1===u.length?(l[f++]=239,l[f++]=191,l[f++]=189):y=m;continue}if(m<56320){l[f++]=239,l[f++]=191,l[f++]=189,y=m;continue}m=y-55296<<10|m-56320|65536,y=null}else y&&(l[f++]=239,l[f++]=191,l[f++]=189,y=null);m<128?l[f++]=m:(m<2048?l[f++]=m>>6|192:(m<65536?l[f++]=m>>12|224:(l[f++]=m>>18|240,l[f++]=m>>12&63|128),l[f++]=m>>6&63|128),l[f++]=63&m|128)}return f}(this.buf,r,this.pos);var o=this.pos-e;o>=128&&Ww(e,o,this),this.pos=e-1,this.writeVarint(o),this.pos+=o},writeFloat:function(r){this.realloc(4),Gw(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),Gw(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var e=r.length;this.writeVarint(e),this.realloc(e);for(var o=0;o<e;o++)this.buf[this.pos++]=r[o]},writeRawMessage:function(r,e){this.pos++;var o=this.pos;r(e,this);var l=this.pos-o;l>=128&&Ww(o,l,this),this.pos=o-1,this.writeVarint(l),this.pos+=l},writeMessage:function(r,e,o){this.writeTag(r,Vi.Bytes),this.writeRawMessage(e,o)},writePackedVarint:function(r,e){e.length&&this.writeMessage(r,mD,e)},writePackedSVarint:function(r,e){e.length&&this.writeMessage(r,_D,e)},writePackedBoolean:function(r,e){e.length&&this.writeMessage(r,vD,e)},writePackedFloat:function(r,e){e.length&&this.writeMessage(r,gD,e)},writePackedDouble:function(r,e){e.length&&this.writeMessage(r,yD,e)},writePackedFixed32:function(r,e){e.length&&this.writeMessage(r,xD,e)},writePackedSFixed32:function(r,e){e.length&&this.writeMessage(r,bD,e)},writePackedFixed64:function(r,e){e.length&&this.writeMessage(r,wD,e)},writePackedSFixed64:function(r,e){e.length&&this.writeMessage(r,ED,e)},writeBytesField:function(r,e){this.writeTag(r,Vi.Bytes),this.writeBytes(e)},writeFixed32Field:function(r,e){this.writeTag(r,Vi.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(r,e){this.writeTag(r,Vi.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(r,e){this.writeTag(r,Vi.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(r,e){this.writeTag(r,Vi.Fixed64),this.writeSFixed64(e)},writeVarintField:function(r,e){this.writeTag(r,Vi.Varint),this.writeVarint(e)},writeSVarintField:function(r,e){this.writeTag(r,Vi.Varint),this.writeSVarint(e)},writeStringField:function(r,e){this.writeTag(r,Vi.Bytes),this.writeString(e)},writeFloatField:function(r,e){this.writeTag(r,Vi.Fixed32),this.writeFloat(e)},writeDoubleField:function(r,e){this.writeTag(r,Vi.Fixed64),this.writeDouble(e)},writeBooleanField:function(r,e){this.writeVarintField(r,Boolean(e))}};class Cv{constructor(e,{pixelRatio:o,version:l,stretchX:u,stretchY:f,content:m}){this.paddedRect=e,this.pixelRatio=o,this.stretchX=u,this.stretchY=f,this.content=m,this.version=l}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Xw{constructor(e,o){const l={},u={};this.haveRenderCallbacks=[];const f=[];this.addImages(e,l,f),this.addImages(o,u,f);const{w:m,h:y}=Tv(f),b=new Or({width:m||1,height:y||1});for(const w in e){const A=e[w],k=l[w].paddedRect;Or.copy(A.data,b,{x:0,y:0},{x:k.x+1,y:k.y+1},A.data)}for(const w in o){const A=o[w],k=u[w].paddedRect,D=k.x+1,R=k.y+1,F=A.data.width,V=A.data.height;Or.copy(A.data,b,{x:0,y:0},{x:D,y:R},A.data),Or.copy(A.data,b,{x:0,y:V-1},{x:D,y:R-1},{width:F,height:1}),Or.copy(A.data,b,{x:0,y:0},{x:D,y:R+V},{width:F,height:1}),Or.copy(A.data,b,{x:F-1,y:0},{x:D-1,y:R},{width:1,height:V}),Or.copy(A.data,b,{x:0,y:0},{x:D+F,y:R},{width:1,height:V})}this.image=b,this.iconPositions=l,this.patternPositions=u}addImages(e,o,l){for(const u in e){const f=e[u],m={x:0,y:0,w:f.data.width+2,h:f.data.height+2};l.push(m),o[u]=new Cv(m,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,o){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(l=>e.hasImage(l)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in e.updatedImages)this.patchUpdatedImage(this.iconPositions[l],e.getImage(l),o),this.patchUpdatedImage(this.patternPositions[l],e.getImage(l),o)}patchUpdatedImage(e,o,l){if(!e||!o||e.version===o.version)return;e.version=o.version;const[u,f]=e.tl;l.update(o.data,void 0,{x:u,y:f})}}mt(Cv,"ImagePosition"),mt(Xw,"ImageAtlas");const eo={horizontal:1,vertical:2,horizontalOnly:3};class vf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,o){const l=new vf;return l.scale=e||1,l.fontStack=o,l}static forImage(e){const o=new vf;return o.imageName=e,o}}class Ju{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,o){const l=new Ju;for(let u=0;u<e.sections.length;u++){const f=e.sections[u];f.image?l.addImageSection(f):l.addTextSection(f,o)}return l}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(o,l){let u="";for(let f=0;f<o.length;f++){const m=o.charCodeAt(f+1)||null,y=o.charCodeAt(f-1)||null;u+=!l&&(m&&p(m)&&!gf[o[f+1]]||y&&p(y)&&!gf[o[f-1]])||!gf[o[f]]?o[f]:gf[o[f]]}return u}(this.text,e)}trim(){let e=0;for(let l=0;l<this.text.length&&l_[this.text.charCodeAt(l)];l++)e++;let o=this.text.length;for(let l=this.text.length-1;l>=0&&l>=e&&l_[this.text.charCodeAt(l)];l--)o--;this.text=this.text.substring(e,o),this.sectionIndex=this.sectionIndex.slice(e,o)}substring(e,o){const l=new Ju;return l.text=this.text.substring(e,o),l.sectionIndex=this.sectionIndex.slice(e,o),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,o)=>Math.max(e,this.sections[o].scale),0)}addTextSection(e,o){this.text+=e.text,this.sections.push(vf.forText(e.scale,e.fontStack||o));const l=this.sections.length-1;for(let u=0;u<e.text.length;++u)this.sectionIndex.push(l)}addImageSection(e){const o=e.image?e.image.name:"";if(o.length===0)return void oi("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(vf.forImage(o)),this.sectionIndex.push(this.sections.length-1)):oi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Sv(r,e,o,l,u,f,m,y,b,w,A,k,D,R,F,V){const K=Ju.fromFeature(r,u);let ee;k===eo.vertical&&K.verticalizePunctuation(D);const{processBidirectionalText:he,processStyledBidirectionalText:ce}=Q;if(he&&K.sections.length===1){ee=[];const be=he(K.toString(),Av(K,w,f,e,l,R,F));for(const ke of be){const Pe=new Ju;Pe.text=ke,Pe.sections=K.sections;for(let Fe=0;Fe<ke.length;Fe++)Pe.sectionIndex.push(0);ee.push(Pe)}}else if(ce){ee=[];const be=ce(K.text,K.sectionIndex,Av(K,w,f,e,l,R,F));for(const ke of be){const Pe=new Ju;Pe.text=ke[0],Pe.sectionIndex=ke[1],Pe.sections=K.sections,ee.push(Pe)}}else ee=function(be,ke){const Pe=[],Fe=be.text;let Xe=0;for(const Ae of ke)Pe.push(be.substring(Xe,Ae)),Xe=Ae;return Xe<Fe.length&&Pe.push(be.substring(Xe,Fe.length)),Pe}(K,Av(K,w,f,e,l,R,F));const pe=[],ye={positionedLines:pe,text:K.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:k,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(be,ke,Pe,Fe,Xe,Ae,ze,Ke,Ye,ht,qe,lt){let Gt=0,Kt=0,St=0;const yt=Ke==="right"?1:Ke==="left"?0:.5;let ii=!1;for(const ni of Xe){const xi=ni.getSections();for(const $i of xi){if($i.imageName)continue;const Oi=ke[$i.fontStack];if(Oi&&(ii=Oi.ascender!==void 0&&Oi.descender!==void 0,!ii))break}if(!ii)break}let Zt=0;for(const ni of Xe){ni.trim();const xi=ni.getMaxScale(),$i=(xi-1)*Zn,Oi={positionedGlyphs:[],lineOffset:0};be.positionedLines[Zt]=Oi;const Li=Oi.positionedGlyphs;let Xi=0;if(!ni.length()){Kt+=Ae,++Zt;continue}let nn=0,Bn=0;for(let ui=0;ui<ni.length();ui++){const fn=ni.getSection(ui),Yn=ni.getSectionIndex(ui),Ai=ni.getCharCode(ui);let rn=fn.scale,ur=null,Yi=null,gn=null,Fn=Zn,On=0;const Wn=!(Ye===eo.horizontal||!qe&&!c(Ai)||qe&&(l_[Ai]||(Et=Ai,Am(Et)||Im(Et)||Vl(Et)||tf(Et)||nf(Et))));if(fn.imageName){const hr=Fe[fn.imageName];if(!hr)continue;gn=fn.imageName,be.iconsInText=be.iconsInText||!0,Yi=hr.paddedRect;const Nn=hr.displaySize;rn=rn*Zn/lt,ur={width:Nn[0],height:Nn[1],left:1,top:-3,advance:Wn?Nn[1]:Nn[0],localGlyph:!1},On=ii?-ur.height*rn:xi*Zn-17-Nn[1]*rn,Fn=ur.advance;const Js=(Wn?Nn[0]:Nn[1])*rn-Zn*xi;Js>0&&Js>Xi&&(Xi=Js)}else{const hr=Pe[fn.fontStack];if(!hr)continue;hr[Ai]&&(Yi=hr[Ai]);const Nn=ke[fn.fontStack];if(!Nn)continue;const Js=Nn.glyphs[Ai];if(!Js)continue;if(ur=Js.metrics,Fn=Ai!==8203?Zn:0,ii){const rh=Nn.ascender!==void 0?Math.abs(Nn.ascender):0,Mf=Nn.descender!==void 0?Math.abs(Nn.descender):0,kf=(rh+Mf)*rn;nn<kf&&(nn=kf,Bn=(rh-Mf)/2*rn),On=-rh*rn}else On=(xi-rn)*Zn-17}Wn?(be.verticalizable=!0,Li.push({glyph:Ai,imageName:gn,x:Gt,y:Kt+On,vertical:Wn,scale:rn,localGlyph:ur.localGlyph,fontStack:fn.fontStack,sectionIndex:Yn,metrics:ur,rect:Yi}),Gt+=Fn*rn+ht):(Li.push({glyph:Ai,imageName:gn,x:Gt,y:Kt+On,vertical:Wn,scale:rn,localGlyph:ur.localGlyph,fontStack:fn.fontStack,sectionIndex:Yn,metrics:ur,rect:Yi}),Gt+=ur.advance*rn+ht)}Li.length!==0&&(St=Math.max(Gt-ht,St),ii?eE(Li,yt,Xi,Bn,Ae*xi/2):eE(Li,yt,Xi,0,Ae/2)),Gt=0;const vr=Ae*xi+Xi;Oi.lineOffset=Math.max(Xi,$i),Kt+=vr,++Zt}var Et;const Cn=Kt,{horizontalAlign:_n,verticalAlign:dn}=Iv(ze);(function(ni,xi,$i,Oi,Li,Xi){const nn=(xi-$i)*Li,Bn=-Xi*Oi;for(const vr of ni)for(const ui of vr.positionedGlyphs)ui.x+=nn,ui.y+=Bn})(be.positionedLines,yt,_n,dn,St,Cn),be.top+=-dn*Cn,be.bottom=be.top+Cn,be.left+=-_n*St,be.right=be.left+St,be.hasBaseline=ii}(ye,e,o,l,ee,m,y,b,k,w,D,V),!function(be){for(const ke of be)if(ke.positionedGlyphs.length!==0)return!1;return!0}(pe)&&ye}const l_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},AD={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Kw(r,e,o,l,u,f){if(e.imageName){const m=l[e.imageName];return m?m.displaySize[0]*e.scale*Zn/f+u:0}{const m=o[e.fontStack],y=m&&m.glyphs[r];return y?y.metrics.advance*e.scale+u:0}}function Yw(r,e,o,l){const u=Math.pow(r-e,2);return l?r<e?u/2:2*u:u+Math.abs(o)*o}function ID(r,e,o){let l=0;return r===10&&(l-=1e4),o&&(l+=150),r!==40&&r!==65288||(l+=50),e!==41&&e!==65289||(l+=50),l}function Jw(r,e,o,l,u,f){let m=null,y=Yw(e,o,u,f);for(const b of l){const w=Yw(e-b.x,o,u,f)+b.badness;w<=y&&(m=b,y=w)}return{index:r,x:e,priorBreak:m,badness:y}}function Qw(r){return r?Qw(r.priorBreak).concat(r.index):[]}function Av(r,e,o,l,u,f,m){if(f!=="point")return[];if(!r)return[];const y=[],b=function(D,R,F,V,K,ee){let he=0;for(let ce=0;ce<D.length();ce++){const pe=D.getSection(ce);he+=Kw(D.getCharCode(ce),pe,V,K,R,ee)}return he/Math.max(1,Math.ceil(he/F))}(r,e,o,l,u,m),w=r.text.indexOf("\u200B")>=0;let A=0;for(let D=0;D<r.length();D++){const R=r.getSection(D),F=r.getCharCode(D);if(l_[F]||(A+=Kw(F,R,l,u,e,m)),D<r.length()-1){const V=!((k=F)<11904||!(Yd(k)||Kd(k)||Vs(k)||zm(k)||Uu(k)||Mm(k)||Jd(k)||Ru(k)||Pm(k)||ef(k)||Nu(k)||Vu(k)||Bu(k)||$l(k)||km(k)||Qd(k)||Fu(k)||Om(k)||ju(k)||Dm(k)));(AD[F]||V||R.imageName)&&y.push(Jw(D+1,A,b,y,ID(F,r.getCharCode(D+1),V&&w),!1))}}var k;return Qw(Jw(r.length(),A,b,y,0,!0))}function Iv(r){let e=.5,o=.5;switch(r){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:e,verticalAlign:o}}function eE(r,e,o,l,u){if(!(e||o||l||u))return;const f=r.length-1,m=r[f],y=(m.x+m.metrics.advance*m.scale)*e;for(let b=0;b<=f;b++)r[b].x-=y,r[b].y+=o+l+u}function MD(r,e,o){const{horizontalAlign:l,verticalAlign:u}=Iv(o),f=e[0]-r.displaySize[0]*l,m=e[1]-r.displaySize[1]*u;return{image:r,top:m,bottom:m+r.displaySize[1],left:f,right:f+r.displaySize[0]}}function tE(r,e,o,l,u,f){const m=r.image;let y;if(m.content){const K=m.content,ee=m.pixelRatio||1;y=[K[0]/ee,K[1]/ee,m.displaySize[0]-K[2]/ee,m.displaySize[1]-K[3]/ee]}const b=e.left*f,w=e.right*f;let A,k,D,R;o==="width"||o==="both"?(R=u[0]+b-l[3],k=u[0]+w+l[1]):(R=u[0]+(b+w-m.displaySize[0])/2,k=R+m.displaySize[0]);const F=e.top*f,V=e.bottom*f;return o==="height"||o==="both"?(A=u[1]+F-l[0],D=u[1]+V+l[2]):(A=u[1]+(F+V-m.displaySize[1])/2,D=A+m.displaySize[1]),{image:m,top:A,right:k,bottom:D,left:R,collisionPadding:y}}class Ys extends P{constructor(e,o,l,u,f){super(e,o),this.angle=u,this.z=l,f!==void 0&&(this.segment=f)}clone(){return new Ys(this.x,this.y,this.z,this.angle,this.segment)}}function iE(r,e,o,l,u){if(e.segment===void 0)return!0;let f=e,m=e.segment+1,y=0;for(;y>-o/2;){if(m--,m<0)return!1;y-=r[m].dist(f),f=r[m]}y+=r[m].dist(r[m+1]),m++;const b=[];let w=0;for(;y<o/2;){const A=r[m],k=r[m+1];if(!k)return!1;let D=r[m-1].angleTo(A)-A.angleTo(k);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:y,angleDelta:D}),w+=D;y-b[0].distance>l;)w-=b.shift().angleDelta;if(w>u)return!1;m++,y+=A.dist(k)}return!0}function nE(r){let e=0;for(let o=0;o<r.length-1;o++)e+=r[o].dist(r[o+1]);return e}function rE(r,e,o){return r?.6*e*o:0}function oE(r,e){return Math.max(r?r.right-r.left:0,e?e.right-e.left:0)}function kD(r,e,o,l,u,f){const m=rE(o,u,f),y=oE(o,l)*f;let b=0;const w=nE(r)/2;for(let A=0;A<r.length-1;A++){const k=r[A],D=r[A+1],R=k.dist(D);if(b+R>w){const F=(w-b)/R,V=yi(k.x,D.x,F),K=yi(k.y,D.y,F),ee=new Ys(V,K,0,D.angleTo(k),A);return!m||iE(r,ee,y,m,e)?ee:void 0}b+=R}}function PD(r,e,o,l,u,f,m,y,b){const w=rE(l,f,m),A=oE(l,u),k=A*m,D=r[0].x===0||r[0].x===b||r[0].y===0||r[0].y===b;return e-k<e/4&&(e=k+e/4),sE(r,D?e/2*y%e:(A/2+2*f)*m*y%e,e,w,o,k,D,!1,b)}function sE(r,e,o,l,u,f,m,y,b){const w=f/2,A=nE(r);let k=0,D=e-o,R=[];for(let F=0;F<r.length-1;F++){const V=r[F],K=r[F+1],ee=V.dist(K),he=K.angleTo(V);for(;D+o<k+ee;){D+=o;const ce=(D-k)/ee,pe=yi(V.x,K.x,ce),ye=yi(V.y,K.y,ce);if(pe>=0&&pe<b&&ye>=0&&ye<b&&D-w>=0&&D+w<=A){const be=new Ys(pe,ye,0,he,F);be._round(),l&&!iE(r,be,f,l,u)||R.push(be)}}k+=ee}return y||R.length||m||(R=sE(r,k/2,o,l,u,f,m,!0,b)),R}function aE(r,e,o,l,u){const f=[];for(let m=0;m<r.length;m++){const y=r[m];let b;for(let w=0;w<y.length-1;w++){let A=y[w],k=y[w+1];A.x<e&&k.x<e||(A.x<e?A=new P(e,A.y+(e-A.x)/(k.x-A.x)*(k.y-A.y))._round():k.x<e&&(k=new P(e,A.y+(e-A.x)/(k.x-A.x)*(k.y-A.y))._round()),A.y<o&&k.y<o||(A.y<o?A=new P(A.x+(o-A.y)/(k.y-A.y)*(k.x-A.x),o)._round():k.y<o&&(k=new P(A.x+(o-A.y)/(k.y-A.y)*(k.x-A.x),o)._round()),A.x>=l&&k.x>=l||(A.x>=l?A=new P(l,A.y+(l-A.x)/(k.x-A.x)*(k.y-A.y))._round():k.x>=l&&(k=new P(l,A.y+(l-A.x)/(k.x-A.x)*(k.y-A.y))._round()),A.y>=u&&k.y>=u||(A.y>=u?A=new P(A.x+(u-A.y)/(k.y-A.y)*(k.x-A.x),u)._round():k.y>=u&&(k=new P(A.x+(u-A.y)/(k.y-A.y)*(k.x-A.x),u)._round()),b&&A.equals(b[b.length-1])||(b=[A],f.push(b)),b.push(k)))))}}return f}mt(Ys,"Anchor");const xf=1e20;function lE(r,e,o,l,u,f,m,y,b){for(let w=e;w<e+l;w++)cE(r,o*f+w,f,u,m,y,b);for(let w=o;w<o+u;w++)cE(r,w*f+e,1,l,m,y,b)}function cE(r,e,o,l,u,f,m){f[0]=0,m[0]=-xf,m[1]=xf,u[0]=r[e];for(let y=1,b=0,w=0;y<l;y++){u[y]=r[e+y*o];const A=y*y;do{const k=f[b];w=(u[y]-u[k]+A-k*k)/(y-k)/2}while(w<=m[b]&&--b>-1);b++,f[b]=y,m[b]=w,m[b+1]=xf}for(let y=0,b=0;y<l;y++){for(;m[b+1]<y;)b++;const w=f[b],A=y-w;r[e+y*o]=u[w]+A*A}}const Mv={none:0,ideographs:1,all:2};class Qu{constructor(e,o,l){this.requestManager=e,this.localGlyphMode=o,this.localFontFamily=l,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,o){const l=[];for(const u in e)for(const f of e[u])l.push({stack:u,id:f});jt(l,({stack:u,id:f},m)=>{let y=this.entries[u];y||(y=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let b=y.glyphs[f];if(b!==void 0)return void m(null,{stack:u,id:f,glyph:b});if(b=this._tinySDF(y,u,f),b)return y.glyphs[f]=b,void m(null,{stack:u,id:f,glyph:b});const w=Math.floor(f/256);if(256*w>65535)return void m(new Error("glyphs > 65535 not supported"));if(y.ranges[w])return void m(null,{stack:u,id:f,glyph:b});let A=y.requests[w];A||(A=y.requests[w]=[],Qu.loadGlyphRange(u,w,this.url,this.requestManager,(k,D)=>{if(D){y.ascender=D.ascender,y.descender=D.descender;for(const R in D.glyphs)this._doesCharSupportLocalGlyph(+R)||(y.glyphs[+R]=D.glyphs[+R]);y.ranges[w]=!0}for(const R of A)R(k,D);delete y.requests[w]})),A.push((k,D)=>{k?m(k):D&&m(null,{stack:u,id:f,glyph:D.glyphs[f]||null})})},(u,f)=>{if(u)o(u);else if(f){const m={};for(const{stack:y,id:b,glyph:w}of f)m[y]===void 0&&(m[y]={}),m[y].glyphs===void 0&&(m[y].glyphs={}),m[y].glyphs[b]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics},m[y].ascender=this.entries[y].ascender,m[y].descender=this.entries[y].descender;o(null,m)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Mv.none&&(this.localGlyphMode===Mv.all?!!this.localFontFamily:!!this.localFontFamily&&(ef(e)||Lm(e)||Bu(e)||Fu(e)||Ru(e)))}_tinySDF(e,o,l){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(l))return;let f=e.tinySDF;if(!f){let V="400";/bold/i.test(o)?V="900":/medium/i.test(o)?V="500":/light/i.test(o)&&(V="200"),f=e.tinySDF=new Qu.TinySDF({fontFamily:u,fontWeight:V,fontSize:48,buffer:6,radius:16}),f.fontWeight=V}if(this.localGlyphs[f.fontWeight][l])return this.localGlyphs[f.fontWeight][l];const m=String.fromCharCode(l),{data:y,width:b,height:w,glyphWidth:A,glyphHeight:k,glyphLeft:D,glyphTop:R,glyphAdvance:F}=f.draw(m);return this.localGlyphs[f.fontWeight][l]={id:l,bitmap:new Xs({width:b,height:w},y),metrics:{width:A/2,height:k/2,left:D/2,top:R/2-27,advance:F/2,localGlyph:!0}}}}function uE(r,e,o,l){const u=[],f=r.image,m=f.pixelRatio,y=f.paddedRect.w-2,b=f.paddedRect.h-2,w=r.right-r.left,A=r.bottom-r.top,k=f.stretchX||[[0,y]],D=f.stretchY||[[0,b]],R=(Ae,ze)=>Ae+ze[1]-ze[0],F=k.reduce(R,0),V=D.reduce(R,0),K=y-F,ee=b-V;let he=0,ce=F,pe=0,ye=V,be=0,ke=K,Pe=0,Fe=ee;if(f.content&&l){const Ae=f.content;he=c_(k,0,Ae[0]),pe=c_(D,0,Ae[1]),ce=c_(k,Ae[0],Ae[2]),ye=c_(D,Ae[1],Ae[3]),be=Ae[0]-he,Pe=Ae[1]-pe,ke=Ae[2]-Ae[0]-ce,Fe=Ae[3]-Ae[1]-ye}const Xe=(Ae,ze,Ke,Ye)=>{const ht=u_(Ae.stretch-he,ce,w,r.left),qe=h_(Ae.fixed-be,ke,Ae.stretch,F),lt=u_(ze.stretch-pe,ye,A,r.top),Gt=h_(ze.fixed-Pe,Fe,ze.stretch,V),Kt=u_(Ke.stretch-he,ce,w,r.left),St=h_(Ke.fixed-be,ke,Ke.stretch,F),yt=u_(Ye.stretch-pe,ye,A,r.top),ii=h_(Ye.fixed-Pe,Fe,Ye.stretch,V),Zt=new P(ht,lt),Et=new P(Kt,lt),Cn=new P(Kt,yt),_n=new P(ht,yt),dn=new P(qe/m,Gt/m),ni=new P(St/m,ii/m),xi=e*Math.PI/180;if(xi){const Li=Math.sin(xi),Xi=Math.cos(xi),nn=[Xi,-Li,Li,Xi];Zt._matMult(nn),Et._matMult(nn),_n._matMult(nn),Cn._matMult(nn)}const $i=Ae.stretch+Ae.fixed,Oi=ze.stretch+ze.fixed;return{tl:Zt,tr:Et,bl:_n,br:Cn,tex:{x:f.paddedRect.x+1+$i,y:f.paddedRect.y+1+Oi,w:Ke.stretch+Ke.fixed-$i,h:Ye.stretch+Ye.fixed-Oi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:dn,pixelOffsetBR:ni,minFontScaleX:ke/m/w,minFontScaleY:Fe/m/A,isSDF:o}};if(l&&(f.stretchX||f.stretchY)){const Ae=hE(k,K,F),ze=hE(D,ee,V);for(let Ke=0;Ke<Ae.length-1;Ke++){const Ye=Ae[Ke],ht=Ae[Ke+1];for(let qe=0;qe<ze.length-1;qe++)u.push(Xe(Ye,ze[qe],ht,ze[qe+1]))}}else u.push(Xe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:y+1},{fixed:0,stretch:b+1}));return u}function c_(r,e,o){let l=0;for(const u of r)l+=Math.max(e,Math.min(o,u[1]))-Math.max(e,Math.min(o,u[0]));return l}function hE(r,e,o){const l=[{fixed:-1,stretch:0}];for(const[u,f]of r){const m=l[l.length-1];l.push({fixed:u-m.stretch,stretch:m.stretch}),l.push({fixed:u-m.stretch,stretch:m.stretch+(f-u)})}return l.push({fixed:e+1,stretch:o}),l}function u_(r,e,o,l){return r/e*o+l}function h_(r,e,o,l){return r-e*o/l}function DD(r,e,o,l){const u=e+r.positionedLines[l].lineOffset;return l===0?o+u/2:o+(u+(e+r.positionedLines[l-1].lineOffset))/2}Qu.loadGlyphRange=function(r,e,o,l,u){const f=256*e,m=f+255,y=l.transformRequest(l.normalizeGlyphsURL(o).replace("{fontstack}",r).replace("{range}",`${f}-${m}`),re.Glyphs);ve(y,(b,w)=>{if(b)u(b);else if(w){const A={},k=function(D){return new yf(D).readFields(TD,{})}(w);for(const D of k.glyphs)A[D.id]=D;u(null,{glyphs:A,ascender:k.ascender,descender:k.descender})}})},Qu.TinySDF=class{constructor({fontSize:r=24,buffer:e=3,radius:o=8,cutoff:l=.25,fontFamily:u="sans-serif",fontWeight:f="normal",fontStyle:m="normal"}={}){this.buffer=e,this.cutoff=l,this.radius=o;const y=this.size=r+4*e,b=this._createCanvas(y),w=this.ctx=b.getContext("2d",{willReadFrequently:!0});w.font=`${m} ${f} ${r}px ${u}`,w.textBaseline="alphabetic",w.textAlign="left",w.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Uint16Array(y)}_createCanvas(r){const e=document.createElement("canvas");return e.width=e.height=r,e}draw(r){const{width:e,actualBoundingBoxAscent:o,actualBoundingBoxDescent:l,actualBoundingBoxLeft:u,actualBoundingBoxRight:f}=this.ctx.measureText(r),m=Math.ceil(o),y=Math.min(this.size-this.buffer,Math.ceil(f-u)),b=Math.min(this.size-this.buffer,m+Math.ceil(l)),w=y+2*this.buffer,A=b+2*this.buffer,k=Math.max(w*A,0),D=new Uint8ClampedArray(k),R={data:D,width:w,height:A,glyphWidth:y,glyphHeight:b,glyphTop:m,glyphLeft:0,glyphAdvance:e};if(y===0||b===0)return R;const{ctx:F,buffer:V,gridInner:K,gridOuter:ee}=this;F.clearRect(V,V,y,b),F.fillText(r,V,V+m);const he=F.getImageData(V,V,y,b);ee.fill(xf,0,k),K.fill(0,0,k);for(let ce=0;ce<b;ce++)for(let pe=0;pe<y;pe++){const ye=he.data[4*(ce*y+pe)+3]/255;if(ye===0)continue;const be=(ce+V)*w+pe+V;if(ye===1)ee[be]=0,K[be]=xf;else{const ke=.5-ye;ee[be]=ke>0?ke*ke:0,K[be]=ke<0?ke*ke:0}}lE(ee,0,0,w,A,w,this.f,this.v,this.z),lE(K,V,V,y,b,w,this.f,this.v,this.z);for(let ce=0;ce<k;ce++){const pe=Math.sqrt(ee[ce])-Math.sqrt(K[ce]);D[ce]=Math.round(255-255*(pe/this.radius+this.cutoff))}return R}};class LD{constructor(e=[],o=zD){if(this.data=e,this.length=this.data.length,this.compare=o,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:o,compare:l}=this,u=o[e];for(;e>0;){const f=e-1>>1,m=o[f];if(l(u,m)>=0)break;o[e]=m,e=f}o[e]=u}_down(e){const{data:o,compare:l}=this,u=this.length>>1,f=o[e];for(;e<u;){let m=1+(e<<1),y=o[m];const b=m+1;if(b<this.length&&l(o[b],y)<0&&(m=b,y=o[b]),l(y,f)>=0)break;o[e]=y,e=m}o[e]=f}}function zD(r,e){return r<e?-1:r>e?1:0}function OD(r,e=1,o=!1){let l=1/0,u=1/0,f=-1/0,m=-1/0;const y=r[0];for(let R=0;R<y.length;R++){const F=y[R];(!R||F.x<l)&&(l=F.x),(!R||F.y<u)&&(u=F.y),(!R||F.x>f)&&(f=F.x),(!R||F.y>m)&&(m=F.y)}const b=Math.min(f-l,m-u);let w=b/2;const A=new LD([],RD);if(b===0)return new P(l,u);for(let R=l;R<f;R+=b)for(let F=u;F<m;F+=b)A.push(new eh(R+w,F+w,w,r));let k=function(R){let F=0,V=0,K=0;const ee=R[0];for(let he=0,ce=ee.length,pe=ce-1;he<ce;pe=he++){const ye=ee[he],be=ee[pe],ke=ye.x*be.y-be.x*ye.y;V+=(ye.x+be.x)*ke,K+=(ye.y+be.y)*ke,F+=3*ke}return new eh(V/F,K/F,0,R)}(r),D=A.length;for(;A.length;){const R=A.pop();(R.d>k.d||!k.d)&&(k=R,o&&console.log("found best %d after %d probes",Math.round(1e4*R.d)/1e4,D)),R.max-k.d<=e||(w=R.h/2,A.push(new eh(R.p.x-w,R.p.y-w,w,r)),A.push(new eh(R.p.x+w,R.p.y-w,w,r)),A.push(new eh(R.p.x-w,R.p.y+w,w,r)),A.push(new eh(R.p.x+w,R.p.y+w,w,r)),D+=4)}return o&&(console.log(`num probes: ${D}`),console.log(`best distance: ${k.d}`)),k.p}function RD(r,e){return e.max-r.max}function eh(r,e,o,l){this.p=new P(r,e),this.h=o,this.d=function(u,f){let m=!1,y=1/0;for(let b=0;b<f.length;b++){const w=f[b];for(let A=0,k=w.length,D=k-1;A<k;D=A++){const R=w[A],F=w[D];R.y>u.y!=F.y>u.y&&u.x<(F.x-R.x)*(u.y-R.y)/(F.y-R.y)+R.x&&(m=!m),y=Math.min(y,rw(u,R,F))}}return(m?1:-1)*Math.sqrt(y)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}const kv=Number.POSITIVE_INFINITY,BD=Math.sqrt(2);function dE(r,e){return e[1]!==kv?function(o,l,u){let f=0,m=0;switch(l=Math.abs(l),u=Math.abs(u),o){case"top-right":case"top-left":case"top":m=u-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-u}switch(o){case"top-right":case"bottom-right":case"right":f=-l;break;case"top-left":case"bottom-left":case"left":f=l}return[f,m]}(r,e[0],e[1]):function(o,l){let u=0,f=0;l<0&&(l=0);const m=l/BD;switch(o){case"top-right":case"top-left":f=m-7;break;case"bottom-right":case"bottom-left":f=7-m;break;case"bottom":f=7-l;break;case"top":f=l-7}switch(o){case"top-right":case"bottom-right":u=-m;break;case"top-left":case"bottom-left":u=m;break;case"left":u=l;break;case"right":u=-l}return[u,f]}(r,e[0])}function FD(r,e,o,l,u,f,m,y,b,w){r.createArrays(),r.tilePixelRatio=Ot/(512*r.overscaling),r.compareText={},r.iconsNeedLinear=!1;const A=r.layers[0].layout,k=r.layers[0]._unevaluatedLayout._values,D={};if(r.textSizeData.kind==="composite"){const{minZoom:V,maxZoom:K}=r.textSizeData;D.compositeTextSizes=[k["text-size"].possiblyEvaluate(new W(V),y),k["text-size"].possiblyEvaluate(new W(K),y)]}if(r.iconSizeData.kind==="composite"){const{minZoom:V,maxZoom:K}=r.iconSizeData;D.compositeIconSizes=[k["icon-size"].possiblyEvaluate(new W(V),y),k["icon-size"].possiblyEvaluate(new W(K),y)]}D.layoutTextSize=k["text-size"].possiblyEvaluate(new W(b+1),y),D.layoutIconSize=k["icon-size"].possiblyEvaluate(new W(b+1),y),D.textMaxSize=k["text-size"].possiblyEvaluate(new W(18),y);const R=A.get("text-rotation-alignment")==="map"&&A.get("symbol-placement")!=="point",F=A.get("text-size");for(const V of r.features){const K=A.get("text-font").evaluate(V,{},y).join(","),ee=F.evaluate(V,{},y),he=D.layoutTextSize.evaluate(V,{},y),ce=(D.layoutIconSize.evaluate(V,{},y),{horizontal:{},vertical:void 0}),pe=V.text;let ye,be=[0,0];if(pe){const Fe=pe.toString(),Xe=A.get("text-letter-spacing").evaluate(V,{},y)*Zn,Ae=A.get("text-line-height").evaluate(V,{},y)*Zn,ze=d(Fe)?Xe:0,Ke=A.get("text-anchor").evaluate(V,{},y),Ye=A.get("text-variable-anchor");if(!Ye){const St=A.get("text-radial-offset").evaluate(V,{},y);be=St?dE(Ke,[St*Zn,kv]):A.get("text-offset").evaluate(V,{},y).map(yt=>yt*Zn)}let ht=R?"center":A.get("text-justify").evaluate(V,{},y);const qe=A.get("symbol-placement"),lt=qe==="point",Gt=qe==="point"?A.get("text-max-width").evaluate(V,{},y)*Zn:0,Kt=St=>{r.allowVerticalPlacement&&Pa(Fe)&&(ce.vertical=Sv(pe,e,o,u,K,Gt,Ae,Ke,St,ze,be,eo.vertical,!0,qe,he,ee))};if(!R&&Ye){const St=ht==="auto"?Ye.map(ii=>Pv(ii)):[ht];let yt=!1;for(let ii=0;ii<St.length;ii++){const Zt=St[ii];if(!ce.horizontal[Zt])if(yt)ce.horizontal[Zt]=ce.horizontal[0];else{const Et=Sv(pe,e,o,u,K,Gt,Ae,"center",Zt,ze,be,eo.horizontal,!1,qe,he,ee);Et&&(ce.horizontal[Zt]=Et,yt=Et.positionedLines.length===1)}}Kt("left")}else{if(ht==="auto"&&(ht=Pv(Ke)),lt||A.get("text-writing-mode").indexOf("horizontal")>=0||!Pa(Fe)){const St=Sv(pe,e,o,u,K,Gt,Ae,Ke,ht,ze,be,eo.horizontal,!1,qe,he,ee);St&&(ce.horizontal[ht]=St)}Kt(qe==="point"?"left":ht)}}let ke=!1;if(V.icon&&V.icon.name){const Fe=l[V.icon.name];Fe&&(ye=MD(u[V.icon.name],A.get("icon-offset").evaluate(V,{},y),A.get("icon-anchor").evaluate(V,{},y)),ke=Fe.sdf,r.sdfIcons===void 0?r.sdfIcons=Fe.sdf:r.sdfIcons!==Fe.sdf&&oi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Fe.pixelRatio!==r.pixelRatio||A.get("icon-rotate").constantOr(1)!==0)&&(r.iconsNeedLinear=!0))}const Pe=pE(ce.horizontal)||ce.vertical;r.iconsInText||(r.iconsInText=!!Pe&&Pe.iconsInText),(Pe||ye)&&ND(r,V,ce,ye,l,D,he,0,be,ke,m,y,w)}f&&r.generateCollisionDebugBuffers(b,r.collisionBoxArray)}function Pv(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ND(r,e,o,l,u,f,m,y,b,w,A,k,D){let R=f.textMaxSize.evaluate(e,{},k);R===void 0&&(R=m);const F=r.layers[0].layout,V=F.get("icon-offset").evaluate(e,{},k),K=pE(o.horizontal)||o.vertical,ee=D.name==="globe",he=m/24,ce=r.tilePixelRatio*R/24,pe=(ze=r.overscaling,r.zoom>18&&ze>2&&(ze>>=1),Math.max(Ot/(512*ze),1)*F.get("symbol-spacing")),ye=F.get("text-padding")*r.tilePixelRatio,be=F.get("icon-padding")*r.tilePixelRatio,ke=ue(F.get("text-max-angle")),Pe=F.get("text-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",Fe=F.get("icon-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",Xe=F.get("symbol-placement"),Ae=pe/2;var ze;const Ke=F.get("icon-text-fit");let Ye;l&&Ke!=="none"&&(r.allowVerticalPlacement&&o.vertical&&(Ye=tE(l,o.vertical,Ke,F.get("icon-text-fit-padding"),V,he)),K&&(l=tE(l,K,Ke,F.get("icon-text-fit-padding"),V,he)));const ht=(qe,lt,Gt)=>{if(lt.x<0||lt.x>=Ot||lt.y<0||lt.y>=Ot)return;let Kt=null;if(ee){const{x:St,y:yt,z:ii}=D.projectTilePoint(lt.x,lt.y,Gt);Kt={anchor:new Ys(St,yt,ii,0,void 0),up:D.upVector(Gt,lt.x,lt.y)}}(function(St,yt,ii,Zt,Et,Cn,_n,dn,ni,xi,$i,Oi,Li,Xi,nn,Bn,vr,ui,fn,Yn,Ai,rn,ur,Yi,gn){const Fn=St.addToLineVertexArray(yt,Zt);let On,Wn,hr,Nn,Js,rh,Mf,kf=0,YE=0,JE=0,QE=0,Hv=-1,Xv=-1;const hs={};let eT=rf("");const tc=ii?ii.anchor:yt;let Kv=0,Yv=0;if(ni._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Kv,Yv]=ni.layout.get("text-offset").evaluate(Ai,{},gn).map(Fr=>Fr*Zn):(Kv=ni.layout.get("text-radial-offset").evaluate(Ai,{},gn)*Zn,Yv=kv),St.allowVerticalPlacement&&Et.vertical){const Fr=Et.vertical;if(nn)rh=Dv(Fr),dn&&(Mf=Dv(dn));else{const Nr=ni.layout.get("text-rotate").evaluate(Ai,{},gn)+90;hr=d_(xi,tc,yt,$i,Oi,Li,Fr,Xi,Nr,Bn),dn&&(Nn=d_(xi,tc,yt,$i,Oi,Li,dn,ui,Nr))}}if(Cn){const Fr=ni.layout.get("icon-rotate").evaluate(Ai,{},gn),Nr=ni.layout.get("icon-text-fit")!=="none",Pf=uE(Cn,Fr,ur,Nr),Qv=dn?uE(dn,Fr,ur,Nr):void 0;Wn=d_(xi,tc,yt,$i,Oi,Li,Cn,ui,Fr),kf=4*Pf.length;const tT=St.iconSizeData;let ic=null;tT.kind==="source"?(ic=[ss*ni.layout.get("icon-size").evaluate(Ai,{},gn)],ic[0]>Na&&oi(`${St.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):tT.kind==="composite"&&(ic=[ss*rn.compositeIconSizes[0].evaluate(Ai,{},gn),ss*rn.compositeIconSizes[1].evaluate(Ai,{},gn)],(ic[0]>Na||ic[1]>Na)&&oi(`${St.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),St.addSymbols(St.icon,Pf,ic,Yn,fn,Ai,!1,ii,yt,Fn.lineStartIndex,Fn.lineLength,-1,Yi,gn),Hv=St.icon.placedSymbolArray.length-1,Qv&&(YE=4*Qv.length,St.addSymbols(St.icon,Qv,ic,Yn,fn,Ai,eo.vertical,ii,yt,Fn.lineStartIndex,Fn.lineLength,-1,Yi,gn),Xv=St.icon.placedSymbolArray.length-1)}for(const Fr in Et.horizontal){const Nr=Et.horizontal[Fr];On||(eT=rf(Nr.text),nn?Js=Dv(Nr):On=d_(xi,tc,yt,$i,Oi,Li,Nr,Xi,ni.layout.get("text-rotate").evaluate(Ai,{},gn),Bn));const Pf=Nr.positionedLines.length===1;if(JE+=fE(St,ii,yt,Nr,_n,ni,nn,Ai,Bn,Fn,Et.vertical?eo.horizontal:eo.horizontalOnly,Pf?Object.keys(Et.horizontal):[Fr],hs,Hv,rn,Yi,gn),Pf)break}Et.vertical&&(QE+=fE(St,ii,yt,Et.vertical,_n,ni,nn,Ai,Bn,Fn,eo.vertical,["vertical"],hs,Xv,rn,Yi,gn));let qa=-1;const Jv=(Fr,Nr)=>Fr?Math.max(Fr,Nr):Nr;qa=Jv(Js,qa),qa=Jv(rh,qa),qa=Jv(Mf,qa);const gL=qa>-1?1:0;St.glyphOffsetArray.length>=ja.MAX_GLYPHS&&oi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ai.sortKey!==void 0&&St.addToSortKeyRanges(St.symbolInstances.length,Ai.sortKey),St.symbolInstances.emplaceBack(tc.x,tc.y,tc.z,yt.x,yt.y,hs.right>=0?hs.right:-1,hs.center>=0?hs.center:-1,hs.left>=0?hs.left:-1,hs.vertical>=0?hs.vertical:-1,Hv,Xv,eT,On!==void 0?On:St.collisionBoxArray.length,On!==void 0?On+1:St.collisionBoxArray.length,hr!==void 0?hr:St.collisionBoxArray.length,hr!==void 0?hr+1:St.collisionBoxArray.length,Wn!==void 0?Wn:St.collisionBoxArray.length,Wn!==void 0?Wn+1:St.collisionBoxArray.length,Nn||St.collisionBoxArray.length,Nn?Nn+1:St.collisionBoxArray.length,$i,JE,QE,kf,YE,gL,0,Kv,Yv,qa)})(r,lt,Kt,qe,o,l,u,Ye,r.layers[0],r.collisionBoxArray,e.index,e.sourceLayerIndex,r.index,ye,Pe,b,0,be,Fe,V,e,f,w,A,k)};if(Xe==="line")for(const qe of aE(e.geometry,0,0,Ot,Ot)){const lt=PD(qe,pe,ke,o.vertical||K,l,24,ce,r.overscaling,Ot);for(const Gt of lt){const Kt=K;Kt&&UD(r,Kt.text,Ae,Gt)||ht(qe,Gt,k)}}else if(Xe==="line-center"){for(const qe of e.geometry)if(qe.length>1){const lt=kD(qe,ke,o.vertical||K,l,24,ce);lt&&ht(qe,lt,k)}}else if(e.type==="Polygon")for(const qe of vv(e.geometry,0)){const lt=OD(qe,16);ht(qe[0],new Ys(lt.x,lt.y,0,0,void 0),k)}else if(e.type==="LineString")for(const qe of e.geometry)ht(qe,new Ys(qe[0].x,qe[0].y,0,0,void 0),k);else if(e.type==="Point")for(const qe of e.geometry)for(const lt of qe)ht([lt],new Ys(lt.x,lt.y,0,0,void 0),k)}const Na=32640;function fE(r,e,o,l,u,f,m,y,b,w,A,k,D,R,F,V,K){const ee=function(pe,ye,be,ke,Pe,Fe,Xe,Ae){const ze=[];if(ye.positionedLines.length===0)return ze;const Ke=ke.layout.get("text-rotate").evaluate(Fe,{})*Math.PI/180,Ye=function(Kt){const St=Kt[0],yt=Kt[1],ii=St*yt;return ii>0?[St,-yt]:ii<0?[-St,yt]:St===0?[yt,St]:[yt,-St]}(be);let ht=Math.abs(ye.top-ye.bottom);for(const Kt of ye.positionedLines)ht-=Kt.lineOffset;const qe=ye.positionedLines.length,lt=ht/qe;let Gt=ye.top-be[1];for(let Kt=0;Kt<qe;++Kt){const St=ye.positionedLines[Kt];Gt=DD(ye,lt,Gt,Kt);for(const yt of St.positionedGlyphs){if(!yt.rect)continue;const ii=yt.rect||{};let Zt=4,Et=!0,Cn=1,_n=0;if(yt.imageName){const Yi=Xe[yt.imageName];if(!Yi)continue;if(Yi.sdf){oi("SDF images are not supported in formatted text and will be ignored.");continue}Et=!1,Cn=Yi.pixelRatio,Zt=1/Cn}const dn=(Pe||Ae)&&yt.vertical,ni=yt.metrics.advance*yt.scale/2,xi=yt.metrics,$i=yt.rect;if($i===null)continue;Ae&&ye.verticalizable&&(_n=yt.imageName?ni-yt.metrics.width*yt.scale/2:0);const Oi=Pe?[yt.x+ni,yt.y]:[0,0];let Li=[0,0],Xi=[0,0],nn=!1;Pe||(dn?(Xi=[yt.x+ni+Ye[0],yt.y+Ye[1]-_n],nn=!0):Li=[yt.x+ni+be[0],yt.y+be[1]-_n]);const Bn=$i.w*yt.scale/(Cn*(yt.localGlyph?2:1)),vr=$i.h*yt.scale/(Cn*(yt.localGlyph?2:1));let ui,fn,Yn,Ai;if(dn){const Yi=yt.y-Gt,gn=new P(-ni,ni-Yi),Fn=-Math.PI/2,On=new P(...Xi);ui=new P(-ni+Li[0],Li[1]),ui._rotateAround(Fn,gn)._add(On),ui.x+=-Yi+ni,ui.y-=(xi.left-Zt)*yt.scale;const Wn=yt.imageName?xi.advance*yt.scale:Zn*yt.scale,hr=String.fromCharCode(yt.glyph);fD(hr)?ui.x+=(1-Zt)*yt.scale:pD(hr)?ui.x+=Wn-xi.height*yt.scale+(-Zt-1)*yt.scale:ui.x+=yt.imageName||xi.width+2*Zt===$i.w&&xi.height+2*Zt===$i.h?(Wn-vr)/2:(Wn-(xi.height+2*Zt)*yt.scale)/2,fn=new P(ui.x,ui.y-Bn),Yn=new P(ui.x+vr,ui.y),Ai=new P(ui.x+vr,ui.y-Bn)}else{const Yi=(xi.left-Zt)*yt.scale-ni+Li[0],gn=(-xi.top-Zt)*yt.scale+Li[1],Fn=Yi+Bn,On=gn+vr;ui=new P(Yi,gn),fn=new P(Fn,gn),Yn=new P(Yi,On),Ai=new P(Fn,On)}if(Ke){let Yi;Yi=Pe?new P(0,0):nn?new P(Ye[0],Ye[1]):new P(be[0],be[1]),ui._rotateAround(Ke,Yi),fn._rotateAround(Ke,Yi),Yn._rotateAround(Ke,Yi),Ai._rotateAround(Ke,Yi)}const rn=new P(0,0),ur=new P(0,0);ze.push({tl:ui,tr:fn,bl:Yn,br:Ai,tex:ii,writingMode:ye.writingMode,glyphOffset:Oi,sectionIndex:yt.sectionIndex,isSDF:Et,pixelOffsetTL:rn,pixelOffsetBR:ur,minFontScaleX:0,minFontScaleY:0})}}return ze}(0,l,b,f,m,y,u,r.allowVerticalPlacement),he=r.textSizeData;let ce=null;he.kind==="source"?(ce=[ss*f.layout.get("text-size").evaluate(y,{},K)],ce[0]>Na&&oi(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):he.kind==="composite"&&(ce=[ss*F.compositeTextSizes[0].evaluate(y,{},K),ss*F.compositeTextSizes[1].evaluate(y,{},K)],(ce[0]>Na||ce[1]>Na)&&oi(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),r.addSymbols(r.text,ee,ce,b,m,y,A,e,o,w.lineStartIndex,w.lineLength,R,V,K);for(const pe of k)D[pe]=r.text.placedSymbolArray.length-1;return 4*ee.length}function pE(r){for(const e in r)return r[e];return null}function d_(r,e,o,l,u,f,m,y,b,w){let A=m.top,k=m.bottom,D=m.left,R=m.right;const F=m.collisionPadding;if(F&&(D-=F[0],A-=F[1],R+=F[2],k+=F[3]),b){const V=new P(D,A),K=new P(R,A),ee=new P(D,k),he=new P(R,k),ce=ue(b);let pe=new P(0,0);w&&(pe=new P(w[0],w[1])),V._rotateAround(ce,pe),K._rotateAround(ce,pe),ee._rotateAround(ce,pe),he._rotateAround(ce,pe),D=Math.min(V.x,K.x,ee.x,he.x),R=Math.max(V.x,K.x,ee.x,he.x),A=Math.min(V.y,K.y,ee.y,he.y),k=Math.max(V.y,K.y,ee.y,he.y)}return r.emplaceBack(e.x,e.y,e.z,o.x,o.y,D,A,R,k,y,l,u,f),r.length-1}function Dv(r){r.collisionPadding&&(r.top-=r.collisionPadding[1],r.bottom+=r.collisionPadding[3]);const e=r.bottom-r.top;return e>0?Math.max(10,e):null}function UD(r,e,o,l){const u=r.compareText;if(e in u){const f=u[e];for(let m=f.length-1;m>=0;m--)if(l.dist(f[m])<o)return!0}else u[e]=[];return u[e].push(l),!1}const jD=_t([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_merc_pos",components:2},{type:"Float32",name:"a_uv",components:2}]),{members:mE}=jD,_E=_t([{name:"a_pos_3",components:3,type:"Int16"}]);var bf=_t([{name:"a_pos",type:"Int16",components:2}]);const Jl=Ot/Math.PI/2,Lv=2*_o(1,0)*Jl*Math.PI,th=[64,32,16],Rr=-Jl,Br=Jl,VD=[new Qr([Rr,Rr,Rr],[Br,Br,Br]),new Qr([Rr,Rr,Rr],[0,0,Br]),new Qr([0,Rr,Rr],[Br,0,Br]),new Qr([Rr,0,Rr],[0,Br,Br]),new Qr([0,0,Rr],[Br,Br,Br])];function gE(r,e,o,l=!0){const u=os([],r._camera.position,r.worldSize),f=[e,o,1,1];Kl(f,f,r.pixelMatrixInverse),pw(f,f,1/f[3]);const m=ar([],yo([],f,u)),y=r.globeMatrix,b=[y[12],y[13],y[14]],w=yo([],b,u),A=sf(w),k=ar([],w),D=r.worldSize/(2*Math.PI),R=go(k,m),F=Math.asin(D/A);if(F<Math.acos(R)){if(!l)return null;const Xe=[],Ae=[];os(Xe,m,A/R),ar(Ae,yo(Ae,Xe,w)),ar(m,Ba(m,w,os(m,Ae,Math.tan(F)*A)))}const V=[];new hv(u,m).closestPointOnSphere(b,D,V);const K=ar([],di(y,0)),ee=ar([],di(y,1)),he=ar([],di(y,2)),ce=go(K,V),pe=go(ee,V),ye=go(he,V),be=oe(Math.asin(-pe/D));let ke=oe(Math.atan2(ce,ye));ke=r.center.lng+function(Xe,Ae){const ze=(Ae-Xe+180)%360-180;return ze<-180?ze+360:ze}(r.center.lng,ke);const Pe=ql(ke),Fe=Ge(Zl(be),0,1);return new Gu(Pe,Fe)}class $D{constructor(e,o,l){this.a=yo([],e,l),this.b=yo([],o,l),this.center=l;const u=ar([],this.a),f=ar([],this.b);this.angle=Math.acos(go(u,f))}}function zv(r,e){if(r.angle===0)return null;let o;return o=r.a[e]===0?1/r.angle*.5*Math.PI:1/r.angle*Math.atan(r.b[e]/r.a[e]/Math.sin(r.angle)-1/Math.tan(r.angle)),o<0||o>1?null:function(l,u,f,m){const y=Math.sin(f);return l*(Math.sin((1-m)*f)/y)+u*(Math.sin(m*f)/y)}(r.a[e],r.b[e],r.angle,Ge(o,0,1))+r.center[e]}function as(r){if(r.z<=1)return VD[r.z+2*r.y+r.x];const[e,o]=Ov(r),l=[cr(e[0],e[1]),cr(e[0],o[1]),cr(o[0],e[1]),cr(o[0],o[1])],u=[Br,Br,Br],f=[Rr,Rr,Rr];for(const m of l)u[0]=Math.min(u[0],m[0]),u[1]=Math.min(u[1],m[1]),u[2]=Math.min(u[2],m[2]),f[0]=Math.max(f[0],m[0]),f[1]=Math.max(f[1],m[1]),f[2]=Math.max(f[2],m[2]);return new Qr(u,f)}function GD(r,e,o){const l=e/r.worldSize,u=Number.MAX_VALUE,f=[-u,-u,-u],m=[u,u,u],y=zr(new Float64Array(16));if(rs(y,y,[l,l,l]),Ra(y,y,r.globeMatrix),o.z<=1){const Ae=as(o).getCorners();for(let ze=0;ze<Ae.length;ze++)qn(Ae[ze],Ae[ze],y),Wm(m,m,Ae[ze]),Hm(f,f,Ae[ze]);return new Qr(m,f)}const[b,w]=Ov(o),A=new Oa;A.setSouthWest([b[1],w[0]]),A.setNorthEast([w[1],b[0]]);const k=[cr(A.getSouth(),A.getWest()),cr(A.getSouth(),A.getEast()),cr(A.getNorth(),A.getEast()),cr(A.getNorth(),A.getWest())];for(let Ae=0;Ae<k.length;Ae++)qn(k[Ae],k[Ae],y),Wm(m,m,k[Ae]),Hm(f,f,k[Ae]);if(A.contains(r.center)){f[2]=0;const Ae=r.point,ze=[Ae.x*l,Ae.y*l,0];return Wm(m,m,ze),Hm(f,f,ze),new Qr(m,f)}const D=[y[12],y[13],y[14]],R=r.center.lng,F=Ge(r.center.lat,-85.051129,ns),V=[ql(R),Zl(F)],K=A.getCenter().lng,ee=Ge(A.getCenter().lat,-85.051129,ns),he=[ql(K),Zl(ee)];let ce=new Array(3),pe=0,ye=V[0]-he[0];const be=V[1]-he[1];if(ye>.5?ye-=1:ye<-.5&&(ye+=1),Math.abs(ye)>Math.abs(be))pe=ye>=0?1:3,ce=D;else{pe=be>=0?0:2;const Ae=[y[4],y[5],y[6]];let ze;ze=be>=0?-Math.sin(ue(A.getSouth()))*Jl:-Math.sin(ue(A.getNorth()))*Jl,ce=Xm(ce,D,Ae,ze)}const ke=k[pe],Pe=k[(pe+1)%4],Fe=new $D(ke,Pe,ce),Xe=[zv(Fe,0)||ke[0],zv(Fe,1)||ke[1],zv(Fe,2)||ke[2]];return m[2]=Math.min(ke[2],Pe[2]),Wm(m,m,Xe),Hm(f,f,Xe),new Qr(m,f)}function Ov(r){const e=1<<r.z,o=r.x/e,l=(r.x+1)/e,u=(r.y+1)/e;return[[Tn(r.y/e),sr(o)],[Tn(u),sr(l)]]}function yE(r,e,o,l=Jl){return o=ue(o),[r*Math.sin(o)*l,-e*l,r*Math.cos(o)*l]}function cr(r,e,o){return yE(Math.cos(ue(r)),Math.sin(ue(r)),e,o)}function vE(r,e,o){const l=Math.pow(2,o.z),u=(r/Ot+o.x)/l;return cr(Tn((e/Ot+o.y)/l),sr(u))}function f_(r){return 16383/Math.max(...yo([],r.max,r.min))}function wf(r){const e=zr(new Float64Array(16)),o=f_(r);var l,u;return rs(e,e,[o,o,o]),Xl(e,e,((l=[])[0]=-(u=r.min)[0],l[1]=-u[1],l[2]=-u[2],l)),e}function xE(r){const e=zr(new Float64Array(16)),o=1/f_(r);return Xl(e,e,r.min),rs(e,e,[o,o,o]),e}function bE(r,e,o,l,u){const f=function(b){const w=Ot/(2*Math.PI);return b/(2*Math.PI)/w}(o),m=[r,e,-o/(2*Math.PI)],y=zr(new Float64Array(16));return Xl(y,y,m),rs(y,y,[f,f,f]),qm(y,y,ue(-u)),Zm(y,y,ue(-l)),y}function Rv(r){return xt(5,6,r)}function wE(r,e){const o=cr(e.lat,e.lng);return f=(l=cv([],function(R){const F=cr(R._center.lat,R._center.lng);let V=uv([],Zu(0,1,0),F);const K=uw([],-R.angle,F);V=qn(V,V,K),uw(K,-R._pitch,V);const ee=ar([],F);return os(ee,ee,R.cameraToCenterDistance/R.pixelsPerMeter*Lv),qn(ee,ee,K),Ba([],F,ee)}(r),o))[0],m=l[1],y=l[2],b=(u=o)[0],w=u[1],A=u[2],D=(k=Math.sqrt(f*f+m*m+y*y)*Math.sqrt(b*b+w*w+A*A))&&go(l,u)/k,Math.acos(Math.min(Math.max(D,-1),1));var l,u,f,m,y,b,w,A,k,D}const EE=ue(85),qD=Math.cos(EE),ZD=Math.sin(EE);function TE(r,e){const o=r.fovAboveCenter,l=r.elevation?r.elevation.getMinElevationBelowMSL()*e:0,u=(r._camera.position[2]*r.worldSize-l)/Math.cos(r._pitch),f=Math.sin(o)*u/Math.sin(Math.max(Math.PI/2-r._pitch-o,.01)),m=Math.sin(r._pitch)*f+u;return Math.min(1.01*m,u*(1/r._horizonShift))}function Ql(r,e){if(!e.isReprojectedInTileSpace)return{scale:1<<r.z,x:r.x,y:r.y,x2:r.x+1,y2:r.y+1,projection:e};const o=Math.pow(2,-r.z),l=r.x*o,u=(r.x+1)*o,f=r.y*o,m=(r.y+1)*o,y=sr(l),b=sr(u),w=Tn(f),A=Tn(m),k=e.project(y,w),D=e.project(b,w),R=e.project(b,A),F=e.project(y,A);let V=Math.min(k.x,D.x,R.x,F.x),K=Math.min(k.y,D.y,R.y,F.y),ee=Math.max(k.x,D.x,R.x,F.x),he=Math.max(k.y,D.y,R.y,F.y);const ce=o/16;function pe(be,ke,Pe,Fe,Xe,Ae){const ze=(Pe+Xe)/2,Ke=(Fe+Ae)/2,Ye=e.project(sr(ze),Tn(Ke)),ht=Math.max(0,V-Ye.x,K-Ye.y,Ye.x-ee,Ye.y-he);V=Math.min(V,Ye.x),ee=Math.max(ee,Ye.x),K=Math.min(K,Ye.y),he=Math.max(he,Ye.y),ht>ce&&(pe(be,Ye,Pe,Fe,ze,Ke),pe(Ye,ke,ze,Ke,Xe,Ae))}pe(k,D,l,f,u,f),pe(D,R,u,f,u,m),pe(R,F,u,m,l,m),pe(F,k,l,m,l,f),V-=ce,K-=ce,ee+=ce,he+=ce;const ye=1/Math.max(ee-V,he-K);return{scale:ye,x:V*ye,y:K*ye,x2:ee*ye,y2:he*ye,projection:e}}const WD=zr(new Float32Array(16));class Ua{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,o){return{x:0,y:0,z:0}}unproject(e,o){return new Di(0,0)}projectTilePoint(e,o,l){return{x:e,y:o,z:0}}locationPoint(e,o,l=!0){return e._coordinatePoint(e.locationCoordinate(o),l)}pixelsPerMeter(e,o){return _o(1,e)*o}pixelSpaceConversion(e,o,l){return 1}farthestPixelDistance(e){return TE(e,e.pixelsPerMeter)}pointCoordinate(e,o,l,u){const f=e.horizonLineFromTop(!1),m=new P(o,Math.max(f,l));return e.rayIntersectionCoordinate(e.pointRayIntersection(m,u))}pointCoordinate3D(e,o,l){const u=new P(o,l);if(e.elevation)return e.elevation.pointCoordinate(u);{const f=this.pointCoordinate(e,u.x,u.y,0);return[f.x,f.y,f.z]}}isPointAboveHorizon(e,o){if(e.elevation)return!this.pointCoordinate3D(e,o.x,o.y);const l=e.horizonLineFromTop();return o.y<l}createInversionMatrix(e,o){return WD}createTileMatrix(e,o,l){let u,f,m;const y=l.canonical,b=zr(new Float64Array(16));if(this.isReprojectedInTileSpace){const w=Ql(y,this);u=1,f=w.x+l.wrap*w.scale,m=w.y,rs(b,b,[u/w.scale,u/w.scale,e.pixelsPerMeter/o])}else u=o/e.zoomScale(y.z),f=(y.x+Math.pow(2,y.z)*l.wrap)*u,m=y.y*u;return Xl(b,b,[f,m,0]),rs(b,b,[u/Ot,u/Ot,1]),b}upVector(e,o,l){return[0,0,1]}upVectorScale(e,o,l){return{metersToTile:1}}}class HD extends Ua{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[o,l]=this.parallels=e.parallels||[29.5,45.5],u=Math.sin(ue(o));this.n=(u+Math.sin(ue(l)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(e,o){const{n:l,c:u,r0:f}=this,m=ue(e-this.center[0]),y=ue(o),b=Math.sqrt(u-2*l*Math.sin(y))/l;return{x:b*Math.sin(m*l),y:b*Math.cos(m*l)-f,z:0}}unproject(e,o){const{n:l,c:u,r0:f}=this,m=f+o;let y=Math.atan2(e,Math.abs(m))*Math.sign(m);m*l<0&&(y-=Math.PI*Math.sign(e)*Math.sign(m));const b=ue(this.center[0])*l;y=pt(y,-Math.PI-b,Math.PI-b);const w=oe(y/l)+this.center[0],A=Math.asin(Ge((u-(e*e+m*m)*l*l)/(2*l),-1,1)),k=Ge(oe(A),-85.051129,ns);return new Di(w,k)}}const Ef=1.340264,Tf=-.081106,Cf=893e-6,Sf=.003796,p_=Math.sqrt(3)/2;class XD extends Ua{project(e,o){o=o/180*Math.PI,e=e/180*Math.PI;const l=Math.asin(p_*Math.sin(o)),u=l*l,f=u*u*u;return{x:.5*(e*Math.cos(l)/(p_*(Ef+3*Tf*u+f*(7*Cf+9*Sf*u)))/Math.PI+.5),y:1-.5*(l*(Ef+Tf*u+f*(Cf+Sf*u))/Math.PI+1),z:0}}unproject(e,o){e=(2*e-.5)*Math.PI;let l=o=(2*(1-o)-1)*Math.PI,u=l*l,f=u*u*u;for(let A,k,D,R=0;R<12&&(k=l*(Ef+Tf*u+f*(Cf+Sf*u))-o,D=Ef+3*Tf*u+f*(7*Cf+9*Sf*u),A=k/D,l=Ge(l-A,-Math.PI/3,Math.PI/3),u=l*l,f=u*u*u,!(Math.abs(A)<1e-12));++R);const m=p_*e*(Ef+3*Tf*u+f*(7*Cf+9*Sf*u))/Math.cos(l),y=Math.asin(Math.sin(l)/p_),b=Ge(180*m/Math.PI,-180,180),w=Ge(180*y/Math.PI,-85.051129,ns);return new Di(b,w)}}class KD extends Ua{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,o){return{x:.5+e/360,y:.5-o/360,z:0}}unproject(e,o){const l=360*(e-.5),u=Ge(360*(.5-o),-85.051129,ns);return new Di(l,u)}}const ih=Math.PI/2;function m_(r){return Math.tan((ih+r)/2)}class YD extends Ua{constructor(e){super(e),this.center=e.center||[0,30];const[o,l]=this.parallels=e.parallels||[30,30],u=ue(o),f=ue(l),m=Math.cos(u);this.n=u===f?Math.sin(u):Math.log(m/Math.cos(f))/Math.log(m_(f)/m_(u)),this.f=m*Math.pow(m_(u),this.n)/this.n}project(e,o){o=ue(o),e=ue(e-this.center[0]);const l=1e-6,{n:u,f}=this;f>0?o<-ih+l&&(o=-ih+l):o>ih-l&&(o=ih-l);const m=f/Math.pow(m_(o),u),y=m*Math.sin(u*e),b=f-m*Math.cos(u*e);return{x:.5*(y/Math.PI+.5),y:1-.5*(b/Math.PI+.5),z:0}}unproject(e,o){e=(2*e-.5)*Math.PI,o=(2*(1-o)-.5)*Math.PI;const{n:l,f:u}=this,f=u-o,m=Math.sign(f),y=Math.sign(l)*Math.sqrt(e*e+f*f);let b=Math.atan2(e,Math.abs(f))*m;f*l<0&&(b-=Math.PI*Math.sign(e)*m);const w=Ge(oe(b/l)+this.center[0],-180,180),A=Ge(oe(2*Math.atan(Math.pow(u/y,1/l))-ih),-85.051129,ns);return new Di(w,A)}}class CE extends Ua{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,o){return{x:ql(e),y:Zl(o),z:0}}unproject(e,o){const l=sr(e),u=Tn(o);return new Di(l,u)}}const SE=ue(ns);class JD extends Ua{project(e,o){const l=(o=ue(o))*o,u=l*l;return{x:.5*((e=ue(e))*(.8707-.131979*l+u*(u*(.003971*l-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+l*(.015085+u*(.028874*l-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(e,o){e=(2*e-.5)*Math.PI;let l=o=(2*(1-o)-1)*Math.PI,u=25,f=0,m=l*l;do{m=l*l;const w=m*m;f=(l*(1.007226+m*(.015085+w*(.028874*m-.044475-.005916*w)))-o)/(1.007226+m*(.045255+w*(.259866*m-.311325-.005916*11*w))),l=Ge(l-f,-SE,SE)}while(Math.abs(f)>1e-6&&--u>0);m=l*l;const y=Ge(oe(e/(.8707+m*(m*(m*m*m*(.003971-.001529*m)-.013791)-.131979))),-180,180),b=oe(l);return new Di(y,b)}}const AE=ue(ns);class QD extends Ua{project(e,o){o=ue(o),e=ue(e);const l=Math.cos(o),u=2/Math.PI,f=Math.acos(l*Math.cos(e/2)),m=Math.sin(f)/f,y=.5*(e*u+2*l*Math.sin(e/2)/m)||0,b=.5*(o+Math.sin(o)/m)||0;return{x:.5*(y/Math.PI+.5),y:1-.5*(b/Math.PI+1),z:0}}unproject(e,o){let l=e=(2*e-.5)*Math.PI,u=o=(2*(1-o)-1)*Math.PI,f=25;const m=1e-6;let y=0,b=0;do{const w=Math.cos(u),A=Math.sin(u),k=2*A*w,D=A*A,R=w*w,F=Math.cos(l/2),V=Math.sin(l/2),K=2*F*V,ee=V*V,he=1-R*F*F,ce=he?1/he:0,pe=he?Math.acos(w*F)*Math.sqrt(1/he):0,ye=.5*(2*pe*w*V+2*l/Math.PI)-e,be=.5*(pe*A+u)-o,ke=.5*ce*(R*ee+pe*w*F*D)+1/Math.PI,Pe=ce*(K*k/4-pe*A*V),Fe=.125*ce*(k*V-pe*A*R*K),Xe=.5*ce*(D*F+pe*ee*w)+.5,Ae=Pe*Fe-Xe*ke;y=(be*Pe-ye*Xe)/Ae,b=(ye*Fe-be*ke)/Ae,l=Ge(l-y,-Math.PI,Math.PI),u=Ge(u-b,-AE,AE)}while((Math.abs(y)>m||Math.abs(b)>m)&&--f>0);return new Di(oe(l),oe(u))}}class IE extends Ua{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ue(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,o){const{scale:l,cosPhi:u}=this;return{x:ue(e)*u*l+.5,y:-Math.sin(ue(o))/u*l+.5,z:0}}unproject(e,o){const{scale:l,cosPhi:u}=this,f=-(o-.5)/l,m=Ge(oe((e-.5)/l)/u,-180,180),y=Math.asin(Ge(f*u,-1,1)),b=Ge(oe(y),-85.051129,ns);return new Di(m,b)}}class eL extends CE{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(e,o,l){const u=Math.pow(2,l.z),f=(e/Ot+l.x)/u,m=cr(Tn((o/Ot+l.y)/u),sr(f));return qn(m,m,wf(as(l))),{x:m[0],y:m[1],z:m[2]}}locationPoint(e,o){const l=cr(o.lat,o.lng),u=ar([],l),f=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(o),e._centerAltitude):e._centerAltitude;Xm(l,l,u,_o(1,0)*Ot*f);const m=zr(new Float64Array(16));return Ra(m,e.pixelMatrix,e.globeMatrix),qn(l,l,m),new P(l[0],l[1])}pixelsPerMeter(e,o){return _o(1,0)*o}pixelSpaceConversion(e,o,l){const u=yi(_o(1,45)*o,_o(1,e)*o,l);return this.pixelsPerMeter(e,o)/u}createTileMatrix(e,o,l){const u=xE(as(l.canonical));return Ra(new Float64Array(16),e.globeMatrix,u)}createInversionMatrix(e,o){const{center:l}=e,u=zr(new Float64Array(16));return Ra(u,u,wf(as(o))),Zm(u,u,ue(l.lng)),qm(u,u,ue(l.lat)),rs(u,u,[e._projectionScaler,e._projectionScaler,1]),Float32Array.from(u)}pointCoordinate(e,o,l,u){return gE(e,o,l,!0)||new Gu(0,0)}pointCoordinate3D(e,o,l){const u=this.pointCoordinate(e,o,l,0);return[u.x,u.y,u.z]}isPointAboveHorizon(e,o){return!gE(e,o.x,o.y,!1)}farthestPixelDistance(e){const o=function(u,f){const m=u.cameraToCenterDistance,y=u._centerAltitude*f,b=u._camera,w=u._camera.forward(),A=Ba([],os([],w,-m),[0,0,y]),k=u.worldSize/(2*Math.PI),D=[0,0,-k],R=u.width/u.height,F=Math.tan(u.fovAboveCenter),V=os([],b.up(),F),K=os([],b.right(),F*R),ee=ar([],Ba([],Ba([],w,V),K)),he=[];let ce;if(new hv(A,ee).closestPointOnSphere(D,k,he)){const pe=Ba([],he,D),ye=yo([],pe,A);ce=Math.cos(u.fovAboveCenter)*sf(ye)}else{const pe=yo([],A,D),ye=yo([],D,A);ar(ye,ye);const be=sf(pe)-k;ce=Math.sqrt(be*(be+2*k));const ke=Math.acos(ce/(k+be))-Math.acos(go(w,ye));ce*=Math.cos(ke)}return 1.01*ce}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),l=Rv(e.zoom);if(l>0){const u=TE(e,_o(1,e.center.lat)*e.worldSize),f=e.worldSize/(2*Math.PI),m=Math.max(e.width,e.height)/e.worldSize*Math.PI;return yi(o,u+f*(1-Math.cos(m)),Math.pow(l,10))}return o}upVector(e,o,l){const u=1<<e.z,f=(o/Ot+e.x)/u;return cr(Tn((l/Ot+e.y)/u),sr(f),1)}upVectorScale(e){return{metersToTile:Lv*f_(as(e))}}}function ME(r){const e=r.parallels,o=!!e&&Math.abs(e[0]+e[1])<.01;switch(r.name){case"mercator":return new CE(r);case"equirectangular":return new KD(r);case"naturalEarth":return new JD(r);case"equalEarth":return new XD(r);case"winkelTripel":return new QD(r);case"albers":return o?new IE(r):new HD(r);case"lambertConformalConic":return o?new IE(r):new YD(r);case"globe":return new eL(r)}throw new Error(`Invalid projection name: ${r.name}`)}const tL=Yl.VectorTileFeature.types,iL=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function __(r,e,o,l,u,f,m,y,b,w,A,k,D){const R=y?Math.min(Na,Math.round(y[0])):0,F=y?Math.min(Na,Math.round(y[1])):0;r.emplaceBack(e,o,Math.round(32*l),Math.round(32*u),f,m,(R<<1)+(b?1:0),F,16*w,16*A,256*k,256*D)}function g_(r,e,o,l,u,f,m){r.emplaceBack(e,o,l,u,f,m)}function y_(r,e,o,l,u){r.emplaceBack(e,o,l,u),r.emplaceBack(e,o,l,u),r.emplaceBack(e,o,l,u),r.emplaceBack(e,o,l,u)}function nL(r){for(const e of r.sections)if(T(e.text))return!0;return!1}class Bv{constructor(e){this.layoutVertexArray=new fo,this.indexArray=new ln,this.programConfigurations=e,this.segments=new mn,this.dynamicLayoutVertexArray=new Ui,this.opacityVertexArray=new Hi,this.placedSymbolArray=new R1,this.globeExtVertexArray=new Fo}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,o,l,u){this.isEmpty()||(l&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,oD.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,aD.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,iL,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,sD.members,!0)),this.opacityVertexBuffer.itemSize=1),(l||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}mt(Bv,"SymbolBuffers");class Fv{constructor(e,o,l){this.layoutVertexArray=new e,this.layoutAttributes=o,this.indexArray=new l,this.segments=new mn,this.collisionVertexArray=new $n,this.collisionVertexArrayExt=new ji}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,lD.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,cD.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}mt(Fv,"CollisionBuffers");class ja{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(m=>m.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=zr([]),this.placementViewportMatrix=zr([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=wv(this.zoom,o["text-size"]),this.iconSizeData=wv(this.zoom,o["icon-size"]);const l=this.layers[0].layout,u=l.get("symbol-sort-key"),f=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=l.get("text-writing-mode").map(m=>eo[m]),this.stateDependentLayerIds=this.layers.filter(m=>m.isStateDependent()).map(m=>m.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new Bv(new Gl(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Bv(new Gl(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new N1,this.lineVertexArray=new U1,this.symbolInstances=new F1}calculateGlyphDependencies(e,o,l,u,f){for(let m=0;m<e.length;m++)if(o[e.charCodeAt(m)]=!0,u&&f){const y=gf[e.charAt(m)];y&&(o[y.charCodeAt(0)]=!0)}}populate(e,o,l,u){const f=this.layers[0],m=f.layout,y=this.projection.name==="globe",b=m.get("text-font"),w=m.get("text-field"),A=m.get("icon-image"),k=(w.value.kind!=="constant"||w.value.value instanceof Vn&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),D=A.value.kind!=="constant"||!!A.value.value||Object.keys(A.parameters).length>0,R=m.get("symbol-sort-key");if(this.features=[],!k&&!D)return;const F=o.iconDependencies,V=o.glyphDependencies,K=o.availableImages,ee=new W(this.zoom);for(const{feature:he,id:ce,index:pe,sourceLayerIndex:ye}of e){const be=f._featureFilter.needGeometry,ke=Wl(he,be);if(!f._featureFilter.filter(ee,ke,l))continue;if(be||(ke.geometry=Hs(he,l,u)),y&&he.type!==1&&l.z<=5){const Ae=ke.geometry,ze=1<<l.z,Ke=l.x,Ye=l.y,ht=.98078528056;for(let qe=0;qe<Ae.length;qe++)Ae[qe]=aP(Ae[qe],lt=>lt,(lt,Gt)=>go(cr(Tn((lt.y/Ot+Ye)/ze),sr((lt.x/Ot+Ke)/ze),1),cr(Tn((Gt.y/Ot+Ye)/ze),sr((Gt.x/Ot+Ke)/ze),1))<ht)}let Pe,Fe;if(k){const Ae=f.getValueAndResolveTokens("text-field",ke,l,K),ze=Vn.factory(Ae);nL(ze)&&(this.hasRTLText=!0),(!this.hasRTLText||ie()==="unavailable"||this.hasRTLText&&Q.isParsed())&&(Pe=dD(ze,f,ke))}if(D){const Ae=f.getValueAndResolveTokens("icon-image",ke,l,K);Fe=Ae instanceof kr?Ae:kr.fromString(Ae)}if(!Pe&&!Fe)continue;const Xe=this.sortFeaturesByKey?R.evaluate(ke,{},l):void 0;if(this.features.push({id:ce,text:Pe,icon:Fe,index:pe,sourceLayerIndex:ye,geometry:ke.geometry,properties:he.properties,type:tL[he.type],sortKey:Xe}),Fe&&(F[Fe.name]=!0),Pe){const Ae=b.evaluate(ke,{},l).join(","),ze=m.get("text-rotation-alignment")==="map"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(eo.vertical)>=0;for(const Ke of Pe.sections)if(Ke.image)F[Ke.image.name]=!0;else{const Ye=Pa(Pe.toString()),ht=Ke.fontStack||Ae,qe=V[ht]=V[ht]||{};this.calculateGlyphDependencies(Ke.text,qe,ze,this.allowVerticalPlacement,Ye)}}}m.get("symbol-placement")==="line"&&(this.features=function(he){const ce={},pe={},ye=[];let be=0;function ke(Ae){ye.push(he[Ae]),be++}function Pe(Ae,ze,Ke){const Ye=pe[Ae];return delete pe[Ae],pe[ze]=Ye,ye[Ye].geometry[0].pop(),ye[Ye].geometry[0]=ye[Ye].geometry[0].concat(Ke[0]),Ye}function Fe(Ae,ze,Ke){const Ye=ce[ze];return delete ce[ze],ce[Ae]=Ye,ye[Ye].geometry[0].shift(),ye[Ye].geometry[0]=Ke[0].concat(ye[Ye].geometry[0]),Ye}function Xe(Ae,ze,Ke){const Ye=Ke?ze[0][ze[0].length-1]:ze[0][0];return`${Ae}:${Ye.x}:${Ye.y}`}for(let Ae=0;Ae<he.length;Ae++){const ze=he[Ae],Ke=ze.geometry,Ye=ze.text?ze.text.toString():null;if(!Ye){ke(Ae);continue}const ht=Xe(Ye,Ke),qe=Xe(Ye,Ke,!0);if(ht in pe&&qe in ce&&pe[ht]!==ce[qe]){const lt=Fe(ht,qe,Ke),Gt=Pe(ht,qe,ye[lt].geometry);delete ce[ht],delete pe[qe],pe[Xe(Ye,ye[Gt].geometry,!0)]=Gt,ye[lt].geometry=null}else ht in pe?Pe(ht,qe,Ke):qe in ce?Fe(ht,qe,Ke):(ke(Ae),ce[ht]=be-1,pe[qe]=be-1)}return ye.filter(Ae=>Ae.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((he,ce)=>he.sortKey-ce.sortKey)}update(e,o,l,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,o,this.layers,l,u),this.icon.programConfigurations.updatePaintArrays(e,o,this.layers,l,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=ME(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,o){const l=this.lineVertexArray.length,u=e.segment;if(u!==void 0){let f=e.dist(o[u+1]),m=e.dist(o[u]);const y={};for(let b=u+1;b<o.length;b++)y[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:f},b<o.length-1&&(f+=o[b+1].dist(o[b]));for(let b=u||0;b>=0;b--)y[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:m},b>0&&(m+=o[b-1].dist(o[b]));for(let b=0;b<o.length;b++){const w=y[b];this.lineVertexArray.emplaceBack(w.x,w.y,w.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(e,o,l,u,f,m,y,b,w,A,k,D,R,F){const V=e.indexArray,K=e.layoutVertexArray,ee=e.globeExtVertexArray,he=e.segments.prepareSegment(4*o.length,K,V,this.canOverlap?m.sortKey:void 0),ce=this.glyphOffsetArray.length,pe=he.vertexLength,ye=this.allowVerticalPlacement&&y===eo.vertical?Math.PI/2:0,be=m.text&&m.text.sections;for(let Pe=0;Pe<o.length;Pe++){const{tl:Fe,tr:Xe,bl:Ae,br:ze,tex:Ke,pixelOffsetTL:Ye,pixelOffsetBR:ht,minFontScaleX:qe,minFontScaleY:lt,glyphOffset:Gt,isSDF:Kt,sectionIndex:St}=o[Pe],yt=he.vertexLength,ii=Gt[1];if(__(K,w.x,w.y,Fe.x,ii+Fe.y,Ke.x,Ke.y,l,Kt,Ye.x,Ye.y,qe,lt),__(K,w.x,w.y,Xe.x,ii+Xe.y,Ke.x+Ke.w,Ke.y,l,Kt,ht.x,Ye.y,qe,lt),__(K,w.x,w.y,Ae.x,ii+Ae.y,Ke.x,Ke.y+Ke.h,l,Kt,Ye.x,ht.y,qe,lt),__(K,w.x,w.y,ze.x,ii+ze.y,Ke.x+Ke.w,Ke.y+Ke.h,l,Kt,ht.x,ht.y,qe,lt),b){const Zt=b.anchor,Et=b.up;g_(ee,Zt.x,Zt.y,Zt.z,Et[0],Et[1],Et[2]),g_(ee,Zt.x,Zt.y,Zt.z,Et[0],Et[1],Et[2]),g_(ee,Zt.x,Zt.y,Zt.z,Et[0],Et[1],Et[2]),g_(ee,Zt.x,Zt.y,Zt.z,Et[0],Et[1],Et[2]),y_(e.dynamicLayoutVertexArray,Zt.x,Zt.y,Zt.z,ye)}else y_(e.dynamicLayoutVertexArray,w.x,w.y,w.z,ye);V.emplaceBack(yt,yt+1,yt+2),V.emplaceBack(yt+1,yt+2,yt+3),he.vertexLength+=4,he.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Gt[0]),Pe!==o.length-1&&St===o[Pe+1].sectionIndex||e.programConfigurations.populatePaintArrays(K.length,m,m.index,{},R,F,be&&be[St])}const ke=b?b.anchor:w;e.placedSymbolArray.emplaceBack(ke.x,ke.y,ke.z,w.x,w.y,ce,this.glyphOffsetArray.length-ce,pe,A,k,w.segment,l?l[0]:0,l?l[1]:0,u[0],u[1],y,0,!1,0,D,0)}_commitLayoutVertex(e,o,l,u,f,m,y){e.emplaceBack(o,l,u,f,m,Math.round(y.x),Math.round(y.y))}_addCollisionDebugVertices(e,o,l,u,f,m,y){const b=l.segments.prepareSegment(4,l.layoutVertexArray,l.indexArray),w=b.vertexLength,A=y.tileAnchorX,k=y.tileAnchorY;for(let R=0;R<4;R++)l.collisionVertexArray.emplaceBack(0,0,0,0);l.collisionVertexArrayExt.emplaceBack(o,-e.padding,-e.padding),l.collisionVertexArrayExt.emplaceBack(o,e.padding,-e.padding),l.collisionVertexArrayExt.emplaceBack(o,e.padding,e.padding),l.collisionVertexArrayExt.emplaceBack(o,-e.padding,e.padding),this._commitLayoutVertex(l.layoutVertexArray,u,f,m,A,k,new P(e.x1,e.y1)),this._commitLayoutVertex(l.layoutVertexArray,u,f,m,A,k,new P(e.x2,e.y1)),this._commitLayoutVertex(l.layoutVertexArray,u,f,m,A,k,new P(e.x2,e.y2)),this._commitLayoutVertex(l.layoutVertexArray,u,f,m,A,k,new P(e.x1,e.y2)),b.vertexLength+=4;const D=l.indexArray;D.emplaceBack(w,w+1),D.emplaceBack(w+1,w+2),D.emplaceBack(w+2,w+3),D.emplaceBack(w+3,w),b.primitiveLength+=4}_addTextDebugCollisionBoxes(e,o,l,u,f,m){for(let y=u;y<f;y++){const b=l.get(y),w=this.getSymbolInstanceTextSize(e,m,o,y);this._addCollisionDebugVertices(b,w,this.textCollisionBox,b.projectedAnchorX,b.projectedAnchorY,b.projectedAnchorZ,m)}}_addIconDebugCollisionBoxes(e,o,l,u,f,m){for(let y=u;y<f;y++){const b=l.get(y),w=this.getSymbolInstanceIconSize(e,o,y);this._addCollisionDebugVertices(b,w,this.iconCollisionBox,b.projectedAnchorX,b.projectedAnchorY,b.projectedAnchorZ,m)}}generateCollisionDebugBuffers(e,o){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Fv(Ci,Vw.members,yr),this.iconCollisionBox=new Fv(Ci,Vw.members,yr);const l=Xu(this.iconSizeData,e),u=Xu(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const m=this.symbolInstances.get(f);this._addTextDebugCollisionBoxes(u,e,o,m.textBoxStartIndex,m.textBoxEndIndex,m),this._addTextDebugCollisionBoxes(u,e,o,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._addIconDebugCollisionBoxes(l,e,o,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._addIconDebugCollisionBoxes(l,e,o,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}}getSymbolInstanceTextSize(e,o,l,u){const f=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:u),m=s_(this.textSizeData,e,f)/Zn;return this.tilePixelRatio*m}getSymbolInstanceIconSize(e,o,l){const u=this.icon.placedSymbolArray.get(l),f=s_(this.iconSizeData,e,u);return this.tilePixelRatio*f}_commitDebugCollisionVertexUpdate(e,o,l){e.emplaceBack(o,-l,-l),e.emplaceBack(o,l,-l),e.emplaceBack(o,l,l),e.emplaceBack(o,-l,l)}_updateTextDebugCollisionBoxes(e,o,l,u,f,m){for(let y=u;y<f;y++){const b=l.get(y),w=this.getSymbolInstanceTextSize(e,m,o,y);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,w,b.padding)}}_updateIconDebugCollisionBoxes(e,o,l,u,f){for(let m=u;m<f;m++){const y=l.get(m),b=this.getSymbolInstanceIconSize(e,o,m);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,b,y.padding)}}updateCollisionDebugBuffers(e,o){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const l=Xu(this.iconSizeData,e),u=Xu(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const m=this.symbolInstances.get(f);this._updateTextDebugCollisionBoxes(u,e,o,m.textBoxStartIndex,m.textBoxEndIndex,m),this._updateTextDebugCollisionBoxes(u,e,o,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._updateIconDebugCollisionBoxes(l,e,o,m.iconBoxStartIndex,m.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(l,e,o,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,o,l,u,f,m,y,b,w){const A={};for(let k=o;k<l;k++){const D=e.get(k);A.textBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,padding:D.padding,projectedAnchorX:D.projectedAnchorX,projectedAnchorY:D.projectedAnchorY,projectedAnchorZ:D.projectedAnchorZ,tileAnchorX:D.tileAnchorX,tileAnchorY:D.tileAnchorY},A.textFeatureIndex=D.featureIndex;break}for(let k=u;k<f;k++){const D=e.get(k);A.verticalTextBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,padding:D.padding,projectedAnchorX:D.projectedAnchorX,projectedAnchorY:D.projectedAnchorY,projectedAnchorZ:D.projectedAnchorZ,tileAnchorX:D.tileAnchorX,tileAnchorY:D.tileAnchorY},A.verticalTextFeatureIndex=D.featureIndex;break}for(let k=m;k<y;k++){const D=e.get(k);A.iconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,padding:D.padding,projectedAnchorX:D.projectedAnchorX,projectedAnchorY:D.projectedAnchorY,projectedAnchorZ:D.projectedAnchorZ,tileAnchorX:D.tileAnchorX,tileAnchorY:D.tileAnchorY},A.iconFeatureIndex=D.featureIndex;break}for(let k=b;k<w;k++){const D=e.get(k);A.verticalIconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,padding:D.padding,projectedAnchorX:D.projectedAnchorX,projectedAnchorY:D.projectedAnchorY,projectedAnchorZ:D.projectedAnchorZ,tileAnchorX:D.tileAnchorX,tileAnchorY:D.tileAnchorY},A.verticalIconFeatureIndex=D.featureIndex;break}return A}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const l=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,o){const l=e.placedSymbolArray.get(o),u=l.vertexStartIndex+4*l.numGlyphs;for(let f=l.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(e),l=Math.cos(e),u=[],f=[],m=[];for(let y=0;y<this.symbolInstances.length;++y){m.push(y);const b=this.symbolInstances.get(y);u.push(0|Math.round(o*b.tileAnchorX+l*b.tileAnchorY)),f.push(b.featureIndex)}return m.sort((y,b)=>u[y]-u[b]||f[b]-f[y]),m}addToSortKeyRanges(e,o){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===o?l.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const l=this.symbolInstances.get(o);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((u,f,m)=>{u>=0&&m.indexOf(u)===f&&this.addIndicesForPlacedSymbol(this.text,u)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}mt(ja,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),ja.MAX_GLYPHS=65535,ja.addDynamicAttributes=y_;const rL=new gt({"symbol-placement":new ae(Ee.layout_symbol["symbol-placement"]),"symbol-spacing":new ae(Ee.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ae(Ee.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ce(Ee.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ae(Ee.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ae(Ee.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ae(Ee.layout_symbol["icon-ignore-placement"]),"icon-optional":new ae(Ee.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ae(Ee.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ce(Ee.layout_symbol["icon-size"]),"icon-text-fit":new ae(Ee.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ae(Ee.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ce(Ee.layout_symbol["icon-image"]),"icon-rotate":new Ce(Ee.layout_symbol["icon-rotate"]),"icon-padding":new ae(Ee.layout_symbol["icon-padding"]),"icon-keep-upright":new ae(Ee.layout_symbol["icon-keep-upright"]),"icon-offset":new Ce(Ee.layout_symbol["icon-offset"]),"icon-anchor":new Ce(Ee.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ae(Ee.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ae(Ee.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ae(Ee.layout_symbol["text-rotation-alignment"]),"text-field":new Ce(Ee.layout_symbol["text-field"]),"text-font":new Ce(Ee.layout_symbol["text-font"]),"text-size":new Ce(Ee.layout_symbol["text-size"]),"text-max-width":new Ce(Ee.layout_symbol["text-max-width"]),"text-line-height":new Ce(Ee.layout_symbol["text-line-height"]),"text-letter-spacing":new Ce(Ee.layout_symbol["text-letter-spacing"]),"text-justify":new Ce(Ee.layout_symbol["text-justify"]),"text-radial-offset":new Ce(Ee.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ae(Ee.layout_symbol["text-variable-anchor"]),"text-anchor":new Ce(Ee.layout_symbol["text-anchor"]),"text-max-angle":new ae(Ee.layout_symbol["text-max-angle"]),"text-writing-mode":new ae(Ee.layout_symbol["text-writing-mode"]),"text-rotate":new Ce(Ee.layout_symbol["text-rotate"]),"text-padding":new ae(Ee.layout_symbol["text-padding"]),"text-keep-upright":new ae(Ee.layout_symbol["text-keep-upright"]),"text-transform":new Ce(Ee.layout_symbol["text-transform"]),"text-offset":new Ce(Ee.layout_symbol["text-offset"]),"text-allow-overlap":new ae(Ee.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ae(Ee.layout_symbol["text-ignore-placement"]),"text-optional":new ae(Ee.layout_symbol["text-optional"])});var Nv={paint:new gt({"icon-opacity":new Ce(Ee.paint_symbol["icon-opacity"]),"icon-color":new Ce(Ee.paint_symbol["icon-color"]),"icon-halo-color":new Ce(Ee.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ce(Ee.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ce(Ee.paint_symbol["icon-halo-blur"]),"icon-translate":new ae(Ee.paint_symbol["icon-translate"]),"icon-translate-anchor":new ae(Ee.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ce(Ee.paint_symbol["text-opacity"]),"text-color":new Ce(Ee.paint_symbol["text-color"],{runtimeType:Kr,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new Ce(Ee.paint_symbol["text-halo-color"]),"text-halo-width":new Ce(Ee.paint_symbol["text-halo-width"]),"text-halo-blur":new Ce(Ee.paint_symbol["text-halo-blur"]),"text-translate":new ae(Ee.paint_symbol["text-translate"]),"text-translate-anchor":new ae(Ee.paint_symbol["text-translate-anchor"])}),layout:rL};class kE{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:xl,this.defaultValue=e}evaluate(e){if(e.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(e.formattedSection))return o.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}mt(kE,"FormatSectionOverride",{omit:["defaultValue"]});class v_ extends Uo{constructor(e){super(e,Nv)}recalculate(e,o){super.recalculate(e,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const l=this.layout.get("text-writing-mode");if(l){const u=[];for(const f of l)u.indexOf(f)<0&&u.push(f);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,o,l,u){const f=this.layout.get(e).evaluate(o,{},l,u),m=this._unevaluatedLayout._values[e];return m.isDataDriven()||Su(m.value)||!f?f:function(y,b){return b.replace(/{([^{}]+)}/g,(w,A)=>A in y?String(y[A]):"")}(o.properties,f)}createBucket(e){return new ja(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Nv.paint.overridableProperties){if(!v_.hasPaintOverride(this.layout,e))continue;const o=this.paint.get(e),l=new kE(o),u=new Cu(l,o.property.specification);let f=null;f=o.value.kind==="constant"||o.value.kind==="source"?new Au("source",u):new zl("composite",u,o.value.zoomStops,o.value._interpolationType),this.paint._values[e]=new Ie(o.property,f,o.parameters)}}_handleOverridablePaintPropertyUpdate(e,o,l){return!(!this.layout||o.isDataDriven()||l.isDataDriven())&&v_.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,o){const l=e.get("text-field"),u=Nv.paint.properties[o];let f=!1;const m=y=>{for(const b of y)if(u.overrides&&u.overrides.hasOverride(b))return void(f=!0)};if(l.value.kind==="constant"&&l.value.value instanceof Vn)m(l.value.value.sections);else if(l.value.kind==="source"){const y=w=>{f||(w instanceof El&&an(w.value)===pa?m(w.value.sections):w instanceof es?m(w.sections):w.eachChild(y))},b=l.value;b._styleExpression&&y(b._styleExpression.expression)}return f}getProgramConfiguration(e){return new za(this,e)}}var oL={paint:new gt({"background-color":new ae(Ee.paint_background["background-color"]),"background-pattern":new ot(Ee.paint_background["background-pattern"]),"background-opacity":new ae(Ee.paint_background["background-opacity"])})},sL={paint:new gt({"raster-opacity":new ae(Ee.paint_raster["raster-opacity"]),"raster-hue-rotate":new ae(Ee.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ae(Ee.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ae(Ee.paint_raster["raster-brightness-max"]),"raster-saturation":new ae(Ee.paint_raster["raster-saturation"]),"raster-contrast":new ae(Ee.paint_raster["raster-contrast"]),"raster-resampling":new ae(Ee.paint_raster["raster-resampling"]),"raster-fade-duration":new ae(Ee.paint_raster["raster-fade-duration"])})};class aL extends Uo{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var lL={paint:new gt({"sky-type":new ae(Ee.paint_sky["sky-type"]),"sky-atmosphere-sun":new ae(Ee.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ae(Ee.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ae(Ee.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ae(Ee.paint_sky["sky-gradient-radius"]),"sky-gradient":new Oe(Ee.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ae(Ee.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ae(Ee.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ae(Ee.paint_sky["sky-opacity"])})};function Uv(r,e,o){const l=[0,0,1],u=_w([]);return yw(u,u,o?-ue(r)+Math.PI:ue(r)),gw(u,u,-ue(e)),fw(l,l,u),ar(l,l)}const cL={circle:class extends Uo{constructor(r){super(r,pP)}createBucket(r){return new ov(r)}queryRadius(r){const e=r;return qu("circle-radius",this,e)+qu("circle-stroke-width",this,e)+$m(this.paint.get("circle-translate"))}queryIntersectsFeature(r,e,o,l,u,f,m,y){const b=lw(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,r.pixelToTileUnitsFactor),w=this.paint.get("circle-radius").evaluate(e,o)+this.paint.get("circle-stroke-width").evaluate(e,o);return vw(r,l,f,m,y,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",b,w)}getProgramIds(){return["circle"]}getProgramConfiguration(r){return new za(this,r)}},heatmap:class extends Uo{createBucket(r){return new bw(r)}constructor(r){super(r,bP),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=mv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(r){return qu("heatmap-radius",this,r)}queryIntersectsFeature(r,e,o,l,u,f,m,y){const b=this.paint.get("heatmap-radius").evaluate(e,o);return vw(r,l,f,m,y,!0,!0,new P(0,0),b)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(r){return new za(this,r)}},hillshade:class extends Uo{constructor(r){super(r,wP)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Uo{constructor(r){super(r,NP)}getProgramIds(){const r=this.paint.get("fill-pattern"),e=r&&r.constantOr(1),o=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getProgramConfiguration(r){return new za(this,r)}recalculate(r,e){super.recalculate(r,e);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new t_(r)}queryRadius(){return $m(this.paint.get("fill-translate"))}queryIntersectsFeature(r,e,o,l,u,f){return!r.queryGeometry.isAboveHorizon&&nw(aw(r.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,r.pixelToTileUnitsFactor),l)}isTileClipped(){return!0}},"fill-extrusion":class extends Uo{constructor(r){super(r,YP)}createBucket(r){return new pf(r)}queryRadius(){return $m(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(r){return new za(this,r)}queryIntersectsFeature(r,e,o,l,u,f,m,y,b){const w=lw(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,r.pixelToTileUnitsFactor),A=this.paint.get("fill-extrusion-height").evaluate(e,o),k=this.paint.get("fill-extrusion-base").evaluate(e,o),D=[0,0],R=y&&f.elevation,F=f.elevation?f.elevation.exaggeration():1,V=r.tile.getBucket(this);if(R&&V instanceof pf){const he=V.centroidVertexArray,ce=b+1;if(ce<he.length){const pe=he.get(ce);D[0]=pe.a_centroid_pos0,D[1]=pe.a_centroid_pos1}}if(D[0]===0&&D[1]===1)return!1;f.projection.name==="globe"&&(l=zw([l],[new P(0,0),new P(Ot,Ot)],r.tileID.canonical).map(he=>he.polygon).flat());const K=function(he,ce,pe,ye,be,ke,Pe,Fe,Xe,Ae,ze){return he.projection.name==="globe"?function(Ke,Ye,ht,qe,lt,Gt,Kt,St,yt,ii,Zt){const Et=[],Cn=[],_n=Ke.projection.upVectorScale(Zt,Ke.center.lat,Ke.worldSize).metersToTile,dn=[0,0,0,1],ni=[0,0,0,1],xi=(Oi,Li,Xi,nn)=>{Oi[0]=Li,Oi[1]=Xi,Oi[2]=nn,Oi[3]=1},$i=Lw();ht>0&&(ht+=$i),qe+=$i;for(const Oi of Ye){const Li=[],Xi=[];for(const nn of Oi){const Bn=nn.x+lt.x,vr=nn.y+lt.y,ui=Ke.projection.projectTilePoint(Bn,vr,Zt),fn=Ke.projection.upVector(Zt,nn.x,nn.y);let Yn=ht,Ai=qe;if(Kt){const rn=Fw(Bn,vr,ht,qe,Kt,St,yt,ii);Yn+=rn.base,Ai+=rn.top}ht!==0?xi(dn,ui.x+fn[0]*_n*Yn,ui.y+fn[1]*_n*Yn,ui.z+fn[2]*_n*Yn):xi(dn,ui.x,ui.y,ui.z),xi(ni,ui.x+fn[0]*_n*Ai,ui.y+fn[1]*_n*Ai,ui.z+fn[2]*_n*Ai),qn(dn,dn,Gt),qn(ni,ni,Gt),Li.push(r_(dn)),Xi.push(r_(ni))}Et.push(Li),Cn.push(Xi)}return[Et,Cn]}(he,ce,pe,ye,be,ke,Pe,Fe,Xe,Ae,ze):Pe?function(Ke,Ye,ht,qe,lt,Gt,Kt,St,yt){const ii=[],Zt=[],Et=[0,0,0,1];for(const Cn of Ke){const _n=[],dn=[];for(const ni of Cn){const xi=ni.x+qe.x,$i=ni.y+qe.y,Oi=Fw(xi,$i,Ye,ht,Gt,Kt,St,yt);Et[0]=xi,Et[1]=$i,Et[2]=Oi.base,Et[3]=1,Kl(Et,Et,lt),Et[3]=Math.max(Et[3],1e-5);const Li=r_([Et[0]/Et[3],Et[1]/Et[3],Et[2]/Et[3]]);Et[0]=xi,Et[1]=$i,Et[2]=Oi.top,Et[3]=1,Kl(Et,Et,lt),Et[3]=Math.max(Et[3],1e-5);const Xi=r_([Et[0]/Et[3],Et[1]/Et[3],Et[2]/Et[3]]);_n.push(Li),dn.push(Xi)}ii.push(_n),Zt.push(dn)}return[ii,Zt]}(ce,pe,ye,be,ke,Pe,Fe,Xe,Ae):function(Ke,Ye,ht,qe,lt){const Gt=[],Kt=[],St=lt[8]*Ye,yt=lt[9]*Ye,ii=lt[10]*Ye,Zt=lt[11]*Ye,Et=lt[8]*ht,Cn=lt[9]*ht,_n=lt[10]*ht,dn=lt[11]*ht;for(const ni of Ke){const xi=[],$i=[];for(const Oi of ni){const Li=Oi.x+qe.x,Xi=Oi.y+qe.y,nn=lt[0]*Li+lt[4]*Xi+lt[12],Bn=lt[1]*Li+lt[5]*Xi+lt[13],vr=lt[2]*Li+lt[6]*Xi+lt[14],ui=lt[3]*Li+lt[7]*Xi+lt[15],fn=nn+St,Yn=Bn+yt,Ai=vr+ii,rn=Math.max(ui+Zt,1e-5),ur=nn+Et,Yi=Bn+Cn,gn=vr+_n,Fn=Math.max(ui+dn,1e-5),On=new P(fn/rn,Yn/rn);On.z=Ai/rn,xi.push(On);const Wn=new P(ur/Fn,Yi/Fn);Wn.z=gn/Fn,$i.push(Wn)}Gt.push(xi),Kt.push($i)}return[Gt,Kt]}(ce,pe,ye,be,ke)}(f,l,k,A,w,m,R?y:null,D,F,f.center.lat,r.tileID.canonical),ee=r.queryGeometry;return function(he,ce,pe){let ye=1/0;nw(pe,ce)&&(ye=Bw(pe,ce[0]));for(let be=0;be<ce.length;be++){const ke=ce[be],Pe=he[be];for(let Fe=0;Fe<ke.length-1;Fe++){const Xe=ke[Fe],Ae=[Xe,ke[Fe+1],Pe[Fe+1],Pe[Fe],Xe];iw(pe,Ae)&&(ye=Math.min(ye,Bw(pe,Ae)))}}return ye!==1/0&&ye}(K[0],K[1],ee.isPointQuery()?ee.screenBounds:ee.screenGeometry)}},line:class extends Uo{constructor(r){super(r,Nw),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof pu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,e){super.recalculate(r,e),this.paint._values["line-floorwidth"]=Uw.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new o_(r)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(r){return new za(this,r)}queryRadius(r){const e=r,o=jw(qu("line-width",this,e),qu("line-gap-width",this,e)),l=qu("line-offset",this,e);return o/2+Math.abs(l)+$m(this.paint.get("line-translate"))}queryIntersectsFeature(r,e,o,l,u,f){if(r.queryGeometry.isAboveHorizon)return!1;const m=aw(r.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,r.pixelToTileUnitsFactor),y=r.pixelToTileUnitsFactor/2*jw(this.paint.get("line-width").evaluate(e,o),this.paint.get("line-gap-width").evaluate(e,o)),b=this.paint.get("line-offset").evaluate(e,o);return b&&(l=function(w,A){const k=[],D=new P(0,0);for(let R=0;R<w.length;R++){const F=w[R],V=[];for(let K=0;K<F.length;K++){const ee=F[K-1],he=F[K],ce=F[K+1],pe=K===0?D:he.sub(ee)._unit()._perp(),ye=K===F.length-1?D:ce.sub(he)._unit()._perp(),be=pe._add(ye)._unit();be._mult(1/(be.x*ye.x+be.y*ye.y)),V.push(be._mult(A)._add(he))}k.push(V)}return k}(l,b*r.pixelToTileUnitsFactor)),function(w,A,k){for(let D=0;D<A.length;D++){const R=A[D];if(w.length>=3){for(let F=0;F<R.length;F++)if(Hl(w,R[F]))return!0}if(uP(w,R,k))return!0}return!1}(m,l,y)}isTileClipped(){return!0}},symbol:v_,background:class extends Uo{constructor(r){super(r,oL)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Uo{constructor(r){super(r,sL)}getProgramIds(){return["raster"]}},sky:class extends Uo{constructor(r){super(r,lL),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="sky-gradient"?this._updateColorRamp():r!=="sky-atmosphere-sun"&&r!=="sky-atmosphere-halo-color"&&r!=="sky-atmosphere-color"&&r!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=mv({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(r){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=r.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(r,e){if(this.paint.get("sky-type")==="atmosphere"){const l=this.paint.get("sky-atmosphere-sun"),u=!l,f=r.style.light,m=f.properties.get("position");return u&&f.properties.get("anchor")==="viewport"&&oi("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?Uv(m.azimuthal,90-m.polar,e):Uv(l[0],90-l[1],e)}const o=this.paint.get("sky-gradient-center");return Uv(o[0],90-o[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(r){this._skyboxInvalidated=!1,this._lightPosition=r.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const r=this.paint.get("sky-type");return r==="atmosphere"?["skyboxCapture","skybox"]:r==="gradient"?["skyboxGradient"]:null}}};class Af{constructor(e,o,l,u){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(o,u)}update(e,o,l){const{width:u,height:f}=e,{context:m}=this,{gl:y}=m,{HTMLImageElement:b,HTMLCanvasElement:w,HTMLVideoElement:A,ImageData:k,ImageBitmap:D}=S;if(y.bindTexture(y.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA&&(!o||o.premultiply!==!1)),l||this.size&&this.size[0]===u&&this.size[1]===f){const{x:R,y:F}=l||{x:0,y:0};e instanceof b||e instanceof w||e instanceof A||e instanceof k||D&&e instanceof D?y.texSubImage2D(y.TEXTURE_2D,0,R,F,y.RGBA,y.UNSIGNED_BYTE,e):y.texSubImage2D(y.TEXTURE_2D,0,R,F,u,f,y.RGBA,y.UNSIGNED_BYTE,e.data)}else this.size=[u,f],e instanceof b||e instanceof w||e instanceof A||e instanceof k||D&&e instanceof D?y.texImage2D(y.TEXTURE_2D,0,this.format,this.format,y.UNSIGNED_BYTE,e):y.texImage2D(y.TEXTURE_2D,0,this.format,u,f,0,this.format,y.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(o&&o.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&y.generateMipmap(y.TEXTURE_2D)}bind(e,o){const{context:l}=this,{gl:u}=l;u.bindTexture(u.TEXTURE_2D,this.texture),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?e===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:e),this.filter=e),o!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,o),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class jv{constructor(e,o){this.width=e,this.height=o,this.nextRow=0,this.image=new Xs({width:e,height:o}),this.positions={},this.uploaded=!1}getDash(e,o){const l=this.getKey(e,o);return this.positions[l]}trim(){const e=this.width,o=this.height=qi(this.nextRow);this.image.resize({width:e,height:o})}getKey(e,o){return e.join(",")+o}getDashRanges(e,o,l){const u=[];let f=e.length%2==1?-e[e.length-1]*l:0,m=e[0]*l,y=!0;u.push({left:f,right:m,isDash:y,zeroLength:e[0]===0});let b=e[0];for(let w=1;w<e.length;w++){y=!y;const A=e[w];f=b*l,b+=A,m=b*l,u.push({left:f,right:m,isDash:y,zeroLength:A===0})}return u}addRoundDash(e,o,l){const u=o/2;for(let f=-l;f<=l;f++){const m=this.width*(this.nextRow+l+f);let y=0,b=e[y];for(let w=0;w<this.width;w++){w/b.right>1&&(b=e[++y]);const A=Math.abs(w-b.left),k=Math.abs(w-b.right),D=Math.min(A,k);let R;const F=f/l*(u+1);if(b.isDash){const V=u-Math.abs(F);R=Math.sqrt(D*D+V*V)}else R=u-Math.sqrt(D*D+F*F);this.image.data[m+w]=Math.max(0,Math.min(255,R+128))}}}addRegularDash(e,o){for(let b=e.length-1;b>=0;--b){const w=e[b],A=e[b+1];w.zeroLength?e.splice(b,1):A&&A.isDash===w.isDash&&(A.left=w.left,e.splice(b,1))}const l=e[0],u=e[e.length-1];l.isDash===u.isDash&&(l.left=u.left-this.width,u.right=l.right+this.width);const f=this.width*this.nextRow;let m=0,y=e[m];for(let b=0;b<this.width;b++){b/y.right>1&&(y=e[++m]);const w=Math.abs(b-y.left),A=Math.abs(b-y.right),k=Math.min(w,A);this.image.data[f+b]=Math.max(0,Math.min(255,(y.isDash?k:-k)+o+128))}}addDash(e,o){const l=this.getKey(e,o);if(this.positions[l])return this.positions[l];const u=o==="round",f=u?7:0,m=2*f+1;if(this.nextRow+m>this.height)return oi("LineAtlas out of space"),null;e.length===0&&e.push(1);let y=0;for(let A=0;A<e.length;A++)e[A]<0&&(oi("Negative value is found in line dasharray, replacing values with 0"),e[A]=0),y+=e[A];if(y!==0){const A=this.width/y,k=this.getDashRanges(e,this.width,A);u?this.addRoundDash(k,A,f):this.addRegularDash(k,o==="square"?.5*A:0)}const b=this.nextRow+f;this.nextRow+=m;const w={tl:[b,f],br:[y,0]};return this.positions[l]=w,w}}mt(jv,"LineAtlas");class uL{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class hL{constructor(){this.tasks={},this.taskQueue=[],hi(["process"],this),this.invoker=new uL(this.process),this.nextId=0}add(e,o){const l=this.nextId++,u=function({type:f,isSymbolTile:m,zoom:y}){return y=y||0,f==="message"?0:f!=="maybePrepare"||m?f!=="parseTile"||m?f==="parseTile"&&m?300-y:f==="maybePrepare"&&m?400-y:500:200-y:100-y}(o);if(u===0){Ne();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[l]={fn:e,metadata:o,priority:u,id:l},this.taskQueue.push(l),this.invoker.trigger(),{cancel:()=>{delete this.tasks[l]}}}process(){Ne();try{if(this.taskQueue=this.taskQueue.filter(l=>!!this.tasks[l]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const o=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let e=null,o=1/0;for(let u=0;u<this.taskQueue.length;u++){const f=this.tasks[this.taskQueue[u]];f.priority<o&&(o=f.priority,e=u)}if(e===null)return null;const l=this.taskQueue[e];return this.taskQueue.splice(e,1),l}remove(){this.invoker.remove()}}class PE{constructor(e){this._stringToNumber={},this._numberToString=[];for(let o=0;o<e.length;o++){const l=e[o];this._stringToNumber[l]=o,this._numberToString[o]=l}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const dL=["tile","layer","source","sourceLayer","state"];class DE{constructor(e,o,l,u,f){this.type="Feature",this._vectorTileFeature=e,this._z=o,this._x=l,this._y=u,this.properties=e.properties,this.id=f}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const o of dL)this[o]!==void 0&&(e[o]=this[o]);return e}}const vo=32,ls=33,Va=new Uint16Array(8184);for(let r=0;r<2046;r++){let e=r+2,o=0,l=0,u=0,f=0,m=0,y=0;for(1&e?u=f=m=vo:o=l=y=vo;(e>>=1)>1;){const w=o+u>>1,A=l+f>>1;1&e?(u=o,f=l,o=m,l=y):(o=u,l=f,u=m,f=y),m=w,y=A}const b=4*r;Va[b+0]=o,Va[b+1]=l,Va[b+2]=u,Va[b+3]=f}const cs=new Uint16Array(2178),$a=new Uint8Array(1089),x_=new Uint16Array(1089);function LE(r){return r===0?-.03125:r===32?.03125:0}var zE=_t([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const OE={type:2,extent:Ot,loadGeometry:()=>[[new P(0,0),new P(8193,0),new P(8193,8193),new P(0,8193),new P(0,0)]]};class Vv{constructor(e,o,l,u,f){this.tileID=e,this.uid=wt(),this.uses=0,this.tileSize=o,this.tileZoom=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=f,this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(e){const o=e+this.timeAdded;o<et.now()||this.fadeEndTime&&o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Ql(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,o,l){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,f){const m={};if(!f)return m;for(const y of u){const b=y.layerIds.map(w=>f.getLayer(w)).filter(Boolean);if(b.length!==0){y.layers=b,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(w=>b.filter(A=>A.id===w)[0]));for(const w of b)m[w.id]=y}}return m}(e.buckets,o.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const f=this.buckets[u];if(f instanceof ja){if(this.hasSymbolBuckets=!0,!l)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const f=this.buckets[u];if(f instanceof ja&&f.hasRTLText){this.hasRTLText=!0,Q.isLoading()||Q.isLoaded()||ie()!=="deferred"||X();break}}this.queryPadding=0;for(const u in this.buckets){const f=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(u).queryRadius(f))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new Yy}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const u=this.buckets[l];u.uploadPending()&&u.upload(e)}const o=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Af(e,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Af(e,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Af(e,this.lineAtlas.image,o.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,o,l,u,f,m,y,b){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:y,transform:m,params:f,tileTransform:this.tileTransform},e,o,l):{}}querySourceFeatures(e,o){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const u=l.loadVTLayers(),f=o?o.sourceLayer:"",m=u._geojsonTileLayer||u[f];if(!m)return;const y=Us(o&&o.filter),{z:b,x:w,y:A}=this.tileID.canonical,k={z:b,x:w,y:A};for(let D=0;D<m.length;D++){const R=m.feature(D);if(y.needGeometry){const K=Wl(R,!0);if(!y.filter(new W(this.tileID.overscaledZ),K,this.tileID.canonical))continue}else if(!y.filter(new W(this.tileID.overscaledZ),R))continue;const F=l.getId(R,f),V=new DE(R,b,w,A,F);V.tile=k,e.push(V)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const o=this.expirationTime;if(e.cacheControl){const l=bt(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let u=!1;if(this.expirationTime>l)u=!1;else if(o)if(this.expirationTime<o)u=!0;else{const f=this.expirationTime-o;f?this.expirationTime=l+Math.max(f,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!o)return;const l=this.latestFeatureIndex.loadVTLayers(),u=o.style.listImages();for(const f in this.buckets){if(!o.style.hasLayer(f))continue;const m=this.buckets[f],y=m.layers[0].sourceLayer||"_geojsonTileLayer",b=l[y],w=e[y];if(!b||!w||Object.keys(w).length===0)continue;if(m.update(w,b,u,this.imageAtlas&&this.imageAtlas.patternPositions||{}),m instanceof o_||m instanceof t_){const k=o.style._getSourceCache(m.layers[0].source);o._terrain&&o._terrain.enabled&&k&&m.programConfigurations.needsUpload&&o._terrain._clearRenderCacheForTile(k.id,this.tileID)}const A=o&&o.style&&o.style.getLayer(f);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<et.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=et.now()+e}setTexture(e,o){const l=o.context,u=l.gl;this.texture=o.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Af(l,e,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),l.extTextureFilterAnisotropic&&u.texParameterf(u.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax))}setDependencies(e,o){const l={};for(const u of o)l[u]=!0;this.dependencies[e]=l}hasDependency(e,o){for(const l of e){const u=this.dependencies[l];if(u){for(const f of o)if(u[f])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,o){if(!o||o.name==="mercator"||this._tileDebugBuffer)return;const l=Hs(OE,this.tileID.canonical,this.tileTransform)[0],u=new $t,f=new mo;for(let m=0;m<l.length;m++){const{x:y,y:b}=l[m];u.emplaceBack(y,b),f.emplaceBack(m)}f.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(f),this._tileDebugBuffer=e.createVertexBuffer(u,bf.members),this._tileDebugSegments=mn.simpleSegment(0,0,u.length,f.length)}_makeTileBoundsBuffers(e,o){if(this._tileBoundsBuffer||!o||o.name==="mercator")return;const l=Hs(OE,this.tileID.canonical,this.tileTransform)[0];let u,f;if(this.isRaster){const m=function(y,b){const w=Ql(y,b),A=Math.pow(2,y.z);for(let K=0;K<ls;K++)for(let ee=0;ee<ls;ee++){const he=sr((y.x+(ee+LE(ee))/vo)/A),ce=Tn((y.y+(K+LE(K))/vo)/A),pe=b.project(he,ce),ye=K*ls+ee;cs[2*ye+0]=Math.round((pe.x*w.scale-w.x)*Ot),cs[2*ye+1]=Math.round((pe.y*w.scale-w.y)*Ot)}$a.fill(0),x_.fill(0);for(let K=2045;K>=0;K--){const ee=4*K,he=Va[ee+0],ce=Va[ee+1],pe=Va[ee+2],ye=Va[ee+3],be=he+pe>>1,ke=ce+ye>>1,Pe=be+ke-ce,Fe=ke+he-be,Xe=ce*ls+he,Ae=ye*ls+pe,ze=ke*ls+be,Ke=Math.hypot((cs[2*Xe+0]+cs[2*Ae+0])/2-cs[2*ze+0],(cs[2*Xe+1]+cs[2*Ae+1])/2-cs[2*ze+1])>=16;if($a[ze]=$a[ze]||(Ke?1:0),K<1022){const Ye=(ce+Fe>>1)*ls+(he+Pe>>1),ht=(ye+Fe>>1)*ls+(pe+Pe>>1);$a[ze]=$a[ze]||$a[Ye]||$a[ht]}}const k=new Ut,D=new ln;let R=0;function F(K,ee){const he=ee*ls+K;return x_[he]===0&&(k.emplaceBack(cs[2*he+0],cs[2*he+1],K*Ot/vo,ee*Ot/vo),x_[he]=++R),x_[he]-1}function V(K,ee,he,ce,pe,ye){const be=K+he>>1,ke=ee+ce>>1;if(Math.abs(K-pe)+Math.abs(ee-ye)>1&&$a[ke*ls+be])V(pe,ye,K,ee,be,ke),V(he,ce,pe,ye,be,ke);else{const Pe=F(K,ee),Fe=F(he,ce),Xe=F(pe,ye);D.emplaceBack(Pe,Fe,Xe)}}return V(0,0,vo,vo,vo,0),V(vo,vo,0,0,0,vo),{vertices:k,indices:D}}(this.tileID.canonical,o);u=m.vertices,f=m.indices}else{u=new Ut,f=new ln;for(const{x:y,y:b}of l)u.emplaceBack(y,b,0,0);const m=Km(u.int16,void 0,4);for(let y=0;y<m.length;y+=3)f.emplaceBack(m[y],m[y+1],m[y+2])}this._tileBoundsBuffer=e.createVertexBuffer(u,zE.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(f),this._tileBoundsSegments=mn.simpleSegment(0,0,u.length,f.length)}_makeGlobeTileDebugBuffers(e,o){if(this._globeTileDebugBorderBuffer||this._globeTileDebugTextBuffer||!o||o.name!=="globe")return;const l=this.tileID.canonical,u=wf(as(l));this._makeGlobeTileDebugBorderBuffer(e,l,u),this._makeGlobeTileDebugTextBuffer(e,l,u)}_makeGlobeTileDebugBorderBuffer(e,o,l){const u=new $t,f=new mo,m=new Ct,y=(w,A,k,D,R)=>{const F=(k-w)/(R-1),V=(D-A)/(R-1),K=u.length;for(let ee=0;ee<R;ee++){const he=w+ee*F,ce=A+ee*V;u.emplaceBack(he,ce);const pe=vE(he,ce,o),ye=qn(pe,pe,l);m.emplaceBack(ye[0],ye[1],ye[2]),f.emplaceBack(K+ee)}},b=Ot;y(0,0,b,0,16),y(b,0,b,b,16),y(b,b,0,b,16),y(0,b,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(f),this._tileDebugBuffer=e.createVertexBuffer(u,bf.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(m,_E.members),this._tileDebugSegments=mn.simpleSegment(0,0,u.length,f.length)}_makeGlobeTileDebugTextBuffer(e,o,l){const u=new $t,f=new ln,m=new Ct,y=25;f.reserve(32),u.reserve(y),m.reserve(y);const b=(w,A)=>y*w+A;for(let w=0;w<y;w++){const A=2048*w;for(let k=0;k<y;k++){const D=2048*k;u.emplaceBack(D,A);const R=vE(D,A,o),F=qn(R,R,l);m.emplaceBack(F[0],F[1],F[2])}}for(let w=0;w<4;w++)for(let A=0;A<4;A++){const k=b(w,A),D=b(w,A+1),R=b(w+1,A),F=b(w+1,A+1);f.emplaceBack(k,D,R),f.emplaceBack(R,D,F)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(f),this._tileDebugTextBuffer=e.createVertexBuffer(u,bf.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(m,_E.members),this._tileDebugTextSegments=mn.simpleSegment(0,0,y,32)}}class fL{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,o,l){const u=String(o);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},Ft(this.stateChanges[e][u],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const f in this.state[e])f!==u&&(this.deletedStates[e][f]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const f in this.state[e][u])l[f]||(this.deletedStates[e][u][f]=null)}else for(const f in l)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][f]===null&&delete this.deletedStates[e][u][f]}removeFeatureState(e,o,l){if(this.deletedStates[e]===null)return;const u=String(o);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&o!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][l]=null);else if(o!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(l in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][l]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,o){const l=String(o),u=Ft({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const f=this.deletedStates[e][o];if(f===null)return{};for(const m in f)delete u[m]}return u}initializeTileState(e,o){e.setFeatureState(this.state,o)}coalesceChanges(e,o){const l={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const f={};for(const m in this.stateChanges[u])this.state[u][m]||(this.state[u][m]={}),Ft(this.state[u][m],this.stateChanges[u][m]),f[m]=this.state[u][m];l[u]=f}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const f={};if(this.deletedStates[u]===null)for(const m in this.state[u])f[m]={},this.state[u][m]={};else for(const m in this.deletedStates[u]){if(this.deletedStates[u][m]===null)this.state[u][m]={};else for(const y of Object.keys(this.deletedStates[u][m]))delete this.state[u][m][y];f[m]=this.state[u][m]}l[u]=l[u]||{},Ft(l[u],f)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const u in e)e[u].setFeatureState(l,o)}}class RE{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,o){const l=this.toIdx(e,o);return{min:this.minimums[l],max:this.maximums[l]}}isLeaf(e,o){return this.leaves[this.toIdx(e,o)]}toIdx(e,o){return o*this.size+e}}function BE(r,e,o,l){let u=0,f=Number.MAX_VALUE;for(let m=0;m<3;m++)if(Math.abs(l[m])<1e-15){if(o[m]<r[m]||o[m]>e[m])return null}else{const y=1/l[m];let b=(r[m]-o[m])*y,w=(e[m]-o[m])*y;if(b>w){const A=b;b=w,w=A}if(b>u&&(u=b),w<f&&(f=w),u>f)return null}return u}function FE(r,e,o,l,u,f,m,y,b,w,A){const k=l-r,D=u-e,R=f-o,F=m-r,V=y-e,K=b-o,ee=A[1]*K-A[2]*V,he=A[2]*F-A[0]*K,ce=A[0]*V-A[1]*F,pe=k*ee+D*he+R*ce;if(Math.abs(pe)<1e-15)return null;const ye=1/pe,be=w[0]-r,ke=w[1]-e,Pe=w[2]-o,Fe=(be*ee+ke*he+Pe*ce)*ye;if(Fe<0||Fe>1)return null;const Xe=ke*R-Pe*D,Ae=Pe*k-be*R,ze=be*D-ke*k,Ke=(A[0]*Xe+A[1]*Ae+A[2]*ze)*ye;return Ke<0||Fe+Ke>1?null:(F*Xe+V*Ae+K*ze)*ye}function NE(r,e,o){return(r-e)/(o-e)}function UE(r,e,o,l,u,f,m,y,b){const w=1<<o,A=f-l,k=m-u,D=(r+1)/w*A+l,R=(e+0)/w*k+u,F=(e+1)/w*k+u;y[0]=(r+0)/w*A+l,y[1]=R,b[0]=D,b[1]=F}class jE{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(f){const m=Math.ceil(Math.log2(f.dim/8)),y=[];let b=Math.ceil(Math.pow(2,m));const w=1/b,A=(R,F,V,K,ee)=>{const he=K?1:0,ce=(R+1)*V-he,pe=F*V,ye=(F+1)*V-he;ee[0]=R*V,ee[1]=pe,ee[2]=ce,ee[3]=ye};let k=new RE(b);const D=[];for(let R=0;R<b*b;R++){A(R%b,Math.floor(R/b),w,!1,D);const F=Ga(D[0],D[1],f),V=Ga(D[2],D[1],f),K=Ga(D[2],D[3],f),ee=Ga(D[0],D[3],f);k.minimums.push(Math.min(F,V,K,ee)),k.maximums.push(Math.max(F,V,K,ee)),k.leaves.push(1)}for(y.push(k),b/=2;b>=1;b/=2){const R=y[y.length-1];k=new RE(b);for(let F=0;F<b*b;F++){A(F%b,Math.floor(F/b),2,!0,D);const V=R.getElevation(D[0],D[1]),K=R.getElevation(D[2],D[1]),ee=R.getElevation(D[2],D[3]),he=R.getElevation(D[0],D[3]),ce=R.isLeaf(D[0],D[1]),pe=R.isLeaf(D[2],D[1]),ye=R.isLeaf(D[2],D[3]),be=R.isLeaf(D[0],D[3]),ke=Math.min(V.min,K.min,ee.min,he.min),Pe=Math.max(V.max,K.max,ee.max,he.max),Fe=ce&&pe&&ye&&be;k.maximums.push(Pe),k.minimums.push(ke),k.leaves.push(Pe-ke<=5&&Fe?1:0)}y.push(k)}return y}(this.dem),l=o.length-1,u=o[l];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(o,0,0,l,0)}raycastRoot(e,o,l,u,f,m,y=1){return BE([e,o,-100],[l,u,this.maximums[0]*y],f,m)}raycast(e,o,l,u,f,m,y=1){if(!this.nodeCount)return null;const b=this.raycastRoot(e,o,l,u,f,m,y);if(b==null)return null;const w=[],A=[],k=[],D=[],R=[{idx:0,t:b,nodex:0,nodey:0,depth:0}];for(;R.length>0;){const{idx:F,t:V,nodex:K,nodey:ee,depth:he}=R.pop();if(this.leaves[F]){UE(K,ee,he,e,o,l,u,k,D);const pe=1<<he,ye=(K+0)/pe,be=(K+1)/pe,ke=(ee+0)/pe,Pe=(ee+1)/pe,Fe=Ga(ye,ke,this.dem)*y,Xe=Ga(be,ke,this.dem)*y,Ae=Ga(be,Pe,this.dem)*y,ze=Ga(ye,Pe,this.dem)*y,Ke=FE(k[0],k[1],Fe,D[0],k[1],Xe,D[0],D[1],Ae,f,m),Ye=FE(D[0],D[1],Ae,k[0],D[1],ze,k[0],k[1],Fe,f,m),ht=Math.min(Ke!==null?Ke:Number.MAX_VALUE,Ye!==null?Ye:Number.MAX_VALUE);if(ht!==Number.MAX_VALUE)return ht;{const qe=Xm([],f,m,V);if(VE(Fe,Xe,ze,Ae,NE(qe[0],k[0],D[0]),NE(qe[1],k[1],D[1]))>=qe[2])return V}continue}let ce=0;for(let pe=0;pe<this._siblingOffset.length;pe++){UE((K<<1)+this._siblingOffset[pe][0],(ee<<1)+this._siblingOffset[pe][1],he+1,e,o,l,u,k,D),k[2]=-100,D[2]=this.maximums[this.childOffsets[F]+pe]*y;const ye=BE(k,D,f,m);if(ye!=null){const be=ye;w[pe]=be;let ke=!1;for(let Pe=0;Pe<ce&&!ke;Pe++)be>=w[A[Pe]]&&(A.splice(Pe,0,pe),ke=!0);ke||(A[ce]=pe),ce++}}for(let pe=0;pe<ce;pe++){const ye=A[pe];R.push({idx:this.childOffsets[F]+ye,t:w[ye],nodex:(K<<1)+this._siblingOffset[ye][0],nodey:(ee<<1)+this._siblingOffset[ye][1],depth:he+1})}}return null}_addNode(e,o,l){return this.minimums.push(e),this.maximums.push(o),this.leaves.push(l),this.childOffsets.push(0),this.nodeCount++}_construct(e,o,l,u,f){if(e[u].isLeaf(o,l)===1)return;this.childOffsets[f]||(this.childOffsets[f]=this.nodeCount);const m=u-1,y=e[m];let b=0,w=0;for(let A=0;A<this._siblingOffset.length;A++){const k=2*o+this._siblingOffset[A][0],D=2*l+this._siblingOffset[A][1],R=y.getElevation(k,D),F=y.isLeaf(k,D),V=this._addNode(R.min,R.max,F);F&&(b|=1<<A),w||(w=V)}for(let A=0;A<this._siblingOffset.length;A++)b&1<<A||this._construct(e,2*o+this._siblingOffset[A][0],2*l+this._siblingOffset[A][1],m,w+A)}}function VE(r,e,o,l,u,f){return yi(yi(r,o,f),yi(e,l,f),u)}function Ga(r,e,o){const l=o.dim,u=Ge(r*l-.5,0,l-1),f=Ge(e*l-.5,0,l-1),m=Math.floor(u),y=Math.floor(f),b=Math.min(m+1,l-1),w=Math.min(y+1,l-1);return VE(o.get(m,y),o.get(b,y),o.get(m,w),o.get(b,w),u-m,f-y)}const $E={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class b_{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,o,l,u=!1,f=!1){if(this.uid=e,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return oi(`"${l}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const m=this.dim=o.height-2,y=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.encoding=l||"mapbox",this.borderReady=u,!u){for(let b=0;b<m;b++)y[this._idx(-1,b)]=y[this._idx(0,b)],y[this._idx(m,b)]=y[this._idx(m-1,b)],y[this._idx(b,-1)]=y[this._idx(b,0)],y[this._idx(b,m)]=y[this._idx(b,m-1)];y[this._idx(-1,-1)]=y[this._idx(0,0)],y[this._idx(m,-1)]=y[this._idx(m-1,0)],y[this._idx(-1,m)]=y[this._idx(0,m-1)],y[this._idx(m,m)]=y[this._idx(m-1,m-1)],f&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new jE(this)}get(e,o,l=!1){l&&(e=Ge(e,-1,this.dim),o=Ge(o,-1,this.dim));const u=4*this._idx(e,o);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[u],this.pixels[u+1],this.pixels[u+2])}static getUnpackVector(e){return $E[e]}get unpackVector(){return $E[this.encoding]}_idx(e,o){if(e<-1||e>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(e+1)}_unpackMapbox(e,o,l){return(256*e*256+256*o+l)/10-1e4}_unpackTerrarium(e,o,l){return 256*e+o+l/256-32768}static pack(e,o){const l=[0,0,0,0],u=b_.getUnpackVector(o);let f=Math.floor((e+u[3])/u[2]);return l[2]=f%256,f=Math.floor(f/256),l[1]=f%256,f=Math.floor(f/256),l[0]=f,l}getPixels(){return new Or({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,o,l){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=o*this.dim,f=o*this.dim+this.dim,m=l*this.dim,y=l*this.dim+this.dim;switch(o){case-1:u=f-1;break;case 1:f=u+1}switch(l){case-1:m=y-1;break;case 1:y=m+1}const b=-o*this.dim,w=-l*this.dim;for(let A=m;A<y;A++)for(let k=u;k<f;k++){const D=4*this._idx(k,A),R=4*this._idx(k+b,A+w);this.pixels[D+0]=e.pixels[R+0],this.pixels[D+1]=e.pixels[R+1],this.pixels[D+2]=e.pixels[R+2],this.pixels[D+3]=e.pixels[R+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}mt(b_,"DEMData"),mt(jE,"DemMinMaxQuadTree",{omit:["dem"]});class pL{constructor(e,o){this.max=e,this.onRemove=o,this.reset()}reset(){for(const e in this.data)for(const o of this.data[e])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(e,o,l){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const f={value:o,timeout:void 0};if(l!==void 0&&(f.timeout=setTimeout(()=>{this.remove(e,f)},l)),this.data[u].push(f),this.order.push(u),this.order.length>this.max){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const o=this.data[e].shift();return o.timeout&&clearTimeout(o.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),o.value}getByKey(e){const o=this.data[e];return o?o[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,o){if(!this.has(e))return this;const l=e.wrapped().key,u=o===void 0?0:this.data[l].indexOf(o),f=this.data[l][u];return this.data[l].splice(u,1),f.timeout&&clearTimeout(f.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(f.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(e){const o=[];for(const l in this.data)for(const u of this.data[l])e(u.value)||o.push(u);for(const l of o)this.remove(l.value.tileID,l)}}class nh{constructor(e,o,l){this.func=e,this.mask=o,this.range=l}}nh.ReadOnly=!1,nh.ReadWrite=!0,nh.disabled=new nh(519,nh.ReadOnly,[0,1]);const $v=7680;class Gv{constructor(e,o,l,u,f,m){this.test=e,this.ref=o,this.mask=l,this.fail=u,this.depthFail=f,this.pass=m}}Gv.disabled=new Gv({func:519,mask:0},0,0,$v,$v,$v);class us{constructor(e,o,l){this.blendFunction=e,this.blendColor=o,this.mask=l}}us.Replace=[1,0],us.disabled=new us(us.Replace,hn.transparent,[!1,!1,!1,!1]),us.unblended=new us(us.Replace,hn.transparent,[!0,!0,!0,!0]),us.alphaBlended=new us([1,771],hn.transparent,[!0,!0,!0,!0]);const qv=1029,Zv=2305;class jo{constructor(e,o,l){this.enable=e,this.mode=o,this.frontFace=l}}jo.disabled=new jo(!1,qv,Zv),jo.backCCW=new jo(!0,qv,Zv),jo.backCW=new jo(!0,qv,2304),jo.frontCW=new jo(!0,1028,2304),jo.frontCCW=new jo(!0,1028,Zv);class ec extends Mi{constructor(e,o,l){super(),this.id=e,this._onlySymbols=l,o.on("data",u=>{u.dataType==="source"&&u.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&u.dataType==="source"&&u.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),o.on("error",()=>{this._sourceErrored=!0}),this._source=o,this._tiles={},this._cache=new pL(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=o.minTileCacheSize,this._maxTileCacheSize=o.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new fL,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const o=this._tiles[e];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,o){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,o)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){if(this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._source.prepareTile)for(const o in this._tiles){const l=this._tiles[o];this._source.prepareTile(l)&&this.map.painter.terrain&&this.map.painter.terrain._clearRenderCacheForTile(this.id,l.tileID),l.upload(e),l.prepare(this.map.style.imageManager)}else for(const o in this._tiles){const l=this._tiles[o];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Dt(this._tiles).map(e=>e.tileID).sort(GE).map(e=>e.key)}getRenderableIds(e){const o=[];for(const l in this._tiles)this._isIdRenderable(+l,e)&&o.push(this._tiles[l]);return e?o.sort((l,u)=>{const f=l.tileID,m=u.tileID,y=new P(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),b=new P(m.canonical.x,m.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-m.overscaledZ||b.y-y.y||b.x-y.x}).map(l=>l.tileID.key):o.map(l=>l.tileID).sort(GE).map(l=>l.key)}hasRenderableParent(e){const o=this.findLoadedParent(e,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(e,o){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(o||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,o){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=o),this._loadTile(l,this._tileLoaded.bind(this,l,e,o)))}_tileLoaded(e,o,l,u){if(u)if(e.state="errored",u.status!==404)this._source.fire(new Zi(u,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const f=this.map.painter.terrain;this.update(this.transform,f.getScaledDemTileSize(),!0),f.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=et.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(o,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Ei("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const o=this.getRenderableIds();for(let u=0;u<o.length;u++){const f=o[u];if(e.neighboringTiles&&e.neighboringTiles[f]){const m=this.getTileByID(f);l(e,m),l(m,e)}}function l(u,f){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let m=f.tileID.canonical.x-u.tileID.canonical.x;const y=f.tileID.canonical.y-u.tileID.canonical.y,b=Math.pow(2,u.tileID.canonical.z),w=f.tileID.key;m===0&&y===0||Math.abs(y)>1||(Math.abs(m)>1&&(Math.abs(m+b)===1?m+=b:Math.abs(m-b)===1&&(m-=b)),f.dem&&u.dem&&(u.dem.backfillBorder(f.dem,m,y),u.neighboringTiles&&u.neighboringTiles[w]&&(u.neighboringTiles[w].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,o,l,u){for(const f in this._tiles){let m=this._tiles[f];if(u[f]||!m.hasData()||m.tileID.overscaledZ<=o||m.tileID.overscaledZ>l)continue;let y=m.tileID;for(;m&&m.tileID.overscaledZ>o+1;){const w=m.tileID.scaledTo(m.tileID.overscaledZ-1);m=this._tiles[w.key],m&&m.hasData()&&(y=w)}let b=y;for(;b.overscaledZ>o;)if(b=b.scaledTo(b.overscaledZ-1),e[b.key]){u[y.key]=y;break}}}findLoadedParent(e,o){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=o?l:null}for(let l=e.overscaledZ-1;l>=o;l--){const u=e.scaledTo(l),f=this._getLoadedTile(u);if(f)return f}}_getLoadedTile(e){const o=this._tiles[e.key];return o&&o.hasData()?o:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,o){o=o||this._source.tileSize;const l=Math.ceil(e.width/o)+1,u=Math.ceil(e.height/o)+1,f=Math.floor(l*u*5),m=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,f):f,y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(y)}handleWrapJump(e){const o=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,o){const l={};for(const u in this._tiles){const f=this._tiles[u];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+o),l[f.tileID.key]=f}this._tiles=l;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(e,o,l){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!l)return;let u;this.updateCacheSize(e,o),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(y=>new lr(y.canonical.z,y.wrap,y.canonical.z,y.canonical.x,y.canonical.y)):(u=e.coveringTiles({tileSize:o||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!l,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(y=>this._source.hasTile(y)))):u=[];const f=this._updateRetainedTiles(u);if(qE(this._source.type)&&u.length!==0){const y={},b={},w=Object.keys(f);for(const k of w){const D=f[k],R=this._tiles[k];if(!R||R.fadeEndTime&&R.fadeEndTime<=et.now())continue;const F=this.findLoadedParent(D,Math.max(D.overscaledZ-ec.maxOverzooming,this._source.minzoom));F&&(this._addTile(F.tileID),y[F.tileID.key]=F.tileID),b[k]=D}const A=u[u.length-1].overscaledZ;for(const k in this._tiles){const D=this._tiles[k];if(f[k]||!D.hasData())continue;let R=D.tileID;for(;R.overscaledZ>A;){R=R.scaledTo(R.overscaledZ-1);const F=this._tiles[R.key];if(F&&F.hasData()&&b[R.key]){f[k]=D.tileID;break}}}for(const k in y)f[k]||(this._coveredTiles[k]=!0,f[k]=y[k])}for(const y in f)this._tiles[y].clearFadeHold();const m=function(y,b){const w=[];for(const A in y)A in b||w.push(A);return w}(this._tiles,f);for(const y of m){const b=this._tiles[y];b.hasSymbolBuckets&&!b.holdingForFade()?b.setHoldDuration(this.map._fadeDuration):b.hasSymbolBuckets&&!b.symbolFadeFinished()||this._removeTile(+y)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const o={};if(e.length===0)return o;const l={},u=e.reduce((w,A)=>Math.min(w,A.overscaledZ),1/0),f=e[0].overscaledZ,m=Math.max(f-ec.maxOverzooming,this._source.minzoom),y=Math.max(f+ec.maxUnderzooming,this._source.minzoom),b={};for(const w of e){const A=this._addTile(w);o[w.key]=w,A.hasData()||u<this._source.maxzoom&&(b[w.key]=w)}this._retainLoadedChildren(b,u,y,o);for(const w of e){let A=this._tiles[w.key];if(A.hasData())continue;if(w.canonical.z>=this._source.maxzoom){const D=w.children(this._source.maxzoom)[0],R=this.getTile(D);if(R&&R.hasData()){o[D.key]=D;continue}}else{const D=w.children(this._source.maxzoom);if(o[D[0].key]&&o[D[1].key]&&o[D[2].key]&&o[D[3].key])continue}let k=A.wasRequested();for(let D=w.overscaledZ-1;D>=m;--D){const R=w.scaledTo(D);if(l[R.key]||(l[R.key]=!0,A=this.getTile(R),!A&&k&&(A=this._addTile(R)),A&&(o[R.key]=R,k=A.wasRequested(),A.hasData())))break}}return o}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const o=[];let l,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){l=this._loadedParentTiles[u.key];break}o.push(u.key);const f=u.scaledTo(u.overscaledZ-1);if(l=this._getLoadedTile(f),l)break;u=f}for(const f of o)this._loadedParentTiles[f]=l}}_addTile(e){let o=this._tiles[e.key];if(o)return this._source.prepareTile&&this._source.prepareTile(o),o;o=this._cache.getAndRemove(e),o&&(this._setTileReloadTimer(e.key,o),o.tileID=e,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,o)));const l=Boolean(o);if(!l){const u=this.map?this.map.painter:null;o=new Vv(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._source.prepareTile&&this._source.prepareTile(o)||this._loadTile(o,this._tileLoaded.bind(this,o,e.key,o.state))}return o?(o.uses++,this._tiles[e.key]=o,l||this._source.fire(new Ei("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o):null}_setTileReloadTimer(e,o){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=o.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}_removeTile(e){const o=this._tiles[e];o&&(o.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,o,l){const u=[],f=this.transform;if(!f)return u;const m=f.projection.name==="globe",y=ql(f.center.lng);for(const b in this._tiles){const w=this._tiles[b];if(l&&w.clearQueryDebugViz(),w.holdingForFade())continue;let A;if(m){const k=w.tileID.canonical;if(k.z===0){const D=[Math.abs(Ge(y,...If(k,-1))-y),Math.abs(Ge(y,...If(k,1))-y)];A=[0,2*D.indexOf(Math.min(...D))-1]}else{const D=[Math.abs(Ge(y,...If(k,-1))-y),Math.abs(Ge(y,...If(k,0))-y),Math.abs(Ge(y,...If(k,1))-y)];A=[D.indexOf(Math.min(...D))-1]}}else A=[0];for(const k of A){const D=e.containsTile(w,f,o,k);D&&u.push(D)}}return u}getVisibleCoordinates(e){const o=this.getRenderableIds(e).map(l=>this._tiles[l].tileID);for(const l of o)l.projMatrix=this.transform.calculateProjMatrix(l.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(qE(this._source.type))for(const e in this._tiles){const o=this._tiles[e];if(o.fadeEndTime!==void 0&&o.fadeEndTime>=et.now())return!0}return!1}setFeatureState(e,o,l){this._state.updateState(e=e||"_geojsonTileLayer",o,l)}removeFeatureState(e,o,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",o,l)}getFeatureState(e,o){return this._state.getState(e=e||"_geojsonTileLayer",o)}setDependencies(e,o,l){const u=this._tiles[e];u&&u.setDependencies(o,l)}reloadTilesForDependencies(e,o){for(const l in this._tiles)this._tiles[l].hasDependency(e,o)&&this._reloadTile(+l,"reloading");this._cache.filter(l=>!l.hasDependency(e,o))}_preloadTiles(e,o){const l=new Map,u=Array.isArray(e)?e:[e],f=this.map.painter.terrain,m=this.usedForTerrain&&f?f.getScaledDemTileSize():this._source.tileSize;for(const y of u){const b=y.coveringTiles({tileSize:m,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const w of b)l.set(w.key,w);this.usedForTerrain&&y.updateElevation(!1)}jt(Array.from(l.values()),(y,b)=>{const w=new Vv(y,this._source.tileSize*y.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(w,A=>{this._source.type==="raster-dem"&&w.dem&&this._backfillDEM(w),b(A,w)})},o)}}function GE(r,e){const o=Math.abs(2*r.wrap)-+(r.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return r.overscaledZ-e.overscaledZ||l-o||e.canonical.y-r.canonical.y||e.canonical.x-r.canonical.x}function qE(r){return r==="raster"||r==="image"||r==="video"}function If(r,e){const o=1<<r.z;return[r.x/o+e,(r.x+1)/o+e]}ec.maxOverzooming=10,ec.maxUnderzooming=3;class w_{constructor(e,o,l){this._demTile=e,this._dem=this._demTile.dem,this._scale=o,this._offset=l}static create(e,o,l){const u=l||e.findDEMTileFor(o);if(!u||!u.dem)return;const f=u.dem,m=u.tileID,y=1<<o.canonical.z-m.canonical.z;return new w_(u,u.tileSize/Ot/y,[(o.canonical.x/y-m.canonical.x)*f.dim,(o.canonical.y/y-m.canonical.y)*f.dim])}tileCoordToPixel(e,o){const l=o*this._scale+this._offset[1],u=Math.floor(e*this._scale+this._offset[0]),f=Math.floor(l);return new P(u,f)}getElevationAt(e,o,l,u){const f=e*this._scale+this._offset[0],m=o*this._scale+this._offset[1],y=Math.floor(f),b=Math.floor(m),w=this._dem;return u=!!u,l?yi(yi(w.get(y,b,u),w.get(y,b+1,u),m-b),yi(w.get(y+1,b,u),w.get(y+1,b+1,u),m-b),f-y):w.get(y,b,u)}getElevationAtPixel(e,o,l){return this._dem.get(e,o,!!l)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*_o(1,e)*this._dem.stride}}class ZE{constructor(e,o){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new ka(Ot,16,0),this.featureIndexArray=new V1,this.promoteId=o}insert(e,o,l,u,f,m=0){const y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,u,f,m);const b=this.grid;for(let w=0;w<o.length;w++){const A=o[w],k=[1/0,1/0,-1/0,-1/0];for(let D=0;D<A.length;D++){const R=A[D];k[0]=Math.min(k[0],R.x),k[1]=Math.min(k[1],R.y),k[2]=Math.max(k[2],R.x),k[3]=Math.max(k[3],R.y)}k[0]<Ot&&k[1]<Ot&&k[2]>=0&&k[3]>=0&&b.insert(y,k[0],k[1],k[2],k[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Yl.VectorTile(new yf(this.rawTileData)).layers,this.sourceLayerCoder=new PE(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,o,l,u){this.loadVTLayers();const f=e.params||{},m=Us(f.filter),y=e.tileResult,b=e.transform,w=y.bufferedTilespaceBounds,A=this.grid.query(w.min.x,w.min.y,w.max.x,w.max.y,(F,V,K,ee)=>sw(y.bufferedTilespaceGeometry,F,V,K,ee));A.sort(mL);let k=null;b.elevation&&A.length>0&&(k=w_.create(b.elevation,this.tileID));const D={};let R;for(let F=0;F<A.length;F++){const V=A[F];if(V===R)continue;R=V;const K=this.featureIndexArray.get(V);let ee=null;this.loadMatchingFeature(D,K,m,f.layers,f.availableImages,o,l,u,(he,ce,pe,ye=0)=>(ee||(ee=Hs(he,this.tileID.canonical,e.tileTransform)),ce.queryIntersectsFeature(y,he,pe,ee,this.z,e.transform,e.pixelPosMatrix,k,ye)))}return D}loadMatchingFeature(e,o,l,u,f,m,y,b,w){const{featureIndex:A,bucketIndex:k,sourceLayerIndex:D,layoutVertexArrayOffset:R}=o,F=this.bucketLayerIDs[k];if(u&&!function(he,ce){for(let pe=0;pe<he.length;pe++)if(ce.indexOf(he[pe])>=0)return!0;return!1}(u,F))return;const V=this.sourceLayerCoder.decode(D),K=this.vtLayers[V].feature(A);if(l.needGeometry){const he=Wl(K,!0);if(!l.filter(new W(this.tileID.overscaledZ),he,this.tileID.canonical))return}else if(!l.filter(new W(this.tileID.overscaledZ),K))return;const ee=this.getId(K,V);for(let he=0;he<F.length;he++){const ce=F[he];if(u&&u.indexOf(ce)<0)continue;const pe=m[ce];if(!pe)continue;let ye={};ee!==void 0&&b&&(ye=b.getState(pe.sourceLayer||"_geojsonTileLayer",ee));const be=Ft({},y[ce]);be.paint=WE(be.paint,pe.paint,K,ye,f),be.layout=WE(be.layout,pe.layout,K,ye,f);const ke=!w||w(K,pe,ye,R);if(!ke)continue;const Pe=new DE(K,this.z,this.x,this.y,ee);Pe.layer=be;let Fe=e[ce];Fe===void 0&&(Fe=e[ce]=[]),Fe.push({featureIndex:A,feature:Pe,intersectionZ:ke})}}lookupSymbolFeatures(e,o,l,u,f,m,y,b){const w={};this.loadVTLayers();const A=Us(f);for(const k of e)this.loadMatchingFeature(w,{bucketIndex:l,sourceLayerIndex:u,featureIndex:k,layoutVertexArrayOffset:0},A,m,y,b,o);return w}loadFeature(e){const{featureIndex:o,sourceLayerIndex:l}=e;this.loadVTLayers();const u=this.sourceLayerCoder.decode(l),f=this.vtFeatures[u];if(f[o])return f[o];const m=this.vtLayers[u].feature(o);return f[o]=m,m}hasLayer(e){for(const o of this.bucketLayerIDs)for(const l of o)if(e===l)return!0;return!1}getId(e,o){let l=e.id;return this.promoteId&&(l=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof l=="boolean"&&(l=Number(l))),l}}function WE(r,e,o,l,u){return ei(r,(f,m)=>{const y=e instanceof Je?e.get(m):null;return y&&y.evaluate?y.evaluate(o,l,u):y})}function mL(r,e){return e-r}mt(ZE,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class HE{constructor(e){const o={},l=[];for(const y in e){const b=e[y],w=o[y]={};for(const A in b.glyphs){const k=b.glyphs[+A];if(!k||k.bitmap.width===0||k.bitmap.height===0)continue;const D=k.metrics.localGlyph?2:1,R={x:0,y:0,w:k.bitmap.width+2*D,h:k.bitmap.height+2*D};l.push(R),w[A]=R}}const{w:u,h:f}=Tv(l),m=new Xs({width:u||1,height:f||1});for(const y in e){const b=e[y];for(const w in b.glyphs){const A=b.glyphs[+w];if(!A||A.bitmap.width===0||A.bitmap.height===0)continue;const k=o[y][w],D=A.metrics.localGlyph?2:1;Xs.copy(A.bitmap,m,{x:0,y:0},{x:k.x+D,y:k.y+D},A.bitmap)}}this.image=m,this.positions=o}}mt(HE,"GlyphAtlas");class _L{constructor(e){this.tileID=new lr(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=Ql(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,o,l,u,f){this.status="parsing",this.data=e,this.collisionBoxArray=new Yy;const m=new PE(Object.keys(e.layers).sort()),y=new ZE(this.tileID,this.promoteId);y.bucketLayerIDs=[];const b={},w=new jv(256,256),A={featureIndex:y,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:w,availableImages:l},k=o.familiesBySource[this.source];for(const ye in k){const be=e.layers[ye];if(!be)continue;let ke=!1,Pe=!1;for(const Ae of k[ye])Ae[0].type==="symbol"?ke=!0:Pe=!0;if(this.isSymbolTile===!0&&!ke||this.isSymbolTile===!1&&!Pe)continue;be.version===1&&oi(`Vector tile source "${this.source}" layer "${ye}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Fe=m.encode(ye),Xe=[];for(let Ae=0;Ae<be.length;Ae++){const ze=be.feature(Ae),Ke=y.getId(ze,ye);Xe.push({feature:ze,id:Ke,index:Ae,sourceLayerIndex:Fe})}for(const Ae of k[ye]){const ze=Ae[0];this.isSymbolTile!==void 0&&ze.type==="symbol"!==this.isSymbolTile||ze.minzoom&&this.zoom<Math.floor(ze.minzoom)||ze.maxzoom&&this.zoom>=ze.maxzoom||ze.visibility!=="none"&&(Wv(Ae,this.zoom,l),(b[ze.id]=ze.createBucket({index:y.bucketLayerIDs.length,layers:Ae,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Fe,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:l})).populate(Xe,A,this.tileID.canonical,this.tileTransform),y.bucketLayerIDs.push(Ae.map(Ke=>Ke.id)))}}let D,R,F,V;w.trim();const K={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ee=ei(A.glyphDependencies,ye=>Object.keys(ye).map(Number));Object.keys(ee).length?u.send("getGlyphs",{uid:this.uid,stacks:ee},(ye,be)=>{D||(D=ye,R=be,pe.call(this))},void 0,!1,K):R={};const he=Object.keys(A.iconDependencies);he.length?u.send("getImages",{icons:he,source:this.source,tileID:this.tileID,type:"icons"},(ye,be)=>{D||(D=ye,F=be,pe.call(this))},void 0,!1,K):F={};const ce=Object.keys(A.patternDependencies);function pe(){if(D)return f(D);if(R&&F&&V){const ye=new HE(R),be=new Xw(F,V);for(const ke in b){const Pe=b[ke];Pe instanceof ja?(Wv(Pe.layers,this.zoom,l),FD(Pe,R,ye.positions,F,be.iconPositions,this.showCollisionBoxes,l,this.tileID.canonical,this.tileZoom,this.projection)):Pe.hasPattern&&(Pe instanceof o_||Pe instanceof t_||Pe instanceof pf)&&(Wv(Pe.layers,this.zoom,l),Pe.addFeatures(A,this.tileID.canonical,be.patternPositions,l,this.tileTransform))}this.status="done",f(null,{buckets:Dt(b).filter(ke=>!ke.isEmpty()),featureIndex:y,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ye.image,lineAtlas:w,imageAtlas:be,glyphMap:this.returnDependencies?R:null,iconMap:this.returnDependencies?F:null,glyphPositions:this.returnDependencies?ye.positions:null})}}ce.length?u.send("getImages",{icons:ce,source:this.source,tileID:this.tileID,type:"patterns"},(ye,be)=>{D||(D=ye,V=be,pe.call(this))},void 0,!1,K):V={},pe.call(this)}}function Wv(r,e,o){const l=new W(e);for(const u of r)u.recalculate(l,o)}class XE{constructor(e){this.entries={},this.scheduler=e}request(e,o,l,u){const f=this.entries[e]=this.entries[e]||{callbacks:[]};if(f.result){const[m,y]=f.result;return this.scheduler?this.scheduler.add(()=>{u(m,y)},o):u(m,y),()=>{}}return f.callbacks.push(u),f.cancel||(f.cancel=l((m,y)=>{f.result=[m,y];for(const b of f.callbacks)this.scheduler?this.scheduler.add(()=>{b(m,y)},o):b(m,y);setTimeout(()=>delete this.entries[e],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(m=>m!==u),f.callbacks.length||(f.cancel(),delete this.entries[e]))}}}function KE(r,e,o){const l=JSON.stringify(r.request);return r.data&&(this.deduped.entries[l]={result:[null,r.data]}),this.deduped.request(l,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom},u=>{const f=ve(r.request,(m,y,b,w)=>{m?u(m):y&&u(null,{vectorTile:o?void 0:new Yl.VectorTile(new yf(y)),rawData:y,cacheControl:b,expires:w})});return()=>{f.cancel(),u()}},e)}a.ARRAY_TYPE=Lr,a.AUTH_ERR_MSG=fi,a.Aabb=Qr,a.Actor=class{constructor(r,e,o){this.target=r,this.parent=e,this.mapId=o,this.callbacks={},this.cancelCallbacks={},hi(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ne()?r:S,this.scheduler=new hL}send(r,e,o,l,u=!1,f){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(o.metadata=f,this.callbacks[m]=o);const y=It(this.globalScope)?void 0:[];return this.target.postMessage({id:m,type:r,hasCallback:!!o,targetMapId:l,mustQueue:u,sourceMapId:this.mapId,data:Ul(e,y)},y),{cancel:()=>{o&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:l,sourceMapId:this.mapId})}}}receive(r){const e=r.data,o=e.id;if(o&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const l=this.cancelCallbacks[o];delete this.cancelCallbacks[o],l&&l.cancel()}else if(e.mustQueue||Ne()){const l=this.callbacks[o];this.cancelCallbacks[o]=this.scheduler.add(()=>this.processTask(o,e),l&&l.metadata||{type:"message"})}else this.processTask(o,e)}processTask(r,e){if(e.type==="<response>"){const o=this.callbacks[r];delete this.callbacks[r],o&&(e.error?o(jl(e.error)):o(null,jl(e.data)))}else{const o=It(this.globalScope)?void 0:[],l=e.hasCallback?(f,m)=>{delete this.cancelCallbacks[r],this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:f?Ul(f):null,data:Ul(m,o)},o)}:f=>{},u=jl(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,u,l);else if(this.parent.getWorkerSource){const f=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,f[0],u.source)[f[1]](u,l)}else l(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=n_,a.Color=hn,a.ColorMode=us,a.CullFaceMode=jo,a.DEMData=b_,a.DataConstantProperty=ae,a.DedupedRequest=XE,a.DepthMode=nh,a.EXTENT=Ot,a.Elevation=class{isDataAvailableAtPoint(r){const e=this._source();if(!e||r.y<0||r.y>1)return!1;const o=e.getSource().maxzoom,l=1<<o,u=Math.floor(r.x),f=Math.floor((r.x-u)*l),m=Math.floor(r.y*l),y=this.findDEMTileFor(new lr(o,u,o,f,m));return!(!y||!y.dem)}getAtPointOrZero(r,e=0){return this.getAtPoint(r,e)||0}getAtPoint(r,e,o=!0){e==null&&(e=null);const l=this._source();if(!l||r.y<0||r.y>1)return e;const u=l.getSource().maxzoom,f=1<<u,m=Math.floor(r.x),y=r.x-m,b=new lr(u,m,u,Math.floor(y*f),Math.floor(r.y*f)),w=this.findDEMTileFor(b);if(!w||!w.dem)return e;const A=w.dem,k=1<<w.tileID.canonical.z,D=(y*k-w.tileID.canonical.x)*A.dim,R=(r.y*k-w.tileID.canonical.y)*A.dim,F=Math.floor(D),V=Math.floor(R);return(o?this.exaggeration():1)*yi(yi(A.get(F,V),A.get(F,V+1),R-V),yi(A.get(F+1,V),A.get(F+1,V+1),R-V),D-F)}getAtTileOffset(r,e,o){const l=1<<r.canonical.z;return this.getAtPointOrZero(new Gu(r.wrap+(r.canonical.x+e/Ot)/l,(r.canonical.y+o/Ot)/l))}getAtTileOffsetFunc(r,e,o,l){return u=>{const f=this.getAtTileOffset(r,u.x,u.y),m=l.upVector(r.canonical,u.x,u.y);return os(m,m,f*l.upVectorScale(r.canonical,e,o).metersToTile),m}}getForTilePoints(r,e,o,l){const u=w_.create(this,r,l);return!!u&&(e.forEach(f=>{f[2]=this.exaggeration()*u.getElevationAt(f[0],f[1],o)}),!0)}getMinMaxForTile(r){const e=this.findDEMTileFor(r);if(!e||!e.dem)return null;const o=e.dem.tree,l=e.tileID,u=1<<r.canonical.z-l.canonical.z;let f=r.canonical.x/u-l.canonical.x,m=r.canonical.y/u-l.canonical.y,y=0;for(let b=0;b<r.canonical.z-l.canonical.z&&!o.leaves[y];b++){f*=2,m*=2;const w=2*Math.floor(m)+Math.floor(f);y=o.childOffsets[y]+w,f%=1,m%=1}return{min:this.exaggeration()*o.minimums[y],max:this.exaggeration()*o.maximums[y]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(r,e,o){throw new Error("Pure virtual method called.")}pointCoordinate(r){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(r){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=Zi,a.EvaluationParameters=W,a.Event=Ei,a.Evented=Mi,a.FillExtrusionBucket=pf,a.Frustum=fv,a.FrustumCorners=dv,a.GLOBE_METERS_TO_ECEF=Lv,a.GLOBE_RADIUS=Jl,a.GLOBE_SCALE_MATCH_LATITUDE=45,a.GLOBE_ZOOM_THRESHOLD_MAX=6,a.GLOBE_ZOOM_THRESHOLD_MIN=5,a.GlobeSharedBuffers=class{constructor(r){this._createGrid(r),this._createPoles(r)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const r of this._poleSegments)r.destroy();for(const r of this._gridSegments)r.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const r of this._wireframeSegments)r.destroy()}}_createGrid(r){const e=new $t,o=new ln,l=65;for(let u=0;u<l;u++)for(let f=0;f<l;f++)e.emplaceBack(f,u);this._gridSegments=[];for(let u=0,f=0;u<th.length;u++){const m=th[u];for(let b=0;b<m;b++)for(let w=0;w<64;w++){const A=b*l+w;o.emplaceBack(A+1,A,A+l),o.emplaceBack(A+l,A+l+1,A+1)}const y=64*m*2;this._gridSegments.push(mn.simpleSegment(0,f,(m+1)*l,y)),f+=y}this._gridBuffer=r.createVertexBuffer(e,bf.members),this._gridIndexBuffer=r.createIndexBuffer(o,!0)}_createPoles(r){const e=new ln;for(let u=0;u<=64;u++)e.emplaceBack(0,u+1,u+2);this._poleIndexBuffer=r.createIndexBuffer(e,!0);const o=new Gs,l=new Gs;this._poleSegments=[];for(let u=0,f=0;u<5;u++){const m=1<<u,y=512*m/Math.PI/2,b=360/m;o.emplaceBack(0,-y,0,0,0,.5,0),l.emplaceBack(0,-y,0,0,0,.5,1);for(let w=0;w<=64;w++){const A=w/64,k=yi(0,b,A),[D,R,F]=yE(qD,ZD,k,y);o.emplaceBack(D,R,F,0,0,A,0),l.emplaceBack(D,R,F,0,0,A,1)}this._poleSegments.push(mn.simpleSegment(f,0,66,64)),f+=66}this._poleNorthVertexBuffer=r.createVertexBuffer(o,mE,!1),this._poleSouthVertexBuffer=r.createVertexBuffer(l,mE,!1)}getGridBuffers(r){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[r]]}getPoleBuffers(r){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[r]]}getWirefameBuffers(r,e){if(!this._wireframeSegments){const o=new yr,l=64,u=l+1;this._wireframeSegments=[];for(let f=0,m=0;f<th.length;f++){const y=th[f];for(let w=0;w<y;w++)for(let A=0;A<l;A++){const k=w*u+A;o.emplaceBack(k,k+1),o.emplaceBack(k,k+u),o.emplaceBack(k,k+u+1)}const b=y*l*3;this._wireframeSegments.push(mn.simpleSegment(0,m,(y+1)*u,b)),m+=b}this._wireframeIndexBuffer=r.createIndexBuffer(o)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},a.GlyphManager=Qu,a.ImagePosition=Cv,a.LineAtlas=jv,a.LngLat=Di,a.LngLatBounds=Oa,a.LocalGlyphMode=Mv,a.MAX_MERCATOR_LATITUDE=ns,a.MercatorCoordinate=Gu,a.ONE_EM=Zn,a.OverscaledTileID=lr,a.Properties=gt,a.RGBAImage=Or,a.Ray=hv,a.RequestManager=class{constructor(r,e,o){this._transformRequestFn=r,this._customAccessToken=e,this._silenceAuthErrors=!!o,this._createSkuToken()}_createSkuToken(){const r=function(){let e="";for(let o=0;o<10;o++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",li,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,e){return this._transformRequestFn&&this._transformRequestFn(r,e)||{url:r}}normalizeStyleURL(r,e){if(!pi(r))return r;const o=wn(r);return o.path=`/styles/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||e)}normalizeGlyphsURL(r,e){if(!pi(r))return r;const o=wn(r);return o.path=`/fonts/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||e)}normalizeSourceURL(r,e,o,l){if(!pi(r))return r;const u=wn(r);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),o&&u.params.push(`language=${o}`),l&&u.params.push(`worldview=${l}`),this._makeAPIURL(u,this._customAccessToken||e)}normalizeSpriteURL(r,e,o,l){const u=wn(r);return pi(r)?(u.path=`/styles/v1${u.path}/sprite${e}${o}`,this._makeAPIURL(u,this._customAccessToken||l)):(u.path+=`${e}${o}`,Sr(u))}normalizeTileURL(r,e,o){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!pi(r))return r;const l=wn(r);l.path=l.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||o&&l.authority!=="raster"&&o===512?"@2x":""}${rt.supported?".webp":"$1"}`),l.authority==="raster"?l.path=`/${Ue.RASTER_URL_PREFIX}${l.path}`:(l.path=l.path.replace(/^.+\/v4\//,"/"),l.path=`/${Ue.TILE_URL_VERSION}${l.path}`);const u=this._customAccessToken||function(f){for(const m of f){const y=m.match(/^access_token=(.*)$/);if(y)return y[1]}return null}(l.params)||Ue.ACCESS_TOKEN;return Ue.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&l.params.push(`sku=${this._skuToken}`),this._makeAPIURL(l,u)}canonicalizeTileURL(r,e){const o=wn(r);if(!o.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!o.path.match(/\.[\w]+$/))return r;let l="mapbox://";o.path.match(/^\/raster\/v1\//)?l+=`raster/${o.path.replace(`/${Ue.RASTER_URL_PREFIX}/`,"")}`:l+=`tiles/${o.path.replace(`/${Ue.TILE_URL_VERSION}/`,"")}`;let u=o.params;return e&&(u=u.filter(f=>!f.match(/^access_token=/))),u.length&&(l+=`?${u.join("&")}`),l}canonicalizeTileset(r,e){const o=!!e&&pi(e),l=[];for(const u of r.tiles||[])Ii(u)?l.push(this.canonicalizeTileURL(u,o)):l.push(u);return l}_makeAPIURL(r,e){const o="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=wn(Ue.API_URL);if(r.protocol=l.protocol,r.authority=l.authority,r.protocol==="http"){const u=r.params.indexOf("secure");u>=0&&r.params.splice(u,1)}if(l.path!=="/"&&(r.path=`${l.path}${r.path}`),!Ue.REQUIRE_ACCESS_TOKEN)return Sr(r);if(e=e||Ue.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${o}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${o}`)}return r.params=r.params.filter(u=>u.indexOf("access_token")===-1),r.params.push(`access_token=${e||""}`),Sr(r)}},a.ResourceType=re,a.SegmentVector=mn,a.SourceCache=ec,a.StencilMode=Gv,a.StructArrayLayout1ui2=mo,a.StructArrayLayout2f1f2i16=vn,a.StructArrayLayout2i4=$t,a.StructArrayLayout2ui4=yr,a.StructArrayLayout3f12=ji,a.StructArrayLayout3ui6=ln,a.StructArrayLayout4i8=Ut,a.StructArrayLayout5f20=is,a.Texture=Af,a.Tile=Vv,a.Transitionable=ne,a.Uniform1f=Nm,a.Uniform1i=class extends Zs{constructor(r,e){super(r,e),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},a.Uniform2f=class extends Zs{constructor(r,e){super(r,e),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},a.Uniform3f=class extends Zs{constructor(r,e){super(r,e),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},a.Uniform4f=X1,a.UniformColor=K1,a.UniformMatrix2f=class extends Zs{constructor(r,e){super(r,e),this.current=eP}set(r){for(let e=0;e<4;e++)if(r[e]!==this.current[e]){this.current=r,this.gl.uniformMatrix2fv(this.location,!1,r);break}}},a.UniformMatrix3f=class extends Zs{constructor(r,e){super(r,e),this.current=Qk}set(r){for(let e=0;e<9;e++)if(r[e]!==this.current[e]){this.current=r,this.gl.uniformMatrix3fv(this.location,!1,r);break}}},a.UniformMatrix4f=class extends Zs{constructor(r,e){super(r,e),this.current=Jk}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let e=1;e<16;e++)if(r[e]!==this.current[e]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},a.UnwrappedTileID=Rw,a.ValidationError=ft,a.VectorTileWorkerSource=class extends Mi{constructor(r,e,o,l,u){super(),this.actor=r,this.layerIndex=e,this.availableImages=o,this.loadVectorData=u||KE,this.loading={},this.loaded={},this.deduped=new XE(r.scheduler),this.isSpriteLoaded=l,this.scheduler=r.scheduler}loadTile(r,e){const o=r.uid,l=r&&r.request,u=l&&l.collectResourceTiming,f=this.loading[o]=new _L(r);f.abort=this.loadVectorData(r,(m,y)=>{const b=!this.loading[o];if(delete this.loading[o],b||m||!y)return f.status="done",b||(this.loaded[o]=f),e(m);const w=y.rawData,A={};y.expires&&(A.expires=y.expires),y.cacheControl&&(A.cacheControl=y.cacheControl),f.vectorTile=y.vectorTile||new Yl.VectorTile(new yf(w));const k=()=>{f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,(D,R)=>{if(D||!R)return e(D);const F={};if(u){const V=Wt(l);V.length>0&&(F.resourceTiming=JSON.parse(JSON.stringify(V)))}e(null,Ft({rawTileData:w.slice(0)},R,A,F))})};this.isSpriteLoaded?k():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(k,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom}):k()}),this.loaded=this.loaded||{},this.loaded[o]=f})}reloadTile(r,e){const o=this.loaded,l=r.uid,u=this;if(o&&o[l]){const f=o[l];f.showCollisionBoxes=r.showCollisionBoxes,f.enableTerrain=!!r.enableTerrain,f.projection=r.projection,f.tileTransform=Ql(r.tileID.canonical,r.projection);const m=(y,b)=>{const w=f.reloadCallback;w&&(delete f.reloadCallback,f.parse(f.vectorTile,u.layerIndex,this.availableImages,u.actor,w)),e(y,b)};f.status==="parsing"?f.reloadCallback=m:f.status==="done"&&(f.vectorTile?f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,m):m())}}abortTile(r,e){const o=r.uid,l=this.loading[o];l&&(l.abort&&l.abort(),delete this.loading[o]),e()}removeTile(r,e){const o=this.loaded,l=r.uid;o&&o[l]&&delete o[l],e()}},a.WritingMode=eo,a.ZoomHistory=Sm,a.add=Ba,a.addDynamicAttributes=y_,a.adjoint=function(r,e){var o=e[0],l=e[1],u=e[2],f=e[3],m=e[4],y=e[5],b=e[6],w=e[7],A=e[8];return r[0]=m*A-y*w,r[1]=u*w-l*A,r[2]=l*y-u*m,r[3]=y*b-f*A,r[4]=o*A-u*b,r[5]=u*f-o*y,r[6]=f*w-m*b,r[7]=l*b-o*w,r[8]=o*m-l*f,r},a.asyncAll=jt,a.bezier=Be,a.bindAll=hi,a.boundsAttributes=zE,a.bufferConvexPolygon=function(r,e){const o=[];for(let l=0;l<r.length;l++){const u=pt(l-1,-1,r.length-1),f=pt(l+1,-1,r.length-1),m=r[l],y=r[f],b=r[u].sub(m).unit(),w=y.sub(m).unit(),A=w.angleWithSep(b.x,b.y),k=b.add(w).unit().mult(-1*e/Math.sin(A/2));o.push(m.add(k))}return o},a.cacheEntryPossiblyAdded=function(r){Y++,Y>iu&&(r.getActor().send("enforceCacheSizeLimit",fa),Y=0)},a.calculateGlobeLabelMatrix=function(r,e){const{x:o,y:l}=r.point,u=bE(o,l,r.worldSize/r._projectionScaler,0,0);return Ra(u,u,xE(as(e)))},a.calculateGlobeMatrix=function(r){const{x:e,y:o}=r.point,{lng:l,lat:u}=r._center;return bE(e,o,r.worldSize,l,u)},a.calculateGlobeMercatorMatrix=function(r){const e=r.worldSize,o=r.point,l=_o(1,r.center.lat)*e,u=r.pixelsPerMeter,f=e/(l/r.pixelsPerMeter),m=zr(new Float64Array(16));return Xl(m,m,[o.x,o.y,0]),rs(m,m,[f,f,u]),Float32Array.from(m)},a.circumferenceAtLatitude=tv,a.clamp=Ge,a.clearTileCache=function(r){const e=[];for(const o in rr)e.push(S.caches.delete(o)),delete rr[o];r&&Promise.all(e).catch(r).then(()=>r())},a.clipLine=aE,a.clone=function(r){var e=new Lr(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},a.clone$1=sn,a.collisionCircleLayout=uD,a.config=Ue,a.conjugate=function(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r},a.create=function(){var r=new Lr(16);return Lr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},a.create$1=cw,a.createExpression=Bs,a.createLayout=_t,a.createStyleLayer=function(r){return r.type==="custom"?new aL(r):new cL[r.type](r)},a.cross=uv,a.degToRad=ue,a.distance=function(r,e){return Math.hypot(e[0]-r[0],e[1]-r[1],e[2]-r[2])},a.div=function(r,e,o){return r[0]=e[0]/o[0],r[1]=e[1]/o[1],r[2]=e[2]/o[2],r},a.dot=go,a.ease=$e,a.easeCubicInOut=xe,a.emitValidationErrors=Em,a.endsWith=ri,a.enforceCacheSizeLimit=function(r){for(const e in rr)J(e),rr[e].then(o=>{o.keys().then(l=>{for(let u=0;u<l.length-r;u++)o.delete(l[u])})})},a.evaluateSizeForFeature=s_,a.evaluateSizeForZoom=Xu,a.evaluateVariableOffset=dE,a.evented=G,a.exactEquals=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]},a.exactEquals$1=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]},a.exported=et,a.exported$1=rt,a.extend=Ft,a.extend$1=_r,a.fillExtrusionHeightLift=Lw,a.filterObject=Wi,a.fromMat4=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r},a.fromQuat=function(r,e){var o=e[0],l=e[1],u=e[2],f=e[3],m=o+o,y=l+l,b=u+u,w=o*m,A=l*m,k=l*y,D=u*m,R=u*y,F=u*b,V=f*m,K=f*y,ee=f*b;return r[0]=1-k-F,r[1]=A+ee,r[2]=D-K,r[3]=0,r[4]=A-ee,r[5]=1-w-F,r[6]=R+V,r[7]=0,r[8]=D+K,r[9]=R-V,r[10]=1-w-k,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},a.fromRotation=function(r,e){var o=Math.sin(e),l=Math.cos(e);return r[0]=l,r[1]=o,r[2]=0,r[3]=-o,r[4]=l,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},a.fromScaling=function(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},a.furthestTileCorner=function(r){const e=Math.round((r+45+360)%360/90)%4;return fe[e]},a.getAABBPointSquareDist=function(r,e,o){let l=0;for(let u=0;u<2;++u){const f=o?o[u]:0;r[u]>f&&(l+=(r[u]-f)*(r[u]-f)),e[u]<f&&(l+=(f-e[u])*(f-e[u]))}return l},a.getAnchorAlignment=Iv,a.getAnchorJustification=Pv,a.getBounds=function(r){let e=1/0,o=1/0,l=-1/0,u=-1/0;for(const f of r)e=Math.min(e,f.x),o=Math.min(o,f.y),l=Math.max(l,f.x),u=Math.max(u,f.y);return{min:new P(e,o),max:new P(l,u)}},a.getColumn=di,a.getGridMatrix=function(r,e,o){const[l,u]=e,f=.015625;return[0,(u[1]-l[1])*f,1<<r.z,(u[0]-l[0])/th[o],0,r.y,l[0],l[1],f]},a.getImage=Pt,a.getJSON=function(r,e){return we(Ft(r,{type:"json"}),e)},a.getLatitudinalLod=function(r){const e=80.051129;r=Ge(r,-80.051129,e)/e*90;const o=Math.pow(Math.abs(Math.sin(ue(r))),3);return Math.round(o*(th.length-1))},a.getMapSessionAPI=vd,a.getPerformanceMeasurement=Wt,a.getProjection=ME,a.getRTLTextPluginStatus=ie,a.getReferrer=Te,a.getTilePoint=function(r,{x:e,y:o},l=0){return new P(((e-l)*r.scale-r.x)*Ot,(o*r.scale-r.y)*Ot)},a.getTileVec3=function(r,e,o=0){return Zu(((e.x-o)*r.scale-r.x)*Ot,(e.y*r.scale-r.y)*Ot,Q1(e.z,e.y))},a.getVideo=function(r,e){const o=S.document.createElement("video");o.muted=!0,o.onloadstart=function(){e(null,o)};for(let l=0;l<r.length;l++){const u=S.document.createElement("source");dt(r[l])||(o.crossOrigin="Anonymous"),u.src=r[l],o.appendChild(u)}return{cancel:()=>{}}},a.globeCenterToScreenPoint=function(r){const e=[0,0,0],o=zr(new Float64Array(16));return Ra(o,r.pixelMatrix,r.globeMatrix),qn(e,e,o),new P(e[0],e[1])},a.globeECEFOrigin=function(r,e){const o=[0,0,0];return qn(o,o,wf(as(e.canonical))),qn(o,o,r),o},a.globeNormalizeECEF=wf,a.globePixelsToTileUnits=function(r,e){return Ot/(512*Math.pow(2,r))*f_(as(e))},a.globePoleMatrixForTile=function(r,e,o){const l=zr(new Float64Array(16)),u=1<<r,f=360*(e/u-.5),m=o.point,y=o.worldSize/(o.tileSize*u);return Xl(l,l,[m.x,m.y,-o.worldSize/Math.PI/2]),rs(l,l,[y,y,y]),qm(l,l,ue(-o._center.lat)),Zm(l,l,ue(-o._center.lng+f)),Float32Array.from(l)},a.globeTileBounds=as,a.globeTileLatLngCorners=Ov,a.globeTiltAtLngLat=wE,a.globeToMercatorTransition=Rv,a.globeUseCustomAntiAliasing=function(r,e,o){const l=Rv(o.zoom),u=r.style.map._antialias,f=!!e.extStandardDerivatives,m=e.extStandardDerivativesForceOff||r.terrain&&r.terrain.exaggeration()>0;return l===0&&!u&&!m&&f},a.identity=zr,a.identity$1=_w,a.invert=function(r,e){var o=e[0],l=e[1],u=e[2],f=e[3],m=e[4],y=e[5],b=e[6],w=e[7],A=e[8],k=e[9],D=e[10],R=e[11],F=e[12],V=e[13],K=e[14],ee=e[15],he=o*y-l*m,ce=o*b-u*m,pe=o*w-f*m,ye=l*b-u*y,be=l*w-f*y,ke=u*w-f*b,Pe=A*V-k*F,Fe=A*K-D*F,Xe=A*ee-R*F,Ae=k*K-D*V,ze=k*ee-R*V,Ke=D*ee-R*K,Ye=he*Ke-ce*ze+pe*Ae+ye*Xe-be*Fe+ke*Pe;return Ye?(r[0]=(y*Ke-b*ze+w*Ae)*(Ye=1/Ye),r[1]=(u*ze-l*Ke-f*Ae)*Ye,r[2]=(V*ke-K*be+ee*ye)*Ye,r[3]=(D*be-k*ke-R*ye)*Ye,r[4]=(b*Xe-m*Ke-w*Fe)*Ye,r[5]=(o*Ke-u*Xe+f*Fe)*Ye,r[6]=(K*pe-F*ke-ee*ce)*Ye,r[7]=(A*ke-D*pe+R*ce)*Ye,r[8]=(m*ze-y*Xe+w*Pe)*Ye,r[9]=(l*Xe-o*ze-f*Pe)*Ye,r[10]=(F*be-V*pe+ee*he)*Ye,r[11]=(k*pe-A*be-R*he)*Ye,r[12]=(y*Fe-m*Ae-b*Pe)*Ye,r[13]=(o*Ae-l*Fe+u*Pe)*Ye,r[14]=(V*ce-F*ye-K*he)*Ye,r[15]=(A*ye-k*ce+D*he)*Ye,r):null},a.isLngLatBehindGlobe=function(r,e){return wE(r,e)>Math.PI/2*1.01},a.isMapAuthenticated=function(r){return Qo.has(r)},a.isMapboxURL=pi,a.isSafariWithAntialiasingBug=function(r){const e=r.navigator?r.navigator.userAgent:null;return!!It(r)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.latFromMercatorY=Tn,a.len=gP,a.length=sf,a.length$1=function(r){return Math.hypot(r[0],r[1],r[2],r[3])},a.loadVectorTile=KE,a.makeRequest=we,a.mapValue=function(r,e,o,l,u){return Ge((r-e)/(o-e)*(u-l)+l,l,u)},a.mercatorXfromLng=ql,a.mercatorYfromLat=Zl,a.mercatorZfromAltitude=_o,a.mul=mP,a.mul$1=_P,a.multiply=Ra,a.multiply$1=function(r,e,o){var l=e[0],u=e[1],f=e[2],m=e[3],y=e[4],b=e[5],w=e[6],A=e[7],k=e[8],D=o[0],R=o[1],F=o[2],V=o[3],K=o[4],ee=o[5],he=o[6],ce=o[7],pe=o[8];return r[0]=D*l+R*m+F*w,r[1]=D*u+R*y+F*A,r[2]=D*f+R*b+F*k,r[3]=V*l+K*m+ee*w,r[4]=V*u+K*y+ee*A,r[5]=V*f+K*b+ee*k,r[6]=he*l+ce*m+pe*w,r[7]=he*u+ce*y+pe*A,r[8]=he*f+ce*b+pe*k,r},a.multiply$2=dw,a.nextPowerOfTwo=qi,a.normalize=ar,a.normalize$1=function(r,e){var o=e[0],l=e[1],u=e[2],f=e[3],m=o*o+l*l+u*u+f*f;return m>0&&(m=1/Math.sqrt(m)),r[0]=o*m,r[1]=l*m,r[2]=u*m,r[3]=f*m,r},a.number=yi,a.ortho=function(r,e,o,l,u,f,m){var y=1/(e-o),b=1/(l-u),w=1/(f-m);return r[0]=-2*y,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*b,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*w,r[11]=0,r[12]=(e+o)*y,r[13]=(u+l)*b,r[14]=(m+f)*w,r[15]=1,r},a.pbf=yf,a.perspective=function(r,e,o,l,u){var f,m=1/Math.tan(e/2);return r[0]=m/o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=m,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,u!=null&&u!==1/0?(r[10]=(u+l)*(f=1/(l-u)),r[14]=2*u*l*f):(r[10]=-1,r[14]=-2*l),r},a.pick=function(r,e){const o={};for(let l=0;l<e.length;l++){const u=e[l];u in r&&(o[u]=r[u])}return o},a.plugin=Q,a.pointGeometry=P,a.polygonContainsPoint=Hl,a.polygonIntersectsBox=sw,a.polygonIntersectsPolygon=iw,a.polygonizeBounds=function(r,e,o=0,l=!0){const u=new P(o,o),f=r.sub(u),m=e.add(u),y=[f,new P(m.x,f.y),m,new P(f.x,m.y)];return l&&y.push(f.clone()),y},a.posAttributes=bf,a.postMapLoadEvent=eu,a.postTurnstileEvent=jn,a.potpack=Tv,a.prevPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.floor(Math.log(r)/Math.LN2))},a.radToDeg=oe,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(r){return r({pluginStatus:N,pluginURL:$}),G.on("pluginStateChange",r),r},a.removeAuthState=function(r){Qo.delete(r)},a.renderColorRamp=mv,a.resample=ew,a.rotateX=qm,a.rotateX$1=gw,a.rotateY=Zm,a.rotateY$1=yw,a.rotateZ=function(r,e,o){var l=Math.sin(o),u=Math.cos(o),f=e[0],m=e[1],y=e[2],b=e[3],w=e[4],A=e[5],k=e[6],D=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=f*u+w*l,r[1]=m*u+A*l,r[2]=y*u+k*l,r[3]=b*u+D*l,r[4]=w*u-f*l,r[5]=A*u-m*l,r[6]=k*u-y*l,r[7]=D*u-b*l,r},a.rotateZ$1=function(r,e,o){o*=.5;var l=e[0],u=e[1],f=e[2],m=e[3],y=Math.sin(o),b=Math.cos(o);return r[0]=l*b+u*y,r[1]=u*b-l*y,r[2]=f*b+m*y,r[3]=m*b-f*y,r},a.scale=rs,a.scale$1=pw,a.scale$2=os,a.scaleAndAdd=Xm,a.setCacheLimits=function(r,e){fa=r,iu=e},a.setColumn=function(r,e,o){r[4*e+0]=o[0],r[4*e+1]=o[1],r[4*e+2]=o[2],r[4*e+3]=o[3]},a.setRTLTextPlugin=function(r,e,o=!1){if(N===C||N===I||N===L)throw new Error("setRTLTextPlugin cannot be called multiple times.");$=et.resolveURL(r),N=C,B=e,H(),o||X()},a.smoothstep=xt,a.spec=Ee,a.storeAuthState=function(r,e){e?Qo.add(r):Qo.delete(r)},a.sub=yo,a.subtract=cv,a.symbolSize=hD,a.tileAABB=function(r,e,o,l,u,f,m,y,b){if(b.name==="globe")return GD(r,e,new n_(o,l,u));const w=Ql({z:o,x:l,y:u},b);return new Qr([(f+w.x/w.scale)*e,e*(w.y/w.scale),m],[(f+w.x2/w.scale)*e,e*(w.y2/w.scale),y])},a.tileTransform=Ql,a.transformMat3=function(r,e,o){var l=e[0],u=e[1],f=e[2];return r[0]=l*o[0]+u*o[3]+f*o[6],r[1]=l*o[1]+u*o[4]+f*o[7],r[2]=l*o[2]+u*o[5]+f*o[8],r},a.transformMat4=qn,a.transformMat4$1=Kl,a.transformQuat=fw,a.translate=Xl,a.transpose=function(r,e){if(r===e){var o=e[1],l=e[2],u=e[5];r[1]=e[3],r[2]=e[6],r[3]=o,r[5]=e[7],r[6]=l,r[7]=u}else r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8];return r},a.triggerPluginCompletionEvent=Z,a.uniqueId=wt,a.updateGlobeVertexNormal=function(r,e,o,l,u){const f=5*e+2;r.float32[f+0]=o,r.float32[f+1]=l,r.float32[f+2]=u},a.validateCustomStyleLayer=function(r){const e=[],o=r.id;return o===void 0&&e.push({message:`layers.${o}: missing required property "id"`}),r.render===void 0&&e.push({message:`layers.${o}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&e.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),e},a.validateFilter=r=>Jr(Wd(r)),a.validateFog=r=>Jr(vm(r)),a.validateLayer=r=>Jr(gm(r)),a.validateLight=r=>Jr(Hd(r)),a.validateSource=r=>Jr(ym(r)),a.validateStyle=bm,a.validateTerrain=r=>Jr(Xd(r)),a.values=Dt,a.vectorTile=Yl,a.version=de,a.warnOnce=oi,a.window=S,a.wrap=pt}),x(["./shared"],function(a){function S(J){if(typeof J=="number"||typeof J=="boolean"||typeof J=="string"||J==null)return JSON.stringify(J);if(Array.isArray(J)){let j="[";for(const Y of J)j+=`${S(Y)},`;return`${j}]`}let U="{";for(const j of Object.keys(J).sort())U+=`${j}:${S(J[j])},`;return`${U}}`}function O(J){let U="";for(const j of a.refProperties)U+=`/${S(J[j])}`;return U}class M{constructor(U){this.keyCache={},U&&this.replace(U)}replace(U){this._layerConfigs={},this._layers={},this.update(U,[])}update(U,j){for(const re of U)this._layerConfigs[re.id]=re,(this._layers[re.id]=a.createStyleLayer(re)).compileFilter(),this.keyCache[re.id]&&delete this.keyCache[re.id];for(const re of j)delete this.keyCache[re],delete this._layerConfigs[re],delete this._layers[re];this.familiesBySource={};const Y=function(re,ge){const Te={};for(let ve=0;ve<re.length;ve++){const Se=ge&&ge[re[ve].id]||O(re[ve]);ge&&(ge[re[ve].id]=Se);let je=Te[Se];je||(je=Te[Se]=[]),je.push(re[ve])}const we=[];for(const ve in Te)we.push(Te[ve]);return we}(a.values(this._layerConfigs),this.keyCache);for(const re of Y){const ge=re.map(dt=>this._layers[dt.id]),Te=ge[0];if(Te.visibility==="none")continue;const we=Te.source||"";let ve=this.familiesBySource[we];ve||(ve=this.familiesBySource[we]={});const Se=Te.sourceLayer||"_geojsonTileLayer";let je=ve[Se];je||(je=ve[Se]=[]),je.push(ge)}}}class P{loadTile(U,j){const{uid:Y,encoding:re,rawImageData:ge,padding:Te,buildQuadTree:we}=U,ve=a.window.ImageBitmap&&ge instanceof a.window.ImageBitmap?this.getImageData(ge,Te):ge;j(null,new a.DEMData(Y,ve,re,Te<1,we))}getImageData(U,j){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(U.width,U.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=U.width,this.offscreenCanvas.height=U.height,this.offscreenCanvasContext.drawImage(U,0,0,U.width,U.height);const Y=this.offscreenCanvasContext.getImageData(-j,-j,U.width+2*j,U.height+2*j);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Y}}var z=function J(U,j){var Y,re=U&&U.type;if(re==="FeatureCollection")for(Y=0;Y<U.features.length;Y++)J(U.features[Y],j);else if(re==="GeometryCollection")for(Y=0;Y<U.geometries.length;Y++)J(U.geometries[Y],j);else if(re==="Feature")J(U.geometry,j);else if(re==="Polygon")q(U.coordinates,j);else if(re==="MultiPolygon")for(Y=0;Y<U.coordinates.length;Y++)q(U.coordinates[Y],j);return U};function q(J,U){if(J.length!==0){se(J[0],U);for(var j=1;j<J.length;j++)se(J[j],!U)}}function se(J,U){for(var j=0,Y=0,re=0,ge=J.length,Te=ge-1;re<ge;Te=re++){var we=(J[re][0]-J[Te][0])*(J[Te][1]+J[re][1]),ve=j+we;Y+=Math.abs(j)>=Math.abs(we)?j-ve+we:we-ve+j,j=ve}j+Y>=0!=!!U&&J.reverse()}const ue=a.vectorTile.VectorTileFeature.prototype.toGeoJSON;class oe{constructor(U){this._feature=U,this.extent=a.EXTENT,this.type=U.type,this.properties=U.tags,"id"in U&&!isNaN(U.id)&&(this.id=parseInt(U.id,10))}loadGeometry(){if(this._feature.type===1){const U=[];for(const j of this._feature.geometry)U.push([new a.pointGeometry(j[0],j[1])]);return U}{const U=[];for(const j of this._feature.geometry){const Y=[];for(const re of j)Y.push(new a.pointGeometry(re[0],re[1]));U.push(Y)}return U}}toGeoJSON(U,j,Y){return ue.call(this,U,j,Y)}}class fe{constructor(U){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=U.length,this._features=U}feature(U){return new oe(this._features[U])}}var xe=a.vectorTile.VectorTileFeature,Be=$e;function $e(J,U){this.options=U||{},this.features=J,this.length=J.length}function Ge(J,U){this.id=typeof J.id=="number"?J.id:void 0,this.type=J.type,this.rawGeometry=J.type===1?[J.geometry]:J.geometry,this.properties=J.tags,this.extent=U||4096}$e.prototype.feature=function(J){return new Ge(this.features[J],this.options.extent)},Ge.prototype.loadGeometry=function(){var J=this.rawGeometry;this.geometry=[];for(var U=0;U<J.length;U++){for(var j=J[U],Y=[],re=0;re<j.length;re++)Y.push(new a.pointGeometry(j[re][0],j[re][1]));this.geometry.push(Y)}return this.geometry},Ge.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var J=this.geometry,U=1/0,j=-1/0,Y=1/0,re=-1/0,ge=0;ge<J.length;ge++)for(var Te=J[ge],we=0;we<Te.length;we++){var ve=Te[we];U=Math.min(U,ve.x),j=Math.max(j,ve.x),Y=Math.min(Y,ve.y),re=Math.max(re,ve.y)}return[U,Y,j,re]},Ge.prototype.toGeoJSON=xe.prototype.toGeoJSON;var xt=jt,pt=Be;function jt(J){var U=new a.pbf;return function(j,Y){for(var re in j.layers)Y.writeMessage(3,Dt,j.layers[re])}(J,U),U.finish()}function Dt(J,U){var j;U.writeVarintField(15,J.version||1),U.writeStringField(1,J.name||""),U.writeVarintField(5,J.extent||4096);var Y={keys:[],values:[],keycache:{},valuecache:{}};for(j=0;j<J.length;j++)Y.feature=J.feature(j),U.writeMessage(2,Ft,Y);var re=Y.keys;for(j=0;j<re.length;j++)U.writeStringField(3,re[j]);var ge=Y.values;for(j=0;j<ge.length;j++)U.writeMessage(4,bn,ge[j])}function Ft(J,U){var j=J.feature;j.id!==void 0&&U.writeVarintField(1,j.id),U.writeMessage(2,ai,J),U.writeVarintField(3,j.type),U.writeMessage(4,qi,j)}function ai(J,U){var j=J.feature,Y=J.keys,re=J.values,ge=J.keycache,Te=J.valuecache;for(var we in j.properties){var ve=j.properties[we],Se=ge[we];if(ve!==null){Se===void 0&&(Y.push(we),ge[we]=Se=Y.length-1),U.writeVarint(Se);var je=typeof ve;je!=="string"&&je!=="boolean"&&je!=="number"&&(ve=JSON.stringify(ve));var dt=je+":"+ve,We=Te[dt];We===void 0&&(re.push(ve),Te[dt]=We=re.length-1),U.writeVarint(We)}}}function wt(J,U){return(U<<3)+(7&J)}function Nt(J){return J<<1^J>>31}function qi(J,U){for(var j=J.loadGeometry(),Y=J.type,re=0,ge=0,Te=j.length,we=0;we<Te;we++){var ve=j[we],Se=1;Y===1&&(Se=ve.length),U.writeVarint(wt(1,Se));for(var je=Y===3?ve.length-1:ve.length,dt=0;dt<je;dt++){dt===1&&Y!==1&&U.writeVarint(wt(2,je-1));var We=ve[dt].x-re,kt=ve[dt].y-ge;U.writeVarint(Nt(We)),U.writeVarint(Nt(kt)),re+=We,ge+=kt}Y===3&&U.writeVarint(wt(7,1))}}function bn(J,U){var j=typeof J;j==="string"?U.writeStringField(1,J):j==="boolean"?U.writeBooleanField(7,J):j==="number"&&(J%1!=0?U.writeDoubleField(3,J):J<0?U.writeSVarintField(6,J):U.writeVarintField(5,J))}function hi(J,U,j,Y,re,ge){if(re-Y<=j)return;const Te=Y+re>>1;ri(J,U,Te,Y,re,ge%2),hi(J,U,j,Y,Te-1,ge+1),hi(J,U,j,Te+1,re,ge+1)}function ri(J,U,j,Y,re,ge){for(;re>Y;){if(re-Y>600){const Se=re-Y+1,je=j-Y+1,dt=Math.log(Se),We=.5*Math.exp(2*dt/3),kt=.5*Math.sqrt(dt*We*(Se-We)/Se)*(je-Se/2<0?-1:1);ri(J,U,j,Math.max(Y,Math.floor(j-je*We/Se+kt)),Math.min(re,Math.floor(j+(Se-je)*We/Se+kt)),ge)}const Te=U[2*j+ge];let we=Y,ve=re;for(ei(J,U,Y,j),U[2*re+ge]>Te&&ei(J,U,Y,re);we<ve;){for(ei(J,U,we,ve),we++,ve--;U[2*we+ge]<Te;)we++;for(;U[2*ve+ge]>Te;)ve--}U[2*Y+ge]===Te?ei(J,U,Y,ve):(ve++,ei(J,U,ve,re)),ve<=j&&(Y=ve+1),j<=ve&&(re=ve-1)}}function ei(J,U,j,Y){Wi(J,j,Y),Wi(U,2*j,2*Y),Wi(U,2*j+1,2*Y+1)}function Wi(J,U,j){const Y=J[U];J[U]=J[j],J[j]=Y}function sn(J,U,j,Y){const re=J-j,ge=U-Y;return re*re+ge*ge}xt.fromVectorTileJs=jt,xt.fromGeojsonVt=function(J,U){U=U||{};var j={};for(var Y in J)j[Y]=new Be(J[Y].features,U),j[Y].name=Y,j[Y].version=U.version,j[Y].extent=U.extent;return jt({layers:j})},xt.GeoJSONWrapper=pt;const kn=J=>J[0],oi=J=>J[1];class Si{constructor(U,j=kn,Y=oi,re=64,ge=Float64Array){this.nodeSize=re,this.points=U;const Te=U.length<65536?Uint16Array:Uint32Array,we=this.ids=new Te(U.length),ve=this.coords=new ge(2*U.length);for(let Se=0;Se<U.length;Se++)we[Se]=Se,ve[2*Se]=j(U[Se]),ve[2*Se+1]=Y(U[Se]);hi(we,ve,re,0,we.length-1,0)}range(U,j,Y,re){return function(ge,Te,we,ve,Se,je,dt){const We=[0,ge.length-1,0],kt=[];let Lt,Pt;for(;We.length;){const Rt=We.pop(),Ht=We.pop(),Ei=We.pop();if(Ht-Ei<=dt){for(let Ee=Ei;Ee<=Ht;Ee++)Lt=Te[2*Ee],Pt=Te[2*Ee+1],Lt>=we&&Lt<=Se&&Pt>=ve&&Pt<=je&&kt.push(ge[Ee]);continue}const Zi=Math.floor((Ei+Ht)/2);Lt=Te[2*Zi],Pt=Te[2*Zi+1],Lt>=we&&Lt<=Se&&Pt>=ve&&Pt<=je&&kt.push(ge[Zi]);const Mi=(Rt+1)%2;(Rt===0?we<=Lt:ve<=Pt)&&(We.push(Ei),We.push(Zi-1),We.push(Mi)),(Rt===0?Se>=Lt:je>=Pt)&&(We.push(Zi+1),We.push(Ht),We.push(Mi))}return kt}(this.ids,this.coords,U,j,Y,re,this.nodeSize)}within(U,j,Y){return function(re,ge,Te,we,ve,Se){const je=[0,re.length-1,0],dt=[],We=ve*ve;for(;je.length;){const kt=je.pop(),Lt=je.pop(),Pt=je.pop();if(Lt-Pt<=Se){for(let Mi=Pt;Mi<=Lt;Mi++)sn(ge[2*Mi],ge[2*Mi+1],Te,we)<=We&&dt.push(re[Mi]);continue}const Rt=Math.floor((Pt+Lt)/2),Ht=ge[2*Rt],Ei=ge[2*Rt+1];sn(Ht,Ei,Te,we)<=We&&dt.push(re[Rt]);const Zi=(kt+1)%2;(kt===0?Te-ve<=Ht:we-ve<=Ei)&&(je.push(Pt),je.push(Rt-1),je.push(Zi)),(kt===0?Te+ve>=Ht:we+ve>=Ei)&&(je.push(Rt+1),je.push(Lt),je.push(Zi))}return dt}(this.ids,this.coords,U,j,Y,this.nodeSize)}}const yn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:J=>J},Ne=Math.fround||(bt=new Float32Array(1),J=>(bt[0]=+J,bt[0]));var bt;class ct{constructor(U){this.options=Le(Object.create(yn),U),this.trees=new Array(this.options.maxZoom+1)}load(U){const{log:j,minZoom:Y,maxZoom:re,nodeSize:ge}=this.options;j&&console.time("total time");const Te=`prepare ${U.length} points`;j&&console.time(Te),this.points=U;let we=[];for(let ve=0;ve<U.length;ve++)U[ve].geometry&&we.push(wi(U[ve],ve));this.trees[re+1]=new Si(we,He,Ze,ge,Float32Array),j&&console.timeEnd(Te);for(let ve=re;ve>=Y;ve--){const Se=+Date.now();we=this._cluster(we,ve),this.trees[ve]=new Si(we,He,Ze,ge,Float32Array),j&&console.log("z%d: %d clusters in %dms",ve,we.length,+Date.now()-Se)}return j&&console.timeEnd("total time"),this}getClusters(U,j){let Y=((U[0]+180)%360+360)%360-180;const re=Math.max(-90,Math.min(90,U[1]));let ge=U[2]===180?180:((U[2]+180)%360+360)%360-180;const Te=Math.max(-90,Math.min(90,U[3]));if(U[2]-U[0]>=360)Y=-180,ge=180;else if(Y>ge){const je=this.getClusters([Y,re,180,Te],j),dt=this.getClusters([-180,re,ge,Te],j);return je.concat(dt)}const we=this.trees[this._limitZoom(j)],ve=we.range(Wt(Y),de(Te),Wt(ge),de(re)),Se=[];for(const je of ve){const dt=we.points[je];Se.push(dt.numPoints?di(dt):this.points[dt.index])}return Se}getChildren(U){const j=this._getOriginId(U),Y=this._getOriginZoom(U),re="No cluster with the specified id.",ge=this.trees[Y];if(!ge)throw new Error(re);const Te=ge.points[j];if(!Te)throw new Error(re);const we=this.options.radius/(this.options.extent*Math.pow(2,Y-1)),ve=ge.within(Te.x,Te.y,we),Se=[];for(const je of ve){const dt=ge.points[je];dt.parentId===U&&Se.push(dt.numPoints?di(dt):this.points[dt.index])}if(Se.length===0)throw new Error(re);return Se}getLeaves(U,j,Y){const re=[];return this._appendLeaves(re,U,j=j||10,Y=Y||0,0),re}getTile(U,j,Y){const re=this.trees[this._limitZoom(U)],ge=Math.pow(2,U),{extent:Te,radius:we}=this.options,ve=we/Te,Se=(Y-ve)/ge,je=(Y+1+ve)/ge,dt={features:[]};return this._addTileFeatures(re.range((j-ve)/ge,Se,(j+1+ve)/ge,je),re.points,j,Y,ge,dt),j===0&&this._addTileFeatures(re.range(1-ve/ge,Se,1,je),re.points,ge,Y,ge,dt),j===ge-1&&this._addTileFeatures(re.range(0,Se,ve/ge,je),re.points,-1,Y,ge,dt),dt.features.length?dt:null}getClusterExpansionZoom(U){let j=this._getOriginZoom(U)-1;for(;j<=this.options.maxZoom;){const Y=this.getChildren(U);if(j++,Y.length!==1)break;U=Y[0].properties.cluster_id}return j}_appendLeaves(U,j,Y,re,ge){const Te=this.getChildren(j);for(const we of Te){const ve=we.properties;if(ve&&ve.cluster?ge+ve.point_count<=re?ge+=ve.point_count:ge=this._appendLeaves(U,ve.cluster_id,Y,re,ge):ge<re?ge++:U.push(we),U.length===Y)break}return ge}_addTileFeatures(U,j,Y,re,ge,Te){for(const we of U){const ve=j[we],Se=ve.numPoints;let je,dt,We;if(Se)je=ti(ve),dt=ve.x,We=ve.y;else{const Pt=this.points[ve.index];je=Pt.properties,dt=Wt(Pt.geometry.coordinates[0]),We=de(Pt.geometry.coordinates[1])}const kt={type:1,geometry:[[Math.round(this.options.extent*(dt*ge-Y)),Math.round(this.options.extent*(We*ge-re))]],tags:je};let Lt;Se?Lt=ve.id:this.options.generateId?Lt=ve.index:this.points[ve.index].id&&(Lt=this.points[ve.index].id),Lt!==void 0&&(kt.id=Lt),Te.features.push(kt)}}_limitZoom(U){return Math.max(this.options.minZoom,Math.min(+U,this.options.maxZoom+1))}_cluster(U,j){const Y=[],{radius:re,extent:ge,reduce:Te,minPoints:we}=this.options,ve=re/(ge*Math.pow(2,j));for(let Se=0;Se<U.length;Se++){const je=U[Se];if(je.zoom<=j)continue;je.zoom=j;const dt=this.trees[j+1],We=dt.within(je.x,je.y,ve),kt=je.numPoints||1;let Lt=kt;for(const Pt of We){const Rt=dt.points[Pt];Rt.zoom>j&&(Lt+=Rt.numPoints||1)}if(Lt>kt&&Lt>=we){let Pt=je.x*kt,Rt=je.y*kt,Ht=Te&&kt>1?this._map(je,!0):null;const Ei=(Se<<5)+(j+1)+this.points.length;for(const Zi of We){const Mi=dt.points[Zi];if(Mi.zoom<=j)continue;Mi.zoom=j;const Ee=Mi.numPoints||1;Pt+=Mi.x*Ee,Rt+=Mi.y*Ee,Mi.parentId=Ei,Te&&(Ht||(Ht=this._map(je,!0)),Te(Ht,this._map(Mi)))}je.parentId=Ei,Y.push(It(Pt/Lt,Rt/Lt,Ei,Lt,Ht))}else if(Y.push(je),Lt>1)for(const Pt of We){const Rt=dt.points[Pt];Rt.zoom<=j||(Rt.zoom=j,Y.push(Rt))}}return Y}_getOriginId(U){return U-this.points.length>>5}_getOriginZoom(U){return(U-this.points.length)%32}_map(U,j){if(U.numPoints)return j?Le({},U.properties):U.properties;const Y=this.points[U.index].properties,re=this.options.map(Y);return j&&re===Y?Le({},re):re}}function It(J,U,j,Y,re){return{x:Ne(J),y:Ne(U),zoom:1/0,id:j,parentId:-1,numPoints:Y,properties:re}}function wi(J,U){const[j,Y]=J.geometry.coordinates;return{x:Ne(Wt(j)),y:Ne(de(Y)),zoom:1/0,index:U,parentId:-1}}function di(J){return{type:"Feature",id:J.id,properties:ti(J),geometry:{type:"Point",coordinates:[(U=J.x,360*(U-.5)),me(J.y)]}};var U}function ti(J){const U=J.numPoints,j=U>=1e4?`${Math.round(U/1e3)}k`:U>=1e3?Math.round(U/100)/10+"k":U;return Le(Le({},J.properties),{cluster:!0,cluster_id:J.id,point_count:U,point_count_abbreviated:j})}function Wt(J){return J/360+.5}function de(J){const U=Math.sin(J*Math.PI/180),j=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return j<0?0:j>1?1:j}function me(J){const U=(180-360*J)*Math.PI/180;return 360*Math.atan(Math.exp(U))/Math.PI-90}function Le(J,U){for(const j in U)J[j]=U[j];return J}function He(J){return J.x}function Ze(J){return J.y}function et(J,U,j,Y){for(var re,ge=Y,Te=j-U>>1,we=j-U,ve=J[U],Se=J[U+1],je=J[j],dt=J[j+1],We=U+3;We<j;We+=3){var kt=vt(J[We],J[We+1],ve,Se,je,dt);if(kt>ge)re=We,ge=kt;else if(kt===ge){var Lt=Math.abs(We-Te);Lt<we&&(re=We,we=Lt)}}ge>Y&&(re-U>3&&et(J,U,re,Y),J[re+2]=ge,j-re>3&&et(J,re,j,Y))}function vt(J,U,j,Y,re,ge){var Te=re-j,we=ge-Y;if(Te!==0||we!==0){var ve=((J-j)*Te+(U-Y)*we)/(Te*Te+we*we);ve>1?(j=re,Y=ge):ve>0&&(j+=Te*ve,Y+=we*ve)}return(Te=J-j)*Te+(we=U-Y)*we}function Ue(J,U,j,Y){var re={id:J===void 0?null:J,type:U,geometry:j,tags:Y,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ge){var Te=ge.geometry,we=ge.type;if(we==="Point"||we==="MultiPoint"||we==="LineString")rt(ge,Te);else if(we==="Polygon"||we==="MultiLineString")for(var ve=0;ve<Te.length;ve++)rt(ge,Te[ve]);else if(we==="MultiPolygon")for(ve=0;ve<Te.length;ve++)for(var Se=0;Se<Te[ve].length;Se++)rt(ge,Te[ve][Se])}(re),re}function rt(J,U){for(var j=0;j<U.length;j+=3)J.minX=Math.min(J.minX,U[j]),J.minY=Math.min(J.minY,U[j+1]),J.maxX=Math.max(J.maxX,U[j]),J.maxY=Math.max(J.maxY,U[j+1])}function Qe(J,U,j,Y){if(U.geometry){var re=U.geometry.coordinates,ge=U.geometry.type,Te=Math.pow(j.tolerance/((1<<j.maxZoom)*j.extent),2),we=[],ve=U.id;if(j.promoteId?ve=U.properties[j.promoteId]:j.generateId&&(ve=Y||0),ge==="Point")Mt(re,we);else if(ge==="MultiPoint")for(var Se=0;Se<re.length;Se++)Mt(re[Se],we);else if(ge==="LineString")Tt(re,we,Te,!1);else if(ge==="MultiLineString"){if(j.lineMetrics){for(Se=0;Se<re.length;Se++)Tt(re[Se],we=[],Te,!1),J.push(Ue(ve,"LineString",we,U.properties));return}zt(re,we,Te,!1)}else if(ge==="Polygon")zt(re,we,Te,!0);else{if(ge!=="MultiPolygon"){if(ge==="GeometryCollection"){for(Se=0;Se<U.geometry.geometries.length;Se++)Qe(J,{id:ve,geometry:U.geometry.geometries[Se],properties:U.properties},j,Y);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Se=0;Se<re.length;Se++){var je=[];zt(re[Se],je,Te,!0),we.push(je)}}J.push(Ue(ve,ge,we,U.properties))}}function Mt(J,U){U.push(Vt(J[0])),U.push(li(J[1])),U.push(0)}function Tt(J,U,j,Y){for(var re,ge,Te=0,we=0;we<J.length;we++){var ve=Vt(J[we][0]),Se=li(J[we][1]);U.push(ve),U.push(Se),U.push(0),we>0&&(Te+=Y?(re*Se-ve*ge)/2:Math.sqrt(Math.pow(ve-re,2)+Math.pow(Se-ge,2))),re=ve,ge=Se}var je=U.length-3;U[2]=1,et(U,0,je,j),U[je+2]=1,U.size=Math.abs(Te),U.start=0,U.end=U.size}function zt(J,U,j,Y){for(var re=0;re<J.length;re++){var ge=[];Tt(J[re],ge,j,Y),U.push(ge)}}function Vt(J){return J/360+.5}function li(J){var U=Math.sin(J*Math.PI/180),j=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return j<0?0:j>1?1:j}function fi(J,U,j,Y,re,ge,Te,we){if(Y/=U,ge>=(j/=U)&&Te<Y)return J;if(Te<j||ge>=Y)return null;for(var ve=[],Se=0;Se<J.length;Se++){var je=J[Se],dt=je.geometry,We=je.type,kt=re===0?je.minX:je.minY,Lt=re===0?je.maxX:je.maxY;if(kt>=j&&Lt<Y)ve.push(je);else if(!(Lt<j||kt>=Y)){var Pt=[];if(We==="Point"||We==="MultiPoint")pi(dt,Pt,j,Y,re);else if(We==="LineString")Ii(dt,Pt,j,Y,re,!1,we.lineMetrics);else if(We==="MultiLineString")wn(dt,Pt,j,Y,re,!1);else if(We==="Polygon")wn(dt,Pt,j,Y,re,!0);else if(We==="MultiPolygon")for(var Rt=0;Rt<dt.length;Rt++){var Ht=[];wn(dt[Rt],Ht,j,Y,re,!0),Ht.length&&Pt.push(Ht)}if(Pt.length){if(we.lineMetrics&&We==="LineString"){for(Rt=0;Rt<Pt.length;Rt++)ve.push(Ue(je.id,We,Pt[Rt],je.tags));continue}We!=="LineString"&&We!=="MultiLineString"||(Pt.length===1?(We="LineString",Pt=Pt[0]):We="MultiLineString"),We!=="Point"&&We!=="MultiPoint"||(We=Pt.length===3?"Point":"MultiPoint"),ve.push(Ue(je.id,We,Pt,je.tags))}}}return ve.length?ve:null}function pi(J,U,j,Y,re){for(var ge=0;ge<J.length;ge+=3){var Te=J[ge+re];Te>=j&&Te<=Y&&(U.push(J[ge]),U.push(J[ge+1]),U.push(J[ge+2]))}}function Ii(J,U,j,Y,re,ge,Te){for(var we,ve,Se=Un(J),je=re===0?co:Yo,dt=J.start,We=0;We<J.length-3;We+=3){var kt=J[We],Lt=J[We+1],Pt=J[We+2],Rt=J[We+3],Ht=J[We+4],Ei=re===0?kt:Lt,Zi=re===0?Rt:Ht,Mi=!1;Te&&(we=Math.sqrt(Math.pow(kt-Rt,2)+Math.pow(Lt-Ht,2))),Ei<j?Zi>j&&(ve=je(Se,kt,Lt,Rt,Ht,j),Te&&(Se.start=dt+we*ve)):Ei>Y?Zi<Y&&(ve=je(Se,kt,Lt,Rt,Ht,Y),Te&&(Se.start=dt+we*ve)):Sr(Se,kt,Lt,Pt),Zi<j&&Ei>=j&&(ve=je(Se,kt,Lt,Rt,Ht,j),Mi=!0),Zi>Y&&Ei<=Y&&(ve=je(Se,kt,Lt,Rt,Ht,Y),Mi=!0),!ge&&Mi&&(Te&&(Se.end=dt+we*ve),U.push(Se),Se=Un(J)),Te&&(dt+=we)}var Ee=J.length-3;kt=J[Ee],Lt=J[Ee+1],Pt=J[Ee+2],(Ei=re===0?kt:Lt)>=j&&Ei<=Y&&Sr(Se,kt,Lt,Pt),Ee=Se.length-3,ge&&Ee>=3&&(Se[Ee]!==Se[0]||Se[Ee+1]!==Se[1])&&Sr(Se,Se[0],Se[1],Se[2]),Se.length&&U.push(Se)}function Un(J){var U=[];return U.size=J.size,U.start=J.start,U.end=J.end,U}function wn(J,U,j,Y,re,ge){for(var Te=0;Te<J.length;Te++)Ii(J[Te],U,j,Y,re,ge,!1)}function Sr(J,U,j,Y){J.push(U),J.push(j),J.push(Y)}function co(J,U,j,Y,re,ge){var Te=(ge-U)/(Y-U);return J.push(ge),J.push(j+(re-j)*Te),J.push(1),Te}function Yo(J,U,j,Y,re,ge){var Te=(ge-j)/(re-j);return J.push(U+(Y-U)*Te),J.push(ge),J.push(1),Te}function Pn(J,U){for(var j=[],Y=0;Y<J.length;Y++){var re,ge=J[Y],Te=ge.type;if(Te==="Point"||Te==="MultiPoint"||Te==="LineString")re=jn(ge.geometry,U);else if(Te==="MultiLineString"||Te==="Polygon"){re=[];for(var we=0;we<ge.geometry.length;we++)re.push(jn(ge.geometry[we],U))}else if(Te==="MultiPolygon")for(re=[],we=0;we<ge.geometry.length;we++){for(var ve=[],Se=0;Se<ge.geometry[we].length;Se++)ve.push(jn(ge.geometry[we][Se],U));re.push(ve)}j.push(Ue(ge.id,Te,re,ge.tags))}return j}function jn(J,U){var j=[];j.size=J.size,J.start!==void 0&&(j.start=J.start,j.end=J.end);for(var Y=0;Y<J.length;Y+=3)j.push(J[Y]+U,J[Y+1],J[Y+2]);return j}function Jo(J,U){if(J.transformed)return J;var j,Y,re,ge=1<<J.z,Te=J.x,we=J.y;for(j=0;j<J.features.length;j++){var ve=J.features[j],Se=ve.geometry,je=ve.type;if(ve.geometry=[],je===1)for(Y=0;Y<Se.length;Y+=2)ve.geometry.push(eu(Se[Y],Se[Y+1],U,ge,Te,we));else for(Y=0;Y<Se.length;Y++){var dt=[];for(re=0;re<Se[Y].length;re+=2)dt.push(eu(Se[Y][re],Se[Y][re+1],U,ge,Te,we));ve.geometry.push(dt)}}return J.transformed=!0,J}function eu(J,U,j,Y,re,ge){return[Math.round(j*(J*Y-re)),Math.round(j*(U*Y-ge))]}function tu(J,U,j,Y,re){for(var ge=U===re.maxZoom?0:re.tolerance/((1<<U)*re.extent),Te={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:j,y:Y,z:U,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},we=0;we<J.length;we++){Te.numFeatures++,vd(Te,J[we],ge,re);var ve=J[we].minX,Se=J[we].minY,je=J[we].maxX,dt=J[we].maxY;ve<Te.minX&&(Te.minX=ve),Se<Te.minY&&(Te.minY=Se),je>Te.maxX&&(Te.maxX=je),dt>Te.maxY&&(Te.maxY=dt)}return Te}function vd(J,U,j,Y){var re=U.geometry,ge=U.type,Te=[];if(ge==="Point"||ge==="MultiPoint")for(var we=0;we<re.length;we+=3)Te.push(re[we]),Te.push(re[we+1]),J.numPoints++,J.numSimplified++;else if(ge==="LineString")Qo(Te,re,J,j,!1,!1);else if(ge==="MultiLineString"||ge==="Polygon")for(we=0;we<re.length;we++)Qo(Te,re[we],J,j,ge==="Polygon",we===0);else if(ge==="MultiPolygon")for(var ve=0;ve<re.length;ve++){var Se=re[ve];for(we=0;we<Se.length;we++)Qo(Te,Se[we],J,j,!0,we===0)}if(Te.length){var je=U.tags||null;if(ge==="LineString"&&Y.lineMetrics){for(var dt in je={},U.tags)je[dt]=U.tags[dt];je.mapbox_clip_start=re.start/re.size,je.mapbox_clip_end=re.end/re.size}var We={geometry:Te,type:ge==="Polygon"||ge==="MultiPolygon"?3:ge==="LineString"||ge==="MultiLineString"?2:1,tags:je};U.id!==null&&(We.id=U.id),J.features.push(We)}}function Qo(J,U,j,Y,re,ge){var Te=Y*Y;if(Y>0&&U.size<(re?Te:Y))j.numPoints+=U.length/3;else{for(var we=[],ve=0;ve<U.length;ve+=3)(Y===0||U[ve+2]>Te)&&(j.numSimplified++,we.push(U[ve]),we.push(U[ve+1])),j.numPoints++;re&&function(Se,je){for(var dt=0,We=0,kt=Se.length,Lt=kt-2;We<kt;Lt=We,We+=2)dt+=(Se[We]-Se[Lt])*(Se[We+1]+Se[Lt+1]);if(dt>0===je)for(We=0,kt=Se.length;We<kt/2;We+=2){var Pt=Se[We],Rt=Se[We+1];Se[We]=Se[kt-2-We],Se[We+1]=Se[kt-1-We],Se[kt-2-We]=Pt,Se[kt-1-We]=Rt}}(we,ge),J.push(we)}}function Lo(J,U){var j=(U=this.options=function(re,ge){for(var Te in ge)re[Te]=ge[Te];return re}(Object.create(this.options),U)).debug;if(j&&console.time("preprocess data"),U.maxZoom<0||U.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(U.promoteId&&U.generateId)throw new Error("promoteId and generateId cannot be used together.");var Y=function(re,ge){var Te=[];if(re.type==="FeatureCollection")for(var we=0;we<re.features.length;we++)Qe(Te,re.features[we],ge,we);else Qe(Te,re.type==="Feature"?re:{geometry:re},ge);return Te}(J,U);this.tiles={},this.tileCoords=[],j&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",U.indexMaxZoom,U.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Y=function(re,ge){var Te=ge.buffer/ge.extent,we=re,ve=fi(re,1,-1-Te,Te,0,-1,2,ge),Se=fi(re,1,1-Te,2+Te,0,-1,2,ge);return(ve||Se)&&(we=fi(re,1,-Te,1+Te,0,-1,2,ge)||[],ve&&(we=Pn(ve,1).concat(we)),Se&&(we=we.concat(Pn(Se,-1)))),we}(Y,U)).length&&this.splitTile(Y,0,0,0),j&&(Y.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function fa(J,U,j){return 32*((1<<J)*j+U)+J}function iu(J,U){const j=J.tileID.canonical;if(!this._geoJSONIndex)return U(null,null);const Y=this._geoJSONIndex.getTile(j.z,j.x,j.y);if(!Y)return U(null,null);const re=new fe(Y.features);let ge=xt(re);ge.byteOffset===0&&ge.byteLength===ge.buffer.byteLength||(ge=new Uint8Array(ge)),U(null,{vectorTile:re,rawData:ge.buffer})}Lo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Lo.prototype.splitTile=function(J,U,j,Y,re,ge,Te){for(var we=[J,U,j,Y],ve=this.options,Se=ve.debug;we.length;){Y=we.pop(),j=we.pop(),U=we.pop(),J=we.pop();var je=1<<U,dt=fa(U,j,Y),We=this.tiles[dt];if(!We&&(Se>1&&console.time("creation"),We=this.tiles[dt]=tu(J,U,j,Y,ve),this.tileCoords.push({z:U,x:j,y:Y}),Se)){Se>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",U,j,Y,We.numFeatures,We.numPoints,We.numSimplified),console.timeEnd("creation"));var kt="z"+U;this.stats[kt]=(this.stats[kt]||0)+1,this.total++}if(We.source=J,re){if(U===ve.maxZoom||U===re)continue;var Lt=1<<re-U;if(j!==Math.floor(ge/Lt)||Y!==Math.floor(Te/Lt))continue}else if(U===ve.indexMaxZoom||We.numPoints<=ve.indexMaxPoints)continue;if(We.source=null,J.length!==0){Se>1&&console.time("clipping");var Pt,Rt,Ht,Ei,Zi,Mi,Ee=.5*ve.buffer/ve.extent,_r=.5-Ee,Qi=.5+Ee,Ar=1+Ee;Pt=Rt=Ht=Ei=null,Zi=fi(J,je,j-Ee,j+Qi,0,We.minX,We.maxX,ve),Mi=fi(J,je,j+_r,j+Ar,0,We.minX,We.maxX,ve),J=null,Zi&&(Pt=fi(Zi,je,Y-Ee,Y+Qi,1,We.minY,We.maxY,ve),Rt=fi(Zi,je,Y+_r,Y+Ar,1,We.minY,We.maxY,ve),Zi=null),Mi&&(Ht=fi(Mi,je,Y-Ee,Y+Qi,1,We.minY,We.maxY,ve),Ei=fi(Mi,je,Y+_r,Y+Ar,1,We.minY,We.maxY,ve),Mi=null),Se>1&&console.timeEnd("clipping"),we.push(Pt||[],U+1,2*j,2*Y),we.push(Rt||[],U+1,2*j,2*Y+1),we.push(Ht||[],U+1,2*j+1,2*Y),we.push(Ei||[],U+1,2*j+1,2*Y+1)}}},Lo.prototype.getTile=function(J,U,j){var Y=this.options,re=Y.extent,ge=Y.debug;if(J<0||J>24)return null;var Te=1<<J,we=fa(J,U=(U%Te+Te)%Te,j);if(this.tiles[we])return Jo(this.tiles[we],re);ge>1&&console.log("drilling down to z%d-%d-%d",J,U,j);for(var ve,Se=J,je=U,dt=j;!ve&&Se>0;)Se--,je=Math.floor(je/2),dt=Math.floor(dt/2),ve=this.tiles[fa(Se,je,dt)];return ve&&ve.source?(ge>1&&console.log("found parent tile z%d-%d-%d",Se,je,dt),ge>1&&console.time("drilling down"),this.splitTile(ve.source,Se,je,dt,J,U,j),ge>1&&console.timeEnd("drilling down"),this.tiles[we]?Jo(this.tiles[we],re):null):null};class rr extends a.VectorTileWorkerSource{constructor(U,j,Y,re,ge){super(U,j,Y,re,iu),ge&&(this.loadGeoJSON=ge)}loadData(U,j){const Y=U&&U.request,re=Y&&Y.collectResourceTiming;this.loadGeoJSON(U,(ge,Te)=>{if(ge||!Te)return j(ge);if(typeof Te!="object")return j(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`));{z(Te,!0);try{if(U.filter){const ve=a.createExpression(U.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ve.result==="error")throw new Error(ve.value.map(je=>`${je.key}: ${je.message}`).join(", "));const Se=Te.features.filter(je=>ve.value.evaluate({zoom:0},je));Te={type:"FeatureCollection",features:Se}}this._geoJSONIndex=U.cluster?new ct(function({superclusterOptions:ve,clusterProperties:Se}){if(!Se||!ve)return ve;const je={},dt={},We={accumulated:null,zoom:0},kt={properties:null},Lt=Object.keys(Se);for(const Pt of Lt){const[Rt,Ht]=Se[Pt],Ei=a.createExpression(Ht),Zi=a.createExpression(typeof Rt=="string"?[Rt,["accumulated"],["get",Pt]]:Rt);je[Pt]=Ei.value,dt[Pt]=Zi.value}return ve.map=Pt=>{kt.properties=Pt;const Rt={};for(const Ht of Lt)Rt[Ht]=je[Ht].evaluate(We,kt);return Rt},ve.reduce=(Pt,Rt)=>{kt.properties=Rt;for(const Ht of Lt)We.accumulated=Pt[Ht],Pt[Ht]=dt[Ht].evaluate(We,kt)},ve}(U)).load(Te.features):function(ve,Se){return new Lo(ve,Se)}(Te,U.geojsonVtOptions)}catch(ve){return j(ve)}this.loaded={};const we={};if(re){const ve=a.getPerformanceMeasurement(Y);ve&&(we.resourceTiming={},we.resourceTiming[U.source]=JSON.parse(JSON.stringify(ve)))}j(null,we)}})}reloadTile(U,j){const Y=this.loaded;return Y&&Y[U.uid]?super.reloadTile(U,j):this.loadTile(U,j)}loadGeoJSON(U,j){if(U.request)a.getJSON(U.request,j);else{if(typeof U.data!="string")return j(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`));try{return j(null,JSON.parse(U.data))}catch{return j(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(U,j){try{j(null,this._geoJSONIndex.getClusterExpansionZoom(U.clusterId))}catch(Y){j(Y)}}getClusterChildren(U,j){try{j(null,this._geoJSONIndex.getChildren(U.clusterId))}catch(Y){j(Y)}}getClusterLeaves(U,j){try{j(null,this._geoJSONIndex.getLeaves(U.clusterId,U.limit,U.offset))}catch(Y){j(Y)}}}class vl{constructor(U){this.self=U,this.actor=new a.Actor(U,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:rr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(j,Y)=>{if(this.workerSourceTypes[j])throw new Error(`Worker source with name "${j}" already registered.`);this.workerSourceTypes[j]=Y},this.self.registerRTLTextPlugin=j=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=j.applyArabicShaping,a.plugin.processBidirectionalText=j.processBidirectionalText,a.plugin.processStyledBidirectionalText=j.processStyledBidirectionalText}}clearCaches(U,j,Y){delete this.layerIndexes[U],delete this.availableImages[U],delete this.workerSources[U],delete this.demWorkerSources[U],Y()}checkIfReady(U,j,Y){Y()}setReferrer(U,j){this.referrer=j}spriteLoaded(U,j){this.isSpriteLoaded[U]=j;for(const Y in this.workerSources[U]){const re=this.workerSources[U][Y];for(const ge in re)re[ge]instanceof a.VectorTileWorkerSource&&(re[ge].isSpriteLoaded=j,re[ge].fire(new a.Event("isSpriteLoaded")))}}setImages(U,j,Y){this.availableImages[U]=j;for(const re in this.workerSources[U]){const ge=this.workerSources[U][re];for(const Te in ge)ge[Te].availableImages=j}Y()}enableTerrain(U,j,Y){this.terrain=j,Y()}setProjection(U,j){this.projections[U]=a.getProjection(j)}setLayers(U,j,Y){this.getLayerIndex(U).replace(j),Y()}updateLayers(U,j,Y){this.getLayerIndex(U).update(j.layers,j.removedIds),Y()}loadTile(U,j,Y){const re=this.enableTerrain?a.extend({enableTerrain:this.terrain},j):j;re.projection=this.projections[U]||this.defaultProjection,this.getWorkerSource(U,j.type,j.source).loadTile(re,Y)}loadDEMTile(U,j,Y){const re=this.enableTerrain?a.extend({buildQuadTree:this.terrain},j):j;this.getDEMWorkerSource(U,j.source).loadTile(re,Y)}reloadTile(U,j,Y){const re=this.enableTerrain?a.extend({enableTerrain:this.terrain},j):j;re.projection=this.projections[U]||this.defaultProjection,this.getWorkerSource(U,j.type,j.source).reloadTile(re,Y)}abortTile(U,j,Y){this.getWorkerSource(U,j.type,j.source).abortTile(j,Y)}removeTile(U,j,Y){this.getWorkerSource(U,j.type,j.source).removeTile(j,Y)}removeSource(U,j,Y){if(!this.workerSources[U]||!this.workerSources[U][j.type]||!this.workerSources[U][j.type][j.source])return;const re=this.workerSources[U][j.type][j.source];delete this.workerSources[U][j.type][j.source],re.removeSource!==void 0?re.removeSource(j,Y):Y()}loadWorkerSource(U,j,Y){try{this.self.importScripts(j.url),Y()}catch(re){Y(re.toString())}}syncRTLPluginState(U,j,Y){try{a.plugin.setState(j);const re=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&re!=null){this.self.importScripts(re);const ge=a.plugin.isParsed();Y(ge?void 0:new Error(`RTL Text Plugin failed to import scripts from ${re}`),ge)}}catch(re){Y(re.toString())}}getAvailableImages(U){let j=this.availableImages[U];return j||(j=[]),j}getLayerIndex(U){let j=this.layerIndexes[U];return j||(j=this.layerIndexes[U]=new M),j}getWorkerSource(U,j,Y){return this.workerSources[U]||(this.workerSources[U]={}),this.workerSources[U][j]||(this.workerSources[U][j]={}),this.workerSources[U][j][Y]||(this.workerSources[U][j][Y]=new this.workerSourceTypes[j]({send:(re,ge,Te,we,ve,Se)=>{this.actor.send(re,ge,Te,U,ve,Se)},scheduler:this.actor.scheduler},this.getLayerIndex(U),this.getAvailableImages(U),this.isSpriteLoaded[U])),this.workerSources[U][j][Y]}getDEMWorkerSource(U,j){return this.demWorkerSources[U]||(this.demWorkerSources[U]={}),this.demWorkerSources[U][j]||(this.demWorkerSources[U][j]=new P),this.demWorkerSources[U][j]}enforceCacheSizeLimit(U,j){a.enforceCacheSizeLimit(j)}getWorkerPerformanceMetrics(U,j,Y){Y(void 0,void 0)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new vl(self)),vl}),x(["./shared"],function(a){function S(d,n){if(Array.isArray(d)){if(!Array.isArray(n)||d.length!==n.length)return!1;for(let c=0;c<d.length;c++)if(!S(d[c],n[c]))return!1;return!0}if(typeof d=="object"&&d!==null&&n!==null){if(typeof n!="object"||Object.keys(d).length!==Object.keys(n).length)return!1;for(const c in d)if(!S(d[c],n[c]))return!1;return!0}return d===n}var O=M;function M(d){return!function(n){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var p,g,v=new Blob([""],{type:"text/javascript"}),T=URL.createObjectURL(v);try{g=new Worker(T),p=!0}catch{p=!1}return g&&g.terminate(),URL.revokeObjectURL(T),p}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var p=document.createElement("canvas");p.width=p.height=1;var g=p.getContext("2d");if(!g)return!1;var v=g.getImageData(0,0,1,1);return v&&v.width===p.width}()?(P[c=n&&n.failIfMajorPerformanceCaveat]===void 0&&(P[c]=function(p){var g,v=function(T){var C=document.createElement("canvas"),I=Object.create(M.webGLContextAttributes);return I.failIfMajorPerformanceCaveat=T,C.getContext("webgl",I)||C.getContext("experimental-webgl",I)}(p);if(!v)return!1;try{g=v.createShader(v.VERTEX_SHADER)}catch{return!1}return!(!g||v.isContextLost())&&(v.shaderSource(g,"void main() {}"),v.compileShader(g),v.getShaderParameter(g,v.COMPILE_STATUS)===!0)}(c)),P[c]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var c}(d)}var P={};function z(d,n,c){const p=a.window.document.createElement(d);return n!==void 0&&(p.className=n),c&&c.appendChild(p),p}function q(d,n,c){const p=a.window.document.createElementNS("http://www.w3.org/2000/svg",d);for(const g of Object.keys(n))p.setAttributeNS(null,g,n[g]);return c&&c.appendChild(p),p}M.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const se=a.window.document&&a.window.document.documentElement.style,ue=se&&se.userSelect!==void 0?"userSelect":"WebkitUserSelect";let oe;function fe(){se&&ue&&(oe=se[ue],se[ue]="none")}function xe(){se&&ue&&(se[ue]=oe)}function Be(d){d.preventDefault(),d.stopPropagation(),a.window.removeEventListener("click",Be,!0)}function $e(){a.window.addEventListener("click",Be,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",Be,!0)},0)}function Ge(d,n){const c=d.getBoundingClientRect();return jt(d,c,n)}function xt(d,n){const c=d.getBoundingClientRect(),p=[];for(let g=0;g<n.length;g++)p.push(jt(d,c,n[g]));return p}function pt(d){return a.window.InstallTrigger!==void 0&&d.button===2&&d.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button}function jt(d,n,c){const p=d.offsetWidth===n.width?1:d.offsetWidth/n.width;return new a.pointGeometry((c.clientX-n.left)*p,(c.clientY-n.top)*p)}function Dt(d,n){var c=n[0],p=n[1],g=n[2],v=n[3],T=c*v-g*p;return T?(d[0]=v*(T=1/T),d[1]=-p*T,d[2]=-g*T,d[3]=c*T,d):null}function Ft(d){const{userImage:n}=d;return!!(n&&n.render&&n.render())&&(d.data.replace(new Uint8Array(n.data.buffer)),!0)}class ai extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:c,callback:p}of this.requestors)this._notify(c,p);this.requestors=[]}}hasImage(n){return!!this.getImage(n)}getImage(n){return this.images[n]}addImage(n,c){this._validate(n,c)&&(this.images[n]=c)}_validate(n,c){let p=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${n}" has invalid "stretchX" value`))),p=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${n}" has invalid "stretchY" value`))),p=!1),this._validateContent(c.content,c)||(this.fire(new a.ErrorEvent(new Error(`Image "${n}" has invalid "content" value`))),p=!1),p}_validateStretch(n,c){if(!n)return!0;let p=0;for(const g of n){if(g[0]<p||g[1]<g[0]||c<g[1])return!1;p=g[1]}return!0}_validateContent(n,c){return!(n&&(n.length!==4||n[0]<0||c.data.width<n[0]||n[1]<0||c.data.height<n[1]||n[2]<0||c.data.width<n[2]||n[3]<0||c.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))}updateImage(n,c){c.version=this.images[n].version+1,this.images[n]=c,this.updatedImages[n]=!0}removeImage(n){const c=this.images[n];delete this.images[n],delete this.patterns[n],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n,c){let p=!0;if(!this.isLoaded())for(const g of n)this.images[g]||(p=!1);this.isLoaded()||p?this._notify(n,c):this.requestors.push({ids:n,callback:c})}_notify(n,c){const p={};for(const g of n){this.images[g]||this.fire(new a.Event("styleimagemissing",{id:g}));const v=this.images[g];v?p[g]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,hasRenderCallback:Boolean(v.userImage&&v.userImage.render)}:a.warnOnce(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,p)}getPixelSize(){const{width:n,height:c}=this.atlasImage;return{width:n,height:c}}getPattern(n){const c=this.patterns[n],p=this.getImage(n);if(!p)return null;if(c&&c.position.version===p.version)return c.position;if(c)c.position.version=p.version;else{const g={w:p.data.width+2,h:p.data.height+2,x:0,y:0},v=new a.ImagePosition(g,p);this.patterns[n]={bin:g,position:v}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const c=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(n,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const v in this.patterns)n.push(this.patterns[v].bin);const{w:c,h:p}=a.potpack(n),g=this.atlasImage;g.resize({width:c||1,height:p||1});for(const v in this.patterns){const{bin:T}=this.patterns[v],C=T.x+1,I=T.y+1,L=this.images[v].data,B=L.width,N=L.height;a.RGBAImage.copy(L,g,{x:0,y:0},{x:C,y:I},{width:B,height:N}),a.RGBAImage.copy(L,g,{x:0,y:N-1},{x:C,y:I-1},{width:B,height:1}),a.RGBAImage.copy(L,g,{x:0,y:0},{x:C,y:I+N},{width:B,height:1}),a.RGBAImage.copy(L,g,{x:B-1,y:0},{x:C-1,y:I},{width:1,height:N}),a.RGBAImage.copy(L,g,{x:0,y:0},{x:C+B,y:I},{width:1,height:N})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const c of n){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const p=this.images[c];Ft(p)&&this.updateImage(c,p)}}}const wt=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(d,n){return function([c,p,g]){const v=a.degToRad(p+90),T=a.degToRad(g);return{x:c*Math.cos(v)*Math.sin(T),y:c*Math.sin(v)*Math.sin(T),z:c*Math.cos(T),azimuthal:p,polar:g}}(d.expression.evaluate(n))}interpolate(d,n,c){return{x:a.number(d.x,n.x,c),y:a.number(d.y,n.y,c),z:a.number(d.z,n.z,c),azimuthal:a.number(d.azimuthal,n.azimuthal,c),polar:a.number(d.polar,n.polar,c)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),Nt="-transition";class qi extends a.Evented{constructor(n){super(),this._transitionable=new a.Transitionable(wt),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,c={}){if(!this._validate(a.validateLight,n,c))for(const p in n){const g=n[p];a.endsWith(p,Nt)?this._transitionable.setTransition(p.slice(0,-Nt.length),g):this._transitionable.setValue(p,g)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,c,p){return(!p||p.validate!==!1)&&a.emitValidationErrors(this,n.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const bn=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)}),hi="-transition";class ri extends a.Evented{constructor(n,c){super(),this._transitionable=new a.Transitionable(bn),this.set(n),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=c}get(){return this._transitionable.serialize()}set(n){for(const c in n){const p=n[c];a.endsWith(c,hi)?this._transitionable.setTransition(c.slice(0,-hi.length),p):this._transitionable.setValue(c,p)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}}function ei(d,n,c,p){const g=a.smoothstep(45,65,c),[v,T]=Wi(d,p),C=a.length(n);let I=1-Math.min(1,Math.exp((C-v)/(T-v)*-6));return I*=I*I,I=Math.min(1,1.00747*I),I*g*d.alpha}function Wi(d,n){const c=.5/Math.tan(.5*n);return[d.range[0]+c,d.range[1]+c]}const sn=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"high-color":new a.DataConstantProperty(a.spec.fog["high-color"]),"space-color":new a.DataConstantProperty(a.spec.fog["space-color"]),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"]),"star-intensity":new a.DataConstantProperty(a.spec.fog["star-intensity"])}),kn="-transition";class oi extends a.Evented{constructor(n,c){super(),this._transitionable=new a.Transitionable(sn),this.set(n),this._transitioning=this._transitionable.untransitioned(),this._transform=c}get state(){const n=this._transform,c=n.projection.name==="globe",p=a.globeToMercatorTransition(n.zoom),g=this.properties.get("range"),v=[.5,3];return{range:c?[a.number(v[0],g[0],p),a.number(v[1],g[1],p)]:g,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(n,c={}){if(!this._validate(a.validateFog,n,c)){for(const p of Object.keys(a.spec.fog))n&&n[p]===void 0&&(n[p]=a.spec.fog[p].default);for(const p in n){const g=n[p];a.endsWith(p,kn)?this._transitionable.setTransition(p.slice(0,-kn.length),g):this._transitionable.setValue(p,g)}}}getOpacity(n){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.smoothstep(45,65,n))*c.a}getOpacityAtLatLng(n,c){return this._transform.projection.supportsFog?function(p,g,v){const T=a.MercatorCoordinate.fromLngLat(g),C=v.elevation?v.elevation.getAtPointOrZero(T):0,I=[T.x,T.y,C];return a.transformMat4(I,I,v.mercatorFogMatrix),ei(p,I,v.pitch,v._fov)}(this.state,n,c):0}getFovAdjustedRange(n){return this._transform.projection.supportsFog?Wi(this.state,n):[0,1]}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,c,p){return(!p||p.validate!==!1)&&a.emitValidationErrors(this,n.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class Si{constructor(n,c){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const p=this.workerPool.acquire(this.id);for(let g=0;g<p.length;g++){const v=new Si.Actor(p[g],c,this.id);v.name=`Worker ${g}`,this.actors.push(v)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,c,p){a.asyncAll(this.actors,(g,v)=>{g.send(n,c,v)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}function yn(d,n,c){return n*(a.EXTENT/(d.tileSize*Math.pow(2,c-d.tileID.overscaledZ)))}Si.Actor=a.Actor;class Ne{constructor(n,c,p,g){this.screenBounds=n,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,g)}static createFromScreenPoints(n,c){let p,g;if(n instanceof a.pointGeometry||typeof n[0]=="number"){const v=a.pointGeometry.convert(n);p=[a.pointGeometry.convert(n)],g=c.isPointAboveHorizon(v)}else{const v=a.pointGeometry.convert(n[0]),T=a.pointGeometry.convert(n[1]);p=[v,T],g=a.polygonizeBounds(v,T).every(C=>c.isPointAboveHorizon(C))}return new Ne(p,c.getCameraPoint(),g,c)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(n){return a.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],n)}bufferedCameraGeometry(n){const c=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],g=a.polygonizeBounds(c,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<p.x?g.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?g[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(g[3]=this.cameraPoint)),a.bufferConvexPolygon(g,n)}bufferedCameraGeometryGlobe(n){const c=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],g=a.polygonizeBounds(c,p,n),v=this.cameraPoint.clone();switch(3*((v.y>c.y)+(v.y>p.y))+((v.x>c.x)+(v.x>p.x))){case 0:g[0]=v,g[4]=v.clone();break;case 1:g.splice(1,0,v);break;case 2:g[1]=v;break;case 3:g.splice(4,0,v);break;case 5:g.splice(2,0,v);break;case 6:g[3]=v;break;case 7:g.splice(3,0,v);break;case 8:g[2]=v}return g}containsTile(n,c,p,g=0){const v=n.queryPadding/c._projectionScaler+1,T=p?this._bufferedCameraMercator(v,c):this._bufferedScreenMercator(v,c);let C=n.tileID.wrap+(T.unwrapped?g:0);const I=T.polygon.map(ie=>a.getTilePoint(n.tileTransform,ie,C));if(!a.polygonIntersectsBox(I,0,0,a.EXTENT,a.EXTENT))return;C=n.tileID.wrap+(this.screenGeometryMercator.unwrapped?g:0);const L=this.screenGeometryMercator.polygon.map(ie=>a.getTileVec3(n.tileTransform,ie,C)),B=L.map(ie=>new a.pointGeometry(ie[0],ie[1])),N=c.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),$=a.getTileVec3(n.tileTransform,N,C),Z=L.map(ie=>{const X=a.sub(ie,ie,$);return a.normalize(X,X),new a.Ray($,X)}),H=yn(n,1,c.zoom)*c._projectionScaler;return{queryGeometry:this,tilespaceGeometry:B,tilespaceRays:Z,bufferedTilespaceGeometry:I,bufferedTilespaceBounds:(G=a.getBounds(I),G.min.x=a.clamp(G.min.x,0,a.EXTENT),G.min.y=a.clamp(G.min.y,0,a.EXTENT),G.max.x=a.clamp(G.max.x,0,a.EXTENT),G.max.y=a.clamp(G.max.y,0,a.EXTENT),G),tile:n,tileID:n.tileID,pixelToTileUnitsFactor:H};var G}_bufferedScreenMercator(n,c){const p=It(n);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let g;return g=c.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(n),c):{polygon:this.bufferedScreenGeometry(n).map(v=>c.pointCoordinate3D(v)),unwrapped:!0},this._screenRaycastCache[p]=g,g}}_bufferedCameraMercator(n,c){const p=It(n);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let g;return g=c.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(n),c):{polygon:this.bufferedCameraGeometry(n).map(v=>c.pointCoordinate3D(v)),unwrapped:!0},this._cameraRaycastCache[p]=g,g}}_projectAndResample(n,c){const p=function(v,T){const C=a.multiply([],T.pixelMatrix,T.globeMatrix),I=[0,-a.GLOBE_RADIUS,0,1],L=[0,a.GLOBE_RADIUS,0,1],B=[0,0,0,1];a.transformMat4$1(I,I,C),a.transformMat4$1(L,L,C),a.transformMat4$1(B,B,C);const N=new a.pointGeometry(I[0]/I[3],I[1]/I[3]),$=new a.pointGeometry(L[0]/L[3],L[1]/L[3]),Z=a.polygonContainsPoint(v,N)&&I[3]<B[3],H=a.polygonContainsPoint(v,$)&&L[3]<B[3];if(!Z&&!H)return null;const G=function(_e,Me,De){for(let Ie=1;Ie<_e.length;Ie++){const Je=ct(Me.pointCoordinate3D(_e[Ie-1]).x),ae=ct(Me.pointCoordinate3D(_e[Ie]).x);if(De<0){if(Je<ae)return{idx:Ie,t:-Je/(ae-1-Je)}}else if(ae<Je)return{idx:Ie,t:(1-Je)/(ae+1-Je)}}return null}(v,T,Z?-1:1);if(!G)return null;const{idx:ie,t:X}=G;let Q=ie>1?bt(v.slice(0,ie),T):[],W=ie<v.length?bt(v.slice(ie),T):[];Q=Q.map(_e=>new a.pointGeometry(ct(_e.x),_e.y)),W=W.map(_e=>new a.pointGeometry(ct(_e.x),_e.y));const le=[...Q];le.length===0&&le.push(W[W.length-1]);const te=a.number(le[le.length-1].y,(W.length===0?Q[0]:W[0]).y,X);let ne;return ne=Z?[new a.pointGeometry(0,te),new a.pointGeometry(0,0),new a.pointGeometry(1,0),new a.pointGeometry(1,te)]:[new a.pointGeometry(1,te),new a.pointGeometry(1,1),new a.pointGeometry(0,1),new a.pointGeometry(0,te)],le.push(...ne),W.length===0?le.push(Q[0]):le.push(...W),{polygon:le.map(_e=>new a.MercatorCoordinate(_e.x,_e.y)),unwrapped:!1}}(n,c);if(p)return p;const g=function(v,T){let C=!1,I=-1/0,L=0;for(let N=0;N<v.length-1;N++)v[N].x>I&&(I=v[N].x,L=N);for(let N=0;N<v.length-1;N++){const $=(L+N)%(v.length-1),Z=v[$],H=v[$+1];Math.abs(Z.x-H.x)>.5&&(Z.x<H.x?(Z.x+=1,$===0&&(v[v.length-1].x+=1)):(H.x+=1,$+1===v.length-1&&(v[0].x+=1)),C=!0)}const B=a.mercatorXfromLng(T.center.lng);return C&&B<Math.abs(B-1)&&v.forEach(N=>{N.x-=1}),{polygon:v,unwrapped:C}}(bt(n,c).map(v=>new a.pointGeometry(ct(v.x),v.y)),c);return{polygon:g.polygon.map(v=>new a.MercatorCoordinate(v.x,v.y)),unwrapped:g.unwrapped}}}function bt(d,n){return a.resample(d,c=>{const p=n.pointCoordinate3D(c);c.x=p.x,c.y=p.y},1/256)}function ct(d){return d<0?1+d%1:d%1}function It(d){return 100*d|0}function wi(d,n,c,p,g){const v=function(T,C){if(T)return g(T);if(C){const I=a.pick(a.extend(C,d),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);C.vector_layers&&(I.vectorLayers=C.vector_layers,I.vectorLayerIds=I.vectorLayers.map(L=>L.id)),C.language_options&&(I.languageOptions=C.language_options),C.language&&C.language[C.id]&&(I.language=C.language[C.id]),C.worldview_options&&(I.worldviewOptions=C.worldview_options),C.worldview?I.worldview=C.worldview[C.id]:C.worldview_default&&(I.worldview=C.worldview_default),I.tiles=n.canonicalizeTileset(I,d.url),g(null,I)}};return d.url?a.getJSON(n.transformRequest(n.normalizeSourceURL(d.url,null,c,p),a.ResourceType.Source),v):a.exported.frame(()=>v(null,d))}class di{constructor(n,c,p){this.bounds=a.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=c||0,this.maxzoom=p||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const c=Math.pow(2,n.z),p=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*c),g=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*c),v=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*c),T=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*c);return n.x>=p&&n.x<v&&n.y>=g&&n.y<T}}class ti{constructor(n,c,p){this.context=n;const g=n.gl;this.buffer=g.createBuffer(),this.dynamicDraw=Boolean(p),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Wt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class de{constructor(n,c,p,g){this.length=c.length,this.attributes=p,this.itemSize=c.bytesPerElement,this.dynamicDraw=g,this.context=n;const v=n.gl;this.buffer=v.createBuffer(),n.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,c){for(let p=0;p<this.attributes.length;p++){const g=c.attributes[this.attributes[p].name];g!==void 0&&n.enableVertexAttribArray(g)}}setVertexAttribPointers(n,c,p){for(let g=0;g<this.attributes.length;g++){const v=this.attributes[g],T=c.attributes[v.name];T!==void 0&&n.vertexAttribPointer(T,v.components,n[Wt[v.type]],!1,this.itemSize,v.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class me{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Le extends me{getDefault(){return a.Color.transparent}set(n){const c=this.current;(n.r!==c.r||n.g!==c.g||n.b!==c.b||n.a!==c.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class He extends me{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Ze extends me{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class et extends me{getDefault(){return[!0,!0,!0,!0]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||n[3]!==c[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class vt extends me{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class Ue extends me{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class rt extends me{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const c=this.current;(n.func!==c.func||n.ref!==c.ref||n.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Qe extends me{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Mt extends me{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=n,this.dirty=!1}}class Tt extends me{getDefault(){return[0,1]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class zt extends me{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=n,this.dirty=!1}}class Vt extends me{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class li extends me{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.BLEND):c.disable(c.BLEND),this.current=n,this.dirty=!1}}class fi extends me{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class pi extends me{getDefault(){return a.Color.transparent}set(n){const c=this.current;(n.r!==c.r||n.g!==c.g||n.b!==c.b||n.a!==c.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Ii extends me{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class Un extends me{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=n,this.dirty=!1}}class wn extends me{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class Sr extends me{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class co extends me{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class Yo extends me{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Pn extends me{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||n[3]!==c[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class jn extends me{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class Jo extends me{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class eu extends me{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class tu extends me{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class vd extends me{getDefault(){return null}set(n){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Qo extends me{constructor(n){super(n),this.vao=n.extVertexArrayObject}getDefault(){return null}set(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)}}class Lo extends me{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class fa extends me{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class iu extends me{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class rr extends me{constructor(n,c){super(n),this.context=n,this.parent=c}getDefault(){return null}}class vl extends rr{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class J extends rr{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class U extends J{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class j{constructor(n,c,p,g){this.context=n,this.width=c,this.height=p;const v=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new vl(n,v),g&&(this.depthAttachment=new J(n,v))}destroy(){const n=this.context.gl,c=this.colorAttachment.get();if(c&&n.deleteTexture(c),this.depthAttachment){const p=this.depthAttachment.get();p&&n.deleteRenderbuffer(p)}n.deleteFramebuffer(this.framebuffer)}}class Y{constructor(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Le(this),this.clearDepth=new He(this),this.clearStencil=new Ze(this),this.colorMask=new et(this),this.depthMask=new vt(this),this.stencilMask=new Ue(this),this.stencilFunc=new rt(this),this.stencilOp=new Qe(this),this.stencilTest=new Mt(this),this.depthRange=new Tt(this),this.depthTest=new zt(this),this.depthFunc=new Vt(this),this.blend=new li(this),this.blendFunc=new fi(this),this.blendColor=new pi(this),this.blendEquation=new Ii(this),this.cullFace=new Un(this),this.cullFaceSide=new wn(this),this.frontFace=new Sr(this),this.program=new co(this),this.activeTexture=new Yo(this),this.viewport=new Pn(this),this.bindFramebuffer=new jn(this),this.bindRenderbuffer=new Jo(this),this.bindTexture=new eu(this),this.bindVertexBuffer=new tu(this),this.bindElementBuffer=new vd(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Qo(this),this.pixelStoreUnpack=new Lo(this),this.pixelStoreUnpackPremultiplyAlpha=new fa(this),this.pixelStoreUnpackFlipY=new iu(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=n.getExtension("OES_standard_derivatives"),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,c){return new ti(this,n,c)}createVertexBuffer(n,c,p){return new de(this,n,c,p)}createRenderbuffer(n,c,p){const g=this.gl,v=g.createRenderbuffer();return this.bindRenderbuffer.set(v),g.renderbufferStorage(g.RENDERBUFFER,n,c,p),this.bindRenderbuffer.set(null),v}createFramebuffer(n,c,p){return new j(this,n,c,p)}clear({color:n,depth:c,stencil:p}){const g=this.gl;let v=0;n&&(v|=g.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(v|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),p!==void 0&&(v|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),g.clear(v)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){S(n.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class re extends a.Evented{constructor(n,c,p,g){super(),this.id=n,this.dispatcher=p,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},c),a.extend(this,a.pick(c,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=wi(this._options,this.map._requestManager,null,null,(n,c)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new a.ErrorEvent(n)):c&&(a.extend(this,c),c.bounds&&(this.tileBounds=new di(c.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(c.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,c){const p=a.exported.devicePixelRatio>=2,g=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);n.request=a.getImage(this.map._requestManager.transformRequest(g,a.ResourceType.Tile),(v,T,C,I)=>(delete n.request,n.aborted?(n.state="unloaded",c(null)):v?(n.state="errored",c(v)):T?(this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:C,expires:I}),n.setTexture(T,this.map.painter),n.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),void c(null)):c(null)))}static loadTileData(n,c,p){n.setTexture(c,p)}static unloadTileData(n,c){n.texture&&c.saveTileTexture(n.texture)}abortTile(n,c){n.request&&(n.request.cancel(),delete n.request),c()}unloadTile(n,c){n.texture&&this.map.painter.saveTileTexture(n.texture),c()}hasTransition(){return!1}}let ge;function Te(d,n,c,p,g,v,T,C){const I=[d,c,g,n,p,v,1,1,1],L=[T,C,1],B=a.adjoint([],I),[N,$,Z]=a.transformMat3(L,L,a.transpose(B,B));return a.multiply$1(I,[N,0,0,0,$,0,0,0,Z],I)}class we extends a.Evented{constructor(n,c,p,g){super(),this.id=n,this.dispatcher=p,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=c}load(n,c){this._loaded=c||!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(p,g)=>{if(this._loaded=!0,p)this.fire(new a.ErrorEvent(p));else if(g){const{HTMLImageElement:v}=a.window;this.image=g instanceof v?a.exported.getImageData(g):g,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading()}})}loaded(){return this._loaded}updateImage(n){return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this.texture&&this.texture.destroy()}setCoordinates(n){this.coordinates=n,this._boundsArray=void 0;const c=n.map(a.MercatorCoordinate.fromLngLat);return this.tileID=function(p){let g=1/0,v=1/0,T=-1/0,C=-1/0;for(const N of p)g=Math.min(g,N.x),v=Math.min(v,N.y),T=Math.max(T,N.x),C=Math.max(C,N.y);const I=Math.max(T-g,C-v),L=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),B=Math.pow(2,L);return new a.CanonicalTileID(L,Math.floor((g+T)/2*B),Math.floor((v+C)/2*B))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(n){for(const I in this.tiles){const L=this.tiles[I];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture)}if(this._boundsArray)return;const c=a.tileTransform(this.tileID,this.map.transform.projection),[p,g,v,T]=this.coordinates.map(I=>{const L=c.projection.project(I[0],I[1]);return a.getTilePoint(c,L)._round()});this.perspectiveTransform=function(I,L,B,N,$,Z,H,G,ie,X){const Q=Te(0,0,I,0,0,L,I,L),W=Te(B,N,$,Z,H,G,ie,X);return a.multiply$1(W,a.adjoint(Q,Q),W),[W[6]/W[8]*I/a.EXTENT,W[7]/W[8]*L/a.EXTENT]}(this.width,this.height,p.x,p.y,g.x,g.y,T.x,T.y,v.x,v.y);const C=this._boundsArray=new a.StructArrayLayout4i8;C.emplaceBack(p.x,p.y,0,0),C.emplaceBack(g.x,g.y,a.EXTENT,0),C.emplaceBack(T.x,T.y,0,a.EXTENT),C.emplaceBack(v.x,v.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=n.createVertexBuffer(C,a.boundsAttributes.members),this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,c=n.gl;this.texture?this.texture.update(this.image):(this.texture=new a.Texture(n,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._prepareData(n)}loadTile(n,c){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},c(null)):(n.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const ve={vector:class extends a.Evented{constructor(d,n,c,p){if(super(),this.id=d,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(n,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(d){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"}));const n=this.language||this.map._language,c=this.worldview||this.map._worldview;this._tileJSONRequest=wi(this._options,this.map._requestManager,n,c,(p,g)=>{this._tileJSONRequest=null,this._loaded=!0,p?(n&&console.warn(`Ensure that your requested language string is a valid BCP-47 code. Found: ${n}`),c&&c.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${c}`),this.fire(new a.ErrorEvent(p))):g&&(a.extend(this,g),g.bounds&&(this.tileBounds=new di(g.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(g.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),d&&d(p)})}loaded(){return this._loaded}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}onAdd(d){this.map=d,this.load()}setSourceProperty(d){this._tileJSONRequest&&this._tileJSONRequest.cancel(),d(),this.load(()=>{const n=this.map.style._getSourceCaches(this.id);for(const c of n)c.clearTiles()})}setTiles(d){return this.setSourceProperty(()=>{this._options.tiles=d}),this}setUrl(d){return this.setSourceProperty(()=>{this.url=d,this._options.url=d}),this}_setLanguage(d){return d===this.language||this.setSourceProperty(()=>{this.language=d}),this}_setWorldview(d){return d===this.worldview?this:this.worldviewOptions&&d&&!this.worldviewOptions[d]?(console.warn(`Vector tile source "${this.id}" does not support worldview "${d}".`),this):(this.setSourceProperty(()=>{this.worldview=d}),this)}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}loadTile(d,n){const c=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(c,a.ResourceType.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:d.isSymbolTile};if(p.request.collectResourceTiming=this._collectResourceTiming,d.actor&&d.state!=="expired")d.state==="loading"?d.reloadCallback=n:d.request=d.actor.send("reloadTile",p,g.bind(this));else if(d.actor=this._tileWorkers[c]=this._tileWorkers[c]||this.dispatcher.getActor(),this.dispatcher.ready)d.request=d.actor.send("loadTile",p,g.bind(this),void 0,!0);else{const v=a.loadVectorTile.call({deduped:this._deduped},p,(T,C)=>{T||!C?g.call(this,T):(p.data={cacheControl:C.cacheControl,expires:C.expires,rawData:C.rawData.slice(0)},d.actor&&d.actor.send("loadTile",p,g.bind(this),void 0,!0))},!0);d.request={cancel:v}}function g(v,T){return delete d.request,d.aborted?n(null):v&&v.status!==404?n(v):(T&&T.resourceTiming&&(d.resourceTiming=T.resourceTiming),this.map._refreshExpiredTiles&&T&&d.setExpiryData(T),d.loadVectorData(T,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(d.reloadCallback&&(this.loadTile(d,d.reloadCallback),d.reloadCallback=null)))}}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.actor&&d.actor.send("abortTile",{uid:d.uid,type:this.type,source:this.id})}unloadTile(d){d.unloadVectorData(),d.actor&&d.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:re,"raster-dem":class extends re{constructor(d,n,c,p){super(d,n,c,p),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(d,n){const c=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(g,v){g&&(d.state="errored",n(g)),v&&(d.dem=v,d.dem.onDeserialize(),d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0,d.state="loaded",n(null))}d.request=a.getImage(this.map._requestManager.transformRequest(c,a.ResourceType.Tile),function(g,v,T,C){if(delete d.request,d.aborted)d.state="unloaded",n(null);else if(g)d.state="errored",n(g);else if(v){this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:T,expires:C});const I=a.window.ImageBitmap&&v instanceof a.window.ImageBitmap&&(ge==null&&(ge=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&typeof a.window.createImageBitmap=="function"),ge),L=1-(v.width-a.prevPowerOfTwo(v.width))/2;L<1||d.neighboringTiles||(d.neighboringTiles=this._getNeighboringTiles(d.tileID));const B=I?v:a.exported.getImageData(v,L),N={uid:d.uid,coord:d.tileID,source:this.id,rawImageData:B,encoding:this.encoding,padding:L};d.actor&&d.state!=="expired"||(d.actor=this.dispatcher.getActor(),d.actor.send("loadDEMTile",N,p.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(d){const n=d.canonical,c=Math.pow(2,n.z),p=(n.x-1+c)%c,g=n.x===0?d.wrap-1:d.wrap,v=(n.x+1+c)%c,T=n.x+1===c?d.wrap+1:d.wrap,C={};return C[new a.OverscaledTileID(d.overscaledZ,g,n.z,p,n.y).key]={backfilled:!1},C[new a.OverscaledTileID(d.overscaledZ,T,n.z,v,n.y).key]={backfilled:!1},n.y>0&&(C[new a.OverscaledTileID(d.overscaledZ,g,n.z,p,n.y-1).key]={backfilled:!1},C[new a.OverscaledTileID(d.overscaledZ,d.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},C[new a.OverscaledTileID(d.overscaledZ,T,n.z,v,n.y-1).key]={backfilled:!1}),n.y+1<c&&(C[new a.OverscaledTileID(d.overscaledZ,g,n.z,p,n.y+1).key]={backfilled:!1},C[new a.OverscaledTileID(d.overscaledZ,d.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},C[new a.OverscaledTileID(d.overscaledZ,T,n.z,v,n.y+1).key]={backfilled:!1}),C}unloadTile(d){d.demTexture&&this.map.painter.saveTileTexture(d.demTexture),d.fbo&&(d.fbo.destroy(),delete d.fbo),d.dem&&delete d.dem,delete d.neighboringTiles,d.state="unloaded"}},geojson:class extends a.Evented{constructor(d,n,c,p){super(),this.id=d,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(p),this._data=n.data,this._options=a.extend({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const g=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(n.buffer!==void 0?n.buffer:128)*g,tolerance:(n.tolerance!==void 0?n.tolerance:.375)*g,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:a.EXTENT,radius:(n.clusterRadius!==void 0?n.clusterRadius:50)*g,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions)}onAdd(d){this.map=d,this.setData(this._data)}setData(d){return this._data=d,this._updateWorkerData(),this}getClusterExpansionZoom(d,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:d,source:this.id},n),this}getClusterChildren(d,n){return this.actor.send("geojson.getClusterChildren",{clusterId:d,source:this.id},n),this}getClusterLeaves(d,n,c,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:d,limit:n,offset:c},p),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const d=a.extend({},this.workerOptions),n=this._data;typeof n=="string"?(d.request=this.map._requestManager.transformRequest(a.exported.resolveURL(n),a.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(n),this._pendingLoad=this.actor.send(`${this.type}.loadData`,d,(c,p)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new a.ErrorEvent(c));else{const g={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&p&&p.resourceTiming&&p.resourceTiming[this.id]&&(g.resourceTiming=p.resourceTiming[this.id]),this.fire(new a.Event("data",g)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(d,n){const c=d.actor?"reloadTile":"loadTile";d.actor=this.actor,d.request=this.actor.send(c,{type:this.type,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(p,g)=>(delete d.request,d.unloadVectorData(),d.aborted?n(null):p?n(p):(d.loadVectorData(g,this.map.painter,c==="reloadTile"),n(null))),void 0,c==="loadTile")}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.aborted=!0}unloadTile(d){d.unloadVectorData(),this.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends we{constructor(d,n,c,p){super(d,n,c,p),this.roundZoom=!0,this.type="video",this.options=n}load(){this._loaded=!1;const d=this.options;this.urls=[];for(const n of d.urls)this.urls.push(this.map._requestManager.transformRequest(n,a.ResourceType.Source).url);a.getVideo(this.urls,(n,c)=>{this._loaded=!0,n?this.fire(new a.ErrorEvent(n)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(d){if(this.video){const n=this.video.seekable;d<n.start(0)||d>n.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=d}}getVideo(){return this.video}onAdd(d){this.map||(this.map=d,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const d=this.map.painter.context,n=d.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(d,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(d)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:we,canvas:class extends we{constructor(d,n,c,p){super(d,n,c,p),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(v=>typeof v!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(d){this.map=d,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let d=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,d=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,d=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context;this.texture?(d||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(n,this.canvas,n.gl.RGBA,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const d of[this.canvas.width,this.canvas.height])if(isNaN(d)||d<=0)return!0;return!1}},custom:class extends a.Evented{constructor(d,n,c,p){super(),this.id=d,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=n,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new di(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.coveringTiles=this._coveringTiles.bind(this),a.extend(this,a.pick(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(d){this._map=d,this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(d),this.load()}onRemove(d){this._implementation.onRemove&&this._implementation.onRemove(d)}hasTile(d){if(this._implementation.hasTile){const{x:n,y:c,z:p}=d.canonical;return this._implementation.hasTile({x:n,y:c,z:p})}return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d,n){const{x:c,y:p,z:g}=d.tileID.canonical,v=new a.window.AbortController,T=this._implementation.loadTile({x:c,y:p,z:g},{signal:v.signal});if(!T)return this.loadTileData(d,{width:this.tileSize,height:this.tileSize,data:null}),d.state="loaded",n(null);T.cancel=()=>v.abort(),d.request=T.then(function(C){return delete d.request,d.aborted?(d.state="unloaded",n(null)):C?function(I){return I instanceof a.window.ImageData||I instanceof a.window.ImageBitmap||I instanceof a.window.HTMLCanvasElement}(C)?(this.loadTileData(d,C),d.state="loaded",void n(null)):(d.state="errored",n(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`))):(this.loadTileData(d,{width:this.tileSize,height:this.tileSize,data:null}),d.state="loaded",n(null))}.bind(this)).catch(C=>{C.code!==20&&(d.state="errored",n(C))})}loadTileData(d,n){re.loadTileData(d,n,this._map.painter)}unloadTileData(d){re.unloadTileData(d,this._map.painter)}prepareTile(d){if(!this._implementation.prepareTile)return null;const{x:n,y:c,z:p}=d.tileID.canonical,g=this._implementation.prepareTile({x:n,y:c,z:p});return g?(this.loadTileData(d,g),d.state="loaded",g):null}unloadTile(d,n){if(this.unloadTileData(d),this._implementation.unloadTile){const{x:c,y:p,z:g}=d.tileID.canonical;this._implementation.unloadTile({x:c,y:p,z:g})}n()}abortTile(d,n){d.request&&d.request.cancel&&(d.request.cancel(),delete d.request),n()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(d=>({x:d.canonical.x,y:d.canonical.y,z:d.canonical.z}))}_update(){this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Se=function(d,n,c,p){const g=new ve[n.type](d,n,c,p);if(g.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${g.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],g),g};function je(d,n){const c=a.identity([]);return a.scale(c,c,[.5*d.width,.5*-d.height,1]),a.translate(c,c,[1,-1,0]),a.multiply(c,c,d.calculateProjMatrix(n.toUnwrapped())),Float32Array.from(c)}function dt(d,n,c,p,g,v,T,C=!1){const I=d.tilesIn(p,T,C);I.sort(kt);const L=[];for(const N of I)L.push({wrappedTileID:N.tile.tileID.wrapped().key,queryResults:N.tile.queryRenderedFeatures(n,c,d._state,N,g,v,je(d.transform,N.tile.tileID),C)});const B=function(N){const $={},Z={};for(const H of N){const G=H.queryResults,ie=H.wrappedTileID,X=Z[ie]=Z[ie]||{};for(const Q in G){const W=G[Q],le=X[Q]=X[Q]||{},te=$[Q]=$[Q]||[];for(const ne of W)le[ne.featureIndex]||(le[ne.featureIndex]=!0,te.push(ne))}}return $}(L);for(const N in B)B[N].forEach($=>{const Z=$.feature,H=Z.layer;H&&H.type!=="background"&&H.type!=="sky"&&(Z.source=H.source,H["source-layer"]&&(Z.sourceLayer=H["source-layer"]),Z.state=Z.id!==void 0?d.getFeatureState(H["source-layer"],Z.id):{})});return B}function We(d,n){const c=d.getRenderableIds().map(v=>d.getTileByID(v)),p=[],g={};for(let v=0;v<c.length;v++){const T=c[v],C=T.tileID.canonical.key;g[C]||(g[C]=!0,T.querySourceFeatures(p,n))}return p}function kt(d,n){const c=d.tileID,p=n.tileID;return c.overscaledZ-p.overscaledZ||c.canonical.y-p.canonical.y||c.wrap-p.wrap||c.canonical.x-p.canonical.x}function Lt(){return Pa.workerClass!=null?new Pa.workerClass:new a.window.Worker(Pa.workerUrl)}const Pt="mapboxgl_preloaded_worker_pool";class Rt{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<Rt.workerCount;)this.workers.push(new Lt);return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Pt]}numActive(){return Object.keys(this.active).length}}let Ht;function Ei(){return Ht||(Ht=new Rt),Ht}function Zi(d,n){const c={};for(const p in d)p!=="ref"&&(c[p]=d[p]);return a.refProperties.forEach(p=>{p in n&&(c[p]=n[p])}),c}function Mi(d){d=d.slice();const n=Object.create(null);for(let c=0;c<d.length;c++)n[d[c].id]=d[c];for(let c=0;c<d.length;c++)"ref"in d[c]&&(d[c]=Zi(d[c],n[d[c].ref]));return d}Rt.workerCount=2;const Ee={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function _r(d,n,c){c.push({command:Ee.addSource,args:[d,n[d]]})}function Qi(d,n,c){n.push({command:Ee.removeSource,args:[d]}),c[d]=!0}function Ar(d,n,c,p){Qi(d,c,p),_r(d,n,c)}function Py(d,n,c){let p;for(p in d[c])if(d[c].hasOwnProperty(p)&&p!=="data"&&!S(d[c][p],n[c][p]))return!1;for(p in n[c])if(n[c].hasOwnProperty(p)&&p!=="data"&&!S(d[c][p],n[c][p]))return!1;return!0}function gr(d,n,c,p,g,v){let T;for(T in n=n||{},d=d||{})d.hasOwnProperty(T)&&(S(d[T],n[T])||c.push({command:v,args:[p,T,n[T],g]}));for(T in n)n.hasOwnProperty(T)&&!d.hasOwnProperty(T)&&(S(d[T],n[T])||c.push({command:v,args:[p,T,n[T],g]}))}function nu(d){return d.id}function $p(d,n){return d[n.id]=n,d}class xl{constructor(n,c){this.reset(n,c)}reset(n,c){this.points=n||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=a.clamp(n,0,1);let c=1,p=this._distances[c];const g=n*this.paddedLength+this.padding;for(;p<g&&c<this._distances.length;)p=this._distances[++c];const v=c-1,T=this._distances[v],C=p-T,I=C>0?(g-T)/C:0;return this.points[v].mult(1-I).add(this.points[c].mult(I))}}class ut{constructor(n,c,p){const g=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(n/p),this.yCellCount=Math.ceil(c/p);for(let T=0;T<this.xCellCount*this.yCellCount;T++)g.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=c,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,c,p,g,v){this._forEachCell(c,p,g,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(g),this.bboxes.push(v)}insertCircle(n,c,p,g){this._forEachCell(c-g,p-g,c+g,p+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(c),this.circles.push(p),this.circles.push(g)}_insertBoxCell(n,c,p,g,v,T){this.boxCells[v].push(T)}_insertCircleCell(n,c,p,g,v,T){this.circleCells[v].push(T)}_query(n,c,p,g,v,T){if(p<0||n>this.width||g<0||c>this.height)return!v&&[];const C=[];if(n<=0&&c<=0&&this.width<=p&&this.height<=g){if(v)return!0;for(let I=0;I<this.boxKeys.length;I++)C.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){const L=this.circles[3*I],B=this.circles[3*I+1],N=this.circles[3*I+2];C.push({key:this.circleKeys[I],x1:L-N,y1:B-N,x2:L+N,y2:B+N})}return T?C.filter(T):C}return this._forEachCell(n,c,p,g,this._queryCell,C,{hitTest:v,seenUids:{box:{},circle:{}}},T),v?C.length>0:C}_queryCircle(n,c,p,g,v){const T=n-p,C=n+p,I=c-p,L=c+p;if(C<0||T>this.width||L<0||I>this.height)return!g&&[];const B=[];return this._forEachCell(T,I,C,L,this._queryCellCircle,B,{hitTest:g,circle:{x:n,y:c,radius:p},seenUids:{box:{},circle:{}}},v),g?B.length>0:B}query(n,c,p,g,v){return this._query(n,c,p,g,!1,v)}hitTest(n,c,p,g,v){return this._query(n,c,p,g,!0,v)}hitTestCircle(n,c,p,g){return this._queryCircle(n,c,p,!0,g)}_queryCell(n,c,p,g,v,T,C,I){const L=C.seenUids,B=this.boxCells[v];if(B!==null){const $=this.bboxes;for(const Z of B)if(!L.box[Z]){L.box[Z]=!0;const H=4*Z;if(n<=$[H+2]&&c<=$[H+3]&&p>=$[H+0]&&g>=$[H+1]&&(!I||I(this.boxKeys[Z]))){if(C.hitTest)return T.push(!0),!0;T.push({key:this.boxKeys[Z],x1:$[H],y1:$[H+1],x2:$[H+2],y2:$[H+3]})}}}const N=this.circleCells[v];if(N!==null){const $=this.circles;for(const Z of N)if(!L.circle[Z]){L.circle[Z]=!0;const H=3*Z;if(this._circleAndRectCollide($[H],$[H+1],$[H+2],n,c,p,g)&&(!I||I(this.circleKeys[Z]))){if(C.hitTest)return T.push(!0),!0;{const G=$[H],ie=$[H+1],X=$[H+2];T.push({key:this.circleKeys[Z],x1:G-X,y1:ie-X,x2:G+X,y2:ie+X})}}}}}_queryCellCircle(n,c,p,g,v,T,C,I){const L=C.circle,B=C.seenUids,N=this.boxCells[v];if(N!==null){const Z=this.bboxes;for(const H of N)if(!B.box[H]){B.box[H]=!0;const G=4*H;if(this._circleAndRectCollide(L.x,L.y,L.radius,Z[G+0],Z[G+1],Z[G+2],Z[G+3])&&(!I||I(this.boxKeys[H])))return T.push(!0),!0}}const $=this.circleCells[v];if($!==null){const Z=this.circles;for(const H of $)if(!B.circle[H]){B.circle[H]=!0;const G=3*H;if(this._circlesCollide(Z[G],Z[G+1],Z[G+2],L.x,L.y,L.radius)&&(!I||I(this.circleKeys[H])))return T.push(!0),!0}}}_forEachCell(n,c,p,g,v,T,C,I){const L=this._convertToXCellCoord(n),B=this._convertToYCellCoord(c),N=this._convertToXCellCoord(p),$=this._convertToYCellCoord(g);for(let Z=L;Z<=N;Z++)for(let H=B;H<=$;H++)if(v.call(this,n,c,p,g,this.xCellCount*H+Z,T,C,I))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,c,p,g,v,T){const C=g-n,I=v-c,L=p+T;return L*L>C*C+I*I}_circleAndRectCollide(n,c,p,g,v,T,C){const I=(T-g)/2,L=Math.abs(n-(g+I));if(L>I+p)return!1;const B=(C-v)/2,N=Math.abs(c-(v+B));if(N>B+p)return!1;if(L<=I||N<=B)return!0;const $=L-I,Z=N-B;return $*$+Z*Z<=p*p}}const ci=Math.tan(85*Math.PI/180);function Xt(d,n,c,p,g,v,T){const C=a.create();if(c)if(v.name==="globe"){const I=a.calculateGlobeLabelMatrix(g,n);a.multiply(C,C,I)}else{const I=Dt([],T);C[0]=I[0],C[1]=I[1],C[4]=I[2],C[5]=I[3],p||a.rotateZ(C,C,g.angle)}else a.multiply(C,g.labelPlaneMatrix,d);return C}function Kr(d,n,c,p,g,v,T){const C=Xt(d,n,c,p,g,v,T);return v.name==="globe"&&c||(C[2]=C[6]=C[10]=C[14]=0),C}function Ds(d,n,c,p,g,v,T){if(c){if(v.name==="globe"){const C=Xt(d,n,c,p,g,v,T);return a.invert(C,C),a.multiply(C,d,C),C}{const C=a.clone(d),I=a.identity([]);return I[0]=T[0],I[1]=T[1],I[4]=T[2],I[5]=T[3],a.multiply(C,C,I),p||a.rotateZ(C,C,-g.angle),C}}return g.glCoordMatrix}function qt(d,n,c=0){const p=[d.x,d.y,c,1];c?a.transformMat4$1(p,p,n):hn(p,p,n);const g=p[3];return{point:[p[0]/g,p[1]/g,p[2]/g],signedDistanceFromCamera:g}}function zo(d,n){const c=[d[0],d[1],d[2],1];a.transformMat4$1(c,c,n);const p=c[3];return{point:[c[0]/p,c[1]/p,c[2]/p],signedDistanceFromCamera:p}}function pa(d,n){return Math.min(.5+d/n*.5,1.5)}function bl(d,n){const c=d[0]/d[3],p=d[1]/d[3];return c>=-n[0]&&c<=n[0]&&p>=-n[1]&&p<=n[1]}function Ir(d,n,c,p,g,v,T,C,I,L){const B=c.transform,N=p?d.textSizeData:d.iconSizeData,$=a.evaluateSizeForZoom(N,c.transform.zoom),Z=B.projection.name==="globe",H=[256/c.width*2+1,256/c.height*2+1],G=p?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;G.clear();let ie=null;Z&&(ie=p?d.text.globeExtVertexArray:d.icon.globeExtVertexArray);const X=d.lineVertexArray,Q=p?d.text.placedSymbolArray:d.icon.placedSymbolArray,W=c.transform.width/c.transform.height;let le=!1;for(let te=0;te<Q.length;te++){const ne=Q.get(te);if(ne.writingMode!==a.WritingMode.vertical||le||te!==0&&Q.get(te-1).writingMode===a.WritingMode.horizontal||(le=!0),(ne.hidden||ne.writingMode===a.WritingMode.vertical)&&!le){En(ne.numGlyphs,G);continue}le=!1;const _e=new a.pointGeometry(ne.tileAnchorX,ne.tileAnchorY),Me=I?I(_e):[0,0,0],De=B.projection.projectTilePoint(_e.x,_e.y,L.canonical),Ie=[De.x+Me[0],De.y+Me[1],De.z+Me[2]],Je=[...Ie,1];if(a.transformMat4$1(Je,Je,n),!bl(Je,H)){En(ne.numGlyphs,G);continue}const ae=pa(c.transform.cameraToCenterDistance,Je[3]),Ce=a.evaluateSizeForFeature(N,$,ne),Re=T?Ce/ae:Ce*ae,ot=qt(new a.pointGeometry(Ie[0],Ie[1]),g,Ie[2]);if(ot.signedDistanceFromCamera<=0){En(ne.numGlyphs,G);continue}let Oe={};const gt=T?null:I,tt=ma(ne,Re,!1,C,n,g,v,d.glyphOffsetArray,X,G,ie,ot.point,_e,Oe,W,gt,B.projection,L,T);le=tt.useVertical,gt&&tt.needsFlipping&&(Oe={}),(tt.notEnoughRoom||le||tt.needsFlipping&&ma(ne,Re,!0,C,n,g,v,d.glyphOffsetArray,X,G,ie,ot.point,_e,Oe,W,gt,B.projection,L,T).notEnoughRoom)&&En(ne.numGlyphs,G)}p?(d.text.dynamicLayoutVertexBuffer.updateData(G),ie&&d.text.globeExtVertexBuffer.updateData(ie)):(d.icon.dynamicLayoutVertexBuffer.updateData(G),ie&&d.icon.globeExtVertexBuffer.updateData(ie))}function en(d,n,c,p,g,v,T,C,I,L,B,N,$,Z,H,G){const ie=C.glyphStartIndex+C.numGlyphs,X=C.lineStartIndex,Q=C.lineStartIndex+C.lineLength,W=n.getoffsetX(C.glyphStartIndex),le=n.getoffsetX(ie-1),te=ga(d*W,c,p,g,v,T,C.segment,X,Q,I,L,B,N,$,!0,Z,H,G);if(!te)return null;const ne=ga(d*le,c,p,g,v,T,C.segment,X,Q,I,L,B,N,$,!0,Z,H,G);return ne?{first:te,last:ne}:null}function Gp(d,n,c,p){return d.writingMode===a.WritingMode.horizontal&&Math.abs(c.y-n.y)>Math.abs(c.x-n.x)*p?{useVertical:!0}:d.writingMode===a.WritingMode.vertical?n.y<c.y?{needsFlipping:!0}:null:d.flipState!==0&&function(g,v,T){const C=(v.x-g.x)*T;return C===0||Math.abs((v.y-g.y)/C)>ci}(n,c,p)?d.flipState===1?{needsFlipping:!0}:null:n.x>c.x?{needsFlipping:!0}:null}function ma(d,n,c,p,g,v,T,C,I,L,B,N,$,Z,H,G,ie,X,Q){const W=n/24,le=d.lineOffsetX*W,te=d.lineOffsetY*W;let ne;if(d.numGlyphs>1){const _e=d.glyphStartIndex+d.numGlyphs,Me=d.lineStartIndex,De=d.lineStartIndex+d.lineLength,Ie=en(W,C,le,te,c,N,$,d,I,v,Z,G,!1,ie,X,Q);if(!Ie)return{notEnoughRoom:!0};const Je=zo(Ie.first.point,T).point,ae=zo(Ie.last.point,T).point,Ce=new a.pointGeometry(Je[0],Je[1]),Re=new a.pointGeometry(ae[0],ae[1]);if(p&&!c){const ot=Gp(d,Ce,Re,H);if(d.flipState=ot&&ot.needsFlipping?1:2,ot)return ot}ne=[Ie.first];for(let ot=d.glyphStartIndex+1;ot<_e-1;ot++)ne.push(ga(W*C.getoffsetX(ot),le,te,c,N,$,d.segment,Me,De,I,v,Z,G,!1,!1,ie,X,Q));ne.push(Ie.last)}else{if(p&&!c){const Me=qt($,g).point,De=d.lineStartIndex+d.segment+1,Ie=new a.pointGeometry(I.getx(De),I.gety(De)),Je=qt(Ie,g),ae=Je.signedDistanceFromCamera>0?Je.point:_a($,Ie,Me,1,g,void 0,ie,X.canonical),Ce=Gp(d,new a.pointGeometry(Me[0],Me[1]),new a.pointGeometry(ae[0],ae[1]),H);if(d.flipState=Ce&&Ce.needsFlipping?1:2,Ce)return Ce}const _e=ga(W*C.getoffsetX(d.glyphStartIndex),le,te,c,N,$,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,I,v,Z,G,!1,!1,ie,X,Q);if(!_e)return{notEnoughRoom:!0};ne=[_e]}if(B)for(const _e of ne)a.updateGlobeVertexNormal(B,L.length+0,_e.up[0],_e.up[1],_e.up[2]),a.updateGlobeVertexNormal(B,L.length+1,_e.up[0],_e.up[1],_e.up[2]),a.updateGlobeVertexNormal(B,L.length+2,_e.up[0],_e.up[1],_e.up[2]),a.updateGlobeVertexNormal(B,L.length+3,_e.up[0],_e.up[1],_e.up[2]),a.addDynamicAttributes(L,_e.point[0],_e.point[1],_e.point[2],_e.angle);else for(const _e of ne)a.addDynamicAttributes(L,_e.point[0],_e.point[1],_e.point[2],_e.angle);return{}}function ru(d,n,c,p,g){const v=p.projectTilePoint(d.x,d.y,n);if(!g)return qt(v,c,v.z);const T=g(d);return qt(new a.pointGeometry(v.x+T[0],v.y+T[1]),c,v.z+T[2])}function _a(d,n,c,p,g,v,T,C){const I=ru(d.add(d.sub(n)._unit()),C,g,T,v).point,L=a.sub([],c,I);return a.scaleAndAdd([],c,L,p/a.length(L))}function ga(d,n,c,p,g,v,T,C,I,L,B,N,$,Z,H,G,ie,X){const Q=p?d-n:d+n;let W=Q>0?1:-1,le=0;p&&(W*=-1,le=Math.PI),W<0&&(le+=Math.PI);let te=W>0?C+T:C+T+1,ne=g,_e=g,Me=0,De=0;const Ie=Math.abs(Q),Je=[],ae=[];let Ce=v;const Re=()=>{const Ct=te-W;return Me===0?v:new a.pointGeometry(L.getx(Ct),L.gety(Ct))},ot=()=>_a(Re(),Ce,_e,Ie-Me+1,B,$,G,ie.canonical);for(;Me+De<=Ie;){if(te+=W,te<C||te>=I)return null;if(_e=ne,Je.push(ne),Z&&ae.push(Ce||Re()),ne=N[te],ne===void 0){Ce=new a.pointGeometry(L.getx(te),L.gety(te));const Ct=ru(Ce,ie.canonical,B,G,$);ne=Ct.signedDistanceFromCamera>0?N[te]=Ct.point:ot()}else Ce=null;Me+=De,De=a.distance(_e,ne)}Ce=Ce||new a.pointGeometry(L.getx(te),L.gety(te));const Oe=Re();H&&$&&(N[te]=ne=N[te]===void 0?ne:ot(),De=a.distance(_e,ne));const gt=(Ie-Me)/De,tt=Ce.sub(Oe).mult(gt)._add(Oe),st=a.sub([],ne,_e),at=a.scaleAndAdd([],_e,st,gt);let nt=[0,0,1],_t=st[0],Bt=st[1];if(X&&(nt=G.upVector(ie.canonical,tt.x,tt.y),nt[0]!==0||nt[1]!==0||nt[2]!==1)){const Ct=[1,0,0],Ut=[0,1,0];Ct[0]=nt[2],Ct[1]=0,Ct[2]=-nt[0],a.cross(Ut,nt,Ct),a.normalize(Ct,Ct),a.normalize(Ut,Ut),_t=a.dot(st,Ct),Bt=a.dot(st,Ut)}if(c){const Ct=a.cross([],nt,st);a.normalize(Ct,Ct),a.scaleAndAdd(at,at,Ct,c*W)}const $t=le+Math.atan2(Bt,_t);return Je.push(at),Z&&ae.push(tt),{point:at,angle:$t,path:Je,tilePath:ae,up:nt}}const qp=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function En(d,n){for(let c=0;c<d;c++){const p=n.length;n.resize(p+4),n.float32.set(qp,4*p)}}function hn(d,n,c){const p=n[0],g=n[1];return d[0]=c[0]*p+c[4]*g+c[12],d[1]=c[1]*p+c[5]*g+c[13],d[3]=c[3]*p+c[7]*g+c[15],d}const Mr=100;class xd{constructor(n,c,p=new ut(n.width+200,n.height+200,25),g=new ut(n.width+200,n.height+200,25)){this.transform=n,this.grid=p,this.ignoredGrid=g,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+Mr,this.screenBottomBoundary=n.height+Mr,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.fogState=c}placeCollisionBox(n,c,p,g,v,T,C,I){let L=p.projectedAnchorX,B=p.projectedAnchorY,N=p.projectedAnchorZ;const $=p.elevation,Z=p.tileID;if($&&Z){const te=n.getProjection().upVector(Z.canonical,p.tileAnchorX,p.tileAnchorY),ne=n.getProjection().upVectorScale(Z.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;L+=te[0]*$*ne,B+=te[1]*$*ne,N+=te[2]*$*ne}const H=this.projectAndGetPerspectiveRatio(C,[L,B,N],p.tileID,n.projection.name==="globe"||!!$||this.transform.pitch>0,n.getProjection()),G=T*H.perspectiveRatio,ie=(p.x1*c+g.x-p.padding)*G+H.point.x,X=(p.y1*c+g.y-p.padding)*G+H.point.y,Q=(p.x2*c+g.x+p.padding)*G+H.point.x,W=(p.y2*c+g.y+p.padding)*G+H.point.y,le=H.perspectiveRatio<=.55||H.occluded;return!this.isInsideGrid(ie,X,Q,W)||!v&&this.grid.hitTest(ie,X,Q,W,I)||le?{box:[],offscreen:!1,occluded:H.occluded}:{box:[ie,X,Q,W],offscreen:this.isOffscreen(ie,X,Q,W),occluded:!1}}placeCollisionCircles(n,c,p,g,v,T,C,I,L,B,N,$,Z,H,G){const ie=[],X=this.transform.elevation,Q=X?X.getAtTileOffsetFunc(G,this.transform.center.lat,this.transform.worldSize,n.getProjection()):Oe=>[0,0,0],W=new a.pointGeometry(p.tileAnchorX,p.tileAnchorY),le=n.getProjection().projectTilePoint(p.tileAnchorX,p.tileAnchorY,G.canonical),te=Q(W),ne=[le.x+te[0],le.y+te[1],le.z+te[2]],_e=n.projection.name==="globe",Me=this.projectAndGetPerspectiveRatio(C,[ne[0],ne[1],ne[2]],G,_e||!!X||this.transform.pitch>0,n.getProjection()),{perspectiveRatio:De}=Me,Ie=(N?T/De:T*De)/a.ONE_EM,Je=qt(new a.pointGeometry(ne[0],ne[1]),I,ne[2]).point,ae=Me.signedDistanceFromCamera>0?en(Ie,v,p.lineOffsetX*Ie,p.lineOffsetY*Ie,!1,Je,W,p,g,I,{},X&&!N?Q:null,N&&!!X,n.getProjection(),G,N):null;let Ce=!1,Re=!1,ot=!0;if(ae&&!Me.occluded){const Oe=.5*Z*De+H,gt=new a.pointGeometry(-100,-100),tt=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),st=new xl,at=ae.first,nt=ae.last;let _t=[];for(let Ct=at.path.length-1;Ct>=1;Ct--)_t.push(at.path[Ct]);for(let Ct=1;Ct<nt.path.length;Ct++)_t.push(nt.path[Ct]);const Bt=2.5*Oe;if(L){const Ct=_t.map(X&&!_e?(Ut,ki)=>{const Ui=Q(ki<at.path.length-1?at.tilePath[at.path.length-1-ki]:nt.tilePath[ki-at.path.length+2]);return Ut[2]=Ui[2],zo(Ut,L)}:Ut=>zo(Ut,L));_t=Ct.some(Ut=>Ut.signedDistanceFromCamera<=0)?[]:Ct.map(Ut=>Ut.point)}let $t=[];if(_t.length>0){const Ct=_t.map(zi=>new a.pointGeometry(zi[0],zi[1]));let Ut=1/0,ki=-1/0,Ui=1/0,Ki=-1/0;for(let zi=0;zi<Ct.length;zi++)Ut=Math.min(Ut,Ct[zi].x),Ui=Math.min(Ui,Ct[zi].y),ki=Math.max(ki,Ct[zi].x),Ki=Math.max(Ki,Ct[zi].y);$t=Ut>=gt.x&&ki<=tt.x&&Ui>=gt.y&&Ki<=tt.y?[Ct]:ki<gt.x||Ut>tt.x||Ki<gt.y||Ui>tt.y?[]:a.clipLine([Ct],gt.x,gt.y,tt.x,tt.y)}for(const Ct of $t){st.reset(Ct,.25*Oe);let Ut=0;Ut=st.length<=.5*Oe?1:Math.ceil(st.paddedLength/Bt)+1;for(let ki=0;ki<Ut;ki++){const Ui=ki/Math.max(Ut-1,1),Ki=st.lerp(Ui),zi=Ki.x+Mr,or=Ki.y+Mr;ie.push(zi,or,Oe,0);const fo=zi-Oe,Fo=or-Oe,Hi=zi+Oe,tn=or+Oe;if(ot=ot&&this.isOffscreen(fo,Fo,Hi,tn),Re=Re||this.isInsideGrid(fo,Fo,Hi,tn),!c&&this.grid.hitTestCircle(zi,or,Oe,$)&&(Ce=!0,!B))return{circles:[],offscreen:!1,collisionDetected:Ce,occluded:!1}}}}return{circles:!B&&Ce||!Re?[]:ie,offscreen:ot,collisionDetected:Ce,occluded:Me.occluded}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let p=1/0,g=1/0,v=-1/0,T=-1/0;for(const B of n){const N=new a.pointGeometry(B.x+Mr,B.y+Mr);p=Math.min(p,N.x),g=Math.min(g,N.y),v=Math.max(v,N.x),T=Math.max(T,N.y),c.push(N)}const C=this.grid.query(p,g,v,T).concat(this.ignoredGrid.query(p,g,v,T)),I={},L={};for(const B of C){const N=B.key;if(I[N.bucketInstanceId]===void 0&&(I[N.bucketInstanceId]={}),I[N.bucketInstanceId][N.featureIndex])continue;const $=[new a.pointGeometry(B.x1,B.y1),new a.pointGeometry(B.x2,B.y1),new a.pointGeometry(B.x2,B.y2),new a.pointGeometry(B.x1,B.y2)];a.polygonIntersectsPolygon(c,$)&&(I[N.bucketInstanceId][N.featureIndex]=!0,L[N.bucketInstanceId]===void 0&&(L[N.bucketInstanceId]=[]),L[N.bucketInstanceId].push(N.featureIndex))}return L}insertCollisionBox(n,c,p,g,v){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:g,collisionGroupID:v},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,c,p,g,v){const T=c?this.ignoredGrid:this.grid,C={bucketInstanceId:p,featureIndex:g,collisionGroupID:v};for(let I=0;I<n.length;I+=4)T.insertCircle(C,n[I],n[I+1],n[I+2])}projectAndGetPerspectiveRatio(n,c,p,g,v){const T=[c[0],c[1],c[2],1];let C=!1;if(c[2]||this.transform.pitch>0){a.transformMat4$1(T,T,n);const I=v.name==="globe";this.fogState&&p&&!I&&(C=function(L,B,N,$,Z,H){const G=H.calculateFogTileMatrix(Z),ie=[B,N,$];return a.transformMat4(ie,ie,G),ei(L,ie,H.pitch,H._fov)}(this.fogState,c[0],c[1],c[2],p.toUnwrapped(),this.transform)>.9)}else hn(T,T,n);return{point:new a.pointGeometry((T[0]/T[3]+1)/2*this.transform.width+Mr,(-T[1]/T[3]+1)/2*this.transform.height+Mr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(v)/T[3]*.5,1.5),signedDistanceFromCamera:T[3],occluded:g&&T[2]>T[3]||C}}isOffscreen(n,c,p,g){return p<Mr||n>=this.screenRightBoundary||g<Mr||c>this.screenBottomBoundary}isInsideGrid(n,c,p,g){return p>=0&&n<this.gridRightBoundary&&g>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n}}function Vn(d,n,c){const p=n.createTileMatrix(d,d.worldSize,c.toUnwrapped());return a.multiply(new Float32Array(16),d.projMatrix,p)}function kr(d,n,c){if(n.projection.name===c.projection.name)return d.projMatrix;const p=c.clone();return p.setProjection(n.projection),Vn(p,n.getProjection(),d)}function ou(d,n,c){return n.name===c.projection.name?d.projMatrix:Vn(c,n,d)}class wl{constructor(n,c,p,g){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?c:-c))):g&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class an{constructor(n,c,p,g,v,T=!1){this.text=new wl(n?n.text:null,c,p,v),this.icon=new wl(n?n.icon:null,c,g,v),this.clipped=T}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ls{constructor(n,c,p,g=!1){this.text=n,this.icon=c,this.skipFade=p,this.clipped=g}}class bd{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class El{constructor(n,c,p,g,v){this.bucketInstanceId=n,this.featureIndex=c,this.sourceLayerIndex=p,this.bucketIndex=g,this.tileID=v}}class Rn{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const c=++this.maxGroupID;this.collisionGroups[n]={ID:c,predicate:p=>p.collisionGroupID===c}}return this.collisionGroups[n]}}function su(d,n,c,p,g){const{horizontalAlign:v,verticalAlign:T}=a.getAnchorAlignment(d),C=-(v-.5)*n,I=-(T-.5)*c,L=a.evaluateVariableOffset(d,p);return new a.pointGeometry(C+L[0]*g,I+L[1]*g)}function Tl(d,n,c,p,g){const v=new a.pointGeometry(d,n);return c&&v._rotate(p?g:-g),v}class Oo{constructor(n,c,p,g,v){this.transform=n.clone(),this.projection=n.projection.name,this.collisionIndex=new xd(this.transform,v),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Rn(p),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,c,p,g){const v=p.getBucket(c),T=p.latestFeatureIndex;if(!v||!T||c.id!==v.layerIds[0])return;const C=v.layers[0].layout,I=p.collisionBoxArray,L=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),B=p.tileSize/a.EXTENT,N=p.tileID.toUnwrapped();this.transform.setProjection(v.projection);const $=(Z=p.tileID,H=v.getProjection(),G=this.transform,H.name===this.projection?G.calculateProjMatrix(Z.toUnwrapped()):Vn(G,H,Z));var Z,H,G;const ie=C.get("text-pitch-alignment")==="map",X=C.get("text-rotation-alignment")==="map";c.compileFilter();const Q=c.dynamicFilter(),W=c.dynamicFilterNeedsFeature(),le=this.transform.calculatePixelsToTileUnitsMatrix(p),te=Kr($,p.tileID.canonical,ie,X,this.transform,v.getProjection(),le);let ne=null;if(ie){const De=Ds($,p.tileID.canonical,ie,X,this.transform,v.getProjection(),le);ne=a.multiply([],this.transform.labelPlaneMatrix,De)}let _e=null;Q&&p.latestFeatureIndex&&(_e={unwrappedTileID:N,dynamicFilter:Q,dynamicFilterNeedsFeature:W,featureIndex:p.latestFeatureIndex}),this.retainedQueryData[v.bucketInstanceId]=new El(v.bucketInstanceId,T,v.sourceLayerIndex,v.index,p.tileID);const Me={bucket:v,layout:C,posMatrix:$,textLabelPlaneMatrix:te,labelToScreenMatrix:ne,clippingData:_e,scale:L,textPixelRatio:B,holdingForFade:p.holdingForFade(),collisionBoxArray:I,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(v.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(v.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(g)for(const De of v.sortKeyRanges){const{sortKey:Ie,symbolInstanceStart:Je,symbolInstanceEnd:ae}=De;n.push({sortKey:Ie,symbolInstanceStart:Je,symbolInstanceEnd:ae,parameters:Me})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:Me})}attemptAnchorPlacement(n,c,p,g,v,T,C,I,L,B,N,$,Z,H,G,ie,X,Q){const W=[$.textOffset0,$.textOffset1],le=su(n,p,g,W,v),te=this.collisionIndex.placeCollisionBox(H,v,c,Tl(le.x,le.y,T,C,this.transform.angle),N,I,L,B.predicate);if((!ie||this.collisionIndex.placeCollisionBox(H,H.getSymbolInstanceIconSize(Q,this.transform.zoom,Z),ie,Tl(le.x,le.y,T,C,this.transform.angle),N,I,L,B.predicate).box.length!==0)&&te.box.length>0){let ne;return this.prevPlacement&&this.prevPlacement.variableOffsets[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID].text&&(ne=this.prevPlacement.variableOffsets[$.crossTileID].anchor),this.variableOffsets[$.crossTileID]={textOffset:W,width:p,height:g,anchor:n,textScale:v,prevAnchor:ne},this.markUsedJustification(H,n,$,G),H.allowVerticalPlacement&&(this.markUsedOrientation(H,G,$),this.placedOrientations[$.crossTileID]=G),{shift:le,placedGlyphBoxes:te}}}placeLayerBucketPart(n,c,p,g){const{bucket:v,layout:T,posMatrix:C,textLabelPlaneMatrix:I,labelToScreenMatrix:L,clippingData:B,textPixelRatio:N,holdingForFade:$,collisionBoxArray:Z,partiallyEvaluatedTextSize:H,partiallyEvaluatedIconSize:G,collisionGroup:ie}=n.parameters,X=T.get("text-optional"),Q=T.get("icon-optional"),W=T.get("text-allow-overlap"),le=T.get("icon-allow-overlap"),te=T.get("text-rotation-alignment")==="map",ne=T.get("text-pitch-alignment")==="map",_e=T.get("icon-text-fit")!=="none",Me=T.get("symbol-z-order")==="viewport-y";this.transform.setProjection(v.projection);let De=W&&(le||!v.hasIconData()||Q),Ie=le&&(W||!v.hasTextData()||X);!v.collisionArrays&&Z&&v.deserializeCollisionBoxes(Z),p&&g&&v.updateCollisionDebugBuffers(this.transform.zoom,Z);const Je=(ae,Ce,Re)=>{if(B){const Hi={zoom:this.transform.zoom,pitch:this.transform.pitch};let tn=null;if(B.dynamicFilterNeedsFeature){const Ci=this.retainedQueryData[v.bucketInstanceId];tn=B.featureIndex.loadFeature({featureIndex:ae.featureIndex,bucketIndex:Ci.bucketIndex,sourceLayerIndex:Ci.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,B.dynamicFilter)(Hi,tn,this.retainedQueryData[v.bucketInstanceId].tileID.canonical,new a.pointGeometry(ae.tileAnchorX,ae.tileAnchorY),this.transform.calculateDistanceTileData(B.unwrappedTileID)))return this.placements[ae.crossTileID]=new Ls(!1,!1,!1,!0),void(c[ae.crossTileID]=!0)}if(c[ae.crossTileID])return;if($)return void(this.placements[ae.crossTileID]=new Ls(!1,!1,!1));let ot=!1,Oe=!1,gt=!0,tt=!1,st=!1,at=null,nt={box:null,offscreen:null,occluded:null},_t={box:null,offscreen:null,occluded:null},Bt=null,$t=null,Ct=null,Ut=0,ki=0,Ui=0;Re.textFeatureIndex?Ut=Re.textFeatureIndex:ae.useRuntimeCollisionCircles&&(Ut=ae.featureIndex),Re.verticalTextFeatureIndex&&(ki=Re.verticalTextFeatureIndex);const Ki=Hi=>{Hi.tileID=this.retainedQueryData[v.bucketInstanceId].tileID,(this.transform.elevation||Hi.elevation)&&(Hi.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[v.bucketInstanceId].tileID,Hi.tileAnchorX,Hi.tileAnchorY):0)},zi=Re.textBox;if(zi){Ki(zi);const Hi=Ci=>{let vn=a.WritingMode.horizontal;if(v.allowVerticalPlacement&&!Ci&&this.prevPlacement){const $n=this.prevPlacement.placedOrientations[ae.crossTileID];$n&&(this.placedOrientations[ae.crossTileID]=$n,vn=$n,this.markUsedOrientation(v,vn,ae))}return vn},tn=(Ci,vn)=>{if(v.allowVerticalPlacement&&ae.numVerticalGlyphVertices>0&&Re.verticalTextBox){for(const $n of v.writingModes)if($n===a.WritingMode.vertical?(nt=vn(),_t=nt):nt=Ci(),nt&&nt.box&&nt.box.length)break}else nt=Ci()};if(T.get("text-variable-anchor")){let Ci=T.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ae.crossTileID]){const ji=this.prevPlacement.variableOffsets[ae.crossTileID];Ci.indexOf(ji.anchor)>0&&(Ci=Ci.filter(ln=>ln!==ji.anchor),Ci.unshift(ji.anchor))}const vn=(ji,ln,$s)=>{const po=v.getSymbolInstanceTextSize(H,ae,this.transform.zoom,Ce),Da=(ji.x2-ji.x1)*po+2*ji.padding,Gs=(ji.y2-ji.y1)*po+2*ji.padding,is=_e&&!le?ln:null;is&&Ki(is);let Gn={box:[],offscreen:!1,occluded:!1};const yr=W?2*Ci.length:Ci.length;for(let mo=0;mo<yr;++mo){const qs=this.attemptAnchorPlacement(Ci[mo%Ci.length],ji,Da,Gs,po,te,ne,N,C,ie,mo>=Ci.length,ae,Ce,v,$s,is,H,G);if(qs&&(Gn=qs.placedGlyphBoxes,Gn&&Gn.box&&Gn.box.length)){ot=!0,at=qs.shift;break}}return Gn};tn(()=>vn(zi,Re.iconBox,a.WritingMode.horizontal),()=>{const ji=Re.verticalTextBox;return ji&&Ki(ji),v.allowVerticalPlacement&&!(nt&&nt.box&&nt.box.length)&&ae.numVerticalGlyphVertices>0&&ji?vn(ji,Re.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),nt&&(ot=nt.box,gt=nt.offscreen,tt=nt.occluded);const $n=Hi(nt&&nt.box);if(!ot&&this.prevPlacement){const ji=this.prevPlacement.variableOffsets[ae.crossTileID];ji&&(this.variableOffsets[ae.crossTileID]=ji,this.markUsedJustification(v,ji.anchor,ae,$n))}}else{const Ci=(vn,$n)=>{const ji=v.getSymbolInstanceTextSize(H,ae,this.transform.zoom,Ce),ln=this.collisionIndex.placeCollisionBox(v,ji,vn,new a.pointGeometry(0,0),W,N,C,ie.predicate);return ln&&ln.box&&ln.box.length&&(this.markUsedOrientation(v,$n,ae),this.placedOrientations[ae.crossTileID]=$n),ln};tn(()=>Ci(zi,a.WritingMode.horizontal),()=>{const vn=Re.verticalTextBox;return v.allowVerticalPlacement&&ae.numVerticalGlyphVertices>0&&vn?(Ki(vn),Ci(vn,a.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Hi(nt&&nt.box&&nt.box.length)}}if(Bt=nt,ot=Bt&&Bt.box&&Bt.box.length>0,gt=Bt&&Bt.offscreen,tt=Bt&&Bt.occluded,ae.useRuntimeCollisionCircles){const Hi=v.text.placedSymbolArray.get(ae.centerJustifiedTextSymbolIndex>=0?ae.centerJustifiedTextSymbolIndex:ae.verticalPlacedTextSymbolIndex),tn=a.evaluateSizeForFeature(v.textSizeData,H,Hi),Ci=T.get("text-padding");$t=this.collisionIndex.placeCollisionCircles(v,W,Hi,v.lineVertexArray,v.glyphOffsetArray,tn,C,I,L,p,ne,ie.predicate,ae.collisionCircleDiameter*tn/a.ONE_EM,Ci,this.retainedQueryData[v.bucketInstanceId].tileID),ot=W||$t.circles.length>0&&!$t.collisionDetected,gt=gt&&$t.offscreen,tt=$t.occluded}if(Re.iconFeatureIndex&&(Ui=Re.iconFeatureIndex),Re.iconBox){const Hi=tn=>{Ki(tn);const Ci=_e&&at?Tl(at.x,at.y,te,ne,this.transform.angle):new a.pointGeometry(0,0),vn=v.getSymbolInstanceIconSize(G,this.transform.zoom,Ce);return this.collisionIndex.placeCollisionBox(v,vn,tn,Ci,le,N,C,ie.predicate)};_t&&_t.box&&_t.box.length&&Re.verticalIconBox?(Ct=Hi(Re.verticalIconBox),Oe=Ct.box.length>0):(Ct=Hi(Re.iconBox),Oe=Ct.box.length>0),gt=gt&&Ct.offscreen,st=Ct.occluded}const or=X||ae.numHorizontalGlyphVertices===0&&ae.numVerticalGlyphVertices===0,fo=Q||ae.numIconVertices===0;if(or||fo?fo?or||(Oe=Oe&&ot):ot=Oe&&ot:Oe=ot=Oe&&ot,ot&&Bt&&Bt.box&&this.collisionIndex.insertCollisionBox(Bt.box,T.get("text-ignore-placement"),v.bucketInstanceId,_t&&_t.box&&ki?ki:Ut,ie.ID),Oe&&Ct&&this.collisionIndex.insertCollisionBox(Ct.box,T.get("icon-ignore-placement"),v.bucketInstanceId,Ui,ie.ID),$t&&(ot&&this.collisionIndex.insertCollisionCircles($t.circles,T.get("text-ignore-placement"),v.bucketInstanceId,Ut,ie.ID),p)){const Hi=v.bucketInstanceId;let tn=this.collisionCircleArrays[Hi];tn===void 0&&(tn=this.collisionCircleArrays[Hi]=new bd);for(let Ci=0;Ci<$t.circles.length;Ci+=4)tn.circles.push($t.circles[Ci+0]),tn.circles.push($t.circles[Ci+1]),tn.circles.push($t.circles[Ci+2]),tn.circles.push($t.collisionDetected?1:0)}const Fo=v.projection.name!=="globe";De=De&&(Fo||!tt),Ie=Ie&&(Fo||!st),this.placements[ae.crossTileID]=new Ls(ot||De,Oe||Ie,gt||v.justReloaded),c[ae.crossTileID]=!0};if(Me){const ae=v.getSortedSymbolIndexes(this.transform.angle);for(let Ce=ae.length-1;Ce>=0;--Ce){const Re=ae[Ce];Je(v.symbolInstances.get(Re),Re,v.collisionArrays[Re])}}else for(let ae=n.symbolInstanceStart;ae<n.symbolInstanceEnd;ae++)Je(v.symbolInstances.get(ae),ae,v.collisionArrays[ae]);if(p&&v.bucketInstanceId in this.collisionCircleArrays){const ae=this.collisionCircleArrays[v.bucketInstanceId];a.invert(ae.invProjMatrix,C),ae.viewportMatrix=this.collisionIndex.getViewportMatrix()}v.justReloaded=!1}markUsedJustification(n,c,p,g){let v;v=g===a.WritingMode.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(c)];const T=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const C of T)C>=0&&(n.text.placedSymbolArray.get(C).crossTileID=v>=0&&C!==v?0:p.crossTileID)}markUsedOrientation(n,c,p){const g=c===a.WritingMode.horizontal||c===a.WritingMode.horizontalOnly?c:0,v=c===a.WritingMode.vertical?c:0,T=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const C of T)n.text.placedSymbolArray.get(C).placedOrientation=g;p.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=v)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let p=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const g=c?c.symbolFadeChange(n):1,v=c?c.opacities:{},T=c?c.variableOffsets:{},C=c?c.placedOrientations:{};for(const I in this.placements){const L=this.placements[I],B=v[I];B?(this.opacities[I]=new an(B,g,L.text,L.icon,null,L.clipped),p=p||L.text!==B.text.placed||L.icon!==B.icon.placed):(this.opacities[I]=new an(null,g,L.text,L.icon,L.skipFade,L.clipped),p=p||L.text||L.icon)}for(const I in v){const L=v[I];if(!this.opacities[I]){const B=new an(L,g,!1,!1);B.isHidden()||(this.opacities[I]=B,p=p||L.text.placed||L.icon.placed)}}for(const I in T)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=T[I]);for(const I in C)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=C[I]);p?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:n)}updateLayerOpacities(n,c){const p={};for(const g of c){const v=g.getBucket(n);v&&g.latestFeatureIndex&&n.id===v.layerIds[0]&&this.updateBucketOpacities(v,p,g.collisionBoxArray)}}updateBucketOpacities(n,c,p){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const g=n.layers[0].layout,v=!!n.layers[0].dynamicFilter(),T=new an(null,0,!1,!1,!0),C=g.get("text-allow-overlap"),I=g.get("icon-allow-overlap"),L=g.get("text-variable-anchor"),B=g.get("text-rotation-alignment")==="map",N=g.get("text-pitch-alignment")==="map",$=g.get("icon-text-fit")!=="none",Z=new an(null,0,C&&(I||!n.hasIconData()||g.get("icon-optional")),I&&(C||!n.hasTextData()||g.get("text-optional")),!0);!n.collisionArrays&&p&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(p);const H=(ie,X,Q)=>{for(let W=0;W<X/4;W++)ie.opacityVertexArray.emplaceBack(Q)};let G=0;for(let ie=0;ie<n.symbolInstances.length;ie++){const X=n.symbolInstances.get(ie),{numHorizontalGlyphVertices:Q,numVerticalGlyphVertices:W,crossTileID:le}=X;let te=this.opacities[le];c[le]?te=T:te||(te=Z,this.opacities[le]=te),c[le]=!0;const ne=Q>0||W>0,_e=X.numIconVertices>0,Me=this.placedOrientations[X.crossTileID],De=Me===a.WritingMode.vertical,Ie=Me===a.WritingMode.horizontal||Me===a.WritingMode.horizontalOnly;if(!ne&&!_e||te.isHidden()||G++,ne){const Je=Ro(te.text);H(n.text,Q,De?zs:Je),H(n.text,W,Ie?zs:Je);const ae=te.text.isHidden();[X.rightJustifiedTextSymbolIndex,X.centerJustifiedTextSymbolIndex,X.leftJustifiedTextSymbolIndex].forEach(ot=>{ot>=0&&(n.text.placedSymbolArray.get(ot).hidden=ae||De?1:0)}),X.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(X.verticalPlacedTextSymbolIndex).hidden=ae||Ie?1:0);const Ce=this.variableOffsets[X.crossTileID];Ce&&this.markUsedJustification(n,Ce.anchor,X,Me);const Re=this.placedOrientations[X.crossTileID];Re&&(this.markUsedJustification(n,"left",X,Re),this.markUsedOrientation(n,Re,X))}if(_e){const Je=Ro(te.icon);X.placedIconSymbolIndex>=0&&(H(n.icon,X.numIconVertices,De?zs:Je),n.icon.placedSymbolArray.get(X.placedIconSymbolIndex).hidden=te.icon.isHidden()),X.verticalPlacedIconSymbolIndex>=0&&(H(n.icon,X.numVerticalIconVertices,Ie?zs:Je),n.icon.placedSymbolArray.get(X.verticalPlacedIconSymbolIndex).hidden=te.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const Je=n.collisionArrays[ie];if(Je){let ae=new a.pointGeometry(0,0),Ce=!0;if(Je.textBox||Je.verticalTextBox){if(L){const ot=this.variableOffsets[le];ot?(ae=su(ot.anchor,ot.width,ot.height,ot.textOffset,ot.textScale),B&&ae._rotate(N?this.transform.angle:-this.transform.angle)):Ce=!1}v&&(Ce=!te.clipped),Je.textBox&&es(n.textCollisionBox.collisionVertexArray,te.text.placed,!Ce||De,ae.x,ae.y),Je.verticalTextBox&&es(n.textCollisionBox.collisionVertexArray,te.text.placed,!Ce||Ie,ae.x,ae.y)}const Re=Ce&&Boolean(!Ie&&Je.verticalIconBox);Je.iconBox&&es(n.iconCollisionBox.collisionVertexArray,te.icon.placed,Re,$?ae.x:0,$?ae.y:0),Je.verticalIconBox&&es(n.iconCollisionBox.collisionVertexArray,te.icon.placed,!Re,$?ae.x:0,$?ae.y:0)}}}if(n.fullyClipped=G===0,n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){const ie=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=ie.invProjMatrix,n.placementViewportMatrix=ie.viewportMatrix,n.collisionCircleArray=ie.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,c){const p=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*p>n}setStale(){this.stale=!0}}function es(d,n,c,p,g){d.emplaceBack(n?1:0,c?1:0,p||0,g||0),d.emplaceBack(n?1:0,c?1:0,p||0,g||0),d.emplaceBack(n?1:0,c?1:0,p||0,g||0),d.emplaceBack(n?1:0,c?1:0,p||0,g||0)}const au=Math.pow(2,25),Dy=Math.pow(2,24),wd=Math.pow(2,17),ya=Math.pow(2,16),Ly=Math.pow(2,9),Zp=Math.pow(2,8),va=Math.pow(2,1);function Ro(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;const n=d.placed?1:0,c=Math.floor(127*d.opacity);return c*au+n*Dy+c*wd+n*ya+c*Ly+n*Zp+c*va+n}const zs=0;class ts{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,c,p,g,v){const T=this._bucketParts;for(;this._currentTileIndex<n.length;)if(c.getBucketParts(T,g,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort((C,I)=>C.sortKey-I.sortKey));this._currentPartIndex<T.length;){const C=T[this._currentPartIndex];if(c.placeLayerBucketPart(C,this._seenCrossTileIDs,p,C.symbolInstanceStart===0),this._currentPartIndex++,v())return!0}return!1}}class Ed{constructor(n,c,p,g,v,T,C,I){this.placement=new Oo(n,v,T,C,I),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(n,c,p){const g=a.exported.now(),v=()=>{const T=a.exported.now()-g;return!this._forceFullPlacement&&T>2};for(;this._currentPlacementIndex>=0;){const T=c[n[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(T.type==="symbol"&&(!T.minzoom||T.minzoom<=C)&&(!T.maxzoom||T.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new ts(T)),this._inProgressLayer.continuePlacement(p[T.source],this.placement,this._showCollisionBoxes,T,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const lu=512/a.EXTENT/2;class zy{constructor(n,c,p){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=p;for(let g=0;g<c.length;g++){const v=c.get(g),T=v.key;this.indexedSymbolInstances[T]||(this.indexedSymbolInstances[T]=[]),this.indexedSymbolInstances[T].push({crossTileID:v.crossTileID,coord:this.getScaledCoordinates(v,n)})}}getScaledCoordinates(n,c){const p=lu/Math.pow(2,c.canonical.z-this.tileID.canonical.z);return{x:Math.floor((c.canonical.x*a.EXTENT+n.tileAnchorX)*p),y:Math.floor((c.canonical.y*a.EXTENT+n.tileAnchorY)*p)}}findMatches(n,c,p){const g=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let v=0;v<n.length;v++){const T=n.get(v);if(T.crossTileID)continue;const C=this.indexedSymbolInstances[T.key];if(!C)continue;const I=this.getScaledCoordinates(T,c);for(const L of C)if(Math.abs(L.coord.x-I.x)<=g&&Math.abs(L.coord.y-I.y)<=g&&!p[L.crossTileID]){p[L.crossTileID]=!0,T.crossTileID=L.crossTileID;break}}}}class Oy{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Td{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const c=Math.round((n-this.lng)/360);if(c!==0)for(const p in this.indexes){const g=this.indexes[p],v={};for(const T in g){const C=g[T];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+c),v[C.tileID.key]=C}this.indexes[p]=v}this.lng=n}addBucket(n,c,p){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let v=0;v<c.symbolInstances.length;v++)c.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const g=this.usedCrossTileIDs[n.overscaledZ];for(const v in this.indexes){const T=this.indexes[v];if(Number(v)>n.overscaledZ)for(const C in T){const I=T[C];I.tileID.isChildOf(n)&&I.findMatches(c.symbolInstances,n,g)}else{const C=T[n.scaledTo(Number(v)).key];C&&C.findMatches(c.symbolInstances,n,g)}}for(let v=0;v<c.symbolInstances.length;v++){const T=c.symbolInstances.get(v);T.crossTileID||(T.crossTileID=p.generate(),g[T.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new zy(n,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(n,c){for(const p in c.indexedSymbolInstances)for(const g of c.indexedSymbolInstances[p])delete this.usedCrossTileIDs[n][g.crossTileID]}removeStaleBuckets(n){let c=!1;for(const p in this.indexes){const g=this.indexes[p];for(const v in g)n[g[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,g[v]),delete g[v],c=!0)}return c}}class Wp{constructor(){this.layerIndexes={},this.crossTileIDs=new Oy,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,c,p,g){let v=this.layerIndexes[n.id];v===void 0&&(v=this.layerIndexes[n.id]=new Td);let T=!1;const C={};g.name!=="globe"&&v.handleWrapJump(p);for(const I of c){const L=I.getBucket(n);L&&n.id===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(I.tileID,L,this.crossTileIDs)&&(T=!0),C[L.bucketInstanceId]=!0)}return v.removeStaleBuckets(C)&&(T=!0),T}pruneUnusedLayers(n){const c={};n.forEach(p=>{c[p]=!0});for(const p in this.layerIndexes)c[p]||delete this.layerIndexes[p]}}const Cl=(d,n)=>a.emitValidationErrors(d,n&&n.filter(c=>c.identifier!=="source.canvas")),Ry=a.pick(Ee,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Hp=a.pick(Ee,["setCenter","setZoom","setBearing","setPitch"]),By={version:8,layers:[],sources:{}},Cd={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Yr extends a.Evented{constructor(n,c={}){super(),this.map=n,this.dispatcher=new Si(Ei(),this),this.imageManager=new ai,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(n._requestManager,c.localFontFamily?a.LocalGlyphMode.all:c.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.lineAtlas=new a.LineAtlas(256,512),this.crossTileSymbolIndex=new Wp,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const p=this;this._rtlTextPluginCallback=Yr.registerForPluginStateChange(g=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:g.pluginStatus,pluginURL:g.pluginURL},(v,T)=>{if(a.triggerPluginCompletionEvent(v),T&&T.every(C=>C))for(const C in p._sourceCaches){const I=p._sourceCaches[C],L=I.getSource().type;L!=="vector"&&L!=="geojson"||I.reload()}})}),this.on("data",g=>{if(g.dataType!=="source"||g.sourceDataType!=="metadata")return;const v=this.getSource(g.sourceId);if(v&&v.vectorLayerIds)for(const T in this._layers){const C=this._layers[T];C.source===v.id&&this._validateLayer(C)}})}loadURL(n,c={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const p=typeof c.validate=="boolean"?c.validate:!a.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,c.accessToken);const g=this.map._requestManager.transformRequest(n,a.ResourceType.Style);this._request=a.getJSON(g,(v,T)=>{this._request=null,v?this.fire(new a.ErrorEvent(v)):T&&this._load(T,p)})}loadJSON(n,c={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(n,c.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(By,!1)}_updateLayerCount(n,c){const p=c?1:-1;n.is3D()&&(this._num3DLayers+=p),n.type==="circle"&&(this._numCircleLayers+=p),n.type==="symbol"&&(this._numSymbolLayers+=p)}_load(n,c){if(c&&Cl(this,a.validateStyle(n)))return;this._loaded=!0,this.stylesheet=a.clone$1(n),this._updateMapProjection();for(const g in n.sources)this.addSource(g,n.sources[g],{validate:!1});this._changed=!1,n.sprite?this._loadSprite(n.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(n.glyphs);const p=Mi(this.stylesheet.layers);this._order=p.map(g=>g.id),this._layers={},this._serializedLayers={};for(let g of p)g=a.createStyleLayer(g),g.setEventedParent(this,{layer:{id:g.id}}),this._layers[g.id]=g,this._serializedLayers[g.id]=g.serialize(),this._updateLayerCount(g,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new qi(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(n){n?this.stylesheet.projection=n:delete this.stylesheet.projection,this.map._explicitProjection||this.map._updateProjection()}_updateMapProjection(){this.map._explicitProjection?this.applyProjectionUpdate():this.map._updateProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_loadSprite(n){this._spriteRequest=function(c,p,g){let v,T,C;const I=a.exported.devicePixelRatio>1?"@2x":"";let L=a.getJSON(p.transformRequest(p.normalizeSpriteURL(c,I,".json"),a.ResourceType.SpriteJSON),($,Z)=>{L=null,C||(C=$,v=Z,N())}),B=a.getImage(p.transformRequest(p.normalizeSpriteURL(c,I,".png"),a.ResourceType.SpriteImage),($,Z)=>{B=null,C||(C=$,T=Z,N())});function N(){if(C)g(C);else if(v&&T){const $=a.exported.getImageData(T),Z={};for(const H in v){const{width:G,height:ie,x:X,y:Q,sdf:W,pixelRatio:le,stretchX:te,stretchY:ne,content:_e}=v[H],Me=new a.RGBAImage({width:G,height:ie});a.RGBAImage.copy($,Me,{x:X,y:Q},{x:0,y:0},{width:G,height:ie}),Z[H]={data:Me,pixelRatio:le,sdf:W,stretchX:te,stretchY:ne,content:_e}}g(null,Z)}}return{cancel(){L&&(L.cancel(),L=null),B&&(B.cancel(),B=null)}}}(n,this.map._requestManager,(c,p)=>{if(this._spriteRequest=null,c)this.fire(new a.ErrorEvent(c));else if(p)for(const g in p)this.imageManager.addImage(g,p[g]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(n){const c=this.getSource(n.source);if(!c)return;const p=n.sourceLayer;p&&(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(p)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${c.id}" as specified by style layer "${n.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this._sourceCaches)if(!this._sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(n){const c=[];for(const p of n){const g=this._layers[p];g.type!=="custom"&&c.push(g.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const n in this._sourceCaches)if(this._sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(n){return!!this.terrain&&Cd[n.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(n){if(!this._loaded)return;const c=this._changed;if(this._changed){const g=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(g.length||v.length)&&this._updateWorkerLayers(g,v);for(const T in this._updatedSources){const C=this._updatedSources[T];C==="reload"?this._reloadSource(T):C==="clear"&&this._clearSource(T)}this._updateTilesForChangedImages();for(const T in this._updatedPaintProps)this._layers[T].updateTransitions(n);this.light.updateTransitions(n),this.fog&&this.fog.updateTransitions(n),this._resetUpdates()}const p={};for(const g in this._sourceCaches){const v=this._sourceCaches[g];p[g]=v.used,v.used=!1}for(const g of this._order){const v=this._layers[g];if(v.recalculate(n,this._availableImages),!v.isHidden(n.zoom)){const C=this._getLayerSourceCache(v);C&&(C.used=!0)}const T=this.map.painter;if(T){const C=v.getProgramIds();if(!C)continue;const I=v.getProgramConfiguration(n.zoom);for(const L of C)T.useProgram(L,I)}}for(const g in p){const v=this._sourceCaches[g];p[g]!==v.used&&v.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:v.getSource().id}))}this.light.recalculate(n),this.terrain&&this.terrain.recalculate(n),this.fog&&this.fog.recalculate(n),this.z=n.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateWorkerLayers(n,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(n){if(this._checkLoaded(),Cl(this,a.validateStyle(n)))return!1;(n=a.clone$1(n)).layers=Mi(n.layers);const c=function(g,v){if(!g)return[{command:Ee.setStyle,args:[v]}];let T=[];try{if(!S(g.version,v.version))return[{command:Ee.setStyle,args:[v]}];S(g.center,v.center)||T.push({command:Ee.setCenter,args:[v.center]}),S(g.zoom,v.zoom)||T.push({command:Ee.setZoom,args:[v.zoom]}),S(g.bearing,v.bearing)||T.push({command:Ee.setBearing,args:[v.bearing]}),S(g.pitch,v.pitch)||T.push({command:Ee.setPitch,args:[v.pitch]}),S(g.sprite,v.sprite)||T.push({command:Ee.setSprite,args:[v.sprite]}),S(g.glyphs,v.glyphs)||T.push({command:Ee.setGlyphs,args:[v.glyphs]}),S(g.transition,v.transition)||T.push({command:Ee.setTransition,args:[v.transition]}),S(g.light,v.light)||T.push({command:Ee.setLight,args:[v.light]}),S(g.fog,v.fog)||T.push({command:Ee.setFog,args:[v.fog]}),S(g.projection,v.projection)||T.push({command:Ee.setProjection,args:[v.projection]});const C={},I=[];(function(N,$,Z,H){let G;for(G in $=$||{},N=N||{})N.hasOwnProperty(G)&&($.hasOwnProperty(G)||Qi(G,Z,H));for(G in $)$.hasOwnProperty(G)&&(N.hasOwnProperty(G)?S(N[G],$[G])||(N[G].type==="geojson"&&$[G].type==="geojson"&&Py(N,$,G)?Z.push({command:Ee.setGeoJSONSourceData,args:[G,$[G].data]}):Ar(G,$,Z,H)):_r(G,$,Z))})(g.sources,v.sources,I,C);const L=[];g.layers&&g.layers.forEach(N=>{N.source&&C[N.source]?T.push({command:Ee.removeLayer,args:[N.id]}):L.push(N)});let B=g.terrain;B&&C[B.source]&&(T.push({command:Ee.setTerrain,args:[void 0]}),B=void 0),T=T.concat(I),S(B,v.terrain)||T.push({command:Ee.setTerrain,args:[v.terrain]}),function(N,$,Z){$=$||[];const H=(N=N||[]).map(nu),G=$.map(nu),ie=N.reduce($p,{}),X=$.reduce($p,{}),Q=H.slice(),W=Object.create(null);let le,te,ne,_e,Me,De,Ie;for(le=0,te=0;le<H.length;le++)ne=H[le],X.hasOwnProperty(ne)?te++:(Z.push({command:Ee.removeLayer,args:[ne]}),Q.splice(Q.indexOf(ne,te),1));for(le=0,te=0;le<G.length;le++)ne=G[G.length-1-le],Q[Q.length-1-le]!==ne&&(ie.hasOwnProperty(ne)?(Z.push({command:Ee.removeLayer,args:[ne]}),Q.splice(Q.lastIndexOf(ne,Q.length-te),1)):te++,De=Q[Q.length-le],Z.push({command:Ee.addLayer,args:[X[ne],De]}),Q.splice(Q.length-le,0,ne),W[ne]=!0);for(le=0;le<G.length;le++)if(ne=G[le],_e=ie[ne],Me=X[ne],!W[ne]&&!S(_e,Me))if(S(_e.source,Me.source)&&S(_e["source-layer"],Me["source-layer"])&&S(_e.type,Me.type)){for(Ie in gr(_e.layout,Me.layout,Z,ne,null,Ee.setLayoutProperty),gr(_e.paint,Me.paint,Z,ne,null,Ee.setPaintProperty),S(_e.filter,Me.filter)||Z.push({command:Ee.setFilter,args:[ne,Me.filter]}),S(_e.minzoom,Me.minzoom)&&S(_e.maxzoom,Me.maxzoom)||Z.push({command:Ee.setLayerZoomRange,args:[ne,Me.minzoom,Me.maxzoom]}),_e)_e.hasOwnProperty(Ie)&&Ie!=="layout"&&Ie!=="paint"&&Ie!=="filter"&&Ie!=="metadata"&&Ie!=="minzoom"&&Ie!=="maxzoom"&&(Ie.indexOf("paint.")===0?gr(_e[Ie],Me[Ie],Z,ne,Ie.slice(6),Ee.setPaintProperty):S(_e[Ie],Me[Ie])||Z.push({command:Ee.setLayerProperty,args:[ne,Ie,Me[Ie]]}));for(Ie in Me)Me.hasOwnProperty(Ie)&&!_e.hasOwnProperty(Ie)&&Ie!=="layout"&&Ie!=="paint"&&Ie!=="filter"&&Ie!=="metadata"&&Ie!=="minzoom"&&Ie!=="maxzoom"&&(Ie.indexOf("paint.")===0?gr(_e[Ie],Me[Ie],Z,ne,Ie.slice(6),Ee.setPaintProperty):S(_e[Ie],Me[Ie])||Z.push({command:Ee.setLayerProperty,args:[ne,Ie,Me[Ie]]}))}else Z.push({command:Ee.removeLayer,args:[ne]}),De=Q[Q.lastIndexOf(ne)+1],Z.push({command:Ee.addLayer,args:[Me,De]})}(L,v.layers,T)}catch(C){console.warn("Unable to compute style diff:",C),T=[{command:Ee.setStyle,args:[v]}]}return T}(this.serialize(),n).filter(g=>!(g.command in Hp));if(c.length===0)return!1;const p=c.filter(g=>!(g.command in Ry));if(p.length>0)throw new Error(`Unimplemented: ${p.map(g=>g.command).join(", ")}.`);return c.forEach(g=>{g.command!=="setTransition"&&this[g.command].apply(this,g.args)}),this.stylesheet=n,this._updateMapProjection(),!0}addImage(n,c){return this.getImage(n)?this.fire(new a.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(n,c),this._afterImageUpdated(n),this)}updateImage(n,c){this.imageManager.updateImage(n,c)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){return this.getImage(n)?(this.imageManager.removeImage(n),this._afterImageUpdated(n),this):this.fire(new a.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(n,c,p={}){if(this._checkLoaded(),this.getSource(n)!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(a.validateSource,`sources.${n}`,c,null,p))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const g=Se(n,c,this.dispatcher,this);g.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(n),source:g.serialize(),sourceId:n}));const v=T=>{const C=(T?"symbol:":"other:")+n,I=this._sourceCaches[C]=new a.SourceCache(C,g,T);(T?this._symbolSourceCaches:this._otherSourceCaches)[n]=I,I.style=this,I.onAdd(this.map)};v(!1),c.type!=="vector"&&c.type!=="geojson"||v(!0),g.onAdd&&g.onAdd(this.map),this._changed=!0}removeSource(n){this._checkLoaded();const c=this.getSource(n);if(!c)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===n)return this.fire(new a.ErrorEvent(new Error(`Source "${n}" cannot be removed while layer "${g}" is using it.`)));if(this.terrain&&this.terrain.get().source===n)return this.fire(new a.ErrorEvent(new Error(`Source "${n}" cannot be removed while terrain is using it.`)));const p=this._getSourceCaches(n);for(const g of p)delete this._sourceCaches[g.id],delete this._updatedSources[g.id],g.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:g.getSource().id})),g.setEventedParent(null),g.clearTiles();return delete this._otherSourceCaches[n],delete this._symbolSourceCaches[n],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(n,c){this._checkLoaded(),this.getSource(n).setData(c),this._changed=!0}getSource(n){const c=this._getSourceCache(n);return c&&c.getSource()}addLayer(n,c,p={}){this._checkLoaded();const g=n.id;if(this.getLayer(g))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${g}" already exists on this map`)));let v;if(n.type==="custom"){if(Cl(this,a.validateCustomStyleLayer(n)))return;v=a.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(g,n.source),n=a.clone$1(n),n=a.extend(n,{source:g})),this._validate(a.validateLayer,`layers.${g}`,n,{arrayIndex:-1},p))return;v=a.createStyleLayer(n),this._validateLayer(v),v.setEventedParent(this,{layer:{id:g}}),this._serializedLayers[v.id]=v.serialize(),this._updateLayerCount(v,!0)}const T=c?this._order.indexOf(c):this._order.length;if(c&&T===-1)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(T,0,g),this._layerOrderChanged=!0,this._layers[g]=v;const C=this._getLayerSourceCache(v);if(this._removedLayers[g]&&v.source&&C&&v.type!=="custom"){const I=this._removedLayers[g];delete this._removedLayers[g],I.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",C.pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(n,c){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===c)return;const p=this._order.indexOf(n);this._order.splice(p,1);const g=c?this._order.indexOf(c):this._order.length;c&&g===-1?this.fire(new a.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(g,0,n),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(n){this._checkLoaded();const c=this._layers[n];if(!c)return void this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const p=this._order.indexOf(n);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=c,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(n){return this._layers[n]}hasLayer(n){return n in this._layers}hasLayerType(n){for(const c in this._layers)if(this._layers[c].type===n)return!0;return!1}setLayerZoomRange(n,c,p){this._checkLoaded();const g=this.getLayer(n);g?g.minzoom===c&&g.maxzoom===p||(c!=null&&(g.minzoom=c),p!=null&&(g.maxzoom=p),this._updateLayer(g)):this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(n,c,p={}){this._checkLoaded();const g=this.getLayer(n);if(g){if(!S(g.filter,c))return c==null?(g.filter=void 0,void this._updateLayer(g)):void(this._validate(a.validateFilter,`layers.${g.id}.filter`,c,{layerType:g.type},p)||(g.filter=a.clone$1(c),this._updateLayer(g)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be filtered.`)))}getFilter(n){const c=this.getLayer(n);return c&&a.clone$1(c.filter)}setLayoutProperty(n,c,p,g={}){this._checkLoaded();const v=this.getLayer(n);v?S(v.getLayoutProperty(c),p)||(v.setLayoutProperty(c,p,g),this._updateLayer(v)):this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(n,c){const p=this.getLayer(n);if(p)return p.getLayoutProperty(c);this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style.`)))}setPaintProperty(n,c,p,g={}){this._checkLoaded();const v=this.getLayer(n);v?S(v.getPaintProperty(c),p)||(v.setPaintProperty(c,p,g)&&this._updateLayer(v),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(n,c){const p=this.getLayer(n);return p&&p.getPaintProperty(c)}setFeatureState(n,c){this._checkLoaded();const p=n.source,g=n.sourceLayer,v=this.getSource(p);if(!v)return void this.fire(new a.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const T=v.type;if(T==="geojson"&&g)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(T==="vector"&&!g)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));n.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const C=this._getSourceCaches(p);for(const I of C)I.setFeatureState(g,n.id,c)}removeFeatureState(n,c){this._checkLoaded();const p=n.source,g=this.getSource(p);if(!g)return void this.fire(new a.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const v=g.type,T=v==="vector"?n.sourceLayer:void 0;if(v==="vector"&&!T)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&typeof n.id!="string"&&typeof n.id!="number")return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const C=this._getSourceCaches(p);for(const I of C)I.removeFeatureState(T,n.id,c)}getFeatureState(n){this._checkLoaded();const c=n.source,p=n.sourceLayer,g=this.getSource(c);if(g){if(g.type!=="vector"||p)return n.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(p,n.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const n={};for(const c in this._sourceCaches){const p=this._sourceCaches[c].getSource();n[p.id]||(n[p.id]=p.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:n,layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0;const c=this._getLayerSourceCache(n);n.source&&!this._updatedSources[n.source]&&c&&c.getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",c.pause()),this._changed=!0,n.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(n){const c=T=>this._layers[T].type==="fill-extrusion",p={},g=[];for(let T=this._order.length-1;T>=0;T--){const C=this._order[T];if(c(C)){p[C]=T;for(const I of n){const L=I[C];if(L)for(const B of L)g.push(B)}}}g.sort((T,C)=>C.intersectionZ-T.intersectionZ);const v=[];for(let T=this._order.length-1;T>=0;T--){const C=this._order[T];if(c(C))for(let I=g.length-1;I>=0;I--){const L=g[I].feature;if(p[L.layer.id]<T)break;v.push(L),g.pop()}else for(const I of n){const L=I[C];if(L)for(const B of L)v.push(B.feature)}}return v}queryRenderedFeatures(n,c,p){c&&c.filter&&this._validate(a.validateFilter,"queryRenderedFeatures.filter",c.filter,null,c);const g={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const I of c.layers){const L=this._layers[I];if(!L)return this.fire(new a.ErrorEvent(new Error(`The layer '${I}' does not exist in the map's style and cannot be queried for features.`))),[];g[L.source]=!0}}const v=[];c.availableImages=this._availableImages;const T=c&&c.layers?c.layers.some(I=>{const L=this.getLayer(I);return L&&L.is3D()}):this.has3DLayers(),C=Ne.createFromScreenPoints(n,p);for(const I in this._sourceCaches){const L=this._sourceCaches[I].getSource().id;c.layers&&!g[L]||v.push(dt(this._sourceCaches[I],this._layers,this._serializedLayers,C,c,p,T,!!this.map._showQueryGeometry))}return this.placement&&v.push(function(I,L,B,N,$,Z,H){const G={},ie=Z.queryRenderedSymbols(N),X=[];for(const Q of Object.keys(ie).map(Number))X.push(H[Q]);X.sort(kt);for(const Q of X){const W=Q.featureIndex.lookupSymbolFeatures(ie[Q.bucketInstanceId],L,Q.bucketIndex,Q.sourceLayerIndex,$.filter,$.layers,$.availableImages,I);for(const le in W){const te=G[le]=G[le]||[],ne=W[le];ne.sort((_e,Me)=>{const De=Q.featureSortOrder;if(De){const Ie=De.indexOf(_e.featureIndex);return De.indexOf(Me.featureIndex)-Ie}return Me.featureIndex-_e.featureIndex});for(const _e of ne)te.push(_e)}}for(const Q in G)G[Q].forEach(W=>{const le=W.feature,te=B(I[Q]).getFeatureState(le.layer["source-layer"],le.id);le.source=le.layer.source,le.layer["source-layer"]&&(le.sourceLayer=le.layer["source-layer"]),le.state=te});return G}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),C.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(n,c){c&&c.filter&&this._validate(a.validateFilter,"querySourceFeatures.filter",c.filter,null,c);const p=this._getSourceCaches(n);let g=[];for(const v of p)g=g.concat(We(v,c));return g}addSourceType(n,c,p){return Yr.getSourceType(n)?p(new Error(`A source type called "${n}" already exists.`)):(Yr.setSourceType(n,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:c.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(n,c={}){this._checkLoaded();const p=this.light.getLight();let g=!1;for(const T in n)if(!S(n[T],p[T])){g=!0;break}if(!g)return;const v=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(n,c),this.light.updateTransitions(v)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(n,c=1){if(this._checkLoaded(),!n)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(c===1){if(typeof n.source=="object"){const p="terrain-dem-src";this.addSource(p,n.source),n=a.clone$1(n),n=a.extend(n,{source:p})}if(this._validate(a.validateTerrain,"terrain",n))return}if(!this.terrain||this.terrain&&c!==this.terrain.drapeRenderMode)this._createTerrain(n,c);else{const p=this.terrain,g=p.get();for(const v of Object.keys(a.spec.terrain))!n.hasOwnProperty(v)&&a.spec.terrain[v].default&&(n[v]=a.spec.terrain[v].default);for(const v in n)if(!S(n[v],g[v])){p.set(n),this.stylesheet.terrain=n;const T=this._setTransitionParameters({duration:0});p.updateTransitions(T);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(n){const c=this.fog=new oi(n,this.map.transform);this.stylesheet.fog=n;const p=this._setTransitionParameters({duration:0});c.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const n of this.map._markers)n._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(n){if(this._checkLoaded(),!n)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,p=c.get();Object.keys(n).length===0&&c.set(n);for(const g in n)if(!S(n[g],p[g])){c.set(n),this.stylesheet.fog=n;const v=this._setTransitionParameters({duration:0});c.updateTransitions(v);break}}else this._createFog(n);this._markersNeedUpdate=!0}_setTransitionParameters(n){return{now:a.exported.now(),transition:a.extend(n,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const n=this._order.filter(p=>this.isLayerDraped(this._layers[p])),c=this._order.filter(p=>!this.isLayerDraped(this._layers[p]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...n),this._drapedFirstOrder.push(...c)}_createTerrain(n,c){const p=this.terrain=new ri(n,c);this.stylesheet.terrain=n,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const g=this._setTransitionParameters({duration:0});p.updateTransitions(g)}_force3DLayerUpdate(){for(const n in this._layers){const c=this._layers[n];c.type==="fill-extrusion"&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const n in this._layers){const c=this._layers[n];c.type==="symbol"&&this._updateLayer(c)}}_validate(n,c,p,g,v={}){return(!v||v.validate!==!1)&&Cl(this,n.call(a.validateStyle,a.extend({key:c,style:this.serialize(),value:p,styleSpec:a.spec},g)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this._sourceCaches)this._sourceCaches[n].clearTiles(),this._sourceCaches[n].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(n){const c=this._getSourceCaches(n);for(const p of c)p.clearTiles()}_reloadSource(n){const c=this._getSourceCaches(n);for(const p of c)p.resume(),p.reload()}_updateSources(n){for(const c in this._sourceCaches)this._sourceCaches[c].update(n)}_generateCollisionBoxes(){for(const n in this._sourceCaches){const c=this._sourceCaches[n];c.resume(),c.reload()}}_updatePlacement(n,c,p,g,v=!1){let T=!1,C=!1;const I={};for(const L of this._order){const B=this._layers[L];if(B.type!=="symbol")continue;if(!I[B.source]){const $=this._getLayerSourceCache(B);if(!$)continue;I[B.source]=$.getRenderableIds(!0).map(Z=>$.getTileByID(Z)).sort((Z,H)=>H.tileID.overscaledZ-Z.tileID.overscaledZ||(Z.tileID.isLessThan(H.tileID)?-1:1))}const N=this.crossTileSymbolIndex.addLayer(B,I[B.source],n.center.lng,n.projection);T=T||N}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),v=v||this._layerOrderChanged||p===0,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(v||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),n.zoom))&&(this.pauseablePlacement=new Ed(n,this._order,v,c,p,g,this.placement,this.fog&&n.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),C=!0),T&&this.pauseablePlacement.placement.setStale()),C||T)for(const L of this._order){const B=this._layers[L];B.type==="symbol"&&this.placement.updateLayerOpacities(B,I[B.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const n in this._sourceCaches)this._sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,c,p){this.imageManager.getImages(c.icons,p),this._updateTilesForChangedImages();const g=v=>{v&&v.setDependencies(c.tileID.key,c.type,c.icons)};g(this._otherSourceCaches[c.source]),g(this._symbolSourceCaches[c.source])}getGlyphs(n,c,p){this.glyphManager.getGlyphs(c.stacks,p)}getResource(n,c,p){return a.makeRequest(c,p)}_getSourceCache(n){return this._otherSourceCaches[n]}_getLayerSourceCache(n){return n.type==="symbol"?this._symbolSourceCaches[n.source]:this._otherSourceCaches[n.source]}_getSourceCaches(n){const c=[];return this._otherSourceCaches[n]&&c.push(this._otherSourceCaches[n]),this._symbolSourceCaches[n]&&c.push(this._symbolSourceCaches[n]),c}_isSourceCacheLoaded(n){const c=this._getSourceCaches(n);return c.length===0?(this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${n}'`))),!1):c.every(p=>p.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Yr.getSourceType=function(d){return ve[d]},Yr.setSourceType=function(d,n){ve[d]=n},Yr.registerForPluginStateChange=a.registerForPluginStateChange;var Sd=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Ad="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let Sl={},Bo={};Sl=Ti("",`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
float unpack_depth(vec4 rgba_depth)
{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,!0),Bo=Ti(`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,!0);const cu=Ti(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef TERRAIN
highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#endif`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),xa=Sd,ba=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var uu={background:Ti(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Ti(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Ti(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);
#else 
mat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Ti("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ti(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
vec3 pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Ti(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ti("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Ti("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Ti("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Ti(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Ti(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Ti(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Ti(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Ti(`varying vec4 v_color;void main() {vec4 color=v_color;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
vec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(pos.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Ti(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Ti(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ti(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Ti(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
highp vec4 out_color=texture2D(u_gradient_image,v_uv.xy);
#else
vec4 out_color=color;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Ti(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Ti(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Ti(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
vec4 offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Ti(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
vec4 offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Ti(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Ti(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
}`),terrainDepth:Ti(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Ti(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ad),skyboxGradient:Ti(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ad),skyboxCapture:Ti(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ti(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);vec4 color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
vec4 color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 merc_pos=a_merc_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idy=u_grid_matrix[1][2];float S=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=a_pos[0]*S;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;uv=uv*EXTENT;vec4 up_vector=vec4(elevationVector(uv),1.0);float height=elevation(uv);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector.xyz*height;vec4 globe=u_globe_matrix*vec4(globe_pos,1.0);vec4 mercator=vec4(0.0);if (u_zoom_transition > 0.0) {mercator=vec4(merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;}vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Ti(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);
#ifdef PROJECTION_GLOBE_VIEW
float globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));float horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
float horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Ti(d,n,c){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,v=n.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),T=d.match(g),C=n.match(g),I=Sd.match(g);let L=C?C.concat(T):T;c||(Sl.staticUniforms&&(L=Sl.staticUniforms.concat(L)),Bo.staticUniforms&&(L=Bo.staticUniforms.concat(L))),L&&(L=L.concat(I));const B={};return{fragmentSource:d=d.replace(p,(N,$,Z,H,G)=>(B[G]=!0,$==="define"?`
#ifndef HAS_UNIFORM_u_${G}
varying ${Z} ${H} ${G};
#else
uniform ${Z} ${H} u_${G};
#endif
`:`
#ifdef HAS_UNIFORM_u_${G}
    ${Z} ${H} ${G} = u_${G};
#endif
`)),vertexSource:n=n.replace(p,(N,$,Z,H,G)=>{const ie=H==="float"?"vec2":"vec4",X=G.match(/color/)?"color":ie;return B[G]?$==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
attribute ${Z} ${ie} a_${G};
varying ${Z} ${H} ${G};
#else
uniform ${Z} ${H} u_${G};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = a_${G};
#else
    ${Z} ${H} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = unpack_mix_${X}(a_${G}, u_${G}_t);
#else
    ${Z} ${H} ${G} = u_${G};
#endif
`:$==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
attribute ${Z} ${ie} a_${G};
#else
uniform ${Z} ${H} u_${G};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${Z} ${H} ${G} = a_${G};
#else
    ${Z} ${H} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${Z} ${H} ${G} = unpack_mix_${X}(a_${G}, u_${G}_t);
#else
    ${Z} ${H} ${G} = u_${G};
#endif
`}),staticAttributes:v,staticUniforms:L}}class Xp{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,c,p,g,v,T,C,I,L){this.context=n;let B=this.boundPaintVertexBuffers.length!==g.length;for(let N=0;!B&&N<g.length;N++)this.boundPaintVertexBuffers[N]!==g[N]&&(B=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===c&&this.boundLayoutVertexBuffer===p&&!B&&this.boundIndexBuffer===v&&this.boundVertexOffset===T&&this.boundDynamicVertexBuffer===C&&this.boundDynamicVertexBuffer2===I&&this.boundDynamicVertexBuffer3===L?(n.bindVertexArrayOES.set(this.vao),C&&C.bind(),v&&v.dynamicDraw&&v.bind(),I&&I.bind(),L&&L.bind()):this.freshBind(c,p,g,v,T,C,I,L)}freshBind(n,c,p,g,v,T,C,I){let L;const B=n.numAttributes,N=this.context,$=N.gl;if(N.extVertexArrayObject)this.vao&&this.destroy(),this.vao=N.extVertexArrayObject.createVertexArrayOES(),N.bindVertexArrayOES.set(this.vao),L=0,this.boundProgram=n,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=g,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=T,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=I;else{L=N.currentNumAttributes||0;for(let Z=B;Z<L;Z++)$.disableVertexAttribArray(Z)}c.enableAttributes($,n);for(const Z of p)Z.enableAttributes($,n);T&&T.enableAttributes($,n),C&&C.enableAttributes($,n),I&&I.enableAttributes($,n),c.bind(),c.setVertexAttribPointers($,n,v);for(const Z of p)Z.bind(),Z.setVertexAttribPointers($,n,v);T&&(T.bind(),T.setVertexAttribPointers($,n,v)),g&&g.bind(),C&&(C.bind(),C.setVertexAttribPointers($,n,v)),I&&(I.bind(),I.setVertexAttribPointers($,n,v)),N.currentNumAttributes=B}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Id(d,n){const c=Math.pow(2,n.canonical.z),p=n.canonical.y;return[new a.MercatorCoordinate(0,p/c).toLngLat().lat,new a.MercatorCoordinate(0,(p+1)/c).toLngLat().lat]}function Kp(d,n,c,p,g,v,T){const C=d.context,I=C.gl,L=c.fbo;if(!L)return;d.prepareDrawTile();const B=d.useProgram("hillshade");C.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,L.colorAttachment.get());const N=((G,ie,X,Q)=>{const W=X.paint.get("hillshade-shadow-color"),le=X.paint.get("hillshade-highlight-color"),te=X.paint.get("hillshade-accent-color");let ne=X.paint.get("hillshade-illumination-direction")*(Math.PI/180);X.paint.get("hillshade-illumination-anchor")==="viewport"&&(ne-=G.transform.angle);const _e=!G.options.moving;return{u_matrix:Q||G.transform.calculateProjMatrix(ie.tileID.toUnwrapped(),_e),u_image:0,u_latrange:Id(0,ie.tileID),u_light:[X.paint.get("hillshade-exaggeration"),ne],u_shadow:W,u_highlight:le,u_accent:te}})(d,c,p,d.terrain?n.projMatrix:null);d.prepareDrawProgram(C,B,n.toUnwrapped());const{tileBoundsBuffer:$,tileBoundsIndexBuffer:Z,tileBoundsSegments:H}=d.getTileBoundsBuffers(c);B.draw(C,I.TRIANGLES,g,v,T,a.CullFaceMode.disabled,N,p.id,$,Z,H)}function hu(d,n,c){if(!n.needsDEMTextureUpload)return;const p=d.context,g=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||d.getTileTexture(c.stride);const v=c.getPixels();n.demTexture?n.demTexture.update(v,{premultiply:!1}):n.demTexture=new a.Texture(p,v,g.RGBA,{premultiply:!1}),n.needsDEMTextureUpload=!1}function du(d,n,c,p,g,v){const T=d.context,C=T.gl;if(!n.dem)return;const I=n.dem;if(T.activeTexture.set(C.TEXTURE1),hu(d,n,I),!n.demTexture)return;n.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE);const L=I.dim;T.activeTexture.set(C.TEXTURE0);let B=n.fbo;if(!B){const H=new a.Texture(T,{width:L,height:L,data:null},C.RGBA);H.bind(C.LINEAR,C.CLAMP_TO_EDGE),B=n.fbo=T.createFramebuffer(L,L,!0),B.colorAttachment.set(H.texture)}T.bindFramebuffer.set(B.framebuffer),T.viewport.set([0,0,L,L]);const{tileBoundsBuffer:N,tileBoundsIndexBuffer:$,tileBoundsSegments:Z}=d.getMercatorTileBoundsBuffers();d.useProgram("hillshadePrepare").draw(T,C.TRIANGLES,p,g,v,a.CullFaceMode.disabled,((H,G)=>{const ie=G.stride,X=a.create();return a.ortho(X,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(X,X,[0,-a.EXTENT,0]),{u_matrix:X,u_image:1,u_dimension:[ie,ie],u_zoom:H.overscaledZ,u_unpack:G.unpackVector}})(n.tileID,I),c.id,N,$,Z),n.needsHillshadePrepare=!1}const fu=(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_image0:new a.Uniform1i(d,n.u_image0),u_skirt_height:new a.Uniform1f(d,n.u_skirt_height)}),pu=(d,n)=>({u_matrix:d,u_image0:0,u_skirt_height:n}),yi=(d,n,c,p,g,v,T,C,I,L,B,N,$,Z)=>({u_proj_matrix:Float32Array.from(d),u_globe_matrix:n,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:c,u_zoom_transition:g,u_merc_center:v,u_image0:0,u_frustum_tl:T,u_frustum_tr:C,u_frustum_br:I,u_frustum_bl:L,u_globe_pos:B,u_globe_radius:N,u_viewport:$,u_grid_matrix:Z?Float32Array.from(Z):new Float32Array(9)});function Al(d,n){return d!=null&&n!=null&&!(!d.hasData()||!n.hasData())&&d.demTexture!=null&&n.demTexture!=null&&d.tileID.key!==n.tileID.key}const Os=new class{constructor(){this.operations={}}newMorphing(d,n,c,p,g){if(d in this.operations){const v=this.operations[d];v.to.tileID.key!==c.tileID.key&&(v.queued=c)}else this.operations[d]={startTime:p,phase:0,duration:g,from:n,to:c,queued:null}}getMorphValuesForProxy(d){if(!(d in this.operations))return null;const n=this.operations[d];return{from:n.from,to:n.to,phase:n.phase}}update(d){for(const n in this.operations){const c=this.operations[n];for(c.phase=(d-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,d)){delete this.operations[n];break}}}_nextOp(d,n){return!!d.queued&&(d.from=d.to,d.to=d.queued,d.queued=null,d.phase=0,d.startTime=n,!0)}_validOp(d){return d.from.hasData()&&d.to.hasData()}},Il={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Yp(d,n){const c=1<<d.z;return!n&&(d.x===0||d.x===c-1)||d.y===0||d.y===c-1}const Ml=d=>({u_matrix:d});function Md(d,n,c,p,g){if(g>0){const v=a.exported.now(),T=(v-d.timeAdded)/g,C=n?(v-n.timeAdded)/g:-1,I=c.getSource(),L=p.coveringZoomLevel({tileSize:I.tileSize,roundZoom:I.roundZoom}),B=!n||Math.abs(n.tileID.overscaledZ-L)>Math.abs(d.tileID.overscaledZ-L),N=B&&d.refreshedUponExpiration?1:a.clamp(B?T:1-C,0,1);return d.refreshedUponExpiration&&T>=1&&(d.refreshedUponExpiration=!1),n?{opacity:1,mix:1-N}:{opacity:N,mix:0}}return{opacity:1,mix:0}}class Fy extends a.SourceCache{constructor(n){const c={type:"raster-dem",maxzoom:n.transform.maxZoom},p=new Si(Ei(),null),g=Se("mock-dem",c,p,n.style);super("mock-dem",g,!1),g.setEventedParent(this),this._sourceLoaded=!0}_loadTile(n,c){n.state="loaded",c(null)}}class Ny extends a.SourceCache{constructor(n){const c=Se("proxy",{type:"geojson",maxzoom:n.transform.maxZoom},new Si(Ei(),null),n.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=n,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(n,c,p){if(n.freezeTileCoverage)return;this.transform=n;const g=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((v,T)=>{if(v[T.key]="",!this._tiles[T.key]){const C=new a.Tile(T,this._source.tileSize*T.overscaleFactor(),n.tileZoom);C.state="loaded",this._tiles[T.key]=C}return v},{});for(const v in this._tiles)v in g||(this.freeFBO(v),this._tiles[v].unloadVectorData(),delete this._tiles[v])}freeFBO(n){const c=this.proxyCachedFBO[n];if(c!==void 0){const p=Object.values(c);this.renderCachePool.push(...p),delete this.proxyCachedFBO[n]}}deallocRenderCache(){this.renderCache.forEach(n=>n.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class mu extends a.OverscaledTileID{constructor(n,c,p){super(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y),this.proxyTileKey=c,this.projMatrix=p}}class kd extends a.Elevation{constructor(n,c){super(),this.painter=n,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,g,v]=function(I){const L=new a.StructArrayLayout4i8,B=new a.StructArrayLayout3ui6,N=131;L.reserve(17161),B.reserve(33800);const $=a.EXTENT/128,Z=a.EXTENT+$/2,H=Z+$;for(let ie=-$;ie<H;ie+=$)for(let X=-$;X<H;X+=$){const Q=X<0||X>Z||ie<0||ie>Z?24575:0,W=a.clamp(Math.round(X),0,a.EXTENT),le=a.clamp(Math.round(ie),0,a.EXTENT);L.emplaceBack(W+Q,le,W,le)}const G=(ie,X)=>{const Q=X*N+ie;B.emplaceBack(Q+1,Q,Q+N),B.emplaceBack(Q+N,Q+N+1,Q+1)};for(let ie=1;ie<129;ie++)for(let X=1;X<129;X++)G(X,ie);return[0,129].forEach(ie=>{for(let X=0;X<130;X++)G(X,ie),G(ie,X)}),[L,B,32768]}(),T=n.context;this.gridBuffer=T.createVertexBuffer(p,a.boundsAttributes.members),this.gridIndexBuffer=T.createIndexBuffer(g),this.gridSegments=a.SegmentVector.simpleSegment(0,0,p.length,g.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,p.length,v),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ny(c.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,0,a.EXTENT,0,a.EXTENT,0,1);const C=T.gl;this._overlapStencilMode=new a.StencilMode({func:C.GEQUAL,mask:255},0,255,C.KEEP,C.KEEP,C.REPLACE),this._previousZoom=n.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Fy(c.map)}set style(n){n.on("data",this._onStyleDataEvent.bind(this)),n.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=n,this._checkRenderCacheEfficiency()}update(n,c,p){if(n&&n.terrain){this._style!==n&&(this.style=n),this.enabled=!0;const g=n.terrain.properties;this.sourceCache=n.terrain.drapeRenderMode===0?this._mockSourceCache:n._getSourceCache(g.get("source")),this._exaggeration=g.get("exaggeration");const v=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const T=this.getScaledDemTileSize();this.sourceCache.update(c,T,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,v(),this._initializing=!0),v(),c.updateElevation(!p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(n){this._findCoveringTileCache[n]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const n=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||n.efficiency!==100&&a.warnOnce(`Terrain render cache efficiency is not optimal (${n.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${n.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(n){n.coord&&n.dataType==="source"?this._clearRenderCacheForTile(n.sourceCacheId,n.coord):n.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const n in this._style._sourceCaches)this._style._sourceCaches[n].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(n=>n.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const n=2*this.proxySourceCache.getSource().tileSize;return[n,n]}set useVertexMorphing(n){this._useVertexMorphing=n}updateTileBinding(n){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const g=this.proxyCoords=c.getIds().map(I=>{const L=c.getTileByID(I).tileID;return L.projMatrix=p.calculateProjMatrix(L.toUnwrapped()),L});(function(I,L){const B=L.transform.pointCoordinate(L.transform.getCameraPoint()),N=new a.pointGeometry(B.x,B.y);I.sort(($,Z)=>{if(Z.overscaledZ-$.overscaledZ)return Z.overscaledZ-$.overscaledZ;const H=new a.pointGeometry($.canonical.x+(1<<$.canonical.z)*$.wrap,$.canonical.y),G=new a.pointGeometry(Z.canonical.x+(1<<Z.canonical.z)*Z.wrap,Z.canonical.y),ie=N.mult(1<<$.canonical.z);return ie.x-=.5,ie.y-=.5,ie.distSqr(H)-ie.distSqr(G)})})(g,this.painter),this._previousZoom=p.zoom;const v=this.proxyToSource||{};this.proxyToSource={},g.forEach(I=>{this.proxyToSource[I.key]={}}),this.terrainTileForTile={};const T=this._style._sourceCaches;for(const I in T){const L=T[I];if(!L.used||(L!==this.sourceCache&&this.resetTileLookupCache(L.id),this._setupProxiedCoordsForOrtho(L,n[I],v),L.usedForTerrain))continue;const B=n[I];L.getSource().reparseOverscaled&&this._assignTerrainTiles(B)}this.proxiedCoords[c.id]=g.map(I=>new mu(I,I.key,this.orthoMatrix)),this._assignTerrainTiles(g),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(v),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const C={};this._visibleDemTiles=[];for(const I of this.proxyCoords){const L=this.terrainTileForTile[I.key];if(!L)continue;const B=L.tileID.key;B in C||(this._visibleDemTiles.push(L),C[B]=B)}}_assignTerrainTiles(n){this._initializing||n.forEach(c=>{if(this.terrainTileForTile[c.key])return;const p=this._findTileCoveringTileID(c,this.sourceCache);p&&(this.terrainTileForTile[c.key]=p)})}_prepareDEMTextures(){const n=this.painter.context,c=n.gl;for(const p in this.terrainTileForTile){const g=this.terrainTileForTile[p],v=g.dem;!v||g.demTexture&&!g.needsDEMTextureUpload||(n.activeTexture.set(c.TEXTURE1),hu(this.painter,g,v))}}_prepareDemTileUniforms(n,c,p,g){if(!c||c.demTexture==null)return!1;const v=n.tileID.canonical,T=Math.pow(2,c.tileID.canonical.z-v.z),C=g||"";return p[`u_dem_tl${C}`]=[v.x*T%1,v.y*T%1],p[`u_dem_scale${C}`]=T,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const n=this.painter.context,c=n.gl;if(!this._emptyDepthBufferTexture){const p=new a.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.Texture(n,p,c.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let n=0;const c=this._visibleDemTiles.reduce((p,g)=>{if(!g.dem)return p;const v=g.dem.tree.minimums[0];return v>0&&n++,p+v},0);return n?c/n:0}_updateEmptyDEMTexture(){const n=this.painter.context,c=n.gl;n.activeTexture.set(c.TEXTURE2);const p=this._getLoadedAreaMinimum(),g=new a.RGBAImage({width:1,height:1},new Uint8Array(a.DEMData.pack(p,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let v=this._emptyDEMTexture;return v?v.update(g,{premultiply:!1}):v=this._emptyDEMTexture=new a.Texture(n,g,c.RGBA,{premultiply:!1}),v}setupElevationDraw(n,c,p){const g=this.painter.context,v=g.gl,T=(C=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(C),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var C;T.u_dem_size=this.sourceCache.getSource().tileSize,T.u_exaggeration=this.exaggeration();const I=this.painter.transform,L=I.projection,B=n.tileID.canonical;T.u_tile_tl_up=L.upVector(B,0,0),T.u_tile_tr_up=L.upVector(B,a.EXTENT,0),T.u_tile_br_up=L.upVector(B,a.EXTENT,a.EXTENT),T.u_tile_bl_up=L.upVector(B,0,a.EXTENT),T.u_tile_up_scale=p&&p.useDenormalizedUpVectorScale?a.GLOBE_METERS_TO_ECEF:L.upVectorScale(B,I.center.lat,I.worldSize).metersToTile;let N=null,$=null,Z=1;if(p&&p.morphing&&this._useVertexMorphing){const H=p.morphing.srcDemTile,G=p.morphing.dstDemTile;Z=p.morphing.phase,H&&G&&(this._prepareDemTileUniforms(n,H,T,"_prev")&&($=H),this._prepareDemTileUniforms(n,G,T)&&(N=G))}if($&&N?(g.activeTexture.set(v.TEXTURE2),N.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE,v.NEAREST),g.activeTexture.set(v.TEXTURE4),$.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE,v.NEAREST),T.u_dem_lerp=Z):(N=this.terrainTileForTile[n.tileID.key],g.activeTexture.set(v.TEXTURE2),(this._prepareDemTileUniforms(n,N,T)?N.demTexture:this.emptyDEMTexture).bind(v.NEAREST,v.CLAMP_TO_EDGE)),g.activeTexture.set(v.TEXTURE3),p&&p.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),this._depthFBO&&(T.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),T.u_depth_size_inv=[1,1]),p&&p.useMeterToDem&&N){const H=(1<<N.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;T.u_meter_to_dem=H}p&&p.labelPlaneMatrixInv&&(T.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),c.setTerrainUniformValues(g,T)}renderToBackBuffer(n){const c=this.painter,p=this.painter.context;n.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(g,v,T,C,I){if(g.transform.projection.name==="globe")(function(L,B,N,$,Z){const H=L.context,G=H.gl;let ie,X;const Q=L.options.showTerrainWireframe?2:0,W=L.transform,le=a.globeUseCustomAntiAliasing(L,H,W),te=(ae,Ce)=>{if(X===ae)return;const Re=[Il[ae],"PROJECTION_GLOBE_VIEW"];le&&Re.push("CUSTOM_ANTIALIASING"),Ce&&Re.push(Il[Q]),ie=L.useProgram("globeRaster",null,Re),X=ae},ne=L.colorModeForRenderPass(),_e=new a.DepthMode(G.LEQUAL,a.DepthMode.ReadWrite,L.depthRangeFor3D);Os.update(Z);const Me=a.calculateGlobeMercatorMatrix(W),De=[a.mercatorXfromLng(W.center.lng),a.mercatorYfromLat(W.center.lat)],Ie=L.globeSharedBuffers,Je=[W.width*a.exported.devicePixelRatio,W.height*a.exported.devicePixelRatio];if((Q?[!1,!0]:[!1]).forEach(ae=>{X=-1;const Ce=ae?G.LINES:G.TRIANGLES;for(const Re of $){const ot=N.getTile(Re),Oe=a.StencilMode.disabled,gt=B.prevTerrainTileForTile[Re.key],tt=B.terrainTileForTile[Re.key];Al(gt,tt)&&Os.newMorphing(Re.key,gt,tt,Z,250),H.activeTexture.set(G.TEXTURE0),ot.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const st=Os.getMorphValuesForProxy(Re.key),at=st?1:0,nt={useDenormalizedUpVectorScale:!0};st&&a.extend$1(nt,{morphing:{srcDemTile:st.from,dstDemTile:st.to,phase:a.easeCubicInOut(st.phase)}});const _t=Float32Array.from(W.globeMatrix),Bt=a.globeTileLatLngCorners(Re.canonical),$t=a.getLatitudinalLod((Bt[0][0]+Bt[1][0])/2),Ct=a.getGridMatrix(Re.canonical,Bt,$t),Ut=a.globeNormalizeECEF(a.globeTileBounds(Re.canonical)),ki=yi(W.projMatrix,_t,Me,Ut,a.globeToMercatorTransition(W.zoom),De,W.frustumCorners.TL,W.frustumCorners.TR,W.frustumCorners.BR,W.frustumCorners.BL,W.globeCenterInViewSpace,W.globeRadius,Je,Ct);if(te(at,ae),B.setupElevationDraw(ot,ie,nt),L.prepareDrawProgram(H,ie,Re.toUnwrapped()),Ie){const[Ui,Ki,zi]=ae?Ie.getWirefameBuffers(L.context,$t):Ie.getGridBuffers($t);ie.draw(H,Ce,_e,Oe,ne,a.CullFaceMode.backCCW,ki,"globe_raster",Ui,Ki,zi)}}}),Ie){const ae=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];le&&ae.push("CUSTOM_ANTIALIASING"),ie=L.useProgram("globeRaster",null,ae);for(const Ce of $){const{x:Re,y:ot,z:Oe}=Ce.canonical,gt=ot===0,tt=ot===(1<<Oe)-1,[st,at,nt,_t]=Ie.getPoleBuffers(Oe);if(_t&&(gt||tt)){const Bt=N.getTile(Ce);H.activeTexture.set(G.TEXTURE0),Bt.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE);let $t=a.globePoleMatrixForTile(Oe,Re,W);const Ct=a.globeNormalizeECEF(a.globeTileBounds(Ce.canonical)),Ut=(ki,Ui)=>ki.draw(H,G.TRIANGLES,_e,a.StencilMode.disabled,ne,a.CullFaceMode.disabled,yi(W.projMatrix,$t,$t,Ct,0,De,W.frustumCorners.TL,W.frustumCorners.TR,W.frustumCorners.BR,W.frustumCorners.BL,W.globeCenterInViewSpace,W.globeRadius,Je),"globe_pole_raster",Ui,nt,_t);B.setupElevationDraw(Bt,ie,{}),L.prepareDrawProgram(H,ie,Ce.toUnwrapped()),gt&&Ut(ie,st),tt&&($t=a.scale(a.create(),$t,[1,-1,1]),Ut(ie,at))}}}})(g,v,T,C,I);else{const L=g.context,B=L.gl;let N,$;const Z=g.options.showTerrainWireframe?2:0,H=(W,le)=>{if($===W)return;const te=[Il[W]];le&&te.push(Il[Z]),N=g.useProgram("terrainRaster",null,te),$=W},G=g.colorModeForRenderPass(),ie=new a.DepthMode(B.LEQUAL,a.DepthMode.ReadWrite,g.depthRangeFor3D);Os.update(I);const X=g.transform,Q=6*Math.pow(1.5,22-X.zoom)*v.exaggeration();(Z?[!1,!0]:[!1]).forEach(W=>{$=-1;const le=W?B.LINES:B.TRIANGLES,[te,ne]=W?v.getWirefameBuffer():[v.gridIndexBuffer,v.gridSegments];for(const _e of C){const Me=T.getTile(_e),De=a.StencilMode.disabled,Ie=v.prevTerrainTileForTile[_e.key],Je=v.terrainTileForTile[_e.key];Al(Ie,Je)&&Os.newMorphing(_e.key,Ie,Je,I,250),L.activeTexture.set(B.TEXTURE0),Me.texture.bind(B.LINEAR,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST);const ae=Os.getMorphValuesForProxy(_e.key),Ce=ae?1:0;let Re;ae&&(Re={morphing:{srcDemTile:ae.from,dstDemTile:ae.to,phase:a.easeCubicInOut(ae.phase)}});const ot=pu(_e.projMatrix,Yp(_e.canonical,X.renderWorldCopies)?Q/10:Q);H(Ce,W),v.setupElevationDraw(Me,N,Re),g.prepareDrawProgram(L,N,_e.toUnwrapped()),N.draw(L,le,ie,De,G,a.CullFaceMode.backCCW,ot,"terrain_raster",v.gridBuffer,te,ne)}})}}(c,this,this.proxySourceCache,n,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),n.splice(0,n.length))}renderBatch(n){if(this._drapedRenderBatches.length===0)return n+1;this.renderingToTexture=!0;const c=this.painter,p=this.painter.context,g=this.proxySourceCache,v=this.proxiedCoords[g.id],T=this._drapedRenderBatches.shift(),C=[],I=c.style.order;let L=0;for(const B of v){const N=g.getTileByID(B.proxyTileKey),$=g.proxyCachedFBO[B.key]?g.proxyCachedFBO[B.key][n]:void 0,Z=$!==void 0?g.renderCache[$]:this.pool[L++],H=$!==void 0;if(N.texture=Z.tex,H&&!Z.dirty){C.push(N.tileID);continue}let G;p.bindFramebuffer.set(Z.fb.framebuffer),this.renderedToTile=!1,Z.dirty&&(p.clear({color:a.Color.transparent,stencil:0}),Z.dirty=!1);for(let ie=T.start;ie<=T.end;++ie){const X=c.style._layers[I[ie]];if(X.isHidden(c.transform.zoom))continue;const Q=c.style._getLayerSourceCache(X),W=Q?this.proxyToSource[B.key][Q.id]:[B];if(!W)continue;const le=W;p.viewport.set([0,0,Z.fb.width,Z.fb.height]),G!==(Q?Q.id:null)&&(this._setupStencil(Z,W,X,Q),G=Q?Q.id:null),c.renderLayer(c,Q,X,le)}this.renderedToTile?(Z.dirty=!0,C.push(N.tileID)):H||--L,L===5&&(L=0,this.renderToBackBuffer(C))}return this.renderToBackBuffer(C),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),T.end+1}postRender(){}renderCacheEfficiency(n){const c=n.order.length;if(c===0)return{efficiency:100};let p,g=0,v=0,T=!1;for(let C=0;C<c;++C){const I=n._layers[n.order[C]];this._style.isLayerDraped(I)?(T&&++g,++v):T||(T=!0,p=I.id)}return v===0?{efficiency:100}:{efficiency:100*(1-g/v),firstUndrapedLayer:p}}getMinElevationBelowMSL(){let n=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{n=Math.min(n,c.dem.tree.minimums[0])}),n===0?n:(n-30)*this._exaggeration}raycast(n,c,p){if(!this._visibleDemTiles)return null;const g=this._visibleDemTiles.filter(v=>v.dem).map(v=>{const T=v.tileID,C=Math.pow(2,T.overscaledZ),{x:I,y:L}=T.canonical,B=I/C,N=(I+1)/C,$=L/C,Z=(L+1)/C;return{minx:B,miny:$,maxx:N,maxy:Z,t:v.dem.tree.raycastRoot(B,$,N,Z,n,c,p),tile:v}});g.sort((v,T)=>(v.t!==null?v.t:Number.MAX_VALUE)-(T.t!==null?T.t:Number.MAX_VALUE));for(const v of g){if(v.t==null)return null;const T=v.tile.dem.tree.raycast(v.minx,v.miny,v.maxx,v.maxy,n,c,p);if(T!=null)return T}return null}_createFBO(){const n=this.painter.context,c=n.gl,p=this.drapeBufferSize;n.activeTexture.set(c.TEXTURE0);const g=new a.Texture(n,{width:p[0],height:p[1],data:null},c.RGBA);g.bind(c.LINEAR,c.CLAMP_TO_EDGE);const v=n.createFramebuffer(p[0],p[1],!1);return v.colorAttachment.set(g.texture),v.depthAttachment=new U(n,v.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=n.createRenderbuffer(n.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,v.depthAttachment.set(this._sharedDepthStencil),n.clear({stencil:0})):v.depthAttachment.set(this._sharedDepthStencil),n.extTextureFilterAnisotropic&&!n.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax),{fb:v,tex:g,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const n in this._style._sourceCaches)if(this._style._sourceCaches[n].hasTransition())return!0;return this._style.order.some(n=>{const c=this._style._layers[n],p=c.isHidden(this.painter.transform.zoom),g=c.getCrossfadeParameters(),v=!!g&&g.t!==1,T=c.hasTransition();return c.type!=="custom"&&!p&&(v||T)})}_clearRasterFadeFromRenderCache(){let n=!1;for(const c in this._style._sourceCaches)if(this._style._sourceCaches[c]._source instanceof re){n=!0;break}if(n)for(let c=0;c<this._style.order.length;++c){const p=this._style._layers[this._style.order[c]],g=p.isHidden(this.painter.transform.zoom),v=this._style._getLayerSourceCache(p);if(p.type!=="raster"||g||!v)continue;const T=p.paint.get("raster-fade-duration");for(const C of this.proxyCoords){const I=this.proxyToSource[C.key][v.id];if(I)for(const L of I){const B=Md(v.getTile(L),v.findLoadedParent(L,0),v,this.painter.transform,T);(B.opacity!==1||B.mix!==0)&&this._clearRenderCacheForTile(v.id,L)}}}}_setupDrapedRenderBatches(){const n=this._style.order,c=n.length;if(c===0)return;const p=[];let g,v=0,T=this._style._layers[n[v]];for(;!this._style.isLayerDraped(T)&&T.isHidden(this.painter.transform.zoom)&&++v<c;)T=this._style._layers[n[v]];for(;v<c;++v){const C=this._style._layers[n[v]];C.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(C)?g===void 0&&(g=v):g!==void 0&&(p.push({start:g,end:v-1}),g=void 0))}g!==void 0&&p.push({start:g,end:v-1}),this._drapedRenderBatches=p}_setupRenderCache(n){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const T=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let C=0;C<T.length;++C){const I=Object.values(T[C]);c.renderCachePool.push(...I)}}return}this._clearRasterFadeFromRenderCache();const p=this.proxyCoords,g=this._tilesDirty;for(let T=p.length-1;T>=0;T--){const C=p[T];if(c.getTileByID(C.key),c.proxyCachedFBO[C.key]!==void 0){const I=n[C.key],L=this.proxyToSource[C.key];let B=0;for(const N in L){const $=L[N],Z=I[N];if(!Z||Z.length!==$.length||$.some((H,G)=>H!==Z[G]||g[N]&&g[N].hasOwnProperty(H.key))){B=-1;break}++B}for(const N in c.proxyCachedFBO[C.key])c.renderCache[c.proxyCachedFBO[C.key][N]].dirty=B<0||B!==Object.values(I).length}}const v=[...this._drapedRenderBatches];v.sort((T,C)=>C.end-C.start-(T.end-T.start));for(const T of v)for(const C of p){if(c.proxyCachedFBO[C.key])continue;let I=c.renderCachePool.pop();I===void 0&&c.renderCache.length<50&&(I=c.renderCache.length,c.renderCache.push(this._createFBO())),I!==void 0&&(c.proxyCachedFBO[C.key]={},c.proxyCachedFBO[C.key][T.start]=I,c.renderCache[I].dirty=!0)}this._tilesDirty={}}_setupStencil(n,c,p,g){if(!g||!this._sourceTilesOverlap[g.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const v=this.painter.context,T=v.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let C;if(p.isTileClipped())C=c.length,this._overlapStencilMode.test={func:T.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);C=1,this._overlapStencilMode.test={func:T.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+C>255&&(v.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=C,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(n){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[n.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(n,c){const p=this.painter,g=this.painter.context,v=g.gl;p._tileClippingMaskIDs={},g.setColorMode(a.ColorMode.disabled),g.setDepthMode(a.DepthMode.disabled);const T=p.useProgram("clippingMask");for(const C of n){const I=p._tileClippingMaskIDs[C.key]=--c;T.draw(g,v.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:v.ALWAYS,mask:0},I,255,v.KEEP,v.KEEP,v.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Ml(C.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(n){const c=this.painter.transform;if(n.x<0||n.x>c.width||n.y<0||n.y>c.height)return null;const p=[n.x,n.y,1,1];a.transformMat4$1(p,p,c.pixelMatrixInverse),a.scale$1(p,p,1/p[3]),p[0]/=c.worldSize,p[1]/=c.worldSize;const g=c._camera.position,v=a.mercatorZfromAltitude(1,c.center.lat),T=[g[0],g[1],g[2]/v,0],C=a.subtract([],p.slice(0,3),T);a.normalize(C,C);const I=this.raycast(T,C,this._exaggeration);return I!==null&&I?(a.scaleAndAdd(T,T,C,I),T[3]=T[2],T[2]*=v,T):null}drawDepth(){const n=this.painter,c=n.context,p=this.proxySourceCache,g=Math.ceil(n.width),v=Math.ceil(n.height);if(!this._depthFBO||this._depthFBO.width===g&&this._depthFBO.height===v||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const T=c.gl,C=c.createFramebuffer(g,v,!0);c.activeTexture.set(T.TEXTURE0);const I=new a.Texture(c,{width:g,height:v,data:null},T.RGBA);I.bind(T.NEAREST,T.CLAMP_TO_EDGE),C.colorAttachment.set(I.texture);const L=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,g,v);C.depthAttachment.set(L),this._depthFBO=C,this._depthTexture=I}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,g,v]),function(T,C,I,L){if(T.transform.projection.name==="globe")return;const B=T.context,N=B.gl;B.clear({depth:1});const $=T.useProgram("terrainDepth"),Z=new a.DepthMode(N.LESS,a.DepthMode.ReadWrite,T.depthRangeFor3D);for(const H of L){const G=I.getTile(H),ie=pu(H.projMatrix,0);C.setupElevationDraw(G,$),$.draw(B,N.TRIANGLES,Z,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,ie,"terrain_depth",C.gridBuffer,C.gridIndexBuffer,C.gridNoSkirtSegments)}}(n,this,p,this.proxyCoords)}_setupProxiedCoordsForOrtho(n,c,p){if(n.getSource()instanceof we)return this._setupProxiedCoordsForImageSource(n,c,p);this._findCoveringTileCache[n.id]=this._findCoveringTileCache[n.id]||{};const g=this.proxiedCoords[n.id]=[],v=this.proxyCoords;for(let C=0;C<v.length;C++){const I=v[C],L=this._findTileCoveringTileID(I,n);if(L){const B=this._createProxiedId(I,L,p[I.key]&&p[I.key][n.id]);g.push(B),this.proxyToSource[I.key][n.id]=[B]}}let T=!1;for(let C=0;C<c.length;C++){const I=n.getTile(c[C]);if(!I||!I.hasData())continue;const L=this._findTileCoveringTileID(I.tileID,this.proxySourceCache);if(L&&L.tileID.canonical.z!==I.tileID.canonical.z){const B=this.proxyToSource[L.tileID.key][n.id],N=this._createProxiedId(L.tileID,I,p[L.tileID.key]&&p[L.tileID.key][n.id]);B?B.splice(B.length-1,0,N):this.proxyToSource[L.tileID.key][n.id]=[N],g.push(N),T=!0}}this._sourceTilesOverlap[n.id]=T}_setupProxiedCoordsForImageSource(n,c,p){if(!n.getSource().loaded())return;const g=this.proxiedCoords[n.id]=[],v=this.proxyCoords,T=n.getSource(),C=new a.pointGeometry(T.tileID.x,T.tileID.y)._div(1<<T.tileID.z),I=T.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((B,N)=>(B.min.x=Math.min(B.min.x,N.x-C.x),B.min.y=Math.min(B.min.y,N.y-C.y),B.max.x=Math.max(B.max.x,N.x-C.x),B.max.y=Math.max(B.max.y,N.y-C.y),B),{min:new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),L=(B,N)=>{const $=B.wrap+B.canonical.x/(1<<B.canonical.z),Z=B.canonical.y/(1<<B.canonical.z),H=a.EXTENT/(1<<B.canonical.z),G=N.wrap+N.canonical.x/(1<<N.canonical.z),ie=N.canonical.y/(1<<N.canonical.z);return $+H<G+I.min.x||$>G+I.max.x||Z+H<ie+I.min.y||Z>ie+I.max.y};for(let B=0;B<v.length;B++){const N=v[B];for(let $=0;$<c.length;$++){const Z=n.getTile(c[$]);if(!Z||!Z.hasData()||L(N,Z.tileID))continue;const H=this._createProxiedId(N,Z,p[N.key]&&p[N.key][n.id]),G=this.proxyToSource[N.key][n.id];G?G.push(H):this.proxyToSource[N.key][n.id]=[H],g.push(H)}}}_createProxiedId(n,c,p){let g=this.orthoMatrix;if(p){const v=p.find(T=>T.key===c.tileID.key);if(v)return v}if(c.tileID.key!==n.key){const v=n.canonical.z-c.tileID.canonical.z;let T,C,I;g=a.create();const L=c.tileID.wrap-n.wrap<<n.overscaledZ;v>0?(T=a.EXTENT>>v,C=T*((c.tileID.canonical.x<<v)-n.canonical.x+L),I=T*((c.tileID.canonical.y<<v)-n.canonical.y)):(T=a.EXTENT<<-v,C=a.EXTENT*(c.tileID.canonical.x-(n.canonical.x+L<<-v)),I=a.EXTENT*(c.tileID.canonical.y-(n.canonical.y<<-v))),a.ortho(g,0,T,0,T,0,1),a.translate(g,g,[C,I,0])}return new mu(c.tileID,n.key,g)}_findTileCoveringTileID(n,c){let p=c.getTile(n);if(p&&p.hasData())return p;const g=this._findCoveringTileCache[c.id],v=g[n.key];if(p=v?c.getTileByID(v):null,p&&p.hasData()||v===null)return p;let T=p?p.tileID:n,C=T.overscaledZ;const I=c.getSource().minzoom,L=[];if(!v){const N=c.getSource().maxzoom;if(n.canonical.z>=N){const $=n.canonical.z-N;c.getSource().reparseOverscaled?(C=Math.max(n.canonical.z+2,c.transform.tileZoom),T=new a.OverscaledTileID(C,n.wrap,N,n.canonical.x>>$,n.canonical.y>>$)):$!==0&&(C=N,T=new a.OverscaledTileID(C,n.wrap,N,n.canonical.x>>$,n.canonical.y>>$))}T.key!==n.key&&(L.push(T.key),p=c.getTile(T))}const B=N=>{L.forEach($=>{g[$]=N}),L.length=0};for(C-=1;C>=I&&(!p||!p.hasData());C--){p&&B(p.tileID.key);const N=T.calculateScaledKey(C);if(p=c.getTileByID(N),p&&p.hasData())break;const $=g[N];if($===null)break;$===void 0?L.push(N):p=c.getTileByID($)}return B(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(n){return this.enabled?this._findTileCoveringTileID(n,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(n,c){let p=this._tilesDirty[n];p||(p=this._tilesDirty[n]={}),p[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const n=function(c){let p=0;const g=new a.StructArrayLayout2ui4,v=131;for(let T=1;T<129;T++){for(let C=1;C<129;C++)p=T*v+C,g.emplaceBack(p,p+1),g.emplaceBack(p,p+v),g.emplaceBack(p+1,p+v),T===128&&g.emplaceBack(p+v,p+v+1);g.emplaceBack(p+1,p+1+v)}return g}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(n),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,n.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function _u(d){const n=[];for(let c=0;c<d.length;c++){if(d[c]===null)continue;const p=d[c].split(" ");n.push(p.pop())}return n}class gu{static cacheKey(n,c,p){let g=`${n}${p?p.cacheKey:""}`;for(const v of c)g+=`/${v}`;return g}constructor(n,c,p,g,v,T){const C=n.gl;this.program=C.createProgram();const I=_u(p.staticAttributes),L=g?g.getBinderAttributes():[],B=I.concat(L),N=p.staticUniforms?_u(p.staticUniforms):[],$=g?g.getBinderUniforms():[],Z=N.concat($),H=[];for(const te of Z)H.indexOf(te)<0&&H.push(te);let G=g?g.defines():[];G=G.concat(T.map(te=>`#define ${te}`));const ie=G.concat(n.extStandardDerivatives?`#extension GL_OES_standard_derivatives : enable
`.concat(ba):ba,ba,xa,cu.fragmentSource,Bo.fragmentSource,p.fragmentSource).join(`
`),X=G.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,xa,cu.vertexSource,Bo.vertexSource,Sl.vertexSource,p.vertexSource).join(`
`),Q=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);C.shaderSource(Q,ie),C.compileShader(Q),C.attachShader(this.program,Q);const W=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);C.shaderSource(W,X),C.compileShader(W),C.attachShader(this.program,W),this.attributes={};const le={};this.numAttributes=B.length;for(let te=0;te<this.numAttributes;te++)B[te]&&(C.bindAttribLocation(this.program,te,B[te]),this.attributes[B[te]]=te);C.linkProgram(this.program),C.deleteShader(W),C.deleteShader(Q);for(let te=0;te<H.length;te++){const ne=H[te];if(ne&&!le[ne]){const _e=C.getUniformLocation(this.program,ne);_e&&(le[ne]=_e)}}this.fixedUniforms=v(n,le),this.binderUniforms=g?g.getUniforms(n,le):[],T.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=((te,ne)=>({u_dem:new a.Uniform1i(te,ne.u_dem),u_dem_prev:new a.Uniform1i(te,ne.u_dem_prev),u_dem_unpack:new a.Uniform4f(te,ne.u_dem_unpack),u_dem_tl:new a.Uniform2f(te,ne.u_dem_tl),u_dem_scale:new a.Uniform1f(te,ne.u_dem_scale),u_dem_tl_prev:new a.Uniform2f(te,ne.u_dem_tl_prev),u_dem_scale_prev:new a.Uniform1f(te,ne.u_dem_scale_prev),u_dem_size:new a.Uniform1f(te,ne.u_dem_size),u_dem_lerp:new a.Uniform1f(te,ne.u_dem_lerp),u_exaggeration:new a.Uniform1f(te,ne.u_exaggeration),u_depth:new a.Uniform1i(te,ne.u_depth),u_depth_size_inv:new a.Uniform2f(te,ne.u_depth_size_inv),u_meter_to_dem:new a.Uniform1f(te,ne.u_meter_to_dem),u_label_plane_matrix_inv:new a.UniformMatrix4f(te,ne.u_label_plane_matrix_inv),u_tile_tl_up:new a.Uniform3f(te,ne.u_tile_tl_up),u_tile_tr_up:new a.Uniform3f(te,ne.u_tile_tr_up),u_tile_br_up:new a.Uniform3f(te,ne.u_tile_br_up),u_tile_bl_up:new a.Uniform3f(te,ne.u_tile_bl_up),u_tile_up_scale:new a.Uniform1f(te,ne.u_tile_up_scale)}))(n,le)),T.indexOf("FOG")!==-1&&(this.fogUniforms=((te,ne)=>({u_fog_matrix:new a.UniformMatrix4f(te,ne.u_fog_matrix),u_fog_range:new a.Uniform2f(te,ne.u_fog_range),u_fog_color:new a.Uniform4f(te,ne.u_fog_color),u_fog_horizon_blend:new a.Uniform1f(te,ne.u_fog_horizon_blend),u_fog_temporal_offset:new a.Uniform1f(te,ne.u_fog_temporal_offset),u_frustum_tl:new a.Uniform3f(te,ne.u_frustum_tl),u_frustum_tr:new a.Uniform3f(te,ne.u_frustum_tr),u_frustum_br:new a.Uniform3f(te,ne.u_frustum_br),u_frustum_bl:new a.Uniform3f(te,ne.u_frustum_bl),u_globe_pos:new a.Uniform3f(te,ne.u_globe_pos),u_globe_radius:new a.Uniform1f(te,ne.u_globe_radius),u_globe_transition:new a.Uniform1f(te,ne.u_globe_transition),u_is_globe:new a.Uniform1i(te,ne.u_is_globe),u_viewport:new a.Uniform2f(te,ne.u_viewport)}))(n,le))}setTerrainUniformValues(n,c){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const g in c)p[g].set(c[g])}}setFogUniformValues(n,c){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const g in c)p[g].location&&p[g].set(c[g])}}draw(n,c,p,g,v,T,C,I,L,B,N,$,Z,H,G,ie,X){const Q=n.gl;if(this.failedToCreate)return;n.program.set(this.program),n.setDepthMode(p),n.setStencilMode(g),n.setColorMode(v),n.setCullFace(T);for(const le of Object.keys(this.fixedUniforms))this.fixedUniforms[le].set(C[le]);H&&H.setUniforms(n,this.binderUniforms,$,{zoom:Z});const W={[Q.LINES]:2,[Q.TRIANGLES]:3,[Q.LINE_STRIP]:1}[c];for(const le of N.get()){const te=le.vaos||(le.vaos={});(te[I]||(te[I]=new Xp)).bind(n,this,L,H?H.getPaintVertexBuffers():[],B,le.vertexOffset,G,ie,X),Q.drawElements(c,le.primitiveLength*W,Q.UNSIGNED_SHORT,le.primitiveOffset*W*2)}}}function Pd(d,n,c){const p=1/yn(c,1,n.transform.tileZoom),g=Math.pow(2,c.tileID.overscaledZ),v=c.tileSize*Math.pow(2,n.transform.tileZoom)/g,T=v*(c.tileID.canonical.x+c.tileID.wrap*g),C=v*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[p,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[T>>16,C>>16],u_pixel_coord_lower:[65535&T,65535&C]}}const Jp=a.create(),Qp=(d,n,c,p,g,v,T,C,I)=>{const L=n.style.light,B=L.properties.get("position"),N=[B.x,B.y,B.z],$=a.create$1();L.properties.get("anchor")==="viewport"&&(a.fromRotation($,-n.transform.angle),a.transformMat3(N,N,$));const Z=L.properties.get("color"),H=n.transform,G={u_matrix:d,u_lightpos:N,u_lightintensity:L.properties.get("intensity"),u_lightcolor:[Z.r,Z.g,Z.b],u_vertical_gradient:+c,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Jp,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0};return H.projection.name==="globe"&&(G.u_tile_id=[g.canonical.x,g.canonical.y,1<<g.canonical.z],G.u_zoom_transition=T,G.u_inv_rot_matrix=I,G.u_merc_center=C,G.u_up_dir=H.projection.upVector(new a.CanonicalTileID(0,0,0),C[0]*a.EXTENT,C[1]*a.EXTENT),G.u_height_lift=v),G},kl=(d,n,c,p,g,v,T,C,I,L,B)=>{const N=Qp(d,n,c,p,g,C,I,L,B),$={u_height_factor:-Math.pow(2,g.overscaledZ)/T.tileSize/8};return a.extend(N,Pd(v,n,T),$)},wa=d=>({u_matrix:d}),Dd=(d,n,c,p)=>a.extend(wa(d),Pd(c,n,p)),yu=(d,n)=>({u_matrix:d,u_world:n}),Ld=(d,n,c,p,g)=>a.extend(Dd(d,n,c,p),{u_world:g}),uo=a.create(),zd=(d,n,c,p,g,v)=>{const T=d.transform,C=T.projection.name==="globe";let I;if(v.paint.get("circle-pitch-alignment")==="map")if(C){const B=a.globePixelsToTileUnits(T.zoom,n.canonical)*T._projectionScaler;I=Float32Array.from([B,0,0,B])}else I=T.calculatePixelsToTileUnitsMatrix(c);else I=new Float32Array([T.pixelsToGLUnits[0],0,0,T.pixelsToGLUnits[1]]);const L={u_camera_to_center_distance:T.cameraToCenterDistance,u_matrix:d.translatePosMatrix(n.projMatrix,c,v.paint.get("circle-translate"),v.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:I,u_inv_rot_matrix:uo,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(C){L.u_inv_rot_matrix=p,L.u_merc_center=g,L.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],L.u_zoom_transition=a.globeToMercatorTransition(T.zoom);const B=g[0]*a.EXTENT,N=g[1]*a.EXTENT;L.u_up_dir=T.projection.upVector(new a.CanonicalTileID(0,0,0),B,N)}return L},em=d=>{const n=[];return d.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),d.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n},Od=(d,n,c,p)=>{const g=a.EXTENT/c.tileSize;return{u_matrix:d,u_camera_to_center_distance:n.getCameraToCenterDistance(p),u_extrude_scale:[n.pixelsToGLUnits[0]/g,n.pixelsToGLUnits[1]/g]}},Rd=(d,n,c=1)=>({u_matrix:d,u_color:n,u_overlay:0,u_overlay_scale:c}),Bd=a.create(),Uy=(d,n,c,p,g,v,T)=>{const C=d.transform,I=C.projection.name==="globe",L=I?a.globePixelsToTileUnits(C.zoom,n.canonical)*C._projectionScaler:yn(c,1,v),B={u_matrix:n.projMatrix,u_extrude_scale:L,u_intensity:T,u_inv_rot_matrix:Bd,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){B.u_inv_rot_matrix=p,B.u_merc_center=g,B.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],B.u_zoom_transition=a.globeToMercatorTransition(C.zoom);const N=g[0]*a.EXTENT,$=g[1]*a.EXTENT;B.u_up_dir=C.projection.upVector(new a.CanonicalTileID(0,0,0),N,$)}return B},Fd=(d,n,c,p,g,v,T,C)=>{const I=d.transform,L=I.calculatePixelsToTileUnitsMatrix(n),B={u_matrix:tm(d,n,c,g),u_pixels_to_tile_units:L,u_device_pixel_ratio:T,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:v,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0,u_trim_offset:C};if(vu(c)){const N=Pl(n,d.transform);B.u_texsize=n.lineAtlasTexture.size,B.u_scale=[N,p.fromScale,p.toScale],B.u_mix=p.t}return B},jy=(d,n,c,p,g,v)=>{const T=d.transform,C=Pl(n,T);return{u_matrix:tm(d,n,c,g),u_texsize:n.imageAtlasTexture.size,u_pixels_to_tile_units:T.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:v,u_image:0,u_scale:[C,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Pl(d,n){return 1/yn(d,1,n.tileZoom)}function tm(d,n,c,p){return d.translatePosMatrix(p||n.tileID.projMatrix,n,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function vu(d){const n=d.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}const Vy=(d,n,c,p,g,v)=>{return{u_matrix:d,u_tl_parent:n,u_scale_parent:c,u_fade_t:p.mix,u_opacity:p.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(C=g.paint.get("raster-saturation"),C>0?1-1/(1.001-C):-C),u_contrast_factor:(T=g.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:Nd(g.paint.get("raster-hue-rotate")),u_perspective_transform:v};var T,C};function Nd(d){d*=Math.PI/180;const n=Math.sin(d),c=Math.cos(d);return[(2*c+1)/3,(-Math.sqrt(3)*n-c+1)/3,(Math.sqrt(3)*n-c+1)/3]}const im=a.create(),Dl=(d,n,c,p,g,v,T,C,I,L,B,N,$,Z,H,G)=>{const ie=g.transform,X={u_is_size_zoom_constant:+(d==="constant"||d==="source"),u_is_size_feature_constant:+(d==="constant"||d==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:ie.cameraToCenterDistance,u_rotate_symbol:+c,u_aspect_ratio:ie.width/ie.height,u_fade_change:g.options.fadeDuration?g.symbolFadeChange:1,u_matrix:v,u_label_plane_matrix:T,u_coord_matrix:C,u_is_text:+I,u_pitch_with_map:+p,u_texsize:L,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:im,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:im,u_up_vector:[0,-1,0]};return G.name==="globe"&&(X.u_tile_id=[B.canonical.x,B.canonical.y,1<<B.canonical.z],X.u_zoom_transition=N,X.u_inv_rot_matrix=Z,X.u_merc_center=$,X.u_camera_forward=ie._camera.forward(),X.u_ecef_origin=a.globeECEFOrigin(ie.globeMatrix,B.toUnwrapped()),X.u_tile_matrix=Float32Array.from(ie.globeMatrix),X.u_up_vector=H),X},nm=(d,n,c,p,g,v,T,C,I,L,B,N,$,Z,H,G,ie)=>a.extend(Dl(d,n,c,p,g,v,T,C,I,L,N,$,Z,H,G,ie),{u_gamma_scale:p?g.transform.cameraToCenterDistance*Math.cos(g.terrain?0:g.transform._pitch):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:+B}),rm=(d,n,c,p,g,v,T,C,I,L,B,N,$,Z,H,G)=>a.extend(nm(d,n,c,p,g,v,T,C,!0,I,!0,B,N,$,Z,H,G),{u_texsize_icon:L,u_texture_icon:1}),om=(d,n,c)=>({u_matrix:d,u_opacity:n,u_color:c}),Ea=(d,n,c,p,g,v)=>a.extend(function(T,C,I,L){const B=I.imageManager.getPattern(T.from.toString()),N=I.imageManager.getPattern(T.to.toString()),{width:$,height:Z}=I.imageManager.getPixelSize(),H=Math.pow(2,L.tileID.overscaledZ),G=L.tileSize*Math.pow(2,I.transform.tileZoom)/H,ie=G*(L.tileID.canonical.x+L.tileID.wrap*H),X=G*L.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:B.tl,u_pattern_br_a:B.br,u_pattern_tl_b:N.tl,u_pattern_br_b:N.br,u_texsize:[$,Z],u_mix:C.t,u_pattern_size_a:B.displaySize,u_pattern_size_b:N.displaySize,u_scale_a:C.fromScale,u_scale_b:C.toScale,u_tile_units_to_pixels:1/yn(L,1,I.transform.tileZoom),u_pixel_coord_upper:[ie>>16,X>>16],u_pixel_coord_lower:[65535&ie,65535&X]}}(p,v,c,g),{u_matrix:d,u_opacity:n}),$y={fillExtrusion:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_lightpos:new a.Uniform3f(d,n.u_lightpos),u_lightintensity:new a.Uniform1f(d,n.u_lightintensity),u_lightcolor:new a.Uniform3f(d,n.u_lightcolor),u_vertical_gradient:new a.Uniform1f(d,n.u_vertical_gradient),u_opacity:new a.Uniform1f(d,n.u_opacity),u_tile_id:new a.Uniform3f(d,n.u_tile_id),u_zoom_transition:new a.Uniform1f(d,n.u_zoom_transition),u_inv_rot_matrix:new a.UniformMatrix4f(d,n.u_inv_rot_matrix),u_merc_center:new a.Uniform2f(d,n.u_merc_center),u_up_dir:new a.Uniform3f(d,n.u_up_dir),u_height_lift:new a.Uniform1f(d,n.u_height_lift)}),fillExtrusionPattern:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_lightpos:new a.Uniform3f(d,n.u_lightpos),u_lightintensity:new a.Uniform1f(d,n.u_lightintensity),u_lightcolor:new a.Uniform3f(d,n.u_lightcolor),u_vertical_gradient:new a.Uniform1f(d,n.u_vertical_gradient),u_height_factor:new a.Uniform1f(d,n.u_height_factor),u_tile_id:new a.Uniform3f(d,n.u_tile_id),u_zoom_transition:new a.Uniform1f(d,n.u_zoom_transition),u_inv_rot_matrix:new a.UniformMatrix4f(d,n.u_inv_rot_matrix),u_merc_center:new a.Uniform2f(d,n.u_merc_center),u_up_dir:new a.Uniform3f(d,n.u_up_dir),u_height_lift:new a.Uniform1f(d,n.u_height_lift),u_image:new a.Uniform1i(d,n.u_image),u_texsize:new a.Uniform2f(d,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(d,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(d,n.u_scale),u_fade:new a.Uniform1f(d,n.u_fade),u_opacity:new a.Uniform1f(d,n.u_opacity)}),fill:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix)}),fillPattern:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_image:new a.Uniform1i(d,n.u_image),u_texsize:new a.Uniform2f(d,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(d,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(d,n.u_scale),u_fade:new a.Uniform1f(d,n.u_fade)}),fillOutline:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_world:new a.Uniform2f(d,n.u_world)}),fillOutlinePattern:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_world:new a.Uniform2f(d,n.u_world),u_image:new a.Uniform1i(d,n.u_image),u_texsize:new a.Uniform2f(d,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(d,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(d,n.u_scale),u_fade:new a.Uniform1f(d,n.u_fade)}),circle:(d,n)=>({u_camera_to_center_distance:new a.Uniform1f(d,n.u_camera_to_center_distance),u_extrude_scale:new a.UniformMatrix2f(d,n.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(d,n.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_inv_rot_matrix:new a.UniformMatrix4f(d,n.u_inv_rot_matrix),u_merc_center:new a.Uniform2f(d,n.u_merc_center),u_tile_id:new a.Uniform3f(d,n.u_tile_id),u_zoom_transition:new a.Uniform1f(d,n.u_zoom_transition),u_up_dir:new a.Uniform3f(d,n.u_up_dir)}),collisionBox:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_camera_to_center_distance:new a.Uniform1f(d,n.u_camera_to_center_distance),u_extrude_scale:new a.Uniform2f(d,n.u_extrude_scale)}),collisionCircle:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_inv_matrix:new a.UniformMatrix4f(d,n.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(d,n.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(d,n.u_viewport_size)}),debug:(d,n)=>({u_color:new a.UniformColor(d,n.u_color),u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_overlay:new a.Uniform1i(d,n.u_overlay),u_overlay_scale:new a.Uniform1f(d,n.u_overlay_scale)}),clippingMask:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix)}),heatmap:(d,n)=>({u_extrude_scale:new a.Uniform1f(d,n.u_extrude_scale),u_intensity:new a.Uniform1f(d,n.u_intensity),u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_inv_rot_matrix:new a.UniformMatrix4f(d,n.u_inv_rot_matrix),u_merc_center:new a.Uniform2f(d,n.u_merc_center),u_tile_id:new a.Uniform3f(d,n.u_tile_id),u_zoom_transition:new a.Uniform1f(d,n.u_zoom_transition),u_up_dir:new a.Uniform3f(d,n.u_up_dir)}),heatmapTexture:(d,n)=>({u_image:new a.Uniform1i(d,n.u_image),u_color_ramp:new a.Uniform1i(d,n.u_color_ramp),u_opacity:new a.Uniform1f(d,n.u_opacity)}),hillshade:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_image:new a.Uniform1i(d,n.u_image),u_latrange:new a.Uniform2f(d,n.u_latrange),u_light:new a.Uniform2f(d,n.u_light),u_shadow:new a.UniformColor(d,n.u_shadow),u_highlight:new a.UniformColor(d,n.u_highlight),u_accent:new a.UniformColor(d,n.u_accent)}),hillshadePrepare:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_image:new a.Uniform1i(d,n.u_image),u_dimension:new a.Uniform2f(d,n.u_dimension),u_zoom:new a.Uniform1f(d,n.u_zoom),u_unpack:new a.Uniform4f(d,n.u_unpack)}),line:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_pixels_to_tile_units:new a.UniformMatrix2f(d,n.u_pixels_to_tile_units),u_device_pixel_ratio:new a.Uniform1f(d,n.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(d,n.u_units_to_pixels),u_dash_image:new a.Uniform1i(d,n.u_dash_image),u_gradient_image:new a.Uniform1i(d,n.u_gradient_image),u_image_height:new a.Uniform1f(d,n.u_image_height),u_texsize:new a.Uniform2f(d,n.u_texsize),u_scale:new a.Uniform3f(d,n.u_scale),u_mix:new a.Uniform1f(d,n.u_mix),u_alpha_discard_threshold:new a.Uniform1f(d,n.u_alpha_discard_threshold),u_trim_offset:new a.Uniform2f(d,n.u_trim_offset)}),linePattern:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_texsize:new a.Uniform2f(d,n.u_texsize),u_pixels_to_tile_units:new a.UniformMatrix2f(d,n.u_pixels_to_tile_units),u_device_pixel_ratio:new a.Uniform1f(d,n.u_device_pixel_ratio),u_image:new a.Uniform1i(d,n.u_image),u_units_to_pixels:new a.Uniform2f(d,n.u_units_to_pixels),u_scale:new a.Uniform3f(d,n.u_scale),u_fade:new a.Uniform1f(d,n.u_fade),u_alpha_discard_threshold:new a.Uniform1f(d,n.u_alpha_discard_threshold)}),raster:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_tl_parent:new a.Uniform2f(d,n.u_tl_parent),u_scale_parent:new a.Uniform1f(d,n.u_scale_parent),u_fade_t:new a.Uniform1f(d,n.u_fade_t),u_opacity:new a.Uniform1f(d,n.u_opacity),u_image0:new a.Uniform1i(d,n.u_image0),u_image1:new a.Uniform1i(d,n.u_image1),u_brightness_low:new a.Uniform1f(d,n.u_brightness_low),u_brightness_high:new a.Uniform1f(d,n.u_brightness_high),u_saturation_factor:new a.Uniform1f(d,n.u_saturation_factor),u_contrast_factor:new a.Uniform1f(d,n.u_contrast_factor),u_spin_weights:new a.Uniform3f(d,n.u_spin_weights),u_perspective_transform:new a.Uniform2f(d,n.u_perspective_transform)}),symbolIcon:(d,n)=>({u_is_size_zoom_constant:new a.Uniform1i(d,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(d,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(d,n.u_size_t),u_size:new a.Uniform1f(d,n.u_size),u_camera_to_center_distance:new a.Uniform1f(d,n.u_camera_to_center_distance),u_rotate_symbol:new a.Uniform1i(d,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(d,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(d,n.u_fade_change),u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(d,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(d,n.u_coord_matrix),u_is_text:new a.Uniform1i(d,n.u_is_text),u_pitch_with_map:new a.Uniform1i(d,n.u_pitch_with_map),u_texsize:new a.Uniform2f(d,n.u_texsize),u_tile_id:new a.Uniform3f(d,n.u_tile_id),u_zoom_transition:new a.Uniform1f(d,n.u_zoom_transition),u_inv_rot_matrix:new a.UniformMatrix4f(d,n.u_inv_rot_matrix),u_merc_center:new a.Uniform2f(d,n.u_merc_center),u_camera_forward:new a.Uniform3f(d,n.u_camera_forward),u_tile_matrix:new a.UniformMatrix4f(d,n.u_tile_matrix),u_up_vector:new a.Uniform3f(d,n.u_up_vector),u_ecef_origin:new a.Uniform3f(d,n.u_ecef_origin),u_texture:new a.Uniform1i(d,n.u_texture)}),symbolSDF:(d,n)=>({u_is_size_zoom_constant:new a.Uniform1i(d,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(d,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(d,n.u_size_t),u_size:new a.Uniform1f(d,n.u_size),u_camera_to_center_distance:new a.Uniform1f(d,n.u_camera_to_center_distance),u_rotate_symbol:new a.Uniform1i(d,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(d,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(d,n.u_fade_change),u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(d,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(d,n.u_coord_matrix),u_is_text:new a.Uniform1i(d,n.u_is_text),u_pitch_with_map:new a.Uniform1i(d,n.u_pitch_with_map),u_texsize:new a.Uniform2f(d,n.u_texsize),u_texture:new a.Uniform1i(d,n.u_texture),u_gamma_scale:new a.Uniform1f(d,n.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(d,n.u_device_pixel_ratio),u_tile_id:new a.Uniform3f(d,n.u_tile_id),u_zoom_transition:new a.Uniform1f(d,n.u_zoom_transition),u_inv_rot_matrix:new a.UniformMatrix4f(d,n.u_inv_rot_matrix),u_merc_center:new a.Uniform2f(d,n.u_merc_center),u_camera_forward:new a.Uniform3f(d,n.u_camera_forward),u_tile_matrix:new a.UniformMatrix4f(d,n.u_tile_matrix),u_up_vector:new a.Uniform3f(d,n.u_up_vector),u_ecef_origin:new a.Uniform3f(d,n.u_ecef_origin),u_is_halo:new a.Uniform1i(d,n.u_is_halo)}),symbolTextAndIcon:(d,n)=>({u_is_size_zoom_constant:new a.Uniform1i(d,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(d,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(d,n.u_size_t),u_size:new a.Uniform1f(d,n.u_size),u_camera_to_center_distance:new a.Uniform1f(d,n.u_camera_to_center_distance),u_rotate_symbol:new a.Uniform1i(d,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(d,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(d,n.u_fade_change),u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(d,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(d,n.u_coord_matrix),u_is_text:new a.Uniform1i(d,n.u_is_text),u_pitch_with_map:new a.Uniform1i(d,n.u_pitch_with_map),u_texsize:new a.Uniform2f(d,n.u_texsize),u_texsize_icon:new a.Uniform2f(d,n.u_texsize_icon),u_texture:new a.Uniform1i(d,n.u_texture),u_texture_icon:new a.Uniform1i(d,n.u_texture_icon),u_gamma_scale:new a.Uniform1f(d,n.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(d,n.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(d,n.u_is_halo)}),background:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_opacity:new a.Uniform1f(d,n.u_opacity),u_color:new a.UniformColor(d,n.u_color)}),backgroundPattern:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_opacity:new a.Uniform1f(d,n.u_opacity),u_image:new a.Uniform1i(d,n.u_image),u_pattern_tl_a:new a.Uniform2f(d,n.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(d,n.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(d,n.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(d,n.u_pattern_br_b),u_texsize:new a.Uniform2f(d,n.u_texsize),u_mix:new a.Uniform1f(d,n.u_mix),u_pattern_size_a:new a.Uniform2f(d,n.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(d,n.u_pattern_size_b),u_scale_a:new a.Uniform1f(d,n.u_scale_a),u_scale_b:new a.Uniform1f(d,n.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(d,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,n.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(d,n.u_tile_units_to_pixels)}),terrainRaster:fu,terrainDepth:fu,skybox:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_sun_direction:new a.Uniform3f(d,n.u_sun_direction),u_cubemap:new a.Uniform1i(d,n.u_cubemap),u_opacity:new a.Uniform1f(d,n.u_opacity),u_temporal_offset:new a.Uniform1f(d,n.u_temporal_offset)}),skyboxGradient:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_color_ramp:new a.Uniform1i(d,n.u_color_ramp),u_center_direction:new a.Uniform3f(d,n.u_center_direction),u_radius:new a.Uniform1f(d,n.u_radius),u_opacity:new a.Uniform1f(d,n.u_opacity),u_temporal_offset:new a.Uniform1f(d,n.u_temporal_offset)}),skyboxCapture:(d,n)=>({u_matrix_3f:new a.UniformMatrix3f(d,n.u_matrix_3f),u_sun_direction:new a.Uniform3f(d,n.u_sun_direction),u_sun_intensity:new a.Uniform1f(d,n.u_sun_intensity),u_color_tint_r:new a.Uniform4f(d,n.u_color_tint_r),u_color_tint_m:new a.Uniform4f(d,n.u_color_tint_m),u_luminance:new a.Uniform1f(d,n.u_luminance)}),globeRaster:(d,n)=>({u_proj_matrix:new a.UniformMatrix4f(d,n.u_proj_matrix),u_globe_matrix:new a.UniformMatrix4f(d,n.u_globe_matrix),u_normalize_matrix:new a.UniformMatrix4f(d,n.u_normalize_matrix),u_merc_matrix:new a.UniformMatrix4f(d,n.u_merc_matrix),u_zoom_transition:new a.Uniform1f(d,n.u_zoom_transition),u_merc_center:new a.Uniform2f(d,n.u_merc_center),u_image0:new a.Uniform1i(d,n.u_image0),u_grid_matrix:new a.UniformMatrix3f(d,n.u_grid_matrix),u_frustum_tl:new a.Uniform3f(d,n.u_frustum_tl),u_frustum_tr:new a.Uniform3f(d,n.u_frustum_tr),u_frustum_br:new a.Uniform3f(d,n.u_frustum_br),u_frustum_bl:new a.Uniform3f(d,n.u_frustum_bl),u_globe_pos:new a.Uniform3f(d,n.u_globe_pos),u_globe_radius:new a.Uniform1f(d,n.u_globe_radius),u_viewport:new a.Uniform2f(d,n.u_viewport)}),globeAtmosphere:(d,n)=>({u_frustum_tl:new a.Uniform3f(d,n.u_frustum_tl),u_frustum_tr:new a.Uniform3f(d,n.u_frustum_tr),u_frustum_br:new a.Uniform3f(d,n.u_frustum_br),u_frustum_bl:new a.Uniform3f(d,n.u_frustum_bl),u_horizon:new a.Uniform1f(d,n.u_horizon),u_transition:new a.Uniform1f(d,n.u_transition),u_fadeout_range:new a.Uniform1f(d,n.u_fadeout_range),u_color:new a.Uniform4f(d,n.u_color),u_high_color:new a.Uniform4f(d,n.u_high_color),u_space_color:new a.Uniform4f(d,n.u_space_color),u_star_intensity:new a.Uniform1f(d,n.u_star_intensity),u_star_density:new a.Uniform1f(d,n.u_star_density),u_star_size:new a.Uniform1f(d,n.u_star_size),u_temporal_offset:new a.Uniform1f(d,n.u_temporal_offset),u_horizon_angle:new a.Uniform1f(d,n.u_horizon_angle),u_rotation_matrix:new a.UniformMatrix4f(d,n.u_rotation_matrix)})};let xu;function sm(d,n,c,p,g,v,T){const C=d.context,I=C.gl,L=d.transform,B=d.useProgram("collisionBox"),N=[];let $=0,Z=0;for(let le=0;le<p.length;le++){const te=p[le],ne=n.getTile(te),_e=ne.getBucket(c);if(!_e)continue;const Me=kr(te,_e,L);let De=Me;g[0]===0&&g[1]===0||(De=d.translatePosMatrix(Me,ne,g,v));const Ie=T?_e.textCollisionBox:_e.iconCollisionBox,Je=_e.collisionCircleArray;if(Je.length>0){const ae=a.create(),Ce=De;a.mul(ae,_e.placementInvProjMatrix,L.glCoordMatrix),a.mul(ae,ae,_e.placementViewportMatrix),N.push({circleArray:Je,circleOffset:Z,transform:Ce,invTransform:ae,projection:_e.getProjection()}),$+=Je.length/4,Z=$}Ie&&(d.terrain&&d.terrain.setupElevationDraw(ne,B),B.draw(C,I.LINES,a.DepthMode.disabled,a.StencilMode.disabled,d.colorModeForRenderPass(),a.CullFaceMode.disabled,Od(De,L,ne,_e.getProjection()),c.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ie.segments,null,L.zoom,null,Ie.collisionVertexBuffer,Ie.collisionVertexBufferExt))}if(!T||!N.length)return;const H=d.useProgram("collisionCircle"),G=new a.StructArrayLayout2f1f2i16;G.resize(4*$),G._trim();let ie=0;for(const le of N)for(let te=0;te<le.circleArray.length/4;te++){const ne=4*te,_e=le.circleArray[ne+0],Me=le.circleArray[ne+1],De=le.circleArray[ne+2],Ie=le.circleArray[ne+3];G.emplace(ie++,_e,Me,De,Ie,0),G.emplace(ie++,_e,Me,De,Ie,1),G.emplace(ie++,_e,Me,De,Ie,2),G.emplace(ie++,_e,Me,De,Ie,3)}(!xu||xu.length<2*$)&&(xu=function(le){const te=2*le,ne=new a.StructArrayLayout3ui6;ne.resize(te),ne._trim();for(let _e=0;_e<te;_e++){const Me=6*_e;ne.uint16[Me+0]=4*_e+0,ne.uint16[Me+1]=4*_e+1,ne.uint16[Me+2]=4*_e+2,ne.uint16[Me+3]=4*_e+2,ne.uint16[Me+4]=4*_e+3,ne.uint16[Me+5]=4*_e+0}return ne}($));const X=C.createIndexBuffer(xu,!0),Q=C.createVertexBuffer(G,a.collisionCircleLayout.members,!0);for(const le of N){const te={u_matrix:le.transform,u_inv_matrix:le.invTransform,u_camera_to_center_distance:(W=L).getCameraToCenterDistance(le.projection),u_viewport_size:[W.width,W.height]};H.draw(C,I.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,d.colorModeForRenderPass(),a.CullFaceMode.disabled,te,c.id,Q,X,a.SegmentVector.simpleSegment(0,2*le.circleOffset,le.circleArray.length,le.circleArray.length/2),null,L.zoom)}var W;Q.destroy(),X.destroy()}const am=a.create();function Gy(d,n,c,p,g,v){const{horizontalAlign:T,verticalAlign:C}=a.getAnchorAlignment(d),I=-(T-.5)*n,L=-(C-.5)*c,B=a.evaluateVariableOffset(d,p);return new a.pointGeometry((I/g+B[0])*v,(L/g+B[1])*v)}function qy(d,n,c,p,g,v,T,C,I,L,B){const N=d.text.placedSymbolArray,$=d.text.dynamicLayoutVertexArray,Z=d.icon.dynamicLayoutVertexArray,H={},G=ou(C,d.getProjection(),v),ie=v.elevation,X=d.getProjection().upVectorScale(C.canonical,v.center.lat,v.worldSize);$.clear();for(let Q=0;Q<N.length;Q++){const W=N.get(Q),le=d.allowVerticalPlacement&&!W.placedOrientation,te=W.hidden||!W.crossTileID||le?null:p[W.crossTileID];if(te){const ne=new a.pointGeometry(W.tileAnchorX,W.tileAnchorY),_e=d.getProjection().upVector(C.canonical,ne.x,ne.y),Me=ie?ie.getAtTileOffset(C,ne.x,ne.y):0,De=zo([W.projectedAnchorX+Me*_e[0]*X.metersToTile,W.projectedAnchorY+Me*_e[1]*X.metersToTile,W.projectedAnchorZ+Me*_e[2]*X.metersToTile],c?G:T),Ie=pa(v.getCameraToCenterDistance(d.getProjection()),De.signedDistanceFromCamera);let Je=g.evaluateSizeForFeature(d.textSizeData,L,W)*Ie/a.ONE_EM;c&&(Je*=d.tilePixelRatio/I);const{width:ae,height:Ce,anchor:Re,textOffset:ot,textScale:Oe}=te,gt=Gy(Re,ae,Ce,ot,Oe,Je);let tt;if(c){const at=ne.add(gt),{x:nt,y:_t,z:Bt}=d.getProjection().projectTilePoint(at.x,at.y,C.canonical);tt=zo([nt+Me*_e[0]*X.metersToTile,_t+Me*_e[1]*X.metersToTile,Bt+Me*_e[2]*X.metersToTile],T).point}else{const at=n?gt.rotate(-v.angle):gt;tt=[De.point[0]+at.x,De.point[1]+at.y,0]}const st=d.allowVerticalPlacement&&W.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let at=0;at<W.numGlyphs;at++)a.addDynamicAttributes($,tt[0],tt[1],tt[2],st);B&&W.associatedIconIndex>=0&&(H[W.associatedIconIndex]={shiftedAnchor:tt,angle:st})}else En(W.numGlyphs,$)}if(B){Z.clear();const Q=d.icon.placedSymbolArray;for(let W=0;W<Q.length;W++){const le=Q.get(W);if(le.hidden)En(le.numGlyphs,Z);else{const te=H[W];if(te)for(let ne=0;ne<le.numGlyphs;ne++)a.addDynamicAttributes(Z,te.shiftedAnchor[0],te.shiftedAnchor[1],te.shiftedAnchor[2],te.angle);else En(le.numGlyphs,Z)}}d.icon.dynamicLayoutVertexBuffer.updateData(Z)}d.text.dynamicLayoutVertexBuffer.updateData($)}function Ud(d,n,c){return c.iconsInText&&n?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function bu(d,n,c,p,g,v,T,C,I,L,B,N){const $=d.context,Z=$.gl,H=d.transform,G=C==="map",ie=I==="map",X=G&&c.layout.get("symbol-placement")!=="point",Q=G&&!ie&&!X,W=c.layout.get("symbol-sort-key").constantOr(1)!==void 0;let le=!1;const te=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),ne=[a.mercatorXfromLng(H.center.lng),a.mercatorYfromLat(H.center.lat)],_e=c.layout.get("text-variable-anchor"),Me=H.projection.name==="globe",De=[],Ie=[0,-1,0];let Je=Ie;!Me&&!H.mercatorFromTransition||G||(Je=function(ae){const Ce=ae._camera.getWorldToCamera(ae.worldSize,1),Re=a.multiply([],Ce,ae.globeMatrix);a.invert(Re,Re);const ot=[0,0,0],Oe=[0,1,0,0];return a.transformMat4$1(Oe,Oe,Re),ot[0]=Oe[0],ot[1]=Oe[1],ot[2]=Oe[2],a.normalize(ot,ot),ot}(H));for(const ae of p){const Ce=n.getTile(ae),Re=Ce.getBucket(c);if(!Re||Re.projection.name==="mercator"&&Me)continue;const ot=g?Re.text:Re.icon;if(!ot||Re.fullyClipped||!ot.segments.get().length)continue;const Oe=ot.programConfigurations.get(c.id),gt=g||Re.sdfIcons,tt=g?Re.textSizeData:Re.iconSizeData,st=ie||H.pitch!==0,at=a.evaluateSizeForZoom(tt,H.zoom);let nt,_t,Bt,$t,Ct=[0,0],Ut=null;if(g){if(_t=Ce.glyphAtlasTexture,Bt=Z.LINEAR,nt=Ce.glyphAtlasTexture.size,Re.iconsInText){Ct=Ce.imageAtlasTexture.size,Ut=Ce.imageAtlasTexture;const Gn=tt.kind==="composite"||tt.kind==="camera";$t=st||d.options.rotating||d.options.zooming||Gn?Z.LINEAR:Z.NEAREST}}else{const Gn=c.layout.get("icon-size").constantOr(0)!==1||Re.iconsNeedLinear;_t=Ce.imageAtlasTexture,Bt=gt||d.options.rotating||d.options.zooming||Gn||st?Z.LINEAR:Z.NEAREST,nt=Ce.imageAtlasTexture.size}const ki=Re.projection.name==="globe",Ui=ki?Je:Ie,Ki=ki?a.globeToMercatorTransition(H.zoom):0,zi=ou(ae,Re.getProjection(),H),or=H.calculatePixelsToTileUnitsMatrix(Ce),fo=Xt(zi,Ce.tileID.canonical,ie,G,H,Re.getProjection(),or),Fo=d.terrain&&ie&&X?a.invert(a.create(),fo):am,Hi=Ds(zi,Ce.tileID.canonical,ie,G,H,Re.getProjection(),or),tn=_e&&Re.hasTextData(),Ci=c.layout.get("icon-text-fit")!=="none"&&tn&&Re.hasIconData();if(X){const Gn=H.elevation,yr=Gn?Gn.getAtTileOffsetFunc(ae,H.center.lat,H.worldSize,Re.getProjection()):qs=>[0,0,0],mo=Kr(zi,Ce.tileID.canonical,ie,G,H,Re.getProjection(),or);Ir(Re,zi,d,g,mo,Hi,ie,L,yr,ae)}const vn=X||g&&_e||Ci,$n=d.translatePosMatrix(zi,Ce,v,T),ji=vn?am:fo,ln=d.translatePosMatrix(Hi,Ce,v,T,!0),$s=Re.getProjection().createInversionMatrix(H,ae.canonical),po=[];d.terrain&&ie&&po.push("PITCH_WITH_MAP_TERRAIN"),ki&&po.push("PROJECTION_GLOBE_VIEW"),vn&&po.push("PROJECTED_POS_ON_VIEWPORT");const Da=gt&&c.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Gs;Gs=gt?Re.iconsInText?rm(tt.kind,at,Q,ie,d,$n,ji,ln,nt,Ct,ae,Ki,ne,$s,Ui,Re.getProjection()):nm(tt.kind,at,Q,ie,d,$n,ji,ln,g,nt,!0,ae,Ki,ne,$s,Ui,Re.getProjection()):Dl(tt.kind,at,Q,ie,d,$n,ji,ln,g,nt,ae,Ki,ne,$s,Ui,Re.getProjection());const is={program:d.useProgram(Ud(gt,g,Re),Oe,po),buffers:ot,uniformValues:Gs,atlasTexture:_t,atlasTextureIcon:Ut,atlasInterpolation:Bt,atlasInterpolationIcon:$t,isSDF:gt,hasHalo:Da,tile:Ce,labelPlaneMatrixInv:Fo};if(W&&Re.canOverlap){le=!0;const Gn=ot.segments.get();for(const yr of Gn)De.push({segments:new a.SegmentVector([yr]),sortKey:yr.sortKey,state:is})}else De.push({segments:ot.segments,sortKey:0,state:is})}le&&De.sort((ae,Ce)=>ae.sortKey-Ce.sortKey);for(const ae of De){const Ce=ae.state;if(d.terrain&&d.terrain.setupElevationDraw(Ce.tile,Ce.program,{useDepthForOcclusion:!Me,labelPlaneMatrixInv:Ce.labelPlaneMatrixInv}),$.activeTexture.set(Z.TEXTURE0),Ce.atlasTexture.bind(Ce.atlasInterpolation,Z.CLAMP_TO_EDGE),Ce.atlasTextureIcon&&($.activeTexture.set(Z.TEXTURE1),Ce.atlasTextureIcon&&Ce.atlasTextureIcon.bind(Ce.atlasInterpolationIcon,Z.CLAMP_TO_EDGE)),Ce.isSDF){const Re=Ce.uniformValues;Ce.hasHalo&&(Re.u_is_halo=1,jd(Ce.buffers,ae.segments,c,d,Ce.program,te,B,N,Re)),Re.u_is_halo=0}jd(Ce.buffers,ae.segments,c,d,Ce.program,te,B,N,Ce.uniformValues)}}function jd(d,n,c,p,g,v,T,C,I){const L=p.context;g.draw(L,L.gl.TRIANGLES,v,T,C,a.CullFaceMode.disabled,I,c.id,d.layoutVertexBuffer,d.indexBuffer,n,c.paint,p.transform.zoom,d.programConfigurations.get(c.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer,d.globeExtVertexBuffer)}function Vd(d,n,c,p,g,v,T){const C=d.context.gl,I=c.paint.get("fill-pattern"),L=I&&I.constantOr(1),B=c.getCrossfadeParameters();let N,$,Z,H,G;T?($=L&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=C.LINES):($=L?"fillPattern":"fill",N=C.TRIANGLES);for(const ie of p){const X=n.getTile(ie);if(L&&!X.patternsLoaded())continue;const Q=X.getBucket(c);if(!Q)continue;d.prepareDrawTile();const W=Q.programConfigurations.get(c.id),le=d.useProgram($,W);L&&(d.context.activeTexture.set(C.TEXTURE0),X.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),W.updatePaintBuffers(B));const te=I.constantOr(null);if(te&&X.imageAtlas){const _e=X.imageAtlas,Me=_e.patternPositions[te.to.toString()],De=_e.patternPositions[te.from.toString()];Me&&De&&W.setConstantPatternPositions(Me,De)}const ne=d.translatePosMatrix(ie.projMatrix,X,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(T){H=Q.indexBuffer2,G=Q.segments2;const _e=d.terrain&&d.terrain.renderingToTexture?d.terrain.drapeBufferSize:[C.drawingBufferWidth,C.drawingBufferHeight];Z=$==="fillOutlinePattern"&&L?Ld(ne,d,B,X,_e):yu(ne,_e)}else H=Q.indexBuffer,G=Q.segments,Z=L?Dd(ne,d,B,X):wa(ne);d.prepareDrawProgram(d.context,le,ie.toUnwrapped()),le.draw(d.context,N,g,d.stencilModeForClipping(ie),v,a.CullFaceMode.disabled,Z,c.id,Q.layoutVertexBuffer,H,G,c.paint,d.transform.zoom,W)}}function wu(d,n,c,p,g,v,T){const C=d.context,I=C.gl,L=d.transform,B=c.paint.get("fill-extrusion-pattern"),N=B.constantOr(1),$=c.getCrossfadeParameters(),Z=c.paint.get("fill-extrusion-opacity"),H=L.projection.name==="globe"?a.fillExtrusionHeightLift():0,G=L.projection.name==="globe",ie=G?a.globeToMercatorTransition(L.zoom):0,X=[a.mercatorXfromLng(L.center.lng),a.mercatorYfromLat(L.center.lat)],Q=[];G&&Q.push("PROJECTION_GLOBE_VIEW");for(const W of p){const le=n.getTile(W),te=le.getBucket(c);if(!te||te.projection.name!==L.projection.name)continue;const ne=te.programConfigurations.get(c.id),_e=d.useProgram(N?"fillExtrusionPattern":"fillExtrusion",ne,Q);if(d.terrain){const Ce=d.terrain;if(d.style.terrainSetForDrapingOnly())Ce.setupElevationDraw(le,_e,{useMeterToDem:!0});else{if(!te.enableTerrain)continue;if(Ce.setupElevationDraw(le,_e,{useMeterToDem:!0}),$d(C,n,W,te,c,Ce),!te.centroidVertexBuffer){const Re=_e.attributes.a_centroid_pos;Re!==void 0&&I.vertexAttrib2f(Re,0,0)}}}N&&(d.context.activeTexture.set(I.TEXTURE0),le.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),ne.updatePaintBuffers($));const Me=B.constantOr(null);if(Me&&le.imageAtlas){const Ce=le.imageAtlas,Re=Ce.patternPositions[Me.to.toString()],ot=Ce.patternPositions[Me.from.toString()];Re&&ot&&ne.setConstantPatternPositions(Re,ot)}const De=d.translatePosMatrix(W.projMatrix,le,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),Ie=L.projection.createInversionMatrix(L,W.canonical),Je=c.paint.get("fill-extrusion-vertical-gradient"),ae=N?kl(De,d,Je,Z,W,$,le,H,ie,X,Ie):Qp(De,d,Je,Z,W,H,ie,X,Ie);d.prepareDrawProgram(C,_e,W.toUnwrapped()),_e.draw(C,C.gl.TRIANGLES,g,v,T,a.CullFaceMode.backCCW,ae,c.id,te.layoutVertexBuffer,te.indexBuffer,te.segments,c.paint,d.transform.zoom,ne,d.terrain?te.centroidVertexBuffer:null,G?te.layoutVertexExtBuffer:null)}}function $d(d,n,c,p,g,v){const T=[X=>{let Q=X.canonical.x-1,W=X.wrap;return Q<0&&(Q=(1<<X.canonical.z)-1,W--),new a.OverscaledTileID(X.overscaledZ,W,X.canonical.z,Q,X.canonical.y)},X=>{let Q=X.canonical.x+1,W=X.wrap;return Q===1<<X.canonical.z&&(Q=0,W++),new a.OverscaledTileID(X.overscaledZ,W,X.canonical.z,Q,X.canonical.y)},X=>new a.OverscaledTileID(X.overscaledZ,X.wrap,X.canonical.z,X.canonical.x,(X.canonical.y===0?1<<X.canonical.z:X.canonical.y)-1),X=>new a.OverscaledTileID(X.overscaledZ,X.wrap,X.canonical.z,X.canonical.x,X.canonical.y===(1<<X.canonical.z)-1?0:X.canonical.y+1)],C=X=>{const Q=n.getSource().minzoom,W=te=>{const ne=n.getTileByID(te);if(ne&&ne.hasData())return ne.getBucket(g)},le=[0,-1,1];for(const te of le){if(X.overscaledZ+te<Q)continue;const ne=W(X.calculateScaledKey(X.overscaledZ+te));if(ne)return ne}},I=[0,0,0],L=(X,Q)=>(I[0]=Math.min(X.min.y,Q.min.y),I[1]=Math.max(X.max.y,Q.max.y),I[2]=a.EXTENT-Q.min.x>X.max.x?Q.min.x-a.EXTENT:X.max.x,I),B=(X,Q)=>(I[0]=Math.min(X.min.x,Q.min.x),I[1]=Math.max(X.max.x,Q.max.x),I[2]=a.EXTENT-Q.min.y>X.max.y?Q.min.y-a.EXTENT:X.max.y,I),N=[(X,Q)=>L(X,Q),(X,Q)=>L(Q,X),(X,Q)=>B(X,Q),(X,Q)=>B(Q,X)],$=new a.pointGeometry(0,0);let Z,H,G;const ie=(X,Q,W,le,te)=>{const ne=[[le?W:X,le?X:W,0],[le?W:Q,le?Q:W,0]],_e=te<0?a.EXTENT+te:te,Me=[le?_e:(X+Q)/2,le?(X+Q)/2:_e,0];return W===0&&te<0||W!==0&&te>0?v.getForTilePoints(G,[Me],!0,H):ne.push(Me),v.getForTilePoints(c,ne,!0,Z),Math.max(ne[0][2],ne[1][2],Me[2])/v.exaggeration()};for(let X=0;X<4;X++){const Q=(X<2?1:5)-X,W=p.borders[X];if(W.length===0)continue;const le=G=T[X](c),te=C(le);if(!(te&&te instanceof a.FillExtrusionBucket&&te.enableTerrain)||p.borderDoneWithNeighborZ[X]===te.canonical.z&&te.borderDoneWithNeighborZ[Q]===p.canonical.z||(H=v.findDEMTileFor(le),!H||!H.dem))continue;if(!Z){const De=v.findDEMTileFor(c);if(!De||!De.dem)return;Z=De}const ne=te.borders[Q];let _e=0;const Me=te.borderDoneWithNeighborZ[Q]!==p.canonical.z;if(p.canonical.z===te.canonical.z){for(let De=0;De<W.length;De++){const Ie=p.featuresOnBorder[W[De]],Je=Ie.borders[X];let ae;for(;_e<ne.length&&(ae=te.featuresOnBorder[ne[_e]],!(ae.borders[Q][1]>Je[0]+3));)Me&&te.encodeCentroid(void 0,ae,!1),_e++;if(ae&&_e<ne.length){const Ce=_e;let Re=0;for(;!(ae.borders[Q][0]>Je[1]-3)&&(Re++,++_e!==ne.length);)ae=te.featuresOnBorder[ne[_e]];if(ae=te.featuresOnBorder[ne[Ce]],Ie.intersectsCount()>1||ae.intersectsCount()>1||Re!==1){Re!==1&&(_e=Ce),p.encodeCentroid(void 0,Ie,!1),Me&&te.encodeCentroid(void 0,ae,!1);continue}const ot=N[X](Ie,ae),Oe=X%2?a.EXTENT-1:0;$.x=ie(ot[0],Math.min(a.EXTENT-1,ot[1]),Oe,X<2,ot[2]),$.y=0,p.encodeCentroid($,Ie,!1),Me&&te.encodeCentroid($,ae,!1)}else p.encodeCentroid(void 0,Ie,!1)}p.borderDoneWithNeighborZ[X]=te.canonical.z,p.needsCentroidUpdate=!0,Me&&(te.borderDoneWithNeighborZ[Q]=p.canonical.z,te.needsCentroidUpdate=!0)}else{for(const De of W)p.encodeCentroid(void 0,p.featuresOnBorder[De],!1);if(Me){for(const De of ne)te.encodeCentroid(void 0,te.featuresOnBorder[De],!1);te.borderDoneWithNeighborZ[Q]=p.canonical.z,te.needsCentroidUpdate=!0}p.borderDoneWithNeighborZ[X]=te.canonical.z,p.needsCentroidUpdate=!0}}(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(d)}const Rs=new a.Color(1,0,0,1),Ll=new a.Color(0,1,0,1),lm=new a.Color(0,0,1,1),Ta=new a.Color(1,0,1,1),Ca=new a.Color(0,1,1,1);function Gd(d,n,c,p){vi(d,0,n+c/2,d.transform.width,c,p)}function Eu(d,n,c,p){vi(d,n-c/2,0,c,d.transform.height,p)}function vi(d,n,c,p,g,v){const T=d.context,C=T.gl;C.enable(C.SCISSOR_TEST),C.scissor(n*a.exported.devicePixelRatio,c*a.exported.devicePixelRatio,p*a.exported.devicePixelRatio,g*a.exported.devicePixelRatio),T.clear({color:v}),C.disable(C.SCISSOR_TEST)}function Tu(d,n,c){const p=d.context,g=p.gl,v=d.transform.projection.name==="globe",T=c.projMatrix,C=d.useProgram("debug",null,v?["PROJECTION_GLOBE_VIEW"]:null),I=n.getTileByID(c.key);d.terrain&&d.terrain.setupElevationDraw(I,C);const L=a.DepthMode.disabled,B=a.StencilMode.disabled,N=d.colorModeForRenderPass(),$="$debug";p.activeTexture.set(g.TEXTURE0),d.emptyTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),v?I._makeGlobeTileDebugBuffers(d.context,d.transform.projection):I._makeDebugTileBoundsBuffers(d.context,d.transform.projection);const Z=I._tileDebugBuffer||d.debugBuffer,H=I._tileDebugIndexBuffer||d.debugIndexBuffer,G=I._tileDebugSegments||d.debugSegments;C.draw(p,g.LINE_STRIP,L,B,N,a.CullFaceMode.disabled,Rd(T,a.Color.red),$,Z,H,G,null,null,null,I._globeTileDebugBorderBuffer);const ie=I.latestRawTileData,X=Math.floor((ie&&ie.byteLength||0)/1024),Q=n.getTile(c).tileSize,W=512/Math.min(Q,512)*(c.overscaledZ/d.transform.zoom)*.5;let le=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(le+=` => ${c.overscaledZ}`),function(Me,De){Me.initDebugOverlayCanvas();const Ie=Me.debugOverlayCanvas,Je=Me.context.gl,ae=Me.debugOverlayCanvas.getContext("2d");ae.clearRect(0,0,Ie.width,Ie.height),ae.shadowColor="white",ae.shadowBlur=2,ae.lineWidth=1.5,ae.strokeStyle="white",ae.textBaseline="top",ae.font="bold 36px Open Sans, sans-serif",ae.fillText(De,5,5),ae.strokeText(De,5,5),Me.debugOverlayTexture.update(Ie),Me.debugOverlayTexture.bind(Je.LINEAR,Je.CLAMP_TO_EDGE)}(d,`${le} ${X}kb`);const te=I._tileDebugTextBuffer||d.debugBuffer,ne=I._tileDebugTextIndexBuffer||d.quadTriangleIndexBuffer,_e=I._tileDebugTextSegments||d.debugSegments;C.draw(p,g.TRIANGLES,L,B,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,Rd(T,a.Color.transparent,W),$,te,ne,_e,null,null,null,I._globeTileDebugTextBuffer)}const Zy=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:cm}=Zy;function Pr(d,n,c,p){d.emplaceBack(n,c,p)}class um{constructor(n){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,Pr(this.vertexArray,-1,-1,1),Pr(this.vertexArray,1,-1,1),Pr(this.vertexArray,-1,1,1),Pr(this.vertexArray,1,1,1),Pr(this.vertexArray,-1,-1,-1),Pr(this.vertexArray,1,-1,-1),Pr(this.vertexArray,-1,1,-1),Pr(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=n.createVertexBuffer(this.vertexArray,cm),this.indexBuffer=n.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function Sa(d,n,c,p,g,v){const T=d.gl,C=n.paint.get("sky-atmosphere-color"),I=n.paint.get("sky-atmosphere-halo-color"),L=n.paint.get("sky-atmosphere-sun-intensity"),B=((N,$,Z,H,G)=>({u_matrix_3f:N,u_sun_direction:$,u_sun_intensity:Z,u_color_tint_r:[H.r,H.g,H.b,H.a],u_color_tint_m:[G.r,G.g,G.b,G.a],u_luminance:5e-5}))(a.fromMat4(a.create$1(),p),g,L,C,I);T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_CUBE_MAP_POSITIVE_X+v,n.skyboxTexture,0),c.draw(d,T.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,B,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const hm=a.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Wy{constructor(n){const c=new a.StructArrayLayout5f20;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const p=new a.StructArrayLayout3ui6;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=n.createVertexBuffer(c,hm.members),this.indexBuffer=n.createIndexBuffer(p),this.segments=a.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Cu={symbol:function(d,n,c,p,g){if(d.renderPass!=="translucent")return;const v=a.StencilMode.disabled,T=d.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(C,I,L,B,N,$,Z){const H=I.transform,G=N==="map",ie=$==="map";for(const X of C){const Q=B.getTile(X),W=Q.getBucket(L);if(!W||!W.text||!W.text.segments.get().length)continue;const le=a.evaluateSizeForZoom(W.textSizeData,H.zoom),te=ou(X,W.getProjection(),H),ne=H.calculatePixelsToTileUnitsMatrix(Q),_e=Xt(te,Q.tileID.canonical,ie,G,H,W.getProjection(),ne),Me=L.layout.get("icon-text-fit")!=="none"&&W.hasIconData();if(le){const De=Math.pow(2,H.zoom-Q.tileID.overscaledZ);qy(W,G,ie,Z,a.symbolSize,H,_e,X,De,le,Me)}}}(p,d,c,n,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),g),c.paint.get("icon-opacity").constantOr(1)!==0&&bu(d,n,c,p,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),v,T),c.paint.get("text-opacity").constantOr(1)!==0&&bu(d,n,c,p,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),v,T),n.map.showCollisionBoxes&&(sm(d,n,c,p,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),sm(d,n,c,p,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(d,n,c,p){if(d.renderPass!=="translucent")return;const g=c.paint.get("circle-opacity"),v=c.paint.get("circle-stroke-width"),T=c.paint.get("circle-stroke-opacity"),C=c.layout.get("circle-sort-key").constantOr(1)!==void 0;if(g.constantOr(1)===0&&(v.constantOr(1)===0||T.constantOr(1)===0))return;const I=d.context,L=I.gl,B=d.transform,N=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),$=a.StencilMode.disabled,Z=d.colorModeForRenderPass(),H=B.projection.name==="globe",G=[a.mercatorXfromLng(B.center.lng),a.mercatorYfromLat(B.center.lat)],ie=[];for(let Q=0;Q<p.length;Q++){const W=p[Q],le=n.getTile(W),te=le.getBucket(c);if(!te||te.projection.name!==B.projection.name)continue;const ne=te.programConfigurations.get(c.id),_e=em(c);H&&_e.push("PROJECTION_GLOBE_VIEW");const Me=d.useProgram("circle",ne,_e),De=te.layoutVertexBuffer,Ie=te.globeExtVertexBuffer,Je=te.indexBuffer,ae=B.projection.createInversionMatrix(B,W.canonical),Ce={programConfiguration:ne,program:Me,layoutVertexBuffer:De,globeExtVertexBuffer:Ie,indexBuffer:Je,uniformValues:zd(d,W,le,ae,G,c),tile:le};if(C){const Re=te.segments.get();for(const ot of Re)ie.push({segments:new a.SegmentVector([ot]),sortKey:ot.sortKey,state:Ce})}else ie.push({segments:te.segments,sortKey:0,state:Ce})}C&&ie.sort((Q,W)=>Q.sortKey-W.sortKey);const X={useDepthForOcclusion:!H};for(const Q of ie){const{programConfiguration:W,program:le,layoutVertexBuffer:te,globeExtVertexBuffer:ne,indexBuffer:_e,uniformValues:Me,tile:De}=Q.state,Ie=Q.segments;d.terrain&&d.terrain.setupElevationDraw(De,le,X),d.prepareDrawProgram(I,le,De.tileID.toUnwrapped()),le.draw(I,L.TRIANGLES,N,$,Z,a.CullFaceMode.disabled,Me,c.id,te,_e,Ie,c.paint,B.zoom,W,H?ne:null)}},heatmap:function(d,n,c,p){if(c.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const g=d.context,v=g.gl,T=a.StencilMode.disabled,C=new a.ColorMode([v.ONE,v.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(Z,H,G,ie){const X=Z.gl,Q=H.width*ie,W=H.height*ie;Z.activeTexture.set(X.TEXTURE1),Z.viewport.set([0,0,Q,W]);let le=G.heatmapFbo;if(!le||le&&(le.width!==Q||le.height!==W)){le&&le.destroy();const te=X.createTexture();X.bindTexture(X.TEXTURE_2D,te),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.LINEAR),le=G.heatmapFbo=Z.createFramebuffer(Q,W,!1),function(ne,_e,Me,De,Ie,Je){const ae=ne.gl;ae.texImage2D(ae.TEXTURE_2D,0,ae.RGBA,Ie,Je,0,ae.RGBA,ne.extRenderToTextureHalfFloat?ne.extTextureHalfFloat.HALF_FLOAT_OES:ae.UNSIGNED_BYTE,null),De.colorAttachment.set(Me)}(Z,0,te,le,Q,W)}else X.bindTexture(X.TEXTURE_2D,le.colorAttachment.get()),Z.bindFramebuffer.set(le.framebuffer)})(g,d,c,d.transform.projection.name==="globe"?.5:.25),g.clear({color:a.Color.transparent});const I=d.transform,L=I.projection.name==="globe",B=L?["PROJECTION_GLOBE_VIEW"]:null,N=L?a.CullFaceMode.frontCCW:a.CullFaceMode.disabled,$=[a.mercatorXfromLng(I.center.lng),a.mercatorYfromLat(I.center.lat)];for(let Z=0;Z<p.length;Z++){const H=p[Z];if(n.hasRenderableParent(H))continue;const G=n.getTile(H),ie=G.getBucket(c);if(!ie||ie.projection.name!==I.projection.name)continue;const X=ie.programConfigurations.get(c.id),Q=d.useProgram("heatmap",X,B),{zoom:W}=d.transform;d.terrain&&d.terrain.setupElevationDraw(G,Q),d.prepareDrawProgram(g,Q,H.toUnwrapped());const le=I.projection.createInversionMatrix(I,H.canonical);Q.draw(g,v.TRIANGLES,a.DepthMode.disabled,T,C,N,Uy(d,H,G,le,$,W,c.paint.get("heatmap-intensity")),c.id,ie.layoutVertexBuffer,ie.indexBuffer,ie.segments,c.paint,d.transform.zoom,X,L?ie.globeExtVertexBuffer:null)}g.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(g,v){const T=g.context,C=T.gl,I=v.heatmapFbo;if(!I)return;T.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,I.colorAttachment.get()),T.activeTexture.set(C.TEXTURE1);let L=v.colorRampTexture;L||(L=v.colorRampTexture=new a.Texture(T,v.colorRamp,C.RGBA)),L.bind(C.LINEAR,C.CLAMP_TO_EDGE),g.useProgram("heatmapTexture").draw(T,C.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,g.colorModeForRenderPass(),a.CullFaceMode.disabled,((B,N,$,Z)=>({u_image:0,u_color_ramp:1,u_opacity:N.paint.get("heatmap-opacity")}))(0,v),v.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments,v.paint,g.transform.zoom)}(d,c))},line:function(d,n,c,p){if(d.renderPass!=="translucent")return;const g=c.paint.get("line-opacity"),v=c.paint.get("line-width");if(g.constantOr(1)===0||v.constantOr(1)===0)return;const T=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),C=d.colorModeForRenderPass(),I=d.terrain&&d.terrain.renderingToTexture?1:a.exported.devicePixelRatio,L=c.paint.get("line-dasharray"),B=L.constantOr(1),N=c.layout.get("line-cap"),$=c.paint.get("line-pattern"),Z=$.constantOr(1),H=c.paint.get("line-gradient"),G=c.getCrossfadeParameters(),ie=Z?"linePattern":"line",X=d.context,Q=X.gl,W=(te=>{const ne=[];vu(te)&&ne.push("RENDER_LINE_DASH"),te.paint.get("line-gradient")&&ne.push("RENDER_LINE_GRADIENT");const _e=te.paint.get("line-trim-offset");_e[0]===0&&_e[1]===0||ne.push("RENDER_LINE_TRIM_OFFSET");const Me=te.paint.get("line-pattern").constantOr(1),De=te.paint.get("line-opacity").constantOr(1)!==1;return!Me&&De&&ne.push("RENDER_LINE_ALPHA_DISCARD"),ne})(c);let le=W.includes("RENDER_LINE_ALPHA_DISCARD");d.terrain&&d.terrain.clipOrMaskOverlapStencilType()&&(le=!1);for(const te of p){const ne=n.getTile(te);if(Z&&!ne.patternsLoaded())continue;const _e=ne.getBucket(c);if(!_e)continue;d.prepareDrawTile();const Me=_e.programConfigurations.get(c.id),De=d.useProgram(ie,Me,W),Ie=$.constantOr(null);if(Ie&&ne.imageAtlas){const tt=ne.imageAtlas,st=tt.patternPositions[Ie.to.toString()],at=tt.patternPositions[Ie.from.toString()];st&&at&&Me.setConstantPatternPositions(st,at)}const Je=L.constantOr(null),ae=N.constantOr(null);if(!Z&&Je&&ae&&ne.lineAtlas){const tt=ne.lineAtlas,st=tt.getDash(Je.to,ae),at=tt.getDash(Je.from,ae);st&&at&&Me.setConstantPatternPositions(st,at)}let[Ce,Re]=c.paint.get("line-trim-offset");if(ae==="round"||ae==="square"){const tt=1;Ce!==Re&&(Ce===0&&(Ce-=tt),Re===1&&(Re+=tt))}const ot=d.terrain?te.projMatrix:null,Oe=Z?jy(d,ne,c,G,ot,I):Fd(d,ne,c,G,ot,_e.lineClipsArray.length,I,[Ce,Re]);if(H){const tt=_e.gradients[c.id];let st=tt.texture;if(c.gradientVersion!==tt.version){let at=256;if(c.stepInterpolant){const nt=n.getSource().maxzoom,_t=te.canonical.z===nt?Math.ceil(1<<d.transform.maxZoom-te.canonical.z):1;at=a.clamp(a.nextPowerOfTwo(_e.maxLineLength/a.EXTENT*1024*_t),256,X.maxTextureSize)}tt.gradient=a.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:at,image:tt.gradient||void 0,clips:_e.lineClipsArray}),tt.texture?tt.texture.update(tt.gradient):tt.texture=new a.Texture(X,tt.gradient,Q.RGBA),tt.version=c.gradientVersion,st=tt.texture}X.activeTexture.set(Q.TEXTURE1),st.bind(c.stepInterpolant?Q.NEAREST:Q.LINEAR,Q.CLAMP_TO_EDGE)}B&&(X.activeTexture.set(Q.TEXTURE0),ne.lineAtlasTexture.bind(Q.LINEAR,Q.REPEAT),Me.updatePaintBuffers(G)),Z&&(X.activeTexture.set(Q.TEXTURE0),ne.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),Me.updatePaintBuffers(G)),d.prepareDrawProgram(X,De,te.toUnwrapped());const gt=tt=>{De.draw(X,Q.TRIANGLES,T,tt,C,a.CullFaceMode.disabled,Oe,c.id,_e.layoutVertexBuffer,_e.indexBuffer,_e.segments,c.paint,d.transform.zoom,Me,_e.layoutVertexBuffer2)};if(le){const tt=d.stencilModeForClipping(te).ref;tt===0&&d.terrain&&X.clear({stencil:0});const st={func:Q.EQUAL,mask:255};Oe.u_alpha_discard_threshold=.8,gt(new a.StencilMode(st,tt,255,Q.KEEP,Q.KEEP,Q.INVERT)),Oe.u_alpha_discard_threshold=0,gt(new a.StencilMode(st,tt,255,Q.KEEP,Q.KEEP,Q.KEEP))}else gt(d.stencilModeForClipping(te))}le&&(d.resetStencilClippingMasks(),d.terrain&&X.clear({stencil:0}))},fill:function(d,n,c,p){const g=c.paint.get("fill-color"),v=c.paint.get("fill-opacity");if(v.constantOr(1)===0)return;const T=d.colorModeForRenderPass(),C=c.paint.get("fill-pattern"),I=d.opaquePassEnabledForLayer()&&!C.constantOr(1)&&g.constantOr(a.Color.transparent).a===1&&v.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===I){const L=d.depthModeForSublayer(1,d.renderPass==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);Vd(d,n,c,p,L,T,!1)}if(d.renderPass==="translucent"&&c.paint.get("fill-antialias")){const L=d.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);Vd(d,n,c,p,L,T,!0)}},"fill-extrusion":function(d,n,c,p){const g=c.paint.get("fill-extrusion-opacity");if(g!==0&&d.renderPass==="translucent"){const v=new a.DepthMode(d.context.gl.LEQUAL,a.DepthMode.ReadWrite,d.depthRangeFor3D);if(g!==1||c.paint.get("fill-extrusion-pattern").constantOr(1))wu(d,n,c,p,v,a.StencilMode.disabled,a.ColorMode.disabled),wu(d,n,c,p,v,d.stencilModeFor3D(),d.colorModeForRenderPass()),d.resetStencilClippingMasks();else{const T=d.colorModeForRenderPass();wu(d,n,c,p,v,a.StencilMode.disabled,T)}}},hillshade:function(d,n,c,p){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent")return;const g=d.context,v=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),T=d.colorModeForRenderPass(),C=d.terrain&&d.terrain.renderingToTexture,[I,L]=d.renderPass!=="translucent"||C?[{},p]:d.stencilConfigForOverlap(p);for(const B of L){const N=n.getTile(B);if(N.needsHillshadePrepare&&d.renderPass==="offscreen")du(d,N,c,v,a.StencilMode.disabled,T);else if(d.renderPass==="translucent"){const $=C&&d.terrain?d.terrain.stencilModeForRTTOverlap(B):I[B.overscaledZ];Kp(d,B,N,c,v,$,T)}}g.viewport.set([0,0,d.width,d.height]),d.resetStencilClippingMasks()},raster:function(d,n,c,p,g,v){if(d.renderPass!=="translucent"||c.paint.get("raster-opacity")===0||!p.length)return;const T=d.context,C=T.gl,I=n.getSource(),L=d.useProgram("raster"),B=d.colorModeForRenderPass(),N=d.terrain&&d.terrain.renderingToTexture,[$,Z]=I instanceof we||N?[{},p]:d.stencilConfigForOverlap(p),H=Z[Z.length-1].overscaledZ,G=!d.options.moving;for(const ie of Z){const X=N?a.DepthMode.disabled:d.depthModeForSublayer(ie.overscaledZ-H,c.paint.get("raster-opacity")===1?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,C.LESS),Q=ie.toUnwrapped(),W=n.getTile(ie);if(N&&(!W||!W.hasData()))continue;const le=N?ie.projMatrix:d.transform.calculateProjMatrix(Q,G),te=d.terrain&&N?d.terrain.stencilModeForRTTOverlap(ie):$[ie.overscaledZ],ne=v?0:c.paint.get("raster-fade-duration");W.registerFadeDuration(ne);const _e=n.findLoadedParent(ie,0),Me=Md(W,_e,n,d.transform,ne);let De,Ie;d.terrain&&d.terrain.prepareDrawTile();const Je=c.paint.get("raster-resampling")==="nearest"?C.NEAREST:C.LINEAR;T.activeTexture.set(C.TEXTURE0),W.texture.bind(Je,C.CLAMP_TO_EDGE),T.activeTexture.set(C.TEXTURE1),_e?(_e.texture.bind(Je,C.CLAMP_TO_EDGE),De=Math.pow(2,_e.tileID.overscaledZ-W.tileID.overscaledZ),Ie=[W.tileID.canonical.x*De%1,W.tileID.canonical.y*De%1]):W.texture.bind(Je,C.CLAMP_TO_EDGE);const ae=Vy(le,Ie||[0,0],De||1,Me,c,I instanceof we?I.perspectiveTransform:[0,0]);if(d.prepareDrawProgram(T,L,Q),I instanceof we)I.boundsBuffer&&I.boundsSegments&&L.draw(T,C.TRIANGLES,X,a.StencilMode.disabled,B,a.CullFaceMode.disabled,ae,c.id,I.boundsBuffer,d.quadTriangleIndexBuffer,I.boundsSegments);else{const{tileBoundsBuffer:Ce,tileBoundsIndexBuffer:Re,tileBoundsSegments:ot}=d.getTileBoundsBuffers(W);L.draw(T,C.TRIANGLES,X,te,B,a.CullFaceMode.disabled,ae,c.id,Ce,Re,ot)}}d.resetStencilClippingMasks()},background:function(d,n,c,p){const g=c.paint.get("background-color"),v=c.paint.get("background-opacity");if(v===0)return;const T=d.context,C=T.gl,I=d.transform,L=I.tileSize,B=c.paint.get("background-pattern");if(d.isPatternMissing(B))return;const N=!B&&g.a===1&&v===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==N)return;const $=a.StencilMode.disabled,Z=d.depthModeForSublayer(0,N==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),H=d.colorModeForRenderPass(),G=d.useProgram(B?"backgroundPattern":"background");let ie,X=p;X||(ie=d.getBackgroundTiles(),X=Object.values(ie).map(W=>W.tileID)),B&&(T.activeTexture.set(C.TEXTURE0),d.imageManager.bind(d.context));const Q=c.getCrossfadeParameters();for(const W of X){const le=W.toUnwrapped(),te=p?W.projMatrix:d.transform.calculateProjMatrix(le);d.prepareDrawTile();const ne=n?n.getTile(W):ie?ie[W.key]:new a.Tile(W,L,I.zoom,d),_e=B?Ea(te,v,d,B,{tileID:W,tileSize:L},Q):om(te,v,g);d.prepareDrawProgram(T,G,le);const{tileBoundsBuffer:Me,tileBoundsIndexBuffer:De,tileBoundsSegments:Ie}=d.getTileBoundsBuffers(ne);G.draw(T,C.TRIANGLES,Z,$,H,a.CullFaceMode.disabled,_e,c.id,Me,De,Ie)}},sky:function(d,n,c){const p=d.transform,g=p.projection.name==="mercator"||p.projection.name==="globe"?1:a.smoothstep(7,8,p.zoom),v=c.paint.get("sky-opacity")*g;if(v===0)return;const T=d.context,C=c.paint.get("sky-type"),I=new a.DepthMode(T.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),L=d.frameCounter/1e3%1;C==="atmosphere"?d.renderPass==="offscreen"?c.needsSkyboxCapture(d)&&(function(B,N,$,Z){const H=B.context,G=H.gl;let ie=N.skyboxFbo;if(!ie){ie=N.skyboxFbo=H.createFramebuffer(32,32,!1),N.skyboxGeometry=new um(H),N.skyboxTexture=H.gl.createTexture(),G.bindTexture(G.TEXTURE_CUBE_MAP,N.skyboxTexture),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_WRAP_S,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_WRAP_T,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MIN_FILTER,G.LINEAR),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MAG_FILTER,G.LINEAR);for(let le=0;le<6;++le)G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+le,0,G.RGBA,32,32,0,G.RGBA,G.UNSIGNED_BYTE,null)}H.bindFramebuffer.set(ie.framebuffer),H.viewport.set([0,0,32,32]);const X=N.getCenter(B,!0),Q=B.useProgram("skyboxCapture"),W=new Float64Array(16);a.identity(W),a.rotateY(W,W,.5*-Math.PI),Sa(H,N,Q,W,X,0),a.identity(W),a.rotateY(W,W,.5*Math.PI),Sa(H,N,Q,W,X,1),a.identity(W),a.rotateX(W,W,.5*-Math.PI),Sa(H,N,Q,W,X,2),a.identity(W),a.rotateX(W,W,.5*Math.PI),Sa(H,N,Q,W,X,3),a.identity(W),Sa(H,N,Q,W,X,4),a.identity(W),a.rotateY(W,W,Math.PI),Sa(H,N,Q,W,X,5),H.viewport.set([0,0,B.width,B.height])}(d,c),c.markSkyboxValid(d)):d.renderPass==="sky"&&function(B,N,$,Z,H){const G=B.context,ie=G.gl,X=B.transform,Q=B.useProgram("skybox");G.activeTexture.set(ie.TEXTURE0),ie.bindTexture(ie.TEXTURE_CUBE_MAP,N.skyboxTexture);const W=((le,te,ne,_e,Me)=>({u_matrix:le,u_sun_direction:te,u_cubemap:0,u_opacity:_e,u_temporal_offset:Me}))(X.skyboxMatrix,N.getCenter(B,!1),0,Z,H);B.prepareDrawProgram(G,Q),Q.draw(G,ie.TRIANGLES,$,a.StencilMode.disabled,B.colorModeForRenderPass(),a.CullFaceMode.backCW,W,"skybox",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)}(d,c,I,v,L):C==="gradient"&&d.renderPass==="sky"&&function(B,N,$,Z,H){const G=B.context,ie=G.gl,X=B.transform,Q=B.useProgram("skyboxGradient");N.skyboxGeometry||(N.skyboxGeometry=new um(G)),G.activeTexture.set(ie.TEXTURE0);let W=N.colorRampTexture;W||(W=N.colorRampTexture=new a.Texture(G,N.colorRamp,ie.RGBA)),W.bind(ie.LINEAR,ie.CLAMP_TO_EDGE);const le=((te,ne,_e,Me,De)=>({u_matrix:te,u_color_ramp:0,u_center_direction:ne,u_radius:a.degToRad(_e),u_opacity:Me,u_temporal_offset:De}))(X.skyboxMatrix,N.getCenter(B,!1),N.paint.get("sky-gradient-radius"),Z,H);B.prepareDrawProgram(G,Q),Q.draw(G,ie.TRIANGLES,$,a.StencilMode.disabled,B.colorModeForRenderPass(),a.CullFaceMode.backCW,le,"skyboxGradient",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)}(d,c,I,v,L)},debug:function(d,n,c){for(let p=0;p<c.length;p++)Tu(d,n,c[p])},custom:function(d,n,c){const p=d.context,g=c.implementation;if(d.transform.projection.unsupportedLayers&&d.transform.projection.unsupportedLayers.includes("custom"))a.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(d.renderPass==="offscreen"){const v=g.prerender;v&&(d.setCustomLayerDefaults(),p.setColorMode(d.colorModeForRenderPass()),v.call(g,p.gl,d.transform.customLayerMatrix()),p.setDirty(),d.setBaseState())}else if(d.renderPass==="translucent"){d.setCustomLayerDefaults(),p.setColorMode(d.colorModeForRenderPass()),p.setStencilMode(a.StencilMode.disabled);const v=g.renderingMode==="3d"?new a.DepthMode(d.context.gl.LEQUAL,a.DepthMode.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,a.DepthMode.ReadOnly);p.setDepthMode(v),g.render(p.gl,d.transform.customLayerMatrix()),p.setDirty(),d.setBaseState(),p.bindFramebuffer.set(null)}}};class Su{constructor(n,c){this.context=new Y(n),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Wp,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(n,c){const p=!!n&&!!n.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new kd(this,n));const g=this._terrain;this.transform.elevation=p?g:null,g.update(n,this.transform,c)}_updateFog(n){const c=n.fog;if(!c||this.transform.projection.name==="globe"||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,g]=c.getFovAdjustedRange(this.transform._fov);if(p>g)return void(this.transform.fogCullDistSq=null);const v=p+.78*(g-p);this.transform.fogCullDistSq=v*v}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(n,c){if(this.width=n*a.exported.devicePixelRatio,this.height=c*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._layers[p].resize()}setup(){const n=this.context,c=new a.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(a.EXTENT,0),c.emplaceBack(0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(c,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const p=new a.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(a.EXTENT,0),p.emplaceBack(0,a.EXTENT),p.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(p,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const g=new a.StructArrayLayout2i4;g.emplaceBack(-1,-1),g.emplaceBack(1,-1),g.emplaceBack(-1,1),g.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(g,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const v=new a.StructArrayLayout4i8;v.emplaceBack(0,0,0,0),v.emplaceBack(a.EXTENT,0,a.EXTENT,0),v.emplaceBack(0,a.EXTENT,0,a.EXTENT),v.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=n.createVertexBuffer(v,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const T=new a.StructArrayLayout3ui6;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(T);const C=new a.StructArrayLayout1ui2;for(const L of[0,1,3,2,0])C.emplaceBack(L);this.debugIndexBuffer=n.createIndexBuffer(C),this.emptyTexture=new a.Texture(n,new a.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),n.gl.RGBA),this.identityMat=a.create();const I=this.context.gl;this.stencilClearMode=new a.StencilMode({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO),this.loadTimeStamps.push(a.window.performance.now()),this.atmosphereBuffer=new Wy(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(n){return n._makeTileBoundsBuffers(this.context,this.transform.projection),n._tileBoundsBuffer?{tileBoundsBuffer:n._tileBoundsBuffer,tileBoundsIndexBuffer:n._tileBoundsIndexBuffer,tileBoundsSegments:n._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const n=this.context,c=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(n,c.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,Ml(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(n,c,p){if(!c||this.currentStencilSource===c.id||!n.isTileClipped()||!p||p.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let C=!1;for(const I of p)if(this._tileClippingMaskIDs[I.key]===void 0){C=!0;break}if(!C)return}this.currentStencilSource=c.id;const g=this.context,v=g.gl;this.nextStencilID+p.length>256&&this.clearStencil(),g.setColorMode(a.ColorMode.disabled),g.setDepthMode(a.DepthMode.disabled);const T=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const C of p){const I=c.getTile(C),L=this._tileClippingMaskIDs[C.key]=this.nextStencilID++,{tileBoundsBuffer:B,tileBoundsIndexBuffer:N,tileBoundsSegments:$}=this.getTileBoundsBuffers(I);T.draw(g,v.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:v.ALWAYS,mask:0},L,255,v.KEEP,v.KEEP,v.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Ml(C.projMatrix),"$clipping",B,N,$)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,c=this.context.gl;return new a.StencilMode({func:c.NOTEQUAL,mask:255},n,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(n){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(n);const c=this.context.gl;return new a.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(n){const c=this.context.gl,p=n.sort((T,C)=>C.overscaledZ-T.overscaledZ),g=p[p.length-1].overscaledZ,v=p[0].overscaledZ-g+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const T={};for(let C=0;C<v;C++)T[C+g]=new a.StencilMode({func:c.GEQUAL,mask:255},C+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=v,[T,p]}return[{[g]:a.StencilMode.disabled},p]}colorModeForRenderPass(){const n=this.context.gl;if(this._showOverdrawInspector){const c=1/8;return new a.ColorMode([n.CONSTANT_COLOR,n.ONE],new a.Color(c,c,c,0),[!0,!0,!0,!0])}return this.renderPass==="opaque"?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(n,c,p){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new a.DepthMode(p||this.context.gl.LEQUAL,c,[g,g])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,c){this.style=n,this.options=c,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const p=this.style.order,g=this.style._sourceCaches;for(const I in g){const L=g[I];L.used&&L.prepare(this.context)}const v={},T={},C={};for(const I in g){const L=g[I];v[I]=L.getVisibleCoordinates(),T[I]=v[I].slice().reverse(),C[I]=L.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let I=0;I<p.length;I++)if(this.style._layers[p[I]].is3D()){this.opaquePassCutoff=I;break}if(this.terrain&&(this.terrain.updateTileBinding(C),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),a.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const I of p){const L=this.style._layers[I],B=n._getLayerSourceCache(L);if(!L.hasOffscreenPass()||L.isHidden(this.transform.zoom))continue;const N=B?T[B.id]:void 0;(L.type==="custom"||L.isSky()||N&&N.length)&&this.renderLayer(this,B,L,N)}if(this.depthRangeFor3D=[0,1-(n.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:c.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const I=this.style._layers[p[this.currentLayer]],L=n._getLayerSourceCache(I);if(I.isSky())continue;const B=L?T[L.id]:void 0;this._renderTileClippingMasks(I,L,B),this.renderLayer(this,L,I,B)}if(this.style.fog&&this.transform.projection.supportsFog&&function(I,L){const B=I.context,N=B.gl,$=I.transform,Z=new a.DepthMode(N.LEQUAL,a.DepthMode.ReadOnly,[0,1]),H=I.useProgram("globeAtmosphere",null,$.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),G=a.globeToMercatorTransition($.zoom),ie=L.properties.get("color").toArray01(),X=L.properties.get("high-color").toArray01(),Q=L.properties.get("space-color").toArray01PremultipliedAlpha(),W=a.identity$1([]);a.rotateY$1(W,W,-a.degToRad($._center.lng)),a.rotateX$1(W,W,a.degToRad($._center.lat)),a.rotateZ$1(W,W,$.angle),a.rotateX$1(W,W,-$._pitch);const le=a.fromQuat(new Float32Array(16),W),te=a.mapValue(L.properties.get("star-intensity"),0,1,0,.25),ne=5e-4,_e=a.mapValue(L.properties.get("horizon-blend"),0,1,ne,.25),Me=a.globeUseCustomAntiAliasing(I,B,$)&&_e===ne?$.worldSize/(2*Math.PI*1.025)-1:$.globeRadius,De=I.frameCounter/1e3%1,Ie=a.length($.globeCenterInViewSpace),Je=Math.sqrt(Math.pow(Ie,2)-Math.pow(Me,2)),ae=Math.acos(Je/Ie),Ce=((ot,Oe,gt,tt,st,at,nt,_t,Bt,$t,Ct,Ut,ki,Ui)=>({u_frustum_tl:ot,u_frustum_tr:Oe,u_frustum_br:gt,u_frustum_bl:tt,u_horizon:st,u_transition:at,u_fadeout_range:nt,u_color:_t,u_high_color:Bt,u_space_color:$t,u_star_intensity:Ct,u_star_size:5*a.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Ut,u_horizon_angle:ki,u_rotation_matrix:Ui}))($.frustumCorners.TL,$.frustumCorners.TR,$.frustumCorners.BR,$.frustumCorners.BL,$.frustumCorners.horizon,G,_e,ie,X,Q,te,De,ae,le);I.prepareDrawProgram(B,H);const Re=I.atmosphereBuffer;Re&&H.draw(B,N.TRIANGLES,Z,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,Ce,"skybox",Re.vertexBuffer,Re.indexBuffer,Re.segments)}(this,this.style.fog),this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const I=this.style._layers[p[this.currentLayer]],L=n._getLayerSourceCache(I);I.isSky()&&this.renderLayer(this,L,I,L?T[L.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;){const I=this.style._layers[p[this.currentLayer]],L=n._getLayerSourceCache(I);if(I.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(I)){if(I.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const B=L?(I.type==="symbol"?C:T)[L.id]:void 0;this._renderTileClippingMasks(I,L,L?v[L.id]:void 0),this.renderLayer(this,L,I,B),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let I=null;a.values(this.style._layers).forEach(L=>{const B=n._getLayerSourceCache(L);B&&!L.isHidden(this.transform.zoom)&&(!I||I.getSource().maxzoom<B.getSource().maxzoom)&&(I=B)}),I&&this.options.showTileBoundaries&&Cu.debug(this,I,I.getVisibleCoordinates())}this.options.showPadding&&function(I){const L=I.transform.padding;Gd(I,I.transform.height-(L.top||0),3,Rs),Gd(I,L.bottom||0,3,Ll),Eu(I,L.left||0,3,lm),Eu(I,I.transform.width-(L.right||0),3,Ta);const B=I.transform.centerPoint;(function(N,$,Z,H){vi(N,$-1,Z-10,2,20,H),vi(N,$-10,Z-1,20,2,H)})(I,B.x,I.transform.height-B.y,Ca)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}}renderLayer(n,c,p,g){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||g&&g.length)&&(this.id=p.id,this.gpuTimingStart(p),n.transform.projection.unsupportedLayers&&n.transform.projection.unsupportedLayers.includes(p.type)||Cu[p.type](n,c,p,g,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let p=this.gpuTimers[n.id];p||(p=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),p.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,p.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const n=this.context.extTimerQuery,c=n.createQueryEXT();this.deferredRenderGpuTimeQueries.push(c),n.beginQueryEXT(n.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}collectDeferredRenderGpuQueries(){const n=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],n}queryGpuTimers(n){const c={};for(const p in n){const g=n[p],v=this.context.extTimerQuery,T=v.getQueryObjectEXT(g.query,v.QUERY_RESULT_EXT)/1e6;v.deleteQueryEXT(g.query),c[p]=T}return c}queryGpuTimeDeferredRender(n){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.extTimerQuery;let p=0;for(const g of n)p+=c.getQueryObjectEXT(g,c.QUERY_RESULT_EXT)/1e6,c.deleteQueryEXT(g);return p}translatePosMatrix(n,c,p,g,v){if(!p[0]&&!p[1])return n;const T=v?g==="map"?this.transform.angle:0:g==="viewport"?-this.transform.angle:0;if(T){const L=Math.sin(T),B=Math.cos(T);p=[p[0]*B-p[1]*L,p[0]*L+p[1]*B]}const C=[v?p[0]:yn(c,p[0],this.transform.zoom),v?p[1]:yn(c,p[1],this.transform.zoom),0],I=new Float32Array(16);return a.translate(I,n,C),I}saveTileTexture(n){const c=this._tileTextures[n.size[0]];c?c.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const c=this._tileTextures[n];return c&&c.length>0?c.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const c=this.imageManager.getPattern(n.from.toString()),p=this.imageManager.getPattern(n.to.toString());return!c||!p}currentGlobalDefines(){const n=this.terrain&&this.terrain.renderingToTexture,c=this.style&&this.style.fog,p=[];return this.terrain&&!this.terrain.renderingToTexture&&p.push("TERRAIN"),c&&!n&&c.getOpacity(this.transform.pitch)!==0&&p.push("FOG"),n&&p.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&p.push("OVERDRAW_INSPECTOR"),p}useProgram(n,c,p){this.cache=this.cache||{};const g=p||[],v=this.currentGlobalDefines().concat(g),T=gu.cacheKey(n,v,c);return this.cache[T]||(this.cache[T]=new gu(this.context,n,uu[n],c,$y[n],v)),this.cache[T]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(n,c,p){if(this.terrain&&this.terrain.renderingToTexture)return;const g=this.style.fog;if(g){const v=g.getOpacity(this.transform.pitch),T=((C,I,L,B,N,$,Z,H,G,ie,X)=>{const Q=C.transform,W=I.properties.get("color").toArray01();W[3]=B;const le=C.frameCounter/1e3%1;return{u_fog_matrix:L?Q.calculateFogTileMatrix(L):C.identityMat,u_fog_range:I.getFovAdjustedRange(Q._fov),u_fog_color:W,u_fog_horizon_blend:I.properties.get("horizon-blend"),u_fog_temporal_offset:le,u_frustum_tl:N,u_frustum_tr:$,u_frustum_br:Z,u_frustum_bl:H,u_globe_pos:G,u_globe_radius:ie,u_viewport:X,u_globe_transition:a.globeToMercatorTransition(Q.zoom),u_is_globe:+(Q.projection.name==="globe")}})(this,g,p,v,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.exported.devicePixelRatio,this.transform.height*a.exported.devicePixelRatio]);c.setFogUniformValues(n,T)}}setTileLoadedFlag(n){this.tileLoaded=n}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const n=this.context.gl,c=n.createTexture();return n.bindTexture(n.TEXTURE_2D,c),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,0,0,n.drawingBufferWidth,n.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const n=this.style&&this.style.fog;return!!n&&n.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const n=this._backgroundTiles,c=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const g of p)c[g.key]=n[g.key]||new a.Tile(g,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class Bs{constructor(n=0,c=0,p=0,g=0){if(isNaN(n)||n<0||isNaN(c)||c<0||isNaN(p)||p<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=c,this.left=p,this.right=g}interpolate(n,c,p){return c.top!=null&&n.top!=null&&(this.top=a.number(n.top,c.top,p)),c.bottom!=null&&n.bottom!=null&&(this.bottom=a.number(n.bottom,c.bottom,p)),c.left!=null&&n.left!=null&&(this.left=a.number(n.left,c.left,p)),c.right!=null&&n.right!=null&&(this.right=a.number(n.right,c.right,p)),this}getCenter(n,c){const p=a.clamp((this.left+n-this.right)/2,0,n),g=a.clamp((this.top+c-this.bottom)/2,0,c);return new a.pointGeometry(p,g)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new Bs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Au(d,n){const c=a.getColumn(d,3);a.fromQuat(d,n),a.setColumn(d,3,c)}function zl(d,n){const c=a.identity$1([]);return a.rotateZ$1(c,c,-n),a.rotateX$1(c,c,-d),c}function Iu(d,n){const c=[d[0],d[1],0],p=[n[0],n[1],0];if(a.length(c)>=1e-15){const T=a.normalize([],c);a.scale$2(p,T,a.dot(p,T)),n[0]=p[0],n[1]=p[1]}const g=a.cross([],n,d);if(a.len(g)<1e-15)return null;const v=Math.atan2(-g[1],g[0]);return zl(Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2]),v)}class Ol{constructor(n,c){this.position=n,this.orientation=c}get position(){return this._position}set position(n){if(n){const c=n instanceof a.MercatorCoordinate?n:new a.MercatorCoordinate(n[0],n[1],n[2]);this._renderWorldCopies&&(c.x=a.wrap(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(n,c){if(this.orientation=null,!this.position)return;const p=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(n)):0,g=this.position,v=a.MercatorCoordinate.fromLngLat(n,p),T=[v.x-g.x,v.y-g.y,v.z-g.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=Iu(T,c)}setPitchBearing(n,c){this.orientation=zl(a.degToRad(n),a.degToRad(-c))}}class Aa{constructor(n,c){this._transform=a.identity([]),this.orientation=c,this.position=n}get mercatorPosition(){const n=this.position;return new a.MercatorCoordinate(n[0],n[1],n[2])}get position(){const n=a.getColumn(this._transform,3);return[n[0],n[1],n[2]]}set position(n){var c;n&&a.setColumn(this._transform,3,[(c=n)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(n){this._orientation=n||a.identity$1([]),n&&Au(this._transform,this._orientation)}getPitchBearing(){const n=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),-n[2])}}setPitchBearing(n,c){this._orientation=zl(n,c),Au(this._transform,this._orientation)}forward(){const n=a.getColumn(this._transform,2);return[-n[0],-n[1],-n[2]]}up(){const n=a.getColumn(this._transform,1);return[-n[0],-n[1],-n[2]]}right(){const n=a.getColumn(this._transform,0);return[n[0],n[1],n[2]]}getCameraToWorld(n,c){const p=new Float64Array(16);return a.invert(p,this.getWorldToCamera(n,c)),p}getWorldToCameraPosition(n,c,p){const g=this.position;a.scale$2(g,g,-n);const v=new Float64Array(16);return a.fromScaling(v,[p,p,p]),a.translate(v,v,g),v[10]*=c,v}getWorldToCamera(n,c){const p=new Float64Array(16),g=new Float64Array(4),v=this.position;return a.conjugate(g,this._orientation),a.scale$2(v,v,-n),a.fromQuat(p,g),a.translate(p,p,v),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=c,p[9]*=c,p[10]*=c,p[11]*=c,p}getCameraToClipPerspective(n,c,p,g){const v=new Float64Array(16);return a.perspective(v,n,c,p,g),v}getDistanceToElevation(n){const c=n===0?0:a.mercatorZfromAltitude(n,this.position[1]),p=this.forward();return(c-this.position[2])/p[2]}clone(){return new Aa([...this.position],[...this.orientation])}}function ft(d,n){const c=Rl(d.projection,d.zoom,d.width,d.height),p=function(v,T,C,I,L){const B=new a.LngLat(C.lng-180*Fs,C.lat),N=new a.LngLat(C.lng+180*Fs,C.lat),$=v.project(B.lng,B.lat),Z=v.project(N.lng,N.lat),H=-Math.atan2(Z.y-$.y,Z.x-$.x),G=a.MercatorCoordinate.fromLngLat(C);G.y=a.clamp(G.y,-.999975,.999975);const ie=G.toLngLat(),X=v.project(ie.lng,ie.lat),Q=a.MercatorCoordinate.fromLngLat(ie);Q.x+=Fs;const W=Q.toLngLat(),le=v.project(W.lng,W.lat),te=Ns(le.x-X.x,le.y-X.y,H),ne=a.MercatorCoordinate.fromLngLat(ie);ne.y+=Fs;const _e=ne.toLngLat(),Me=v.project(_e.lng,_e.lat),De=Ns(Me.x-X.x,Me.y-X.y,H),Ie=Math.abs(te.x)/Math.abs(De.y),Je=a.identity([]);a.rotateZ(Je,Je,-H*(1-(L?0:I)));const ae=a.identity([]);return a.scale(ae,ae,[1,1-(1-Ie)*I,1]),ae[4]=-De.x/De.y*I,a.rotateZ(ae,ae,H),a.multiply(ae,Je,ae),ae}(d.projection,0,d.center,c,n),g=Dr(d);return a.scale(p,p,[g,g,1]),p}function Dr(d){const n=d.projection,c=Rl(d.projection,d.zoom,d.width,d.height),p=qd(n,d.center),g=qd(n,a.LngLat.convert(n.center));return Math.pow(2,p*c+(1-c)*g)}function Rl(d,n,c,p,g=1/0){const v=d.range;if(!v)return 0;const T=Math.min(g,Math.max(c,p)),C=Math.log(T/1024)/Math.LN2;return a.smoothstep(v[0]+C,v[1]+C,n)}const Fs=1/4e4;function qd(d,n){const c=a.clamp(n.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),p=new a.LngLat(n.lng-180*Fs,c),g=new a.LngLat(n.lng+180*Fs,c),v=d.project(p.lng,c),T=d.project(g.lng,c),C=a.MercatorCoordinate.fromLngLat(p),I=a.MercatorCoordinate.fromLngLat(g),L=T.x-v.x,B=T.y-v.y,N=I.x-C.x,$=I.y-C.y,Z=Math.sqrt((N*N+$*$)/(L*L+B*B));return Math.log(Z)/Math.LN2}function Ns(d,n,c){const p=Math.cos(c),g=Math.sin(c);return{x:d*p-n*g,y:d*g+n*p}}class Mu{constructor(n,c,p,g,v,T,C){this.tileSize=512,this._renderWorldCopies=v===void 0||v,this._minZoom=n||0,this._maxZoom=c||22,this._minPitch=p==null?0:p,this._maxPitch=g==null?60:g,this.setProjection(T),this.setMaxBounds(C),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Bs,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Aa,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._projectionScaler=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const n=new Mu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return n._elevation=this._elevation,n._centerAltitude=this._centerAltitude,n._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,n.tileSize=this.tileSize,n.width=this.width,n.height=this.height,n.cameraElevationReference=this.cameraElevationReference,n._center=this._center,n._setZoom(this.zoom),n._seaLevelZoom=this._seaLevelZoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._nearZ=this._nearZ,n._farZ=this._farZ,n._averageElevation=this._averageElevation,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._camera=this._camera.clone(),n._calcMatrices(),n.freezeTileCoverage=this.freezeTileCoverage,n.frustumCorners=this.frustumCorners,n}get elevation(){return this._elevation}set elevation(n){this._elevation!==n&&(this._elevation=n,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(n){const c=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||c)&&this._updateCameraOnTerrain(),(n||c)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=a.getProjection(this.projectionOptions);const p=!S(c,this.getProjection());return p&&this._calcMatrices(),p}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.mercatorZfromAltitude(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(n){this.rotation=n}get rotation(){return-this.angle/Math.PI*180}set rotation(n){const c=-n*Math.PI/180;var p;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(p=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),function(g,v,T){var C=v[0],I=v[1],L=v[2],B=v[3],N=Math.sin(T),$=Math.cos(T);g[0]=C*$+L*N,g[1]=I*$+B*N,g[2]=C*-N+L*$,g[3]=I*-N+B*$}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const c=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(n){this._averageElevation=n,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(n){const c=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(n){this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const n=this._elevation;this._centerAltitude=n.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=n.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const n=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let g=0,v=0;for(let T=0;T<c.length;T++){const C=new a.pointGeometry(c[T][0]*this.width,p+c[T][1]*(this.height-p)),I=n.pointCoordinate(C);if(!I)continue;const L=1/Math.hypot(I[0]-this._camera.position[0],I[1]-this._camera.position[1]);g+=I[3]*L,v+=L}return v===0?NaN:g/v}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const n=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*c,g=this._mercatorZfromZoom(n),v=this._mercatorZfromZoom(this._maxZoom),T=Math.max(g-p,v);this._setZoom(this._zoomFromMercatorZ(T))}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}computeZoomRelativeTo(n){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,n.toAltitude()));let p;p=n.z<this._camera.position[2]?[c.x,c.y,c.z]:[n.x,n.y,n.z];const g=a.length(a.sub([],this._camera.position,p));return a.clamp(this._zoomFromMercatorZ(g),this._minZoom,this._maxZoom)}setFreeCameraOptions(n){if(!this.height||!n.position&&!n.orientation)return;this._updateCameraState();let c=!1;if(n.orientation&&!a.exactEquals(n.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(n.orientation)),n.position){const p=[n.position.x,n.position.y,n.position.z];a.exactEquals$1(p,this._camera.position)||(this._setCameraPosition(p),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const n=this._camera.position,c=new Ol;return c.position=new a.MercatorCoordinate(n[0],n[1],n[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(n){if(!a.length$1(n))return!1;a.normalize$1(n,n);const c=a.transformQuat([],[0,0,-1],n),p=a.transformQuat([],[0,-1,0],n);if(p[2]<0)return!1;const g=Iu(c,p);return!!g&&(this._camera.orientation=g,!0)}_setCameraPosition(n){const c=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,g=this.cameraToCenterDistance;n[2]=a.clamp(n[2],g/p,g/c),this._camera.position=n}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,c,p){this._unmodified=!1,this._edgeInsets.interpolate(n,c,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const c=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(n){const c=[new a.UnwrappedTileID(0,n)];if(this.renderWorldCopies){const p=this.pointCoordinate(new a.pointGeometry(0,0)),g=this.pointCoordinate(new a.pointGeometry(this.width,0)),v=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),T=this.pointCoordinate(new a.pointGeometry(0,this.height)),C=Math.floor(Math.min(p.x,g.x,v.x,T.x)),I=Math.floor(Math.max(p.x,g.x,v.x,T.x)),L=1;for(let B=C-L;B<=I+L;B++)B!==0&&c.push(new a.UnwrappedTileID(B,n))}return c}coveringTiles(n){let c=this.coveringZoomLevel(n);const p=c,g=this.elevation&&!n.isTerrainDEM,v=this.projection.name==="mercator";if(n.minzoom!==void 0&&c<n.minzoom)return[];n.maxzoom!==void 0&&c>n.maxzoom&&(c=n.maxzoom);const T=this.locationCoordinate(this.center),C=this.center.lat,I=1<<c,L=[I*T.x,I*T.y,0],B=this.projection.name==="globe",N=!B,$=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,N),Z=B?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),H=I*a.mercatorZfromAltitude(1,this.center.lat),G=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),ie=[I*Z.x,I*Z.y,G*(N?1:H)],X=this.cameraToCenterDistance/n.tileSize*(n.roundZoom?1:.502),Q=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?c:0,W=n.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,le=n.isTerrainDEM?-W:this._elevation?this._elevation.getMinElevationBelowMSL():0,te=this.projection.isReprojectedInTileSpace?Dr(this):1,ne=Oe=>{const gt=1/4e4,tt=new a.MercatorCoordinate(Oe.x+gt,Oe.y,Oe.z),st=new a.MercatorCoordinate(Oe.x,Oe.y+gt,Oe.z),at=Oe.toLngLat(),nt=tt.toLngLat(),_t=st.toLngLat(),Bt=this.locationCoordinate(at),$t=this.locationCoordinate(nt),Ct=this.locationCoordinate(_t),Ut=Math.hypot($t.x-Bt.x,$t.y-Bt.y),ki=Math.hypot(Ct.x-Bt.x,Ct.y-Bt.y);return Math.sqrt(Ut*ki)*te/gt},_e=Oe=>{const gt=W,tt=le;return{aabb:a.tileAABB(this,I,0,0,0,Oe,tt,gt,this.projection),zoom:0,x:0,y:0,minZ:tt,maxZ:gt,wrap:Oe,fullyVisible:!1}},Me=[];let De=[];const Ie=c,Je=n.reparseOverscaled?p:c,ae=Oe=>Oe*Oe,Ce=ae((G-this._centerAltitude)*H),Re=Oe=>{if(!this._elevation||!Oe.tileID||!v)return;const gt=this._elevation.getMinMaxForTile(Oe.tileID),tt=Oe.aabb;gt?(tt.min[2]=gt.min,tt.max[2]=gt.max,tt.center[2]=(tt.min[2]+tt.max[2])/2):(Oe.shouldSplit=ot(Oe),Oe.shouldSplit||(tt.min[2]=tt.max[2]=tt.center[2]=this._centerAltitude))},ot=Oe=>{if(Oe.zoom<Q)return!0;if(Oe.zoom===Ie)return!1;if(Oe.shouldSplit!=null)return Oe.shouldSplit;const gt=Oe.aabb.distanceX(ie),tt=Oe.aabb.distanceY(ie);let st=Ce,at=1;if(B){st=ae(Oe.aabb.distanceZ(ie));const _t=Math.pow(2,Oe.zoom),Bt=a.latFromMercatorY((Oe.y+1)/_t),$t=a.latFromMercatorY(Oe.y/_t),Ct=Math.min(Math.max(C,Bt),$t),Ut=a.circumferenceAtLatitude(Ct)/a.circumferenceAtLatitude(C);if(at=Ct===C?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ut/this._mercatorScaleRatio),this.zoom<=a.GLOBE_ZOOM_THRESHOLD_MIN&&Oe.zoom===Ie-1&&Ut>=.9)return!0}else if(g&&(st=ae(Oe.aabb.distanceZ(ie)*H)),this.projection.isReprojectedInTileSpace&&p<=5){const _t=Math.pow(2,Oe.zoom),Bt=ne(new a.MercatorCoordinate((Oe.x+.5)/_t,(Oe.y+.5)/_t));at=Bt>.85?1:Bt}const nt=gt*gt+tt*tt+st;return nt<ae((1<<Ie-Oe.zoom)*X*at*((_t,Bt)=>{if(Bt*ae(.707)<_t)return 1;const $t=Math.sqrt(Bt/_t);return $t/(1.4144271570014144+(Math.pow(1.1,$t-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(st,Ce),nt))};if(this.renderWorldCopies)for(let Oe=1;Oe<=3;Oe++)Me.push(_e(-Oe)),Me.push(_e(Oe));for(Me.push(_e(0));Me.length>0;){const Oe=Me.pop(),gt=Oe.x,tt=Oe.y;let st=Oe.fullyVisible;if(!st){const at=Oe.aabb.intersects($);if(at===0)continue;st=at===2}if(Oe.zoom!==Ie&&ot(Oe))for(let at=0;at<4;at++){const nt=(gt<<1)+at%2,_t=(tt<<1)+(at>>1),Bt={aabb:v?Oe.aabb.quadrant(at):a.tileAABB(this,I,Oe.zoom+1,nt,_t,Oe.wrap,Oe.minZ,Oe.maxZ,this.projection),zoom:Oe.zoom+1,x:nt,y:_t,wrap:Oe.wrap,fullyVisible:st,tileID:void 0,shouldSplit:void 0,minZ:Oe.minZ,maxZ:Oe.maxZ};g&&!B&&(Bt.tileID=new a.OverscaledTileID(Oe.zoom+1===Ie?Je:Oe.zoom+1,Oe.wrap,Oe.zoom+1,nt,_t),Re(Bt)),Me.push(Bt)}else{const at=Oe.zoom===Ie?Je:Oe.zoom;if(n.minzoom&&n.minzoom>at)continue;const nt=L[0]-(.5+gt+(Oe.wrap<<Oe.zoom))*(1<<c-Oe.zoom),_t=L[1]-.5-tt,Bt=Oe.tileID?Oe.tileID:new a.OverscaledTileID(at,Oe.wrap,Oe.zoom,gt,tt);De.push({tileID:Bt,distanceSq:nt*nt+_t*_t})}}if(this.fogCullDistSq){const Oe=this.fogCullDistSq,gt=this.horizonLineFromTop();De=De.filter(tt=>{const st=[0,0,0,1],at=[a.EXTENT,a.EXTENT,0,1],nt=this.calculateFogTileMatrix(tt.tileID.toUnwrapped());a.transformMat4$1(st,st,nt),a.transformMat4$1(at,at,nt);const _t=a.getAABBPointSquareDist(st,at);if(_t===0)return!0;let Bt=!1;const $t=this._elevation;if($t&&_t>Oe&&gt!==0){const Ct=this.calculateProjMatrix(tt.tileID.toUnwrapped());let Ut;n.isTerrainDEM||(Ut=$t.getMinMaxForTile(tt.tileID)),Ut||(Ut={min:le,max:W});const ki=a.furthestTileCorner(this.rotation),Ui=[ki[0]*a.EXTENT,ki[1]*a.EXTENT,Ut.max];a.transformMat4(Ui,Ui,Ct),Bt=(1-Ui[1])*this.height*.5<gt}return _t<Oe||Bt})}return De.sort((Oe,gt)=>Oe.distanceSq-gt.distanceSq).map(Oe=>Oe.tileID)}resize(n,c){this.width=n,this.height=c,this.pixelsToGLUnits=[2/n,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const c=a.clamp(n.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),p=this.projection.project(n.lng,c);return new a.pointGeometry(p.x*this.worldSize,p.y*this.worldSize)}unproject(n){return this.projection.unproject(n.x/this.worldSize,n.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(n,c){let p,g;const v=this.centerPoint;if(this.projection.name==="globe"){const C=this.worldSize;p=(c.x-v.x)/C,g=(c.y-v.y)/C}else{const C=this.pointCoordinate(c),I=this.pointCoordinate(v);p=C.x-I.x,g=C.y-I.y}const T=this.locationCoordinate(n);this.setLocation(new a.MercatorCoordinate(T.x-p,T.y-g))}setLocation(n){this.center=this.coordinateLocation(n),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(n){return this.projection.locationPoint(this,n)}locationPoint3D(n){return this.projection.locationPoint(this,n,!0)}pointLocation(n){return this.coordinateLocation(this.pointCoordinate(n))}pointLocation3D(n){return this.coordinateLocation(this.pointCoordinate3D(n))}locationCoordinate(n,c){const p=c?a.mercatorZfromAltitude(c,n.lat):void 0,g=this.projection.project(n.lng,n.lat);return new a.MercatorCoordinate(g.x,g.y,p)}coordinateLocation(n){return this.projection.unproject(n.x,n.y)}pointRayIntersection(n,c){const p=c!=null?c:this._centerAltitude,g=[n.x,n.y,0,1],v=[n.x,n.y,1,1];a.transformMat4$1(g,g,this.pixelMatrixInverse),a.transformMat4$1(v,v,this.pixelMatrixInverse);const T=v[3];a.scale$1(g,g,1/g[3]),a.scale$1(v,v,1/T);const C=g[2],I=v[2];return{p0:g,p1:v,t:C===I?0:(p-C)/(I-C)}}screenPointToMercatorRay(n){const c=[n.x,n.y,0,1],p=[n.x,n.y,1,1];return a.transformMat4$1(c,c,this.pixelMatrixInverse),a.transformMat4$1(p,p,this.pixelMatrixInverse),a.scale$1(c,c,1/c[3]),a.scale$1(p,p,1/p[3]),c[2]=a.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,p[2]=a.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,a.scale$1(c,c,1/this.worldSize),a.scale$1(p,p,1/this.worldSize),new a.Ray([c[0],c[1],c[2]],a.normalize([],a.sub([],p,c)))}rayIntersectionCoordinate(n){const{p0:c,p1:p,t:g}=n,v=a.mercatorZfromAltitude(c[2],this._center.lat),T=a.mercatorZfromAltitude(p[2],this._center.lat);return new a.MercatorCoordinate(a.number(c[0],p[0],g)/this.worldSize,a.number(c[1],p[1],g)/this.worldSize,a.number(v,T,g))}pointCoordinate(n,c=this._centerAltitude){return this.projection.pointCoordinate(this,n.x,n.y,c)}pointCoordinate3D(n){if(!this.elevation)return this.pointCoordinate(n);let c=this.projection.pointCoordinate3D(this,n.x,n.y);if(c)return new a.MercatorCoordinate(c[0],c[1],c[2]);let p=0,g=this.horizonLineFromTop();if(n.y>g)return this.pointCoordinate(n);const v=.02*g,T=n.clone();for(let C=0;C<10&&g-p>v;C++){T.y=a.number(p,g,.66);const I=this.projection.pointCoordinate3D(this,T.x,T.y);I?(g=T.y,c=I):p=T.y}return c?new a.MercatorCoordinate(c[0],c[1],c[2]):this.pointCoordinate(n)}isPointAboveHorizon(n){return this.projection.isPointAboveHorizon(this,n)}_coordinatePoint(n,c){const p=c&&this.elevation?this.elevation.getAtPointOrZero(n,this._centerAltitude):this._centerAltitude,g=[n.x*this.worldSize,n.y*this.worldSize,p+n.toAltitude(),1];return a.transformMat4$1(g,g,this.pixelMatrix),g[3]>0?new a.pointGeometry(g[0]/g[3],g[1]/g[3]):new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(n,c){const p=new a.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),g=new a.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),v=new a.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),T=new a.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let C=this.pointCoordinate(p,n),I=this.pointCoordinate(g,n);const L=this.pointCoordinate(v,c),B=this.pointCoordinate(T,c),N=($,Z)=>(Z.y-$.y)/(Z.x-$.x);return C.y>1&&I.y>=0?C=new a.MercatorCoordinate((1-B.y)/N(B,C)+B.x,1):C.y<0&&I.y<=1&&(C=new a.MercatorCoordinate(-B.y/N(B,C)+B.x,0)),I.y>1&&C.y>=0?I=new a.MercatorCoordinate((1-L.y)/N(L,I)+L.x,1):I.y<0&&C.y<=1&&(I=new a.MercatorCoordinate(-L.y/N(L,I)+L.x,0)),new a.LngLatBounds().extend(this.coordinateLocation(C)).extend(this.coordinateLocation(I)).extend(this.coordinateLocation(B)).extend(this.coordinateLocation(L))}_getBounds3D(){const n=this.elevation;if(!n.visibleDemTiles.length)return this._getBounds(0,0);const c=n.visibleDemTiles.reduce((p,g)=>{if(g.dem){const v=g.dem.tree;p.min=Math.min(p.min,v.minimums[0]),p.max=Math.max(p.max,v.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBounds(c.min*n.exaggeration(),c.max*n.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(n=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,p=this.height/2-c*(1-this._horizonShift);return n?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(n){this.maxBounds=n,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,n&&(this.minLat=n.getSouth(),this.maxLat=n.getNorth(),this.minLng=n.getWest(),this.maxLng=n.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(n,c){return this.projection.createTileMatrix(this,c,n)}calculateDistanceTileData(n){const c=n.key,p=this._distanceTileDataCache;if(p[c])return p[c];const g=n.canonical,v=1/this.height,T=this.cameraWorldSize/this.zoomScale(g.z),C=(g.x+Math.pow(2,g.z)*n.wrap)*T,I=g.y*T,L=this.point,B=this.angle,N=Math.sin(-B),$=-Math.cos(-B);return p[c]={bearing:[N,$],center:[(L.x-C)*v,(L.y-I)*v],scale:T/a.EXTENT*v},p[c]}calculateFogTileMatrix(n){const c=n.key,p=this._fogTileMatrixCache;if(p[c])return p[c];const g=this.projection.createTileMatrix(this,this.cameraWorldSize,n);return a.multiply(g,this.worldToFogMatrix,g),p[c]=new Float32Array(g),p[c]}calculateProjMatrix(n,c=!1){const p=n.key,g=c?this._alignedProjMatrixCache:this._projMatrixCache;if(g[p])return g[p];const v=this.calculatePosMatrix(n,this.worldSize);return a.multiply(v,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:c?this.alignedProjMatrix:this.projMatrix,v),g[p]=new Float32Array(v),g[p]}calculatePixelsToTileUnitsMatrix(n){const c=n.tileID.key,p=this._pixelsToTileUnitsCache;if(p[c])return p[c];const g=function(v,T){const{scale:C}=v.tileTransform,I=C*a.EXTENT/(v.tileSize*Math.pow(2,T.zoom-v.tileID.overscaledZ+v.tileID.canonical.z));return L=new Float32Array(4),$=(B=T.inverseAdjustmentMatrix)[1],Z=B[2],H=B[3],ie=(N=[I,I])[1],L[0]=B[0]*(G=N[0]),L[1]=$*G,L[2]=Z*ie,L[3]=H*ie,L;var L,B,N,$,Z,H,G,ie}(n,this);return p[c]=g,p[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const n=this._elevation;this._updateCameraState();const c=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(c),g=this._camera.forward(),v=a.mercatorZfromAltitude(1,this._center.lat);p[2]/=v,g[2]/=v,a.normalize(g,g);const T=n.raycast(p,g,n.exaggeration());if(T){const C=a.scaleAndAdd([],p,g,T),I=new a.MercatorCoordinate(C[0],C[1],a.mercatorZfromAltitude(C[2],a.latFromMercatorY(C[1]))),L=(I.z+a.length([I.x-p[0],I.y-p[1],I.z-p[2]*v]))*this._projectionScaler;this._seaLevelZoom=this._zoomFromMercatorZ(L),this._centerAltitude=I.toAltitude(),this._center=this.coordinateLocation(I),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const n=this._elevation;this._updateCameraState();const c=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(c),g=n.getAtPointOrZero(new a.MercatorCoordinate(...p)),v=this._minimumHeightOverTerrain()*Math.cos(a.degToRad(this._maxPitch)),T=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*g;if(T<v){const C=this.locationCoordinate(this._center,this._centerAltitude),I=[C.x-p[0],C.y-p[1],C.z-p[2]],L=a.length(I);I[2]-=(v-T)/this._projectionScaler;const B=a.length(I);if(B===0)return;a.scale$2(I,I,L/B*this._projectionScaler),this._camera.position=[C.x-I[0],C.y-I[1],C.z*this._projectionScaler-I[2]],this._camera.orientation=Iu(I,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,this.projection.isReprojectedInTileSpace){const N=this.center;return N.lat=a.clamp(N.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(N.lng=a.clamp(N.lng,this.minLng,this.maxLng)),this.center=N,void(this._constraining=!1)}const n=this._unmodified,{x:c,y:p}=this.point;let g=0,v=c,T=p;const C=this.width/2,I=this.height/2,L=this.worldMinY*this.scale,B=this.worldMaxY*this.scale;if(p-I<L&&(T=L+I),p+I>B&&(T=B-I),B-L<this.height&&(g=Math.max(g,this.height/(B-L)),T=(B+L)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const N=this.worldMinX*this.scale,$=this.worldMaxX*this.scale,Z=this.worldSize/2-(N+$)/2;v=(c+Z+this.worldSize)%this.worldSize-Z,v-C<N&&(v=N+C),v+C>$&&(v=$-C),$-N<this.width&&(g=Math.max(g,this.width/($-N)),v=($+N)/2)}v===c&&T===p||(this.center=this.unproject(new a.pointGeometry(v,T))),g&&(this.zoom+=this.scaleZoom(g)),this._constrainCameraAltitude(),this._unmodified=n,this._constraining=!1}_minZoomForBounds(){let n=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(n=Math.max(n,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),n}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,c=this.pixelsPerMeter;if(this.projection.name==="globe"){const te=a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,ne=a.mercatorZfromAltitude(1,a.GLOBE_SCALE_MATCH_LATITUDE)*this.worldSize;this._mercatorScaleRatio=te/ne}const p=Rl(this.projection,this.zoom,this.width,this.height,1024);this._projectionScaler=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,p),this.cameraToCenterDistance=this.getCameraToCenterDistance(this.projection),this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const g=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?c:1),v=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);v[8]=2*-n.x/this.width,v[9]=2*n.y/this.height;let T=a.mul([],v,g);if(this.projection.isReprojectedInTileSpace){const te=this.locationCoordinate(this.center),ne=a.identity([]);a.translate(ne,ne,[te.x*this.worldSize,te.y*this.worldSize,0]),a.multiply(ne,ne,ft(this)),a.translate(ne,ne,[-te.x*this.worldSize,-te.y*this.worldSize,0]),a.multiply(T,T,ne),this.inverseAdjustmentMatrix=function(_e){const Me=ft(_e,!0);return Dt([],[Me[0],Me[1],Me[4],Me[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],T,[this.worldSize,this.worldSize,this.worldSize/c,1]),this.projMatrix=T,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const C=a.invert([],v);this.frustumCorners=a.FrustumCorners.fromInvProjectionMatrix(C,this.horizonLineFromTop(),this.height);const I=new Float32Array(16);a.identity(I),a.scale(I,I,[1,-1,1]),a.rotateX(I,I,this._pitch),a.rotateZ(I,I,this.angle);const L=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),B=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;L[8]=2*-n.x/this.width,L[9]=2*(n.y+B)/this.height,this.skyboxMatrix=a.multiply(I,L,I);const N=this.point,$=N.x,Z=N.y,H=this.width%2/2,G=this.height%2/2,ie=Math.cos(this.angle),X=Math.sin(this.angle),Q=$-Math.round($)+ie*H+X*G,W=Z-Math.round(Z)+ie*G+X*H,le=new Float64Array(T);if(a.translate(le,le,[Q>.5?Q-1:Q,W>.5?W-1:W,0]),this.alignedProjMatrix=le,T=a.create(),a.scale(T,T,[this.width/2,-this.height/2,1]),a.translate(T,T,[1,-1,0]),this.labelPlaneMatrix=T,T=a.create(),a.scale(T,T,[1,-1,1]),a.translate(T,T,[-1,-1,0]),a.scale(T,T,[2/this.width,2/this.height,1]),this.glCoordMatrix=T,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},T=a.invert(new Float64Array(16),this.pixelMatrix),!T)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=T,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.calculateGlobeMatrix(this);const te=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.transformMat4(te,te,g),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=T;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const n=this.cameraWorldSize,c=this.cameraPixelsPerMeter,p=this._camera.position,g=1/this.height/this._projectionScaler,v=[n,n,c];a.scale$2(v,v,g),a.scale$2(p,p,-1),a.multiply$2(p,p,v);const T=a.create();a.translate(T,T,p),a.scale(T,T,v),this.mercatorFogMatrix=T,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(n,c,g)}_computeCameraPosition(n){const c=(n=n||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),g=this.point,v=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-n/this.worldSize*this._centerAltitude;return[g.x/this.worldSize-p[0]*v,g.y/this.worldSize-p[1]*v,n/this.worldSize*this._centerAltitude-p[2]*v]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(n){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=n[2];let g=1;p>0&&(g=Math.min((c-this._camera.position[2])/p,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,n,g),this._updateStateFromCamera(),this.projection.wrap&&(this.center=this.center.wrap())}_updateStateFromCamera(){const n=this._camera.position,c=this._camera.forward(),{pitch:p,bearing:g}=this._camera.getPitchBearing(),v=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._projectionScaler,T=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),C=Math.max((n[2]-v)/Math.cos(p),T),I=this._zoomFromMercatorZ(C);a.scaleAndAdd(n,n,c,C),this._pitch=a.clamp(p,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(g,-Math.PI,Math.PI),this._setZoom(a.clamp(I,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.MercatorCoordinate(n[0],n[1],n[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(n){return Math.pow(2,n)*this.tileSize}_mercatorZfromZoom(n){return this.cameraToCenterDistance/this._worldSizeFromZoom(n)}_minimumHeightOverTerrain(){const n=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(n)}_zoomFromMercatorZ(n){return this.scaleZoom(this.cameraToCenterDistance/(n*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(n,c){const p=Math.min(n.x,c.x),g=Math.max(n.x,c.x),v=Math.min(n.y,c.y),T=Math.max(n.y,c.y);if(v<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const C=[new a.pointGeometry(p,v),new a.pointGeometry(g,T),new a.pointGeometry(p,T),new a.pointGeometry(g,v)],I=this.renderWorldCopies?-3:0,L=this.renderWorldCopies?4:1;for(const B of C){const N=this.pointRayIntersection(B);if(N.t<0)return!0;const $=this.rayIntersectionCoordinate(N);if($.x<I||$.y<0||$.x>L||$.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.pointGeometry(0,0),new a.pointGeometry(this.width,this.height))}zoomDeltaToMovement(n,c){const p=a.length(a.sub([],this._camera.position,n)),g=this._zoomFromMercatorZ(p)+c;return p-this._mercatorZfromZoom(g)}getCameraPoint(){if(this.projection.name==="globe"){const n=function(c,p){const g=[c[0],c[1],c[2],1];a.transformMat4$1(g,g,p);const v=Math.max(g[3],1e-6);return[g[0]/v,g[1]/v,g[2]/v,v]}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.pointGeometry(n[0],n[1])}{const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,n))}}getCameraToCenterDistance(n){const c=Rl(n,this.zoom,this.width,this.height,1024),p=n.pixelSpaceConversion(this.center.lat,this.worldSize,c);return .5/Math.tan(.5*this._fov)*this.height*p}}function Bl(d,n){let c=!1,p=null;const g=()=>{p=null,c&&(d(),p=setTimeout(g,n),c=!1)};return()=>(c=!0,p||g(),p)}class Zd{constructor(n){this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Bl(this._updateHashUnthrottled.bind(this),300)}addTo(n){return this._map=n,a.window.addEventListener("hashchange",this._onHashChange,!1),n.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),a.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(n){const c=this._map;if(!c)return"";const p=c.getCenter(),g=Math.round(100*c.getZoom())/100,v=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,v),C=Math.round(p.lng*T)/T,I=Math.round(p.lat*T)/T,L=c.getBearing(),B=c.getPitch();let N="";if(N+=n?`/${C}/${I}/${g}`:`${g}/${I}/${C}`,(L||B)&&(N+="/"+Math.round(10*L)/10),B&&(N+=`/${Math.round(B)}`),this._hashName){const $=this._hashName;let Z=!1;const H=a.window.location.hash.slice(1).split("&").map(G=>{const ie=G.split("=")[0];return ie===$?(Z=!0,`${ie}=${N}`):G}).filter(G=>G);return Z||H.push(`${$}=${N}`),`#${H.join("&")}`}return`#${N}`}_getCurrentHash(){const n=a.window.location.hash.replace("#","");if(this._hashName){let c;return n.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(c=p)}),(c&&c[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._map;if(!n)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(p=>isNaN(p))){const p=n.dragRotate.isEnabled()&&n.touchZoomRotate.isEnabled()?+(c[3]||0):n.getBearing();return n.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:p,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const n=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,n)}}const Us={linearity:.3,easing:a.bezier(0,0,.3,1)},dm=a.extend({deceleration:2500,maxSpeed:1400},Us),fm=a.extend({deceleration:20,maxSpeed:1400},Us),Ia=a.extend({deceleration:1e3,maxSpeed:360},Us),Hy=a.extend({deceleration:1e3,maxSpeed:90},Us);class Xy{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,c=a.exported.now();for(;n.length>0&&c-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const c={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)c.zoom+=v.zoomDelta||0,c.bearing+=v.bearingDelta||0,c.pitch+=v.pitchDelta||0,v.panDelta&&c.pan._add(v.panDelta),v.around&&(c.around=v.around),v.pinchAround&&(c.pinchAround=v.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(c.pan.mag()){const v=js(c.pan.mag(),p,a.extend({},dm,n||{}));g.offset=c.pan.mult(v.amount/c.pan.mag()),g.center=this._map.transform.center,Fl(g,v)}if(c.zoom){const v=js(c.zoom,p,fm);g.zoom=this._map.transform.zoom+v.amount,Fl(g,v)}if(c.bearing){const v=js(c.bearing,p,Ia);g.bearing=this._map.transform.bearing+a.clamp(v.amount,-179,179),Fl(g,v)}if(c.pitch){const v=js(c.pitch,p,Hy);g.pitch=this._map.transform.pitch+v.amount,Fl(g,v)}if(g.zoom||g.bearing){const v=c.pinchAround===void 0?c.around:c.pinchAround;g.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),g.noMoveStart=!0,g}}function Fl(d,n){(!d.duration||d.duration<n.duration)&&(d.duration=n.duration,d.easing=n.easing)}function js(d,n,c){const{maxSpeed:p,linearity:g,deceleration:v}=c,T=a.clamp(d*g/(n/1e3),-p,p),C=Math.abs(T)/(v*g);return{easing:c.easing,duration:1e3*C,amount:T*(C/2)}}class Kn extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,c,p,g={}){const v=Ge(c.getCanvasContainer(),p),T=c.unproject(v);super(n,a.extend({point:v,lngLat:T,originalEvent:p},g)),this._defaultPrevented=!1,this.target=c}}class Nl extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,c,p){const g=n==="touchend"?p.changedTouches:p.touches,v=xt(c.getCanvasContainer(),g),T=v.map(I=>c.unproject(I)),C=v.reduce((I,L,B,N)=>I.add(L.div(N.length)),new a.pointGeometry(0,0));super(n,{points:v,point:C,lngLats:T,lngLat:c.unproject(C),originalEvent:p}),this._defaultPrevented=!1}}class pm extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,c,p){super(n,{originalEvent:p}),this._defaultPrevented=!1}}class ku{constructor(n,c){this._map=n,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(n){return this._firePreventable(new pm(n.type,this._map,n))}mousedown(n,c){return this._mousedownPos=c,this._firePreventable(new Kn(n.type,this._map,n))}mouseup(n){this._map.fire(new Kn(n.type,this._map,n))}preclick(n){const c=a.extend({},n);c.type="preclick",this._map.fire(new Kn(c.type,this._map,c))}click(n,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(n),this._map.fire(new Kn(n.type,this._map,n)))}dblclick(n){return this._firePreventable(new Kn(n.type,this._map,n))}mouseover(n){this._map.fire(new Kn(n.type,this._map,n))}mouseout(n){this._map.fire(new Kn(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Nl(n.type,this._map,n))}touchmove(n){this._map.fire(new Nl(n.type,this._map,n))}touchend(n){this._map.fire(new Nl(n.type,this._map,n))}touchcancel(n){this._map.fire(new Nl(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Wd{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(n){this._map.fire(new Kn(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Kn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Kn(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class mm{constructor(n,c){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,c){this.isEnabled()&&n.shiftKey&&n.button===0&&(fe(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(n,c){if(!this._active)return;const p=c;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=p,this._box||(this._box=z("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const v=Math.min(g.x,p.x),T=Math.max(g.x,p.x),C=Math.min(g.y,p.y),I=Math.max(g.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${v}px,${C}px)`,this._box.style.width=T-v+"px",this._box.style.height=I-C+"px")})}mouseupWindow(n,c){if(!this._active||n.button!==0)return;const p=this._startPos,g=c;if(this.reset(),$e(),p.x!==g.x||p.y!==g.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:v=>v.fitScreenCoordinates(p,g,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),xe(),delete this._startPos,delete this._lastPos}_fireEvent(n,c){return this._map.fire(new a.Event(n,{originalEvent:c}))}}function Pu(d,n){const c={};for(let p=0;p<d.length;p++)c[d[p].identifier]=n[p];return c}class _m{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(n,c,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=n.timeStamp),p.length===this.numTouches&&(this.centroid=function(g){const v=new a.pointGeometry(0,0);for(const T of g)v._add(T);return v.div(g.length)}(c),this.touches=Pu(p,c)))}touchmove(n,c,p){if(this.aborted||!this.centroid)return;const g=Pu(p,c);for(const v in this.touches){const T=this.touches[v],C=g[v];(!C||C.dist(T)>30)&&(this.aborted=!0)}}touchend(n,c,p){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class Du{constructor(n){this.singleTap=new _m(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(n,c,p){this.singleTap.touchstart(n,c,p)}touchmove(n,c,p){this.singleTap.touchmove(n,c,p)}touchend(n,c,p){const g=this.singleTap.touchend(n,c,p);if(g){const v=n.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(g)<30;if(v&&T||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class gm{constructor(){this._zoomIn=new Du({numTouches:1,numTaps:2}),this._zoomOut=new Du({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,c,p){this._zoomIn.touchstart(n,c,p),this._zoomOut.touchstart(n,c,p)}touchmove(n,c,p){this._zoomIn.touchmove(n,c,p),this._zoomOut.touchmove(n,c,p)}touchend(n,c,p){const g=this._zoomIn.touchend(n,c,p),v=this._zoomOut.touchend(n,c,p);return g?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()+1,around:T.unproject(g)},{originalEvent:n})}):v?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()-1,around:T.unproject(v)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Ma={0:1,2:2};class Lu{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(n,c){return!1}_move(n,c){return{}}mousedown(n,c){if(this._lastPoint)return;const p=pt(n);this._correctButton(n,p)&&(this._lastPoint=c,this._eventButton=p)}mousemoveWindow(n,c){const p=this._lastPoint;if(p){if(n.preventDefault(),this._eventButton!=null&&function(g,v){const T=Ma[v];return g.buttons===void 0||(g.buttons&T)!==T}(n,this._eventButton))this.reset();else if(this._moved||!(c.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(p,c)}}mouseupWindow(n){this._lastPoint&&pt(n)===this._eventButton&&(this._moved&&$e(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ym extends Lu{mousedown(n,c){super.mousedown(n,c),this._lastPoint&&(this._active=!0)}_correctButton(n,c){return c===0&&!n.ctrlKey}_move(n,c){return{around:c,panDelta:c.sub(n)}}}class Hd extends Lu{_correctButton(n,c){return c===0&&n.ctrlKey||c===2}_move(n,c){const p=.8*(c.x-n.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(n){n.preventDefault()}}class Xd extends Lu{_correctButton(n,c){return c===0&&n.ctrlKey||c===2}_move(n,c){const p=-.5*(c.y-n.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(n){n.preventDefault()}}class vm{constructor(n,c){this._map=n,this._el=n.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0)}touchstart(n,c,p){return this._calculateTransform(n,c,p)}touchmove(n,c,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1)return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return n.preventDefault(),this._calculateTransform(n,c,p)}}touchend(n,c,p){this._calculateTransform(n,c,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,c,p){p.length>0&&(this._active=!0);const g=Pu(p,c),v=new a.pointGeometry(0,0),T=new a.pointGeometry(0,0);let C=0;for(const L in g){const B=g[L],N=this._touches[L];N&&(v._add(B),T._add(B.sub(N)),C++,g[L]=B)}if(this._touches=g,C<this._minTouches||!T.mag())return;const I=T.div(C);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(C),panDelta:I}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=z("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class zu{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(n){}_move(n,c,p){return{}}touchstart(n,c,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([c[0],c[1]]))}touchmove(n,c,p){const g=this._firstTwoTouches;if(!g)return;n.preventDefault();const[v,T]=g,C=Dn(p,c,v),I=Dn(p,c,T);if(!C||!I)return;const L=this._aroundCenter?null:C.add(I).div(2);return this._move([C,I],L,n)}touchend(n,c,p){if(!this._firstTwoTouches)return;const[g,v]=this._firstTwoTouches,T=Dn(p,c,g),C=Dn(p,c,v);T&&C||(this._active&&$e(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Dn(d,n,c){for(let p=0;p<d.length;p++)if(d[p].identifier===c)return n[p]}function xm(d,n){return Math.log(d/n)/Math.LN2}class bm extends zu{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,c){const p=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(xm(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:xm(this._distance,p),pinchAround:c}}}function wm(d,n){return 180*d.angleWith(n)/Math.PI}class Ky extends zu{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,c){const p=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:wm(this._vector,p),pinchAround:c}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const c=25/(Math.PI*this._minDiameter)*360,p=wm(n,this._startVector);return Math.abs(p)<c}}function Jr(d){return Math.abs(d.y)>Math.abs(d.x)}class Em extends zu{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(n){this._lastPoints=n,Jr(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,c,p){const g=this._lastPoints;if(!g)return;const v=n[0].sub(g[0]),T=n[1].sub(g[1]);return this._map._cooperativeGestures&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(v,T,p.timeStamp),!this._valid)?void 0:(this._lastPoints=n,this._active=!0,{pitchDelta:(v.y+T.y)/2*-.5})}gestureBeginsVertically(n,c,p){if(this._valid!==void 0)return this._valid;const g=n.mag()>=2,v=c.mag()>=2;if(!g&&!v)return;if(!g||!v)return this._firstMove==null&&(this._firstMove=p),p-this._firstMove<100&&void 0;const T=n.y>0==c.y>0;return Jr(n)&&Jr(c)&&T}}const ka={panStep:100,bearingStep:15,pitchStep:10};class ho{constructor(){const n=ka;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let c=0,p=0,g=0,v=0,T=0;switch(n.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:n.shiftKey?p=-1:(n.preventDefault(),v=-1);break;case 39:n.shiftKey?p=1:(n.preventDefault(),v=1);break;case 38:n.shiftKey?g=1:(n.preventDefault(),T=-1);break;case 40:n.shiftKey?g=-1:(n.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(p=0,g=0),{cameraAnimation:C=>{const I=C.getZoom();C.easeTo({duration:300,easeId:"keyboardHandler",easing:Ou,zoom:c?Math.round(I)+c*(n.shiftKey?2:1):I,bearing:C.getBearing()+p*this._bearingStep,pitch:C.getPitch()+g*this._pitchStep,offset:[-v*this._panStep,-T*this._panStep],center:C.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ou(d){return d*(2-d)}const mt=4.000244140625;class Tm{constructor(n,c){this._map=n,this._el=n.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(n.ctrlKey||n.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=n.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const p=a.exported.now(),g=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,c!==0&&c%mt==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(g*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),n.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=n,this._delta-=c,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=Ge(this._el,n);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform,c=()=>n._terrainEnabled()&&this._aroundCoord?n.computeZoomRelativeTo(this._aroundCoord):n.zoom;if(this._delta!==0){const I=this._type==="wheel"&&Math.abs(this._delta)>mt?this._wheelZoomRate:this._defaultZoomRate;let L=2/(1+Math.exp(-Math.abs(this._delta*I)));this._delta<0&&L!==0&&(L=1/L);const B=c(),N=Math.pow(2,B),$=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):N;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom($*L))),this._type==="wheel"&&(this._startZoom=c(),this._easing=this._smoothOutEasing(200)),this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:c(),g=this._startZoom,v=this._easing;let T,C=!1;if(this._type==="wheel"&&g&&v){const I=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),L=v(I);T=a.number(g,p,L),I<1?this._frameId||(this._frameId=!0):C=!0}else T=p,C=!0;return this._active=!0,C&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!C,zoomDelta:T-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let c=a.ease;if(this._prevEase){const p=this._prevEase,g=(a.exported.now()-p.start)/p.duration,v=p.easing(g+.01)-p.easing(g),T=.27/Math.sqrt(v*v+1e-4)*.01,C=Math.sqrt(.0729-T*T);c=a.bezier(T,C,.25,1)}return this._prevEase={start:a.exported.now(),duration:n,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=z("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!a.window.document.fullscreenElement||!!a.window.document.webkitFullscreenElement}_showBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class Cm{constructor(n,c){this._clickZoom=n,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ul{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(n,c){return n.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(n.shiftKey?-1:1),around:p.unproject(c)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jl{constructor(){this._tap=new Du({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(n,c,p){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=c[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(n,c,p))}touchmove(n,c,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const g=c[0],v=g.y-this._swipePoint.y;return this._swipePoint=g,n.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(n,c,p)}touchend(n,c,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(n,c,p)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Sm{constructor(n,c,p){this._el=n,this._mousePan=c,this._touchPan=p}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Am{constructor(n,c,p){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=c,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Im{constructor(n,c,p,g){this._el=n,this._touchZoom=c,this._touchRotate=p,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Vl=d=>d.zoom||d.drag||d.pitch||d.rotate;class Mm extends a.Event{}class km{constructor(){this.constants=[1,1,.01],this.radius=0}setup(n,c){const p=a.sub([],c,n);this.radius=a.length(p[2]<0?a.div([],p,this.constants):[p[0],p[1],0])}projectRay(n){a.div(n,n,this.constants),a.normalize(n,n),a.mul$1(n,n,this.constants);const c=a.scale$2([],n,this.radius);if(c[2]>0){const p=a.scale$2([],[0,0,1],a.dot(c,[0,0,1])),g=a.scale$2([],a.normalize([],[c[0],c[1],0]),this.radius),v=a.add([],c,a.scale$2([],a.sub([],a.add([],g,p),c),2));c[0]=v[0],c[1]=v[1]}return c}}function $l(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}class Ru{constructor(n,c){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Xy(n),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new km,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),a.bindAll(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[g,v,T]of this._listeners)g.addEventListener(v,g===a.window.document?this.handleWindowEvent:this.handleEvent,T)}destroy(){for(const[n,c,p]of this._listeners)n.removeEventListener(c,n===a.window.document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(n){const c=this._map,p=c.getCanvasContainer();this._add("mapEvent",new ku(c,n));const g=c.boxZoom=new mm(c,n);this._add("boxZoom",g);const v=new gm,T=new Ul;c.doubleClickZoom=new Cm(T,v),this._add("tapZoom",v),this._add("clickZoom",T);const C=new jl;this._add("tapDragZoom",C);const I=c.touchPitch=new Em(c);this._add("touchPitch",I);const L=new Hd(n),B=new Xd(n);c.dragRotate=new Am(n,L,B),this._add("mouseRotate",L,["mousePitch"]),this._add("mousePitch",B,["mouseRotate"]);const N=new ym(n),$=new vm(c,n);c.dragPan=new Sm(p,N,$),this._add("mousePan",N),this._add("touchPan",$,["touchZoom","touchRotate"]);const Z=new Ky,H=new bm;c.touchZoomRotate=new Im(p,H,Z,C),this._add("touchRotate",Z,["touchPan","touchZoom"]),this._add("touchZoom",H,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Wd(c));const G=c.scrollZoom=new Tm(c,this);this._add("scrollZoom",G,["mousePan"]);const ie=c.keyboard=new ho;this._add("keyboard",ie);for(const X of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[X]&&c[X].enable(n[X])}_add(n,c,p){this._handlers.push({handlerName:n,handler:c,allowed:p}),this._handlersById[n]=c}stop(n){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Vl(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,c,p){for(const g in n)if(g!==p&&(!c||c.indexOf(g)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const c=[];for(const p of n)this._el.contains(p.target)&&c.push(p);return c}handleEvent(n,c){this._updatingCamera=!0;const p=n.type==="renderFrame",g=p?void 0:n,v={needsRenderFrame:!1},T={},C={},I=n.touches?this._getMapTouches(n.touches):void 0,L=I?xt(this._el,I):p?void 0:Ge(this._el,n);for(const{handlerName:$,handler:Z,allowed:H}of this._handlers){if(!Z.isEnabled())continue;let G;this._blockedByActive(C,H,$)?Z.reset():Z[c||n.type]&&(G=Z[c||n.type](n,L,I),this.mergeHandlerResult(v,T,G,$,g),G&&G.needsRenderFrame&&this._triggerRenderFrame()),(G||Z.isActive())&&(C[$]=Z)}const B={};for(const $ in this._previousActiveHandlers)C[$]||(B[$]=g);this._previousActiveHandlers=C,(Object.keys(B).length||$l(v))&&(this._changes.push([v,T,B]),this._triggerRenderFrame()),(Object.keys(C).length||$l(v))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:N}=v;N&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],N(this._map))}mergeHandlerResult(n,c,p,g,v){if(!p)return;a.extend(n,p);const T={handlerName:g,originalEvent:p.originalEvent||v};p.zoomDelta!==void 0&&(c.zoom=T),p.panDelta!==void 0&&(c.drag=T),p.pitchDelta!==void 0&&(c.pitch=T),p.bearingDelta!==void 0&&(c.rotate=T)}_applyChanges(){const n={},c={},p={};for(const[g,v,T]of this._changes)g.panDelta&&(n.panDelta=(n.panDelta||new a.pointGeometry(0,0))._add(g.panDelta)),g.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+g.pitchDelta),g.around!==void 0&&(n.around=g.around),g.aroundCoord!==void 0&&(n.aroundCoord=g.aroundCoord),g.pinchAround!==void 0&&(n.pinchAround=g.pinchAround),g.noInertia&&(n.noInertia=g.noInertia),a.extend(c,v),a.extend(p,T);this._updateMapTransform(n,c,p),this._changes=[]}_updateMapTransform(n,c,p){const g=this._map,v=g.transform,T=Q=>[Q.x,Q.y,Q.z];if((Q=>{const W=this._eventsInProgress.drag;return W&&!this._handlersById[W.handlerName].isActive()})()&&!$l(n)){const Q=v.zoom;v.cameraElevationReference="sea",v.recenterOnTerrain(),v.cameraElevationReference="ground",Q!==v.zoom&&this._map._update(!0)}if(!$l(n))return void this._fireEvents(c,p,!0);let{panDelta:C,zoomDelta:I,bearingDelta:L,pitchDelta:B,around:N,aroundCoord:$,pinchAround:Z}=n;Z!==void 0&&(N=Z),(Q=>c.drag&&!this._eventsInProgress.drag)()&&N&&(this._dragOrigin=T(v.pointCoordinate3D(N)),this._trackingEllipsoid.setup(v._camera.position,this._dragOrigin)),v.cameraElevationReference="sea",g._stop(!0),N=N||g.transform.centerPoint,L&&(v.bearing+=L),B&&(v.pitch+=B),v._updateCameraState();const H=[0,0,0];if(C){const Q=v.pointCoordinate(N);if(v.projection.name==="globe"){const W=a.latFromMercatorY(Q.y),le=v.center.lat,te=Math.min(a.mercatorZfromAltitude(1,W)/a.mercatorZfromAltitude(1,le),2);C=C.rotate(-v.angle),H[0]=-C.x/v.worldSize*te,H[1]=-C.y/v.worldSize*te}else{const W=v.pointCoordinate(N.sub(C));Q&&W&&(H[0]=W.x-Q.x,H[1]=W.y-Q.y)}}const G=v.zoom,ie=[0,0,0];if(I){const Q=T($||v.pointCoordinate3D(N)),W={dir:a.normalize([],a.sub([],Q,v._camera.position))};if(W.dir[2]<0){const le=v.zoomDeltaToMovement(Q,I);a.scale$2(ie,W.dir,le)}}const X=a.add(H,H,ie);v._translateCameraConstrained(X),I&&Math.abs(v.zoom-G)>1e-4&&v.recenterOnTerrain(),v.cameraElevationReference="ground",this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(c,p,!0)}_fireEvents(n,c,p){const g=Vl(this._eventsInProgress),v=Vl(n),T={};for(const B in n){const{originalEvent:N}=n[B];this._eventsInProgress[B]||(T[`${B}start`]=N),this._eventsInProgress[B]=n[B]}!g&&v&&this._fireEvent("movestart",v.originalEvent);for(const B in T)this._fireEvent(B,T[B]);v&&this._fireEvent("move",v.originalEvent);for(const B in n){const{originalEvent:N}=n[B];this._fireEvent(B,N)}const C={};let I;for(const B in this._eventsInProgress){const{handlerName:N,originalEvent:$}=this._eventsInProgress[B];this._handlersById[N].isActive()||(delete this._eventsInProgress[B],I=c[N]||$,C[`${B}end`]=I)}for(const B in C)this._fireEvent(B,C[B]);const L=Vl(this._eventsInProgress);if(p&&(g||v)&&!L){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),N=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;B?(N(B.bearing||this._map.getBearing())&&(B.bearing=0),this._map.easeTo(B,{originalEvent:I})):(this._map.fire(new a.Event("moveend",{originalEvent:I})),N(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,c){this._map.fire(new a.Event(n,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{this._frameId=void 0,this.handleEvent(new Mm("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Bu="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Fu extends a.Evented{constructor(n,c){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=c.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(n,c){return this.jumpTo({center:n},c)}panBy(n,c,p){return n=a.pointGeometry.convert(n).mult(-1),this.panTo(this.transform.center,a.extend({offset:n},c),p)}panTo(n,c,p){return this.easeTo(a.extend({center:n},c),p)}getZoom(){return this.transform.zoom}setZoom(n,c){return this.jumpTo({zoom:n},c),this}zoomTo(n,c,p){return this.easeTo(a.extend({zoom:n},c),p)}zoomIn(n,c){return this.zoomTo(this.getZoom()+1,n,c),this}zoomOut(n,c){return this.zoomTo(this.getZoom()-1,n,c),this}getBearing(){return this.transform.bearing}setBearing(n,c){return this.jumpTo({bearing:n},c),this}getPadding(){return this.transform.padding}setPadding(n,c){return this.jumpTo({padding:n},c),this}rotateTo(n,c,p){return this.easeTo(a.extend({bearing:n},c),p)}resetNorth(n,c){return this.rotateTo(0,a.extend({duration:1e3},n),c),this}resetNorthPitch(n,c){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},n),c),this}snapToNorth(n,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,c):this}getPitch(){return this.transform.pitch}setPitch(n,c){return this.jumpTo({pitch:n},c),this}cameraForBounds(n,c){this.transform.projection.name==="globe"&&a.warnOnce('Globe projection does not support cameraForBounds API, this API may behave unexpectedly."'),n=a.LngLatBounds.convert(n);const p=c&&c.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),p,c)}_extendCameraOptions(n){const c={top:0,bottom:0,right:0,left:0};if(typeof(n=a.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding=="number"){const p=n.padding;n.padding={top:p,bottom:p,right:p,left:p}}return n.padding=a.extend(c,n.padding),n}_cameraForBoxAndBearing(n,c,p,g){const v=this._extendCameraOptions(g),T=this.transform,C=T.padding,I=T.project(a.LngLat.convert(n)),L=T.project(a.LngLat.convert(c)),B=new a.pointGeometry(I.x,L.y),N=new a.pointGeometry(L.x,I.y),$=-a.degToRad(p),Z=I.rotate($),H=L.rotate($),G=B.rotate($),ie=N.rotate($),X=new a.pointGeometry(Math.max(Z.x,H.x,G.x,ie.x),Math.max(Z.y,H.y,G.y,ie.y)),Q=new a.pointGeometry(Math.min(Z.x,H.x,G.x,ie.x),Math.min(Z.y,H.y,G.y,ie.y)),W=X.sub(Q),le=(T.width-((C.left||0)+(C.right||0)+v.padding.left+v.padding.right))/W.x,te=(T.height-((C.top||0)+(C.bottom||0)+v.padding.top+v.padding.bottom))/W.y;if(te<0||le<0)return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ne=Math.min(T.scaleZoom(T.scale*Math.min(le,te)),v.maxZoom),_e=typeof v.offset.x=="number"&&typeof v.offset.y=="number"?new a.pointGeometry(v.offset.x,v.offset.y):a.pointGeometry.convert(v.offset),Me=new a.pointGeometry((v.padding.left-v.padding.right)/2,(v.padding.top-v.padding.bottom)/2).rotate(p*Math.PI/180),De=_e.add(Me).mult(T.scale/T.zoomScale(ne));return{center:T.unproject(I.add(L).div(2).sub(De)),zoom:ne,bearing:p}}_cameraForBox(n,c,p,g,v){const T=this._extendCameraOptions(v);p=p||0,g=g||0,n=a.LngLat.convert(n),c=a.LngLat.convert(c);const C=this.transform.clone();C.padding=T.padding;const I=this.getFreeCameraOptions(),L=new a.LngLat(.5*(n.lng+c.lng),.5*(n.lat+c.lat)),B=.5*(p+g);if(C._camera.position[2]<a.mercatorZfromAltitude(B,L.lat))return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");I.lookAtPoint(L),C.setFreeCameraOptions(I);const N=a.MercatorCoordinate.fromLngLat(n),$=a.MercatorCoordinate.fromLngLat(c),Z=C.pointRayIntersection(C.centerPoint,B),H=[(G=C.rayIntersectionCoordinate(Z)).x,G.y,G.z];var G;const ie=C.screenPointToMercatorRay(C.centerPoint),X=C.projection.name!=="globe";let Q,W=0;do{const le=Math.floor(C.zoom),te=1<<le,ne=Math.min(te*N.x,te*$.x),_e=Math.min(te*N.y,te*$.y),Me=Math.max(te*N.x,te*$.x),De=Math.max(te*N.y,te*$.y),Ie=new a.Aabb([ne,_e,p],[Me,De,g]),Je=a.Frustum.fromInvProjectionMatrix(C.invProjMatrix,C.worldSize,le,X);if(Ie.intersects(Je)!==2){Q&&(C._camera.position=a.scaleAndAdd([],C._camera.position,ie.dir,-Q),C._updateStateFromCamera());break}const ae=a.sub([],C._camera.position,H);Q=.5*a.length(ae),C._camera.position=a.scaleAndAdd([],C._camera.position,ie.dir,Q);try{C._updateStateFromCamera()}catch{return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++W<10);return{center:C.center,zoom:C.zoom,bearing:C.bearing,pitch:C.pitch}}fitBounds(n,c,p){return this.transform.projection.name==="globe"&&a.warnOnce("Globe projection does not support fitBounds API, this API may behave unexpectedly."),this._fitInternal(this.cameraForBounds(n,c),c,p)}_raycastElevationBox(n,c){const p=this.transform.elevation;if(!p)return;const g=new a.pointGeometry(n.x,c.y),v=new a.pointGeometry(c.x,n.y),T=p.pointCoordinate(n);if(!T)return;const C=p.pointCoordinate(c);if(!C)return;const I=p.pointCoordinate(g);if(!I)return;const L=p.pointCoordinate(v);if(!L)return;const B=new a.MercatorCoordinate(T[0],T[1]).toLngLat(),N=new a.MercatorCoordinate(C[0],C[1]).toLngLat(),$=new a.MercatorCoordinate(I[0],I[1]).toLngLat(),Z=new a.MercatorCoordinate(L[0],L[1]).toLngLat(),H=Math.min(B.lng,Math.min(N.lng,Math.min($.lng,Z.lng))),G=Math.min(B.lat,Math.min(N.lat,Math.min($.lat,Z.lat))),ie=Math.max(B.lng,Math.max(N.lng,Math.max($.lng,Z.lng))),X=Math.max(B.lat,Math.max(N.lat,Math.max($.lat,Z.lat))),Q=Math.min(T[3],Math.min(C[3],Math.min(I[3],L[3]))),W=Math.max(T[3],Math.max(C[3],Math.max(I[3],L[3])));return{minLngLat:new a.LngLat(H,G),maxLngLat:new a.LngLat(ie,X),minAltitude:Q,maxAltitude:W}}fitScreenCoordinates(n,c,p,g,v){let T,C,I,L;this.transform.projection.name==="globe"&&a.warnOnce("Globe projection does not support fitScreenCoordinates API, this API may behave unexpectedly.");const B=a.pointGeometry.convert(n),N=a.pointGeometry.convert(c),$=this._raycastElevationBox(B,N);if($)T=$.minLngLat,C=$.maxLngLat,I=$.minAltitude,L=$.maxAltitude;else{if(this.transform.anyCornerOffEdge(B,N))return this;T=this.transform.pointLocation(B),C=this.transform.pointLocation(N)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(a.pointGeometry.convert(n)),this.transform.pointLocation(a.pointGeometry.convert(c)),p,g):this._cameraForBox(T,C,I,L,g),g,v)}_fitInternal(n,c,p){return n?(delete(c=a.extend(n,c)).padding,c.linear?this.easeTo(c,p):this.flyTo(c,p)):this}jumpTo(n,c){this.stop();const p=n.preloadOnly?this.transform.clone():this.transform;let g=!1,v=!1,T=!1;return"zoom"in n&&p.zoom!==+n.zoom&&(g=!0,p.zoom=+n.zoom),n.center!==void 0&&(p.center=a.LngLat.convert(n.center)),"bearing"in n&&p.bearing!==+n.bearing&&(v=!0,p.bearing=+n.bearing),"pitch"in n&&p.pitch!==+n.pitch&&(T=!0,p.pitch=+n.pitch),n.padding==null||p.isPaddingEqual(n.padding)||(p.padding=n.padding),n.preloadOnly?(this._preloadTiles(p),this):(this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),g&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),v&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),T&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(Bu),this.transform.getFreeCameraOptions()}setFreeCameraOptions(n,c){const p=this.transform;if(!p.projection.supportsFreeCamera)return a.warnOnce(Bu),this;this.stop();const g=p.zoom,v=p.pitch,T=p.bearing;p.setFreeCameraOptions(n);const C=g!==p.zoom,I=v!==p.pitch,L=T!==p.bearing;return this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),C&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),L&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),I&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c)),this}easeTo(n,c){this._stop(!1,n.easeId),((n=a.extend({offset:[0,0],duration:500,easing:a.ease},n)).animate===!1||!n.essential&&a.exported.prefersReducedMotion)&&(n.duration=0);const p=this.transform,g=this.getZoom(),v=this.getBearing(),T=this.getPitch(),C=this.getPadding(),I="zoom"in n?+n.zoom:g,L="bearing"in n?this._normalizeBearing(n.bearing,v):v,B="pitch"in n?+n.pitch:T,N="padding"in n?n.padding:p.padding,$=a.pointGeometry.convert(n.offset);let Z,H,G;if(p.projection.name==="globe"){const De=a.MercatorCoordinate.fromLngLat(p.center),Ie=$.rotate(-p.angle);De.x+=Ie.x/p.worldSize,De.y+=Ie.y/p.worldSize;const Je=De.toLngLat(),ae=a.LngLat.convert(n.center||Je);this._normalizeCenter(ae),Z=p.centerPoint.add(Ie),H=new a.pointGeometry(De.x,De.y).mult(p.worldSize),G=new a.pointGeometry(a.mercatorXfromLng(ae.lng),a.mercatorYfromLat(ae.lat)).mult(p.worldSize).sub(H)}else{Z=p.centerPoint.add($);const De=p.pointLocation(Z),Ie=a.LngLat.convert(n.center||De);this._normalizeCenter(Ie),H=p.project(De),G=p.project(Ie).sub(H)}const ie=p.zoomScale(I-g);let X,Q;n.around&&(X=a.LngLat.convert(n.around),Q=p.locationPoint(X));const W=this._zooming||I!==g,le=this._rotating||v!==L,te=this._pitching||B!==T,ne=!p.isPaddingEqual(N),_e=De=>Ie=>{if(W&&(De.zoom=a.number(g,I,Ie)),le&&(De.bearing=a.number(v,L,Ie)),te&&(De.pitch=a.number(T,B,Ie)),ne&&(De.interpolatePadding(C,N,Ie),Z=De.centerPoint.add($)),X)De.setLocationAtPoint(X,Q);else{const Je=De.zoomScale(De.zoom-g),ae=I>g?Math.min(2,ie):Math.max(.5,ie),Ce=Math.pow(ae,1-Ie),Re=De.unproject(H.add(G.mult(Ie*Ce)).mult(Je));De.setLocationAtPoint(De.renderWorldCopies?Re.wrap():Re,Z)}return n.preloadOnly||this._fireMoveEvents(c),De};if(n.preloadOnly){const De=this._emulate(_e,n.duration,p);return this._preloadTiles(De),this}const Me={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=W,this._rotating=le,this._pitching=te,this._padding=ne,this._easeId=n.easeId,this._prepareEase(c,n.noMoveStart,Me),this._ease(_e(p),De=>{p.recenterOnTerrain(),this._afterEase(c,De)},n),this}_prepareEase(n,c,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||p.moving||this.fire(new a.Event("movestart",n)),this._zooming&&!p.zooming&&this.fire(new a.Event("zoomstart",n)),this._rotating&&!p.rotating&&this.fire(new a.Event("rotatestart",n)),this._pitching&&!p.pitching&&this.fire(new a.Event("pitchstart",n))}_fireMoveEvents(n){this.fire(new a.Event("move",n)),this._zooming&&this.fire(new a.Event("zoom",n)),this._rotating&&this.fire(new a.Event("rotate",n)),this._pitching&&this.fire(new a.Event("pitch",n))}_afterEase(n,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,g=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new a.Event("zoomend",n)),g&&this.fire(new a.Event("rotateend",n)),v&&this.fire(new a.Event("pitchend",n)),this.fire(new a.Event("moveend",n))}flyTo(n,c){if(!n.essential&&a.exported.prefersReducedMotion){const st=a.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(st,c)}this.stop(),n=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},n);const p=this.transform,g=this.getZoom(),v=this.getBearing(),T=this.getPitch(),C=this.getPadding(),I="zoom"in n?a.clamp(+n.zoom,p.minZoom,p.maxZoom):g,L="bearing"in n?this._normalizeBearing(n.bearing,v):v,B="pitch"in n?+n.pitch:T,N="padding"in n?n.padding:p.padding,$=p.zoomScale(I-g),Z=a.pointGeometry.convert(n.offset);let H=p.centerPoint.add(Z);const G=p.pointLocation(H),ie=a.LngLat.convert(n.center||G);this._normalizeCenter(ie);const X=p.project(G),Q=p.project(ie).sub(X);let W=n.curve;const le=Math.max(p.width,p.height),te=le/$,ne=Q.mag();if("minZoom"in n){const st=a.clamp(Math.min(n.minZoom,g,I),p.minZoom,p.maxZoom),at=le/p.zoomScale(st-g);W=Math.sqrt(at/ne*2)}const _e=W*W;function Me(st){const at=(te*te-le*le+(st?-1:1)*_e*_e*ne*ne)/(2*(st?te:le)*_e*ne);return Math.log(Math.sqrt(at*at+1)-at)}function De(st){return(Math.exp(st)-Math.exp(-st))/2}function Ie(st){return(Math.exp(st)+Math.exp(-st))/2}const Je=Me(0);let ae=function(st){return Ie(Je)/Ie(Je+W*st)},Ce=function(st){return le*((Ie(Je)*(De(at=Je+W*st)/Ie(at))-De(Je))/_e)/ne;var at},Re=(Me(1)-Je)/W;if(Math.abs(ne)<1e-6||!isFinite(Re)){if(Math.abs(le-te)<1e-6)return this.easeTo(n,c);const st=te<le?-1:1;Re=Math.abs(Math.log(te/le))/W,Ce=function(){return 0},ae=function(at){return Math.exp(st*W*at)}}n.duration="duration"in n?+n.duration:1e3*Re/("screenSpeed"in n?+n.screenSpeed/W:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0);const ot=v!==L,Oe=B!==T,gt=!p.isPaddingEqual(N),tt=st=>at=>{const nt=at*Re,_t=1/ae(nt);st.zoom=at===1?I:g+st.scaleZoom(_t),ot&&(st.bearing=a.number(v,L,at)),Oe&&(st.pitch=a.number(T,B,at)),gt&&(st.interpolatePadding(C,N,at),H=st.centerPoint.add(Z));const Bt=at===1?ie:st.unproject(X.add(Q.mult(Ce(nt))).mult(_t));return st.setLocationAtPoint(st.renderWorldCopies?Bt.wrap():Bt,H),st._updateCameraOnTerrain(),n.preloadOnly||this._fireMoveEvents(c),st};if(n.preloadOnly){const st=this._emulate(tt,n.duration,p);return this._preloadTiles(st),this}return this._zooming=!0,this._rotating=ot,this._pitching=Oe,this._padding=gt,this._prepareEase(c,!1),this._ease(tt(p),()=>this._afterEase(c),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,c)}if(!n){const p=this.handlers;p&&p.stop(!1)}return this}_ease(n,c,p){p.animate===!1||p.duration===0?(n(1),c()):(this._easeStart=a.exported.now(),this._easeOptions=p,this._onEaseFrame=n,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,c){n=a.wrap(n,-180,180);const p=Math.abs(n-c);return Math.abs(n-360-c)<p&&(n-=360),Math.abs(n+360-c)<p&&(n+=360),n}_normalizeCenter(n){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const p=n.lng-c.center.lng;n.lng+=p>180?-360:p<-180?360:0}_emulate(n,c,p){const g=Math.ceil(15*c/1e3),v=[],T=n(p.clone());for(let C=0;C<=g;C++){const I=T(C/g);v.push(I.clone())}return v}}class Kd{constructor(n={}){this.options=n,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){const c=this.options&&this.options.compact;return this._map=n,this._container=z("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=z("button","mapboxgl-ctrl-attrib-button",this._container),z("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=z("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(n,c){const p=this._map._getUIString(`AttributionControl.${c}`);n.setAttribute("aria-label",p),n.removeAttribute("title"),n.firstElementChild&&n.firstElementChild.setAttribute("title",p)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(n){const p=c.reduce((g,v,T)=>(v.value&&(g+=`${v.key}=${v.value}${T<c.length-1?"&":""}`),g),"?");n.href=`${a.config.FEEDBACK_URL}/${p}${this._map._hash?this._map._hash.getHashString(!0):""}`,n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}}_updateData(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let n=[];if(this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const c=this._map.style._sourceCaches;for(const g in c){const v=c[g];if(v.used){const T=v.getSource();T.attribution&&n.indexOf(T.attribution)<0&&n.push(T.attribution)}}n.sort((g,v)=>g.length-v.length),n=n.filter((g,v)=>{for(let T=v+1;T<n.length;T++)if(n[T].indexOf(g)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=[...this.options.customAttribution,...n]:n.unshift(this.options.customAttribution));const p=n.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,n.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Yd{constructor(){a.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(n){this._map=n,this._container=z("div","mapboxgl-ctrl");const c=z("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const n=this._map.style._sourceCaches;if(Object.entries(n).length===0)return!0;for(const c in n){const p=n[c].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const n=this._container.children;if(n.length){const c=n[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class Jd{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const c=++this._id;return this._queue.push({callback:n,id:c,cancelled:!1}),c}remove(n){const c=this._currentlyRunning,p=c?this._queue.concat(c):this._queue;for(const g of p)if(g.id===n)return void(g.cancelled=!0)}run(n=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const p of c)if(!p.cancelled&&(p.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Qd(d,n,c){if(d=new a.LngLat(d.lng,d.lat),n){const p=new a.LngLat(d.lng-360,d.lat),g=new a.LngLat(d.lng+360,d.lat),v=360*Math.ceil(Math.abs(d.lng-c.center.lng)/360),T=c.locationPoint(d).distSqr(n),C=n.x<0||n.y<0||n.x>c.width||n.y>c.height;c.locationPoint(p).distSqr(n)<T&&(C||Math.abs(p.lng-c.center.lng)<v)?d=p:c.locationPoint(g).distSqr(n)<T&&(C||Math.abs(g.lng-c.center.lng)<v)&&(d=g)}for(;Math.abs(d.lng-c.center.lng)>180;){const p=c.locationPoint(d);if(p.x>=0&&p.y>=0&&p.x<=c.width&&p.y<=c.height)break;d.lng>c.center.lng?d.lng-=360:d.lng+=360}return d}const Nu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Uu extends a.Evented{constructor(n,c){if(super(),(n instanceof a.window.HTMLElement||c)&&(n=a.extend({element:n},c)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),n&&n.element)this._element=n.element,this._offset=a.pointGeometry.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=z("div");const g=41,v=27,T=q("svg",{display:"block",height:g*this._scale+"px",width:v*this._scale+"px",viewBox:`0 0 ${v} ${g}`},this._element),C=q("radialGradient",{id:"shadowGradient"},q("defs",{},T));q("stop",{offset:"10%","stop-opacity":.4},C),q("stop",{offset:"100%","stop-opacity":.05},C),q("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},T),q("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},T),q("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},T),q("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},T),this._offset=a.pointGeometry.convert(n&&n.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",g=>{g.preventDefault()}),this._element.addEventListener("mousedown",g=>{g.preventDefault()});const p=this._element.classList;for(const g in Nu)p.remove(`mapboxgl-marker-anchor-${g}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(n){return n===this._map||(this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._updateMoving),n.on("moveend",this._update),n.on("remove",this._clearFadeTimer),n._addMarker(this),this.setDraggable(this._draggable),this._update(),n.on("click",this._onMapClick)),this}remove(){const n=this._map;return n&&(n.off("click",this._onMapClick),n.off("move",this._updateMoving),n.off("moveend",this._update),n.off("mousedown",this._addDragHandler),n.off("touchstart",this._addDragHandler),n.off("mouseup",this._onUp),n.off("touchend",this._onUp),n.off("mousemove",this._onMove),n.off("touchmove",this._onMove),n.off("remove",this._clearFadeTimer),n._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=a.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const c=38.1,p=13.5,g=Math.sqrt(Math.pow(p,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-c],"bottom-left":[g,-1*(c-p+g)],"bottom-right":[-g,-1*(c-p+g)],left:[p,-1*(c-p)],right:[-p,-1*(c-p)]}:this._offset}this._popup=n,n._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(n){const c=n.code,p=n.charCode||n.keyCode;c!=="Space"&&c!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(n){const c=n.originalEvent.target,p=this._element;this._popup&&(c===p||p.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?(n.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(n.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const n=this._map;if(!n)return!1;const c=n.unproject(this._pos),p=n.getFreeCameraOptions();if(!p.position)return!1;const g=p.position.toLngLat();return g.distanceTo(c)<.9*g.distanceTo(this._lngLat)}_evaluateOpacity(){const n=this._map;if(!n)return;const c=this._pos;if(!c||c.x<0||c.x>n.transform.width||c.y<0||c.y>n.transform.height)return void this._clearFadeTimer();const p=n.unproject(c);let g;n._usingGlobe()&&a.isLngLatBehindGlobe(n.transform,this._lngLat)?g=0:(g=1-n._queryFogOpacity(p),n.transform._terrainEnabled()&&n.getTerrain()&&this._behindTerrain()&&(g*=.2)),this._element.style.opacity=`${g}`,this._element.style.pointerEvents=g>0?"auto":"none",this._popup&&this._popup._setOpacity(g),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const n=this._pos;if(!n||!this._map)return;const c=this._calculateXYTransform()+this._calculateZTransform(),p=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${n.x}px,${n.y}px) ${Nu[this._anchor]}
            ${c}
            translate(${p.x}px,${p.y}px)
        `}_calculateXYTransform(){const n=this._pos,c=this._map;if(this.getPitchAlignment()!=="map"||!c||!n)return"";if(!c._usingGlobe()){const I=c.getPitch();return I?`rotateX(${I}deg)`:""}const p=a.radToDeg(a.globeTiltAtLngLat(c.transform,this._lngLat)),g=n.sub(a.globeCenterToScreenPoint(c.transform)),v=p/(Math.abs(g.x)+Math.abs(g.y)),T=g.x*v,C=-g.y*v;return C||T?`rotateX(${C}deg) rotateY(${T}deg)`:""}_calculateZTransform(){const n=this._calculateRotation();return n?`rotateZ(${n}deg)`:""}_calculateRotation(){if(this._rotationAlignment==="viewport"||this._rotationAlignment==="auto")return this._rotation;if(this._map&&this._rotationAlignment==="map"){const n=this._map;if(this._pos&&n&&n._usingGlobe()){const c=n.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),p=n.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(c);return this._rotation+a.radToDeg(Math.atan2(p.y,p.x))-90}return this._rotation-this._map.getBearing()}return 0}_update(n){a.window.cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=Qd(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),n===!0?this._updateFrameId=a.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._usingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(n){return this._offset=a.pointGeometry.convert(n),this._update(),this}_onMove(n){const c=this._map;if(c){if(!this._isDragging){const p=this._clickTolerance||c._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const n=this._map;n&&(n.off("mousemove",this._onMove),n.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(n){const c=this._map;c&&this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos),this._pointerdownPos=n.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(n){this._draggable=!!n;const c=this._map;return c&&(n?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"?"viewport":this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}}class Pm{constructor(n){this.jumpTo(n)}getValue(n){if(n<=this._startTime)return this._start;if(n>=this._endTime)return this._end;const c=a.easeCubicInOut((n-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(n){return n>=this._startTime&&n<=this._endTime}jumpTo(n){this._startTime=-1/0,this._endTime=-1/0,this._start=n,this._end=n}easeTo(n,c,p){this._start=this.getValue(c),this._end=n,this._startTime=c,this._endTime=c+p}}const ef={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Dm={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function ju(d){d.parentNode&&d.parentNode.removeChild(d)}const Lm={showCompass:!0,showZoom:!0,visualizePitch:!1};class zm{constructor(n,c,p=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new Hd({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,p&&(this.mousePitch=new Xd({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(n,c){this.mouseRotate.mousedown(n,c),this.mousePitch&&this.mousePitch.mousedown(n,c),fe()}move(n,c){const p=this.map,g=this.mouseRotate.mousemoveWindow(n,c),v=g&&g.bearingDelta;if(v&&p.setBearing(p.getBearing()+v),this.mousePitch){const T=this.mousePitch.mousemoveWindow(n,c),C=T&&T.pitchDelta;C&&p.setPitch(p.getPitch()+C)}}off(){const n=this.element;n.removeEventListener("mousedown",this.mousedown),n.removeEventListener("touchstart",this.touchstart,{passive:!1}),n.removeEventListener("touchmove",this.touchmove),n.removeEventListener("touchend",this.touchend),n.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){xe(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(n){this.down(a.extend({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),Ge(this.element,n)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(n){this.move(n,Ge(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=xt(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=xt(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const tf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Om={maxWidth:100,unit:"metric"};function Vs(d,n,c,p,g,v){const T=function(I){const L=Math.pow(10,`${Math.floor(I)}`.length-1);let B=I/L;return B=B>=10?10:B>=5?5:B>=3?3:B>=2?2:B>=1?1:function(N){const $=Math.pow(10,Math.ceil(-Math.log(N)/Math.LN10));return Math.round(N*$)/$}(B),L*B}(c),C=T/c;v._requestDomTask(()=>{d.style.width=n*C+"px",d.innerHTML=g!=="nautical-mile"?new Intl.NumberFormat(p,{style:"unit",unitDisplay:"narrow",unit:g}).format(T):`${T}&nbsp;nm`})}const Rm={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},nf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Vu(d=new a.pointGeometry(0,0),n="bottom"){if(typeof d=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(d,2)));switch(n){case"top":return new a.pointGeometry(0,d);case"top-left":return new a.pointGeometry(c,c);case"top-right":return new a.pointGeometry(-c,c);case"bottom":return new a.pointGeometry(0,-d);case"bottom-left":return new a.pointGeometry(c,-c);case"bottom-right":return new a.pointGeometry(-c,-c);case"left":return new a.pointGeometry(d,0);case"right":return new a.pointGeometry(-d,0)}return new a.pointGeometry(0,0)}return d instanceof a.pointGeometry||Array.isArray(d)?a.pointGeometry.convert(d):a.pointGeometry.convert(d[n]||[0,0])}const Pa={version:a.version,supported:O,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends Fu{constructor(d){if((d=a.extend({},Dm,d)).minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(d.antialias&&a.isSafariWithAntialiasingBug(a.window)&&(d.antialias=!1,a.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Mu(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies),d),this._interactive=d.interactive,this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=d.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=d.collectResourceTiming,this._optimizeForTerrain=d.optimizeForTerrain,this._language=d.language==="auto"?a.window.navigator.language:d.language,this._worldview=d.worldview,this._renderTaskQueue=new Jd,this._domRenderTaskQueue=new Jd,this._controls=[],this._markers=[],this._mapId=a.uniqueId(),this._locale=a.extend({},ef,d.locale),this._clickTolerance=d.clickTolerance,this._cooperativeGestures=d.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Pm(0),this._explicitProjection=null,this._requestManager=new a.RequestManager(d.transformRequest,d.accessToken,d.testMode),this._silenceAuthErrors=!!d.testMode,typeof d.container=="string"){if(this._container=a.window.document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof a.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),d.maxBounds&&this.setMaxBounds(d.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Ru(this,d),this._localFontFamily=d.localFontFamily,this._localIdeographFontFamily=d.localIdeographFontFamily,d.style&&this.setStyle(d.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),d.projection&&this.setProjection(d.projection),this._hash=d.hash&&new Zd(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,a.extend({},d.fitBoundsOptions,{duration:0})))),this.resize(),d.attributionControl&&this.addControl(new Kd({customAttribution:d.customAttribution})),this._logoControl=new Yd,this.addControl(this._logoControl,d.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",n=>{this._update(n.dataType==="style"),this.fire(new a.Event(`${n.dataType}data`,n))}),this.on("dataloading",n=>{this.fire(new a.Event(`${n.dataType}dataloading`,n))})}_getMapId(){return this._mapId}addControl(d,n){if(n===void 0&&(n=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=d.onAdd(this);this._controls.push(d);const p=this._controlPositions[n];return n.indexOf("bottom")!==-1?p.insertBefore(c,p.firstChild):p.appendChild(c),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(d);return n>-1&&this._controls.splice(n,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(d){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new a.Event("movestart",d)).fire(new a.Event("move",d)),this.fire(new a.Event("resize",d)),n&&this.fire(new a.Event("moveend",d)),this}getBounds(){return this.transform.projection.name==="globe"&&a.warnOnce('Globe projection does not support getBounds API, this API may behave unexpectedly."'),this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(d){return this.transform.setMaxBounds(a.LngLatBounds.convert(d)),this._update()}setMinZoom(d){if((d=d==null?-2:d)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d?this.setZoom(d):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d==null?22:d)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d?this.setZoom(d):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d==null?0:d)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d?this.setPitch(d):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d==null?85:d)>85)throw new Error("maxPitch must be less than or equal to 85");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d?this.setPitch(d):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.renderWorldCopies=d,this._update()}getLanguage(){return this._language}setLanguage(d){if(this._language=d==="auto"?a.window.navigator.language:d,this.style)for(const n in this.style._sourceCaches){const c=this.style._sourceCaches[n]._source;c._setLanguage&&c._setLanguage(this._language)}for(const n of this._controls)n._setLanguage&&n._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(d){if(this._worldview=d,this.style)for(const n in this.style._sourceCaches){const c=this.style._sourceCaches[n]._source;c._setWorldview&&c._setWorldview(d)}return this}getProjection(){return this._explicitProjection?this._explicitProjection:this.style&&this.style.stylesheet&&this.style.stylesheet.projection?this.style.stylesheet.projection:{name:"mercator",center:[0,0]}}_usingGlobe(){return this.transform.projection.name==="globe"}setProjection(d){return this._lazyInitEmptyStyle(),d?typeof d=="string"&&(d={name:d}):d=null,this._updateProjection(d)}_updateProjection(d){const n=this.getProjection();d===null&&(this._explicitProjection=null);const c=d||this.getProjection();let p;if(c&&c.name==="globe"&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?(p=this.transform.setProjection({name:"mercator"}),this.transform.mercatorFromTransition=!0):(p=this.transform.setProjection(c),this.transform.mercatorFromTransition=!1),d&&(this._explicitProjection=d.name==="globe"?{name:"globe",center:[0,0]}:this.transform.getProjection()),this.style.applyProjectionUpdate(),p){if(n.name==="globe"&&this.getProjection().name==="globe")this.style._forceSymbolLayerUpdate();else{this.painter.clearBackgroundTiles();for(const g in this.style._sourceCaches)this.style._sourceCaches[g].clearTiles()}this._update(!0)}return this}project(d){return this.transform.locationPoint3D(a.LngLat.convert(d))}unproject(d){return this.transform.pointLocation3D(a.pointGeometry.convert(d))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(d,n,c){if(d==="mouseenter"||d==="mouseover"){let p=!1;const g=T=>{const C=n.filter(L=>this.getLayer(L)),I=C.length?this.queryRenderedFeatures(T.point,{layers:C}):[];I.length?p||(p=!0,c.call(this,new Kn(d,this,T.originalEvent,{features:I}))):p=!1},v=()=>{p=!1};return{layers:new Set(n),listener:c,delegates:{mousemove:g,mouseout:v}}}if(d==="mouseleave"||d==="mouseout"){let p=!1;const g=T=>{const C=n.filter(I=>this.getLayer(I));(C.length?this.queryRenderedFeatures(T.point,{layers:C}):[]).length?p=!0:p&&(p=!1,c.call(this,new Kn(d,this,T.originalEvent)))},v=T=>{p&&(p=!1,c.call(this,new Kn(d,this,T.originalEvent)))};return{layers:new Set(n),listener:c,delegates:{mousemove:g,mouseout:v}}}{const p=g=>{const v=n.filter(C=>this.getLayer(C)),T=v.length?this.queryRenderedFeatures(g.point,{layers:v}):[];T.length&&(g.features=T,c.call(this,g),delete g.features)};return{layers:new Set(n),listener:c,delegates:{[d]:p}}}}on(d,n,c){if(c===void 0)return super.on(d,n);Array.isArray(n)||(n=[n]);const p=this._createDelegatedListener(d,n,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(p);for(const g in p.delegates)this.on(g,p.delegates[g]);return this}once(d,n,c){if(c===void 0)return super.once(d,n);Array.isArray(n)||(n=[n]);const p=this._createDelegatedListener(d,n,c);for(const g in p.delegates)this.once(g,p.delegates[g]);return this}off(d,n,c){if(c===void 0)return super.off(d,n);n=new Set(Array.isArray(n)?n:[n]);const p=(v,T)=>{if(v.size!==T.size)return!1;for(const C of v)if(!T.has(C))return!1;return!0},g=this._delegatedListeners?this._delegatedListeners[d]:void 0;return g&&(v=>{for(let T=0;T<v.length;T++){const C=v[T];if(C.listener===c&&p(C.layers,n)){for(const I in C.delegates)this.off(I,C.delegates[I]);return v.splice(T,1),this}}})(g),this}queryRenderedFeatures(d,n){return this.style?(n!==void 0||d===void 0||d instanceof a.pointGeometry||Array.isArray(d)||(n=d,d=void 0),this.style.queryRenderedFeatures(d=d||[[0,0],[this.transform.width,this.transform.height]],n=n||{},this.transform)):[]}querySourceFeatures(d,n){return this.style.querySourceFeatures(d,n)}queryTerrainElevation(d,n){const c=this.transform.elevation;return c?(n=a.extend({},{exaggerated:!0},n),c.getAtPoint(a.MercatorCoordinate.fromLngLat(d),null,n.exaggerated)):null}setStyle(d,n){return(n=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&n.localFontFamily===this._localFontFamily&&this.style&&d?(this._diffStyle(d,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(d,n))}_getUIString(d){const n=this._locale[d];if(n==null)throw new Error(`Missing UI string '${d}'`);return n}_updateStyle(d,n){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),d&&(this.style=new Yr(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d):this.style.loadJSON(d)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Yr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(d,n){if(typeof d=="string"){const c=this._requestManager.normalizeStyleURL(d),p=this._requestManager.transformRequest(c,a.ResourceType.Style);a.getJSON(p,(g,v)=>{g?this.fire(new a.ErrorEvent(g)):v&&this._updateDiff(v,n)})}else typeof d=="object"&&this._updateDiff(d,n)}_updateDiff(d,n){try{this.style.setState(d)&&this._update(!0)}catch(c){a.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(d,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.warnOnce("There is no style added to the map."),!1)}addSource(d,n){return this._lazyInitEmptyStyle(),this.style.addSource(d,n),this._update(!0)}isSourceLoaded(d){return!!this.style&&this.style._isSourceCacheLoaded(d)}areTilesLoaded(){const d=this.style&&this.style._sourceCaches;for(const n in d){const c=d[n]._tiles;for(const p in c){const g=c[p];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}addSourceType(d,n,c){this._lazyInitEmptyStyle(),this.style.addSourceType(d,n,c)}removeSource(d){return this.style.removeSource(d),this._updateTerrain(),this._update(!0)}getSource(d){return this.style.getSource(d)}addImage(d,n,{pixelRatio:c=1,sdf:p=!1,stretchX:g,stretchY:v,content:T}={}){if(this._lazyInitEmptyStyle(),n instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&n instanceof a.window.ImageBitmap){const{width:C,height:I,data:L}=a.exported.getImageData(n);this.style.addImage(d,{data:new a.RGBAImage({width:C,height:I},L),pixelRatio:c,stretchX:g,stretchY:v,content:T,sdf:p,version:0})}else if(n.width===void 0||n.height===void 0)this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:C,height:I}=n,L=n;this.style.addImage(d,{data:new a.RGBAImage({width:C,height:I},new Uint8Array(L.data)),pixelRatio:c,stretchX:g,stretchY:v,content:T,sdf:p,version:0,userImage:L}),L.onAdd&&L.onAdd(this,d)}}updateImage(d,n){const c=this.style.getImage(d);if(!c)return void this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=n instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&n instanceof a.window.ImageBitmap?a.exported.getImageData(n):n,{width:g,height:v}=p;g!==void 0&&v!==void 0?g===c.data.width&&v===c.data.height?(c.data.replace(p.data,!(n instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&n instanceof a.window.ImageBitmap)),this.style.updateImage(d,c)):this.fire(new a.ErrorEvent(new Error(`The width and height of the updated image (${g}, ${v})
                must be that same as the previous version of the image
                (${c.data.width}, ${c.data.height})`))):this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(d){return d?!!this.style.getImage(d):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d,n){a.getImage(this._requestManager.transformRequest(d,a.ResourceType.Image),(c,p)=>{n(c,p instanceof a.window.HTMLImageElement?a.exported.getImageData(p):p)})}listImages(){return this.style.listImages()}addLayer(d,n){return this._lazyInitEmptyStyle(),this.style.addLayer(d,n),this._update(!0)}moveLayer(d,n){return this.style.moveLayer(d,n),this._update(!0)}removeLayer(d){return this.style.removeLayer(d),this._update(!0)}getLayer(d){return this.style.getLayer(d)}setLayerZoomRange(d,n,c){return this.style.setLayerZoomRange(d,n,c),this._update(!0)}setFilter(d,n,c={}){return this.style.setFilter(d,n,c),this._update(!0)}getFilter(d){return this.style.getFilter(d)}setPaintProperty(d,n,c,p={}){return this.style.setPaintProperty(d,n,c,p),this._update(!0)}getPaintProperty(d,n){return this.style.getPaintProperty(d,n)}setLayoutProperty(d,n,c,p={}){return this.style.setLayoutProperty(d,n,c,p),this._update(!0)}getLayoutProperty(d,n){return this.style.getLayoutProperty(d,n)}setLight(d,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(d,n),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(d){return this._lazyInitEmptyStyle(),!d&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(d),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(d){return this._lazyInitEmptyStyle(),this.style.setFog(d),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(d){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(d),this.transform):0}setFeatureState(d,n){return this.style.setFeatureState(d,n),this._update()}removeFeatureState(d,n){return this.style.removeFeatureState(d,n),this._update()}getFeatureState(d){return this.style.getFeatureState(d)}_updateContainerDimensions(){if(!this._container)return;const d=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let c,p,g,v=this._container;for(;v&&(!p||!g);){const T=a.window.getComputedStyle(v).transform;T&&T!=="none"&&(c=T.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&c[0]!=="0"&&c[0]!=="1"&&(p=c[0]),c[3]&&c[3]!=="0"&&c[3]!=="1"&&(g=c[3])),v=v.parentElement}this._containerWidth=p?Math.abs(d/p):d,this._containerHeight=g?Math.abs(n/g):n}_detectMissingCSS(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=z("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();const n=this._canvasContainer=z("div","mapboxgl-canvas-container",d);this._interactive&&n.classList.add("mapboxgl-interactive"),this._canvas=z("canvas","mapboxgl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=z("div","mapboxgl-control-container",d),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(g=>{p[g]=z("div",`mapboxgl-ctrl-${g}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(d,n){const c=a.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(d),this._canvas.height=c*Math.ceil(n),this._canvas.style.width=`${d}px`,this._canvas.style.height=`${n}px`}_addMarker(d){this._markers.push(d)}_removeMarker(d){const n=this._markers.indexOf(d);n!==-1&&this._markers.splice(n,1)}_setupPainter(){const d=a.extend({},O.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl",d)||this._canvas.getContext("experimental-webgl",d);n?(a.storeAuthState(n,!0),this.painter=new Su(n,this.transform),this.on("data",c=>{c.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(n)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:d}))}_contextRestored(d){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:d}))}_onMapScroll(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_requestDomTask(d){!this.loaded()||this.loaded()&&!this.isMoving()?d():this._domRenderTaskQueue.add(d)}_render(d){let n;const c=this.painter.context.extTimerQuery,p=a.exported.now();if(this.listens("gpu-timing-frame")&&(n=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(d),this._domRenderTaskQueue.run(d),this._removed)return;this.getProjection().name==="globe"&&(this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.projection.name==="globe"&&this._updateProjection():this.transform.projection.name==="mercator"&&this._updateProjection());let g=!1;const v=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,L=this.transform.pitch,B=a.exported.now();this.style.zoomHistory.update(I,B);const N=new a.EvaluationParameters(I,{now:B,fadeDuration:v,pitch:L,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),$=N.crossFadingFactor();$===1&&$===this._crossFadingFactor||(g=!0,this._crossFadingFactor=$),this.style.update(N)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let T=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),T=this._updateAverageElevation(p),this.style._updateSources(this.transform),this._forceMarkerUpdate()):T=this._updateAverageElevation(p),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,v,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:v,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||g)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const I=a.exported.now()-p;c.endQueryEXT(c.TIME_ELAPSED_EXT,n),setTimeout(()=>{const L=c.getQueryObjectEXT(n,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(n),this.fire(new a.Event("gpu-timing-frame",{cpuTime:I,gpuTime:L})),a.window.performance.mark("frame-gpu",{startTime:p,detail:{gpuTime:L}})},50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout(()=>{const L=this.painter.queryGpuTimers(I);this.fire(new a.Event("gpu-timing-layer",{layerTimes:L}))},50)}if(this.listens("gpu-timing-deferred-render")){const I=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const L=this.painter.queryGpuTimeDeferredRender(I);this.fire(new a.Event("gpu-timing-deferred-render",{gpuTime:L}))},50)}const C=this._sourcesDirty||this._styleDirty||this._placementDirty||T;if(C||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(T=this._updateAverageElevation(p,!0)),T)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const L=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:L})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||C||(this._fullyLoaded=!0,this._authenticate())}_forceMarkerUpdate(){for(const d of this._markers)d._update()}_updateAverageElevation(d,n=!1){const c=p=>(this.transform.averageElevation=p,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&c(0);if((n||d-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(d)){const p=this.transform.averageElevation;let g=this.transform.sampleAverageElevation(),v=!1;this.transform.elevation&&(v=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(g)?g=0:this._averageElevationLastSampledAt=d;const T=Math.abs(p-g);if(T>1){if(this._isInitialLoad||v)return this._averageElevation.jumpTo(g),c(g);this._averageElevation.easeTo(g,d,300)}else if(T>1e-4)return this._averageElevation.jumpTo(g),c(g)}return!!this._averageElevation.isEasing(d)&&c(this._averageElevation.getValue(d))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,d=>{if(d&&(d.message===a.AUTH_ERR_MSG||d.status===401)){const n=this.painter.context.gl;a.storeAuthState(n,!1),this._logoControl instanceof Yd&&this._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const d=this.painter.canvasCopy(),n=this.painter.getCanvasCopiesAndTimestamps();n.timeStamps.push(performance.now());const c=this.painter.context.gl,p=c.createFramebuffer();function g(v){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,v,0);const T=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,T),T}return c.bindFramebuffer(c.FRAMEBUFFER,p),this._canvasPixelComparison(g(d),n.canvasCopies.map(g),n.timeStamps)}_canvasPixelComparison(d,n,c){let p=c[1]-c[0];const g=d.length/4;for(let v=0;v<n.length;v++){const T=n[v];let C=0;for(let I=0;I<T.length;I+=4)T[I]===d[I]&&T[I+1]===d[I+1]&&T[I+2]===d[I+2]&&T[I+3]===d[I+3]&&(C+=1);p+=(c[v+2]-c[v+1])*(1-C/g)}return p}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));const d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),ju(this._canvasContainer),ju(this._controlContainer),ju(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(d){this._renderNextFrame=this._renderNextFrame||d,this.style&&!this._frame&&(this._frame=a.exported.frame(n=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(n)}))}_preloadTiles(d){const n=this.style?Object.values(this.style._sourceCaches):[];return a.asyncAll(n,(c,p)=>c._preloadTiles(d,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(d){this._trackResize&&this.resize({originalEvent:d})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(d){this._showTerrainWireframe!==d&&(this._showTerrainWireframe=d,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(d){this._speedIndexTiming!==d&&(this._speedIndexTiming=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}_setCacheLimits(d,n){a.setCacheLimits(d,n)}get version(){return a.version}},NavigationControl:class{constructor(d){this.options=a.extend({},Lm,d),this._container=z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",n=>{this._map&&this._map.zoomIn({},{originalEvent:n})}),z("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",n=>{this._map&&this._map.zoomOut({},{originalEvent:n})}),z("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",n=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:n}):c.resetNorth({},{originalEvent:n}))}),this._compassIcon=z("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const d=this._map;if(!d)return;const n=d.getZoom(),c=n===d.getMaxZoom(),p=n===d.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const d=this._map;if(!d)return;const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(d.transform.pitch*(Math.PI/180)),.5)}) rotateX(${d.transform.pitch}deg) rotateZ(${d.transform.angle*(180/Math.PI)}deg)`:`rotate(${d.transform.angle*(180/Math.PI)}deg)`;d._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=n)})}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),d.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&d.on("pitch",this._rotateCompassArrow),d.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new zm(d,this._compass,this.options.visualizePitch)),this._container}onRemove(){const d=this._map;d&&(this._container.remove(),this.options.showZoom&&d.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&d.off("pitch",this._rotateCompassArrow),d.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(d,n){const c=z("button",d,this._container);return c.type="button",c.addEventListener("click",n),c}_setButtonTitle(d,n){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${n}`);d.setAttribute("aria-label",c),d.firstElementChild&&d.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends a.Evented{constructor(d){super(),this.options=a.extend({geolocation:a.window.navigator.geolocation},tf,d),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Bl(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(d){return this._map=d,this._container=z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(d){this._supportsGeolocation!==void 0?d(this._supportsGeolocation):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(n=>{this._supportsGeolocation=n.state!=="denied",d(this._supportsGeolocation)}):(this._supportsGeolocation=!!this.geolocation,d(this._supportsGeolocation))}_isOutOfMapMaxBounds(d){const n=this._map.getMaxBounds(),c=d.coords;return!!n&&(c.longitude<n.getWest()||c.longitude>n.getEast()||c.latitude<n.getSouth()||c.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(d),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(d),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",d)),this._finish()}}_updateCamera(d){const n=new a.LngLat(d.coords.longitude,d.coords.latitude),c=d.coords.accuracy,p=this._map.getBearing(),g=a.extend({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(c),g,{geolocateSource:!0})}_updateMarker(d){if(d){const n=new a.LngLat(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const d=this._map.transform,n=a.mercatorZfromAltitude(1,d._center.lat)*d.worldSize,c=Math.ceil(2*this._accuracy*n);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(d){if(this._map){if(this.options.trackUserLocation)if(d.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(d.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",d)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(d){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=z("button","mapboxgl-ctrl-geolocate",this._container),z("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",d===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=z("div","mapboxgl-user-location"),this._dotElement.appendChild(z("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(z("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Uu({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=z("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Uu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}_onDeviceOrientation(d){this._userLocationDotMarker&&(d.webkitCompassHeading?this._heading=d.webkitCompassHeading:d.absolute===!0&&(this._heading=-1*d.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let d;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(d={maximumAge:6e5,timeout:0},this._noTimeout=!0):(d=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,d),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const d=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};a.window.DeviceMotionEvent!==void 0&&typeof a.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(n=>{n==="granted"&&d()}).catch(console.error):d()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientation),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Kd,ScaleControl:class{constructor(d){this.options=a.extend({},Om,d),a.bindAll(["_update","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){(function(d,n,c,p){const g=p&&p.maxWidth||100,v=d._containerHeight/2,T=d._containerWidth/2-g/2,C=d.unproject([T,v]),I=d.unproject([T+g,v]),L=C.distanceTo(I);if(p&&p.unit==="imperial"){const B=3.2808*L;B>5280?Vs(n,g,B/5280,c,"mile",d):Vs(n,g,B,c,"foot",d)}else p&&p.unit==="nautical"?Vs(n,g,L/1852,c,"nautical-mile",d):L>=1e3?Vs(n,g,L/1e3,c,"kilometer",d):Vs(n,g,L,c,"meter",d)})(this._map,this._container,this._language,this.options)}onAdd(d){return this._map=d,this._language=d.getLanguage(),this._container=z("div","mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(d){this._language=d,this._update()}setUnit(d){this.options.unit=d,this._update()}},FullscreenControl:class{constructor(d){this._fullscreen=!1,d&&d.container&&(d.container instanceof a.window.HTMLElement?this._container=d.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const d=this._fullscreenButton=z("button","mapboxgl-ctrl-fullscreen",this._controlContainer);z("span","mapboxgl-ctrl-icon",d).setAttribute("aria-hidden","true"),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",d)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(d){super(),this.options=a.extend(Object.create(Rm),d),a.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(d&&d.className?d.className.trim().split(/\s+/):[])}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&d.on("preclick",this._onClose),this.options.closeOnMove&&d.on("move",this._onClose),d.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(d.on("mousemove",this._onMouseEvent),d.on("mouseup",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")):d.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const d=this._map;return d&&(d.off("move",this._update),d.off("move",this._onClose),d.off("preclick",this._onClose),d.off("click",this._onClose),d.off("remove",this.remove),d.off("mousemove",this._onMouseEvent),d.off("mouseup",this._onMouseEvent),d.off("drag",this._onMouseEvent),this._map=void 0),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(d){this._lngLat=a.LngLat.convert(d),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const d=this._map;return d&&(d.off("move",this._update),d.on("mousemove",this._onMouseEvent),d.on("drag",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(a.window.document.createTextNode(d))}setHTML(d){const n=a.window.document.createDocumentFragment(),c=a.window.document.createElement("body");let p;for(c.innerHTML=d;p=c.firstChild,p;)n.appendChild(p);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){let n=this._content;if(n)for(;n.hasChildNodes();)n.firstChild&&n.removeChild(n.firstChild);else n=this._content=z("div","mapboxgl-popup-content",this._container||void 0);if(n.appendChild(d),this.options.closeButton){const c=this._closeButton=z("button","mapboxgl-popup-close-button",n);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(d){return this._classList.add(d),this._updateClassList(),this}removeClassName(d){return this._classList.delete(d),this._updateClassList(),this}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){let n;return this._classList.delete(d)?n=!1:(this._classList.add(d),n=!0),this._updateClassList(),n}_onMouseEvent(d){this._update(d.point)}_getAnchor(d){if(this.options.anchor)return this.options.anchor;const n=this._map,c=this._container,p=this._pos;if(!n||!c||!p)return"bottom";const g=c.offsetWidth,v=c.offsetHeight,T=p.x<g/2,C=p.x>n.transform.width-g/2;if(p.y+d<v)return T?"top-left":C?"top-right":"top";if(p.y>n.transform.height-v){if(T)return"bottom-left";if(C)return"bottom-right"}return T?"left":C?"right":"bottom"}_updateClassList(){const d=this._container;if(!d)return;const n=[...this._classList];n.push("mapboxgl-popup"),this._anchor&&n.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&n.push("mapboxgl-popup-track-pointer"),d.className=n.join(" ")}_update(d){const n=this._map,c=this._content;if(!n||!this._lngLat&&!this._trackPointer||!c)return;let p=this._container;if(p||(p=this._container=z("div","mapboxgl-popup",n.getContainer()),this._tip=z("div","mapboxgl-popup-tip",p),p.appendChild(c)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Qd(this._lngLat,this._pos,n.transform)),!this._trackPointer||d){const g=this._pos=this._trackPointer&&d?d:n.project(this._lngLat),v=Vu(this.options.offset),T=this._anchor=this._getAnchor(v.y),C=Vu(this.options.offset,T),I=g.add(C).round();n._requestDomTask(()=>{this._container&&T&&(this._container.style.transform=`${Nu[T]} translate(${I.x}px,${I.y}px)`)})}if(!this._marker&&n._usingGlobe()){const g=a.isLngLatBehindGlobe(n.transform,this._lngLat)?0:1;this._setOpacity(g)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(nf);d&&d.focus()}_onClose(){this.remove()}_setOpacity(d){this._container&&(this._container.style.opacity=`${d}`),this._content&&(this._content.style.pointerEvents=d?"auto":"none")}},Marker:Uu,Style:Yr,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:Ol,Evented:a.Evented,config:a.config,prewarm:function(){Ei().acquire(Pt)},clearPrewarmedResources:function(){const d=Ht;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(Pt),Ht=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(d){a.config.ACCESS_TOKEN=d},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(d){a.config.API_URL=d},get workerCount(){return Rt.workerCount},set workerCount(d){Rt.workerCount=d},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){a.config.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage(d){a.clearTileCache(d)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return Pa});var E=_;return E})})(Zk);var eZ=Zk.exports;export{Q8 as A,J8 as B,qk as C,Y8 as D,z3 as E,Co as F,eZ as G,N8 as H,Z_ as I,z0 as J,US as K,B8 as L,$8 as M,Bh as S,P2 as T,K8 as V,vN as _,R8 as a,vF as b,ys as c,wr as d,G8 as e,u2 as f,wF as g,EF as h,O8 as i,q8 as j,F8 as k,l2 as l,I3 as m,H8 as n,ux as o,z8 as p,cF as q,Yf as r,U8 as s,L8 as t,X8 as u,fN as v,V8 as w,j8 as x,W8 as y,Z8 as z};
